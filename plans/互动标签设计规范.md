# 互动标签设计规范

> 本文档总结了设计 ACU 可视化表格"互动标签"功能时的核心原则与最佳实践。

---

## 一、核心定位

**互动标签是剧情推进器，不是游戏操作面板。**

标签的作用是向 AI 发送简短的情境提示词，引导叙事方向。它不是用来模拟游戏机制（如装备、升级、库存管理）的。

---

## 二、技术规范

### 2.1 数据结构

```typescript
interface InteractiveTag {
  id: string;
  label: string;           // 标签显示文本，≤4字
  categoryId: string;      // 分类 ID
  promptTemplate: string;  // 提示词模板
  createdAt: string;
  allowPreEdit?: boolean;  // 二次编辑：点击后弹出编辑器让用户修改再发送
}
```

### 2.2 分类结构

```typescript
interface TagCategory {
  id: string;
  path: string;   // 用 "/" 分隔层级，如 "人物/社交"
  icon?: string;  // Font Awesome class，如 "fas fa-user"
}
```

### 2.3 可用通配符

| 通配符 | 含义 | 示例 |
|--------|------|------|
| `{{rowTitle}}` | 互动对象（选中行的标题列值） | 小明、酒馆、长剑 |
| `{{value}}` | 标签名本身 | 搭话、前往、使用 |
| `{{user}}` | 玩家角色名 | (由酒馆宏替换) |
| `{{tableName}}` | 当前表格名 | 人物表、物品表 |

**重点：用 `{{rowTitle}}` 指代互动对象，这是最常用的通配符。**

---

## 三、标签名规范

1. **字数限制**：不超过 4 个汉字
2. **动词优先**：用动词或动词短语（前往、搭话、使用）
3. **避免名词**：不要用"对话"（名词感），用"交谈"或"搭话"

---

## 四、提示词写作规范

### 4.1 ✅ 应该做

- **自然语言**：像对人说话一样写
- **简洁直接**：告诉 AI 当前情境是什么，或要做什么
- **留白**：不要过度规定细节，让 AI 发挥

**好的示例：**
- `向{{rowTitle}}搭话。`
- `出发前往{{rowTitle}}。`
- `在{{rowTitle}}四处闲逛。`

### 4.2 ❌ 不应该做

| 错误类型 | 反例 | 问题 |
|----------|------|------|
| 预设情感目的 | "邀请TA一同行动，以此加深羁绊。" | 用户可能只是想组队，不一定要"加深羁绊" |
| 废话指导 | "描写沿途风景与抵达时的见闻。" | AI 本职就是写正文，不需要你教它描写 |
| 机械分析 | "分析其意图与状态。" | 不需要任何分析类，有目的自然写作时描写行动会分析 |
| 非自然语言 | "使用物品，描写生效时的现象与结果。" | 生硬，改成"使用{{rowTitle}}。" |
| 流水账操作 | "获得物品" / "装备" / "忘记" | 这些是表格数据操作，不是剧情推进 |

---

## 五、二次编辑（allowPreEdit）

当标签动作需要用户补充细节时，开启 `allowPreEdit: true`。

**适用场景：**
- 交谈（需补充话题）
- 请求（需补充请求内容）
- 赠送（需补充送给谁/为什么）
- 质问（需补充质问内容）

**不适用场景：**
- 前往、离开（目标已由 rowTitle 确定）
- 观察、注视（不需要额外参数）

---

## 六、AIRP 场景适用性筛选

AIRP（AI Role-Play）的核心是**叙事驱动的角色扮演**，不是游戏系统模拟。

### 6.1 高频使用

| 分类 | 标签 | 说明 |
|------|------|------|
| 地点 | 前往、离开、探索、闲逛 | 场景切换与探索 |
| 人物 | 搭话、询问、邀请、告别、注视、跟随 | 社交互动 |
| 情绪 | 沉默、发呆、叹气 | 情绪表达/氛围营造 |
| 动作 | 躲藏、逃跑、追赶、等待 | 通用动作 |

### 6.2 中频使用（特定题材）

| 分类 | 标签 | 适用题材 |
|------|------|----------|
| 物品 | 使用、检查、赠送 | 有道具系统的卡 |
| 冲突 | 攻击、威胁、挑衅 | 战斗/冒险题材 |
| 技能 | 施放 | 魔法/超能力题材 |

### 6.3 低频/不推荐

| 分类 | 标签 | 问题 |
|------|------|------|
| 任务流程 | 承接、交付、放弃 | 游戏化，大多数AIRP不是任务驱动 |
| 物品管理 | 拾取、丢弃、拆解、修理 | 流水账，这些是自然发生的 |
| 技能修炼 | 练习、突破、领悟 | 太垂直（修仙/升级流专用） |
| 状态变更 | 装备、卸下 | 改表格字段即可，不需要AI描写 |

---

## 七、推荐的默认标签库

*（待最终确认后补充）*
