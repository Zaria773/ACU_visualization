# åŸä»£ç ç»“æ„åˆ†ææŠ¥å‘Šï¼š`kilocode/å¯è§†åŒ–è¡¨æ ¼/6.4.1.ts`
6.4.1.tsï¼šæ‹¿æ¥ä¿®æ”¹çš„åŸè£…ç‰ˆæœ¬ã€‚å¤§é‡DOMæ“ä½œã€htmlæ‹¼æ¥ã€cssæ ·å¼ç­‰
**æ–‡ä»¶æ¦‚è§ˆ**

| å±æ€§ | å€¼ |
|------|-----|
| æ€»è¡Œæ•° | 4587 è¡Œ |
| é¡¹ç›®ç±»å‹ | è„šæœ¬é¡¹ç›®ï¼ˆä»… index.tsï¼Œæ—  index.htmlï¼‰ |
| DOM æ“ä½œæ–¹å¼ | `window.jQuery || window.parent.jQuery` (è·¨ iframe æ“ä½œ) |
| æ ·å¼æ³¨å…¥ | `teleport_style` æœºåˆ¶ |

---

## 1. å…¨å±€å˜é‡æ¸…å•

> **æ³¨**ï¼šä»¥ä¸‹å˜é‡å®šä¹‰ä½äºæ–‡ä»¶å¤´éƒ¨ï¼ˆè¡Œå· 1-38ï¼‰ï¼Œæ•°æ®ä»¥ç²¾å‡†æ‰«æä¸ºå‡†ã€‚

| å˜é‡å | ç±»å‹ | ç”¨é€” | è¡Œå· |
|--------|------|------|------|
| [`SCRIPT_ID`]14) | `string` | è„šæœ¬å”¯ä¸€æ ‡è¯†ç¬¦ | 14 |
| [`STORAGE_KEY_TABLE_ORDER`]15) | `string` | è¡¨æ ¼é¡ºåºå­˜å‚¨é”® | 15 |
| [`STORAGE_KEY_ACTIVE_TAB`]16) | `string` | å½“å‰æ´»è·ƒæ ‡ç­¾é¡µå­˜å‚¨é”® | 16 |
| [`STORAGE_KEY_UI_CONFIG`]17) | `string` | UIé…ç½®å­˜å‚¨é”® | 17 |
| [`STORAGE_KEY_LAST_SNAPSHOT`]18) | `string` | æ•°æ®å¿«ç…§å­˜å‚¨é”® | 18 |
| [`STORAGE_KEY_UI_COLLAPSE`]19) | `string` | æŠ˜å çŠ¶æ€å­˜å‚¨é”® | 19 |
| [`STORAGE_KEY_TABLE_HEIGHTS`]20) | `string` | è¡¨æ ¼é«˜åº¦å­˜å‚¨é”® | 20 |
| [`STORAGE_KEY_REVERSE_TABLES`]21) | `string` | å€’åºè¡¨æ ¼åˆ—è¡¨å­˜å‚¨é”® | 21 |
| [`TAB_DASHBOARD`]22) | `string` | ä»ªè¡¨ç›˜æ ‡ç­¾å¸¸é‡ | 22 |
| [`STORAGE_KEY_PIN`]23) | `string` | å›ºå®šçŠ¶æ€å­˜å‚¨é”® | 23 |
| [`STORAGE_KEY_TABLE_STYLES`]24) | `string` | è¡¨æ ¼æ ·å¼å­˜å‚¨é”® | 24 |
| [`TAB_OPTIONS`]25) | `string` | é€‰é¡¹é¢æ¿æ ‡ç­¾å¸¸é‡ | 25 |
| [`isInitialized`]26) | `boolean` | åˆå§‹åŒ–çŠ¶æ€æ ‡å¿— | 26 |
| [`isSaving`]27) | `boolean` | ä¿å­˜è¿›è¡Œä¸­æ ‡å¿— | 27 |
| [`isEditingOrder`]28) | `boolean` | æ’åºç¼–è¾‘æ¨¡å¼æ ‡å¿— | 28 |
| [`currentDiffMap`]29) | `Set` | å½“å‰å·®å¼‚æ˜ å°„é›†åˆ | 29 |
| [`pendingDeletes`]30) | `Set` | å¾…åˆ é™¤é¡¹é›†åˆ | 30 |
| [`isCollapsed`]31) | `boolean` | UIæŠ˜å çŠ¶æ€ | 31 |
| [`isPinned`]32) | `boolean` | é¢æ¿å›ºå®šçŠ¶æ€ | 32 |
| [`globalScrollTop`]33) | `number` | å…¨å±€æ»šåŠ¨ä½ç½® | 33 |
| [`currentPage`]34) | `number` | å½“å‰åˆ†é¡µé¡µç  | 34 |
| [`currentSearchTerm`]35) | `string` | å½“å‰æœç´¢å…³é”®è¯ | 35 |
| [`globalStagedData`]36) | `object\|null` | æš‚å­˜çš„å…¨å±€æ•°æ® | 36 |
| [`saveBtnTimer`]37) | `Timer\|null` | ä¿å­˜æŒ‰é’®è®¡æ—¶å™¨ | 37 |
| [`isLongPress`]38) | `boolean` | é•¿æŒ‰çŠ¶æ€æ ‡å¿— | 38 |
| `isMobile` | `boolean` | ç§»åŠ¨ç«¯æ£€æµ‹æ ‡å¿— (åæ–‡æ¨æ–­) | ~65 |
| `cachedStyles` | `string` | ç¼“å­˜çš„ CSS æ ·å¼ (åæ–‡æ¨æ–­) | ~85 |

---

## 2. æ ¸å¿ƒå‡½æ•°/ç±»/å¯¹è±¡æ¸…å•

### 2.1 æ§åˆ¶å™¨å¯¹è±¡

| åç§° | è¡Œå·èŒƒå›´ | ä¸»è¦èŒè´£ |
|------|----------|----------|
| [`UpdateController`]51) | 51-77 | æ›´æ–°æ§åˆ¶å™¨ï¼Œé˜²æ­¢æ›´æ–°å¾ªç¯ï¼Œå¤„ç†é™é»˜æ›´æ–° |
| [`FloatingManager`]97) | 97-269 | æ‚¬æµ®çƒä¸é¢æ¿ç®¡ç†ï¼Œæ³¨å…¥æ ·å¼ã€åˆ›å»ºæ‚¬æµ®çƒã€æŒ‚è½½é¢æ¿ |
| [`CoreActions`]3012) | 3012-3137 | æ ¸å¿ƒåŠ¨ä½œåº“ï¼ŒåŒ…å«æ’å…¥è¡Œã€è®¾ç½®è¾“å…¥ã€åˆ‡æ¢åˆ é™¤ã€ç¼–è¾‘å•å…ƒæ ¼ã€å¤åˆ¶å†…å®¹ |

### 2.2 é…ç½®å¸¸é‡

| åç§° | è¡Œå· | ä¸»è¦èŒè´£ |
|------|------|----------|
| [`DEFAULT_CONFIG`]79) | 79-95 | é»˜è®¤UIé…ç½®å¯¹è±¡ |
| [`THEMES`]271) | 271-279 | ä¸»é¢˜é…ç½®æ•°ç»„ |
| [`FONTS`]281) | 281-292 | å­—ä½“é…ç½®æ•°ç»„ |
| [`HIGHLIGHT_COLORS`]294) | 294-307 | é«˜äº®é¢œè‰²é…ç½®å¯¹è±¡ |

### 2.3 çŠ¶æ€ä¸æ•°æ®ç®¡ç†å‡½æ•°

| å‡½æ•°å | è¡Œå· | ä¸»è¦èŒè´£ |
|--------|------|----------|
| [`getCore()`]308) | 308-314 | è·å–æ ¸å¿ƒä¾èµ–ï¼ˆjQueryã€æ•°æ®åº“APIï¼‰ |
| [`getActiveTabState()`]342) | 342-348 | è·å–å½“å‰æ´»è·ƒæ ‡ç­¾é¡µçŠ¶æ€ |
| [`saveActiveTabState()`]349) | 349-355 | ä¿å­˜æ´»è·ƒæ ‡ç­¾é¡µçŠ¶æ€ |
| [`getSavedTableOrder()`]356) | 356-362 | è·å–ä¿å­˜çš„è¡¨æ ¼é¡ºåº |
| [`getConfig()`]370) | 370-377 | è·å–é…ç½® |
| [`saveConfig()`]378) | 378-387 | ä¿å­˜é…ç½® |
| [`getTableHeights()`]389) | 389-402 | è·å–/ä¿å­˜è¡¨æ ¼é«˜åº¦é…ç½® |
| [`getTableStyles()`]403) | 403-416 | è·å–/ä¿å­˜è¡¨æ ¼æ ·å¼é…ç½® |
| [`getReverseOrderTables()`]417) | 417-430 | è·å–/ä¿å­˜å€’åºæ˜¾ç¤ºçš„è¡¨æ ¼åˆ—è¡¨ |
| [`loadSnapshot()`]432) | 432-438 | åŠ è½½æ•°æ®å¿«ç…§ |
| [`saveSnapshot()`]439) | 439-445 | ä¿å­˜æ•°æ®å¿«ç…§ |
| [`generateDiffMap()`]447) | 447-484 | ç”Ÿæˆæ•°æ®å·®å¼‚æ˜ å°„ |
| [`applyConfigStyles()`]486) | 486-536 | åº”ç”¨é…ç½®æ ·å¼åˆ°DOM |
| [`addStyles()`]538) | 538-956 | **[è¶…å¤§å‡½æ•°]** æ·»åŠ å…¨éƒ¨CSSæ ·å¼ï¼ˆå«teleportï¼‰ |
| [`getTableData()`]958) | 958-961 | è·å–è¡¨æ ¼æ•°æ® |
| [`updateSaveBtnState()`]963) | 963-973 | æ›´æ–°ä¿å­˜æŒ‰é’®çŠ¶æ€ |
| [`saveDataToDatabase()`]977) | 977-1208 | **[æ ¸å¿ƒ]** å¤„ç†æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ï¼ŒåŒæ­¥ä¸–ç•Œä¹¦ï¼Œå¤„ç†èŠå¤©è®°å½• |
| [`processJsonData()`]1210) | 1210-1220 | å¤„ç†JSONæ•°æ®ä¸ºè¡¨æ ¼æ ¼å¼ |

### 2.4 UI æ¸²æŸ“ä¸å¼¹çª—å‡½æ•°

| å‡½æ•°å | è¡Œå· | ä¸»è¦èŒè´£ |
|--------|------|----------|
| [`showSettingsModal()`]1222) | 1222-1856 | **[è¶…å¤§å‡½æ•°]** æ˜¾ç¤ºè®¾ç½®å¼¹çª—ï¼ŒåŒ…å«å¤§é‡HTMLæ¨¡æ¿ä¸é€»è¾‘ |
| [`generatePaginationList()`]1858) | 1858-1889 | ç”Ÿæˆåˆ†é¡µåˆ—è¡¨ |
| [`autoFitPanelHeight()`]1891) | 1891-1943 | è‡ªåŠ¨è°ƒæ•´é¢æ¿é«˜åº¦ |
| [`purgeFloorRange()`]1951) | 1951-2055 | æ¸…ç†æŒ‡å®šæ¥¼å±‚èŒƒå›´æ•°æ® |
| [`renderInterface()`]2058) | 2058-2242 | **[æ ¸å¿ƒ]** æ¸²æŸ“æ•´ä¸ªç•Œé¢æ¡†æ¶ |
| [`renderOptionsPanel()`]2244) | 2244-2378 | æ¸²æŸ“é€‰é¡¹èšåˆé¢æ¿ |
| [`renderDashboard()`]2380) | 2380-2591 | æ¸²æŸ“ä»ªè¡¨ç›˜ |
| [`renderTableContent()`]2605) | 2605-2828 | **[æ ¸å¿ƒ]** æ¸²æŸ“è¡¨æ ¼å…·ä½“å†…å®¹ |
| [`showInputFloorDialog()`]2846) | 2846-2931 | æ˜¾ç¤ºè¾“å…¥æ¥¼å±‚å¼¹çª— |
| [`showPurgeRangeDialog()`]2933) | 2933-3010 | æ˜¾ç¤ºæ¸…é™¤èŒƒå›´å¼¹çª— |

### 2.5 äº¤äº’ä¸äº‹ä»¶å¤„ç†å‡½æ•° (3000è¡Œå)

| å‡½æ•°å | è¡Œå·èŒƒå›´ | ä¸»è¦èŒè´£ |
|--------|----------|----------|
| [`bindFloatingEvents()`]3142) | 3142-3986 | **[è¶…å¤§å‡½æ•°]** ç»‘å®šæ‚¬æµ®é¢æ¿æ‰€æœ‰äº‹ä»¶ï¼ˆå«ç§»åŠ¨ç«¯/PCç«¯é€»è¾‘ï¼‰ |
| [`bindWindowEvents()`]3988) | 3988-4150 | çª—å£çº§äº‹ä»¶ï¼ˆæ‹–æ‹½ã€è°ƒå®½ï¼‰ |
| [`activateInlineEdit()`]3239) | 3239-3347 | æ¿€æ´»å•å…ƒæ ¼åŸåœ°ç¼–è¾‘æ¨¡å¼ |
| [`switchTabFloating()`]4152) | 4152-4190 | Tab åˆ‡æ¢é€»è¾‘ |
| [`refreshFloatingTable()`]4192) | 4192-4222 | åˆ·æ–°æ‚¬æµ®è¡¨æ ¼å†…å®¹ |
| [`showQuickView()`]4224) | 4224-4272 | å¿«é€Ÿé¢„è§ˆå¼¹çª— |
| [`toggleOrderEditMode()`]4274) | 4274-4290 | Tab æ’åºæ¨¡å¼åˆ‡æ¢ |
| [`initSortable()`]4292) | 4292-4318 | æ‹–æ‹½æ’åºåˆå§‹åŒ– |
| [`showCellMenu()`]4320) | 4320-4433 | å•å…ƒæ ¼å³é”®èœå• |
| [`updateCellUI()`]4434) | 4434-4483 | å•å…ƒæ ¼ UI æ›´æ–° |
| [`init()`]4485) | 4485-4582 | **[å…¥å£]** è„šæœ¬ä¸»åˆå§‹åŒ–å‡½æ•° |

---

## 3. æ¨¡å—åŒ–åˆ†æ

### 3.1 å»ºè®®æ‹†åˆ†çš„ Composables (ç»„åˆå¼å‡½æ•°)

| å»ºè®®æ¨¡å—å | åŒ…å«é€»è¾‘/å‡½æ•° | ä¼°è®¡è§„æ¨¡ |
|------------|---------------|----------|
| `useConfig` | `getConfig`, `saveConfig`, `DEFAULT_CONFIG` åŠå¸¸é‡ | 150è¡Œ |
| `useTableState` | `getActiveTabState`, `saveTableOrder`, æ ¸å¿ƒçŠ¶æ€å˜é‡ | 200è¡Œ |
| `useSnapshot` | `loadSnapshot`, `saveSnapshot`, `generateDiffMap` | 150è¡Œ |
| `useFloatingManager` | `FloatingManager` å¯¹è±¡, `bindFloatingEvents` ä¸­çš„é¢æ¿é€»è¾‘ | 200+è¡Œ |
| `useDialog` | `showSettingsModal`, `showInputFloorDialog`, `showPurgeRangeDialog` | **800+è¡Œ** |
| `useTableRender` | `renderTableContent`, `renderDashboard` | 400+è¡Œ |
| `useMobileGestures` | ç§»åŠ¨ç«¯æ‰‹åŠ¿é€»è¾‘ (ä½äº `bindFloatingEvents` å†… 3684-3952) | 300è¡Œ |
| `useInlineEdit` | `activateInlineEdit` åŠç›¸å…³è¾…åŠ© | 150è¡Œ |
| `useDragResize` | `bindWindowEvents` æ‹–æ‹½/è°ƒå®½é€»è¾‘ | 200è¡Œ |

### 3.2 å»ºè®®è¿ç§»åˆ° Pinia Store çš„çŠ¶æ€

| Store åç§° | çŠ¶æ€å†…å®¹ |
|------------|----------|
| `useUIStore` | `isCollapsed`, `isPinned`, `isEditingOrder`, `isMobile`, `globalScrollTop`, `currentPage`, `currentSearchTerm` |
| `useDataStore` | `globalStagedData`, `currentDiffMap`, `pendingDeletes`, `isSaving` |
| `useConfigStore` | æ‰€æœ‰ `STORAGE_KEY_*` ç›¸å…³çš„é…ç½®è¯»å†™ |

---

## 4. ä¾èµ–å…³ç³»

### 4.1 å¤–éƒ¨åº“ä¾èµ–

| åº“å | è·å–æ–¹å¼ | ä½¿ç”¨åœºæ™¯ |
|------|----------|----------|
| **jQuery** | `window.jQuery || window.parent.jQuery` | æ ¸å¿ƒDOMæ“ä½œã€äº‹ä»¶ç»‘å®š |
| **Font Awesome** | CDN / æ ·å¼æ³¨å…¥ | ç•Œé¢å›¾æ ‡ |
| **toastr** | `window.toastr` | æ“ä½œåé¦ˆæç¤º |
| **lodash** | `_` (æ¨æ–­) | é˜²æŠ–ã€æ·±æ‹·è´ç­‰å·¥å…·å‡½æ•° |

### 4.2 é…’é¦†åŠ©æ‰‹ API è°ƒç”¨

| API | è°ƒç”¨ä½ç½® | ç”¨é€” |
|-----|----------|------|
| `window.AutoCardUpdaterAPI.exportTableAsJson()` | [`getTableData`]958) | è·å–è¡¨æ ¼æ•°æ® |
| `window.AutoCardUpdaterAPI.syncWorldbookEntries()` | [`saveDataToDatabase`]1130) | åŒæ­¥ä¸–ç•Œä¹¦æ¡ç›® |
| `window.SillyTavern.chat` | [`saveDataToDatabase`]1050) | è®¿é—®èŠå¤©è®°å½• |
| `window.SillyTavern.saveChat()` / `saveChatDebounced` | [`saveDataToDatabase`]1115) | ä¿å­˜èŠå¤©è®°å½• |
| `window.TavernHelper.triggerSlash()` | `CoreActions.copyContent` ç­‰ | è°ƒç”¨STScriptå‘½ä»¤ |

---




---

# ğŸ“œ ACU Visualizer v6.4 åŠŸèƒ½ç‰¹æ€§æ˜ å°„æ¸…å•

## 1. æ ¸å¿ƒæ•°æ®é€»è¾‘ (Core Data Logic)
> **ä¼˜å…ˆçº§ï¼šæœ€é«˜**ã€‚è¿™æ˜¯æ’ä»¶çš„â€œå¤§è„‘â€ï¼Œè´Ÿè´£ä¸ SillyTavern æ•°æ®åº“äº¤äº’åŠçŠ¶æ€ç®¡ç†ã€‚

| åŠŸèƒ½æ¨¡å— | åŠŸèƒ½ç»†èŠ‚æè¿° | å…³é”®é€»è¾‘/çº¦æŸ | æ¶‰åŠå‡½æ•°/å˜é‡ | æºç å‚è€ƒè¡Œ (çº¦) |
| :--- | :--- | :--- | :--- | :--- |
| **æ•°æ®è¯»å–** | ä» ST è·å– JSON æ•°æ® | éœ€å…¼å®¹ `window.AutoCardUpdaterAPI` æˆ– `getDB()` | `getTableData`, `getCore` | 958, 296 |
| **å·®å¼‚æ¯”å¯¹** | è®¡ç®—æ•°æ®å˜åŠ¨ (Diff) | å¯¹æ¯”å½“å‰æ•°æ®ä¸ `loadSnapshot` çš„å·®å¼‚ï¼Œç”Ÿæˆ `currentDiffMap` é›†åˆ | `generateDiffMap`, `loadSnapshot` | 447-484, 432 |
| **æ•°æ®ä¿å­˜** | **æ ¸å¿ƒä¿å­˜é€»è¾‘** | 1. å¤„ç† `pendingDeletes` (è¿‡æ»¤åˆ é™¤è¡Œ)<br>2. å¯»æ‰¾ç›®æ ‡æ¥¼å±‚ (IsolatedData é€»è¾‘)<br>3. å†™å…¥ `TavernDB_ACU_IsolatedData`<br>4. è°ƒç”¨ `syncWorldbookEntries` åŒæ­¥ | `saveDataToDatabase` | 977-1208 |
| **éš”ç¦»æ•°æ®** | æ•°æ®éš”ç¦»ä¿æŠ¤ | å¿…é¡»ä¿ç•™ `TavernDB_ACU_IsolatedData` ç»“æ„ï¼Œä¸èƒ½ç ´åå…¶ä»–æ’ä»¶çš„æ•°æ® | `saveDataToDatabase` | 1045-1070 |
| **æ¥¼å±‚æ¸…æ´—** | å¼ºåŠ›æ¸…é™¤æ•°æ® | éå†èŠå¤©è®°å½•ï¼Œåˆ é™¤ `TavernDB_ACU_*` æ‰€æœ‰ç›¸å…³å­—æ®µ | `purgeFloorRange` | 1951-2055 |
| **å¿«ç…§ç®¡ç†** | åˆ·æ–°ä¸é‡ç½® | ç‚¹å‡»åˆ·æ–°æ—¶ï¼Œå°†å½“å‰æ•°æ®å­˜ä¸ºæ–°å¿«ç…§ï¼Œæ¸…é™¤ Diff å’Œ Delete æ ‡è®° | äº‹ä»¶ç»‘å®š `#acu-btn-refresh` | 3828-3860 |
| **æ‰‹åŠ¨æ¥¼å±‚** | ä¿å­˜åˆ°æŒ‡å®šæ¥¼å±‚ | å…è®¸ç”¨æˆ·è¾“å…¥ Indexï¼Œå°†æ•°æ®å¼ºè¡Œå†™å…¥è¯¥å±‚ | `showInputFloorDialog` | 2886-2947 |

## 2. UI æ¡†æ¶ä¸æ¸²æŸ“ (UI Framework)
> **ä¼˜å…ˆçº§ï¼šé«˜**ã€‚è´Ÿè´£ç•Œé¢çš„ç”Ÿæˆã€å¸ƒå±€åˆ‡æ¢åŠæ ·å¼æ³¨å…¥ã€‚

| åŠŸèƒ½æ¨¡å— | åŠŸèƒ½ç»†èŠ‚æè¿° | å…³é”®é€»è¾‘/çº¦æŸ | æ¶‰åŠå‡½æ•°/å˜é‡ | æºç å‚è€ƒè¡Œ (çº¦) |
| :--- | :--- | :--- | :--- | :--- |
| **æ ·å¼æ³¨å…¥** | åŠ¨æ€ CSS å˜é‡ | é€šè¿‡ `addStyles` æ³¨å…¥å·¨å‹ CSSï¼Œæ”¯æŒæ¢è‚¤ (Theme) å’ŒåŠ¨æ€å­—ä½“ | `addStyles`, `applyConfigStyles` | 538, 486 |
| **æ‚¬æµ®çƒ** | æ‚¬æµ®çƒç®¡ç† | æ‹–æ‹½ã€å¸é™„è¾¹ç¼˜ã€ç‚¹å‡»å±•å¼€ã€åŒå‡»åœé  | `FloatingManager` | 97-269 |
| **çª—å£å®šä½** | çª—å£ä½ç½®è®°å¿† | è®°å½• `acu_win_config` (Left/Bottom)ï¼Œæ”¯æŒä» LocalStorage æ¢å¤ä½ç½® | `renderInterface` | 2196-2226 |
| **é«˜åº¦è‡ªé€‚åº”** | é¢æ¿é«˜åº¦è®¡ç®— | æ ¹æ®å†…å®¹é«˜åº¦è‡ªåŠ¨è°ƒæ•´é¢æ¿ (`autoFitPanelHeight`)ï¼Œæ”¯æŒåŒå‡»æŠŠæ‰‹é‡ç½® | `autoFitPanelHeight` | 1898-1936 |
| **ä»ªè¡¨ç›˜** | é¦–é¡µèšåˆè§†å›¾ | ç‰¹æ®Šæ¸²æŸ“é€»è¾‘ï¼Œèšåˆä¸»è§’ã€NPCã€ä»»åŠ¡ç­‰ç‰¹å®šè¡¨æ ¼ | `renderDashboard` | 2380-2591 |
| **é€‰é¡¹é¢æ¿** | é€‰é¡¹å¡èšåˆ | èšåˆæ‰€æœ‰å«â€œé€‰é¡¹â€çš„è¡¨æ ¼ï¼Œæ”¯æŒçŸ©é˜µæ¨¡å¼æ£€æµ‹ | `renderOptionsPanel` | 2244-2378 |
| **è®¾ç½®å¼¹çª—** | å·¨å‹è®¾ç½®èœå• | å¤„ç†æ‰€æœ‰å¼€å…³ã€æ»‘å—ã€é¢œè‰²é€‰æ‹©å™¨ï¼Œå®æ—¶é¢„è§ˆ CSS å˜é‡å˜åŒ– | `showSettingsModal` | 1222-1856 |

## 3. è¡¨æ ¼ä¸å¡ç‰‡æ¸²æŸ“ (Grid & Card Rendering)
> **ä¼˜å…ˆçº§ï¼šé«˜**ã€‚æ ¸å¿ƒä¸šåŠ¡è§†å›¾ï¼Œé€»è¾‘æå…¶å¤æ‚ï¼ŒåŒ…å«æ’åºå’Œåˆ†é¡µã€‚

| åŠŸèƒ½æ¨¡å— | åŠŸèƒ½ç»†èŠ‚æè¿° | å…³é”®é€»è¾‘/çº¦æŸ | æ¶‰åŠå‡½æ•°/å˜é‡ | æºç å‚è€ƒè¡Œ (çº¦) |
| :--- | :--- | :--- | :--- | :--- |
| **å¤åˆæ’åº** | æ™ºèƒ½æ’åºé€»è¾‘ | **ä¼˜å…ˆçº§**ï¼šæœ‰å˜åŠ¨(Diff) > å€’åºè®¾ç½® > åŸå§‹ç´¢å¼• | `renderTableContent` (å†…éƒ¨ Sort) | 2650-2665 |
| **è§†å›¾åˆ‡æ¢** | ç½‘æ ¼/åˆ—è¡¨æ¨¡å¼ | åˆ‡æ¢ `.acu-style-list` ç±»ï¼Œåˆ—è¡¨æ¨¡å¼ä¸‹æ¯è¡Œä¸€ä¸ªå±æ€§ | `renderTableContent` | 2715-2760 |
| **å˜åŠ¨é«˜äº®** | è§†è§‰åé¦ˆ | æ ¹æ® `checkRowChanged` ç»“æœæ·»åŠ é«˜äº®ç±» | `renderTableContent` (checkRowChanged) | 2627-2640 |
| **åˆ†é¡µé€»è¾‘** | æ™ºèƒ½åˆ†é¡µå™¨ | æ ¹æ® `itemsPerPage` åˆ‡ç‰‡æ•°æ®ï¼Œç”Ÿæˆå¸¦çœç•¥å·çš„é¡µç æ¡ | `generatePaginationList` | 1863-1896 |
| **æœç´¢è¿‡æ»¤** | å…¨æ–‡æœç´¢ | è¿‡æ»¤ `processedRows`ï¼Œæ”¯æŒè·¨å•å…ƒæ ¼æœç´¢ | `renderTableContent` | 2643-2647 |
| **Badgeæ ·å¼** | å¾½ç« è‡ªåŠ¨ç€è‰² | æ ¹æ®å†…å®¹(Lv., %, ç”·/å¥³)è‡ªåŠ¨è¿”å›æ ·å¼ç±» | `getBadgeStyle` | 329-335 |

## 4. äº¤äº’ä¸æ‰‹åŠ¿ (Interactions & Gestures)
> **ä¼˜å…ˆçº§ï¼šæé«˜ (æ˜“ä¸¢å¤±)**ã€‚åŒ…å«å¤§é‡é’ˆå¯¹ DOM çš„äº‹ä»¶ç›‘å¬ï¼ŒVue é‡æ„æ—¶æœ€éš¾è¿ç§»çš„éƒ¨åˆ†ã€‚

| åŠŸèƒ½æ¨¡å— | åŠŸèƒ½ç»†èŠ‚æè¿° | å…³é”®é€»è¾‘/çº¦æŸ | æ¶‰åŠå‡½æ•°/å˜é‡ | æºç å‚è€ƒè¡Œ (çº¦) |
| :--- | :--- | :--- | :--- | :--- |
| **åŸåœ°ç¼–è¾‘** | å•å…ƒæ ¼ç¼–è¾‘ | ç‚¹å‡»å˜ `textarea`ï¼Œå¤±ç„¦è‡ªåŠ¨ä¿å­˜ï¼Œæ”¯æŒè‡ªåŠ¨é«˜åº¦ | `activateInlineEdit` | 3239-3347 |
| **å³é”®èœå•** | Context Menu | å³é”®æ˜¾ç¤ºèœå•ï¼šæ’å…¥ã€å¤åˆ¶ã€æ’¤é”€ã€åˆ é™¤ | `showCellMenu` | 4320-4433 |
| **ç§»åŠ¨ç«¯é”** | **é˜²è¯¯è§¦é” (Lock)** | æ ¸å¿ƒé€»è¾‘ï¼š`shouldBlockClick`ã€‚é€‰è¯æ—¶ä¸è§¦å‘æ‰‹åŠ¿ï¼Œé•¿æŒ‰æ—¶ä¸è§¦å‘ç‚¹å‡» | `bindFloatingEvents` (Mobile Section) | 4004-4015 |
| **ä¸‹æ‹‰æ–°å¢** | ç§»åŠ¨ç«¯ä¸‹æ‹‰æ‰‹åŠ¿ | ç›‘æµ‹ `touchmove` çš„ `deltaY`ï¼Œè§¦å‘ `insertRow` | `bindFloatingEvents` | 4084-4110 |
| **ä¾§æ»‘åˆ é™¤** | ç§»åŠ¨ç«¯ä¾§æ»‘æ‰‹åŠ¿ | ç›‘æµ‹ `touchmove` çš„ `deltaX`ï¼Œè§¦å‘ `toggleDelete` | `bindFloatingEvents` | 4125-4160 |
| **çŸ­å¡ç‰‡Fix** | æ»šåŠ¨ç©¿é€ä¿®å¤ | é˜»æ­¢çŸ­å¡ç‰‡æ»šåŠ¨å¸¦åŠ¨çˆ¶é¡µé¢æ»šåŠ¨ (Passive Listener) | `init` (Touch listeners) | 4496-4536 |
| **çª—å£æ‹–æ‹½** | é¢æ¿æ‹–åŠ¨é€»è¾‘ | åŒºåˆ† `config.lockPanel`ï¼Œæœªé”å®šæ—¶å…è®¸æ‹–åŠ¨ Header | `bindWindowEvents` | 4184-4279 |
| **é•¿æŒ‰äº¤äº’** | æŒ‰é’®é•¿æŒ‰åŠŸèƒ½ | ä¿å­˜æŒ‰é’®é•¿æŒ‰->å¦å­˜ä¸ºï¼›è®¾ç½®æŒ‰é’®é•¿æŒ‰->åŸç”Ÿå…¥å£ | `bindLongPress` | 3150-3180 |

## 5. çŠ¶æ€ç®¡ç† (State Management)
> **ä¼˜å…ˆçº§ï¼šä¸­**ã€‚åˆ†æ•£çš„å…¨å±€å˜é‡ï¼Œéœ€è¿ç§»è‡³ Piniaã€‚

| åŠŸèƒ½æ¨¡å— | å˜é‡å | ä½œç”¨ | è¿ç§»å»ºè®® |
| :--- | :--- | :--- | :--- |
| **UIçŠ¶æ€** | `isCollapsed`, `isPinned` | æ§åˆ¶é¢æ¿æ˜¾ç¤º | Pinia: `uiStore` |
| **æ•°æ®çŠ¶æ€** | `globalStagedData`, `currentDiffMap` | æš‚å­˜æœªä¿å­˜çš„ä¿®æ”¹ | Pinia: `dataStore` |
| **åˆ é™¤é˜Ÿåˆ—** | `pendingDeletes` | è®°å½•å¾…åˆ é™¤çš„è¡Œ Key | Pinia: `dataStore` |
| **é…ç½®** | `DEFAULT_CONFIG` | æ‰€æœ‰è®¾ç½®é¡¹é»˜è®¤å€¼ | Pinia: `configStore` |
| **è¡¨æ ¼çŠ¶æ€** | `STORAGE_KEY_TABLE_ORDER` | è®°å½•ç”¨æˆ·è‡ªå®šä¹‰çš„ Tab é¡ºåº | Pinia: `uiStore` |

## 6. ç‰¹æ®Šé€»è¾‘ (Special Edge Cases)
> **æ³¨æ„**ï¼šè¿™äº›æ˜¯å®¹æ˜“è¢« AI å¿½ç•¥çš„ç»†èŠ‚ã€‚

1.  **è¾“å…¥æ¡†æ³¨å…¥ (`CoreActions.setInput`)**: éœ€æ£€æµ‹ `#send_textarea`ï¼Œå¹¶åœ¨ç§»åŠ¨ç«¯é˜²æ­¢é”®ç›˜å¼¹å‡º (Line 3033)ã€‚
2.  **æ ·å¼ç©¿é€ (Teleport)**: æ‰€æœ‰ CSS å¿…é¡»é€šè¿‡ `addStyles` æ³¨å…¥åˆ° `window.parent.document.head`ï¼Œè€Œä¸æ˜¯ iframe å†…éƒ¨ã€‚
3.  **å­—ä½“åŠ è½½**: `applyConfigStyles` ä¸­åŒ…å«ä» `zeoseven.com` åŠ è½½å­—ä½“çš„é€»è¾‘ (Line 493)ã€‚
4.  **æ’åºæ¨¡å¼**: æ‹–æ‹½ Tab æ’åºé€»è¾‘ (`initSortable`)ï¼Œéœ€è¦ Vue Draggable æ›¿ä»£ã€‚


