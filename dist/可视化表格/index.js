import*as e from'https://testingcf.jsdelivr.net/npm/pinia/+esm';import*as t from'https://testingcf.jsdelivr.net/npm/klona/+esm';import{default as a}from'https://testingcf.jsdelivr.net/npm/cytoscape/+esm';import{default as o}from'https://testingcf.jsdelivr.net/npm/cytoscape-cola/+esm';import{default as n}from'https://testingcf.jsdelivr.net/npm/cytoscape-fcose/+esm';import{default as r}from'https://testingcf.jsdelivr.net/npm/cytoscape-node-html-label/+esm';import{polyfill as l}from'https://testingcf.jsdelivr.net/npm/mobile-drag-drop/+esm';import'https://testingcf.jsdelivr.net/npm/mobile-drag-drop/default.css/+esm';import{scrollBehaviourDragImageTranslateOverride as i}from'https://testingcf.jsdelivr.net/npm/mobile-drag-drop/scroll-behaviour/+esm';import{v4 as c}from'https://testingcf.jsdelivr.net/npm/uuid/+esm';var s={8(e,t,a){a.d(t,{qy:()=>r,te:()=>u});var o=a(4061);const n={indexColumnName:'ç¼–ç ç´¢å¼•',checkEmptyCell:!0,checkIndexGap:!0,emptyCheckColumns:[]};function r(e){if(!e||'string'!=typeof e)return!1;const t=e.toLowerCase();return t.includes('æ€»ç»“')||t.includes('å¤§çº²')||t.includes('summary')||t.includes('outline')}function l(e){if(null==e)return null;const t=String(e).trim();if(''===t)return null;const a=t.match(/(\d+)/);return a?parseInt(a[1],10):null}function i(e){const t=e.match(/^(.+)-row-\d+$/);if(t)return t[1];const a=e.match(/^(.+)-\d+-\d+$/);return a?a[1]:null}function c(e){const t=e.match(/-row-(\d+)$/);if(t)return parseInt(t[1],10);const a=e.match(/-(\d+)-\d+$/);return a?parseInt(a[1],10):null}function s(e,t,a,o,n){const i=t.name||e,c=[];if(!r(i))return{sheetId:e,tableName:i,hasIssues:!1,issues:[]};if(!t.content||!Array.isArray(t.content)||t.content.length<2)return{sheetId:e,tableName:i,hasIssues:!1,issues:[]};const s=a?.content?.length||1,u=t.content.length;if(u<=s)return{sheetId:e,tableName:i,hasIssues:!1,issues:[]};const d=s,p=u-1;console.info(`[ACU IntegrityCheck] è¡¨æ ¼ "${i}" æ£€æµ‹åˆ°æ–°å¢è¡Œ: å¿«ç…§${s-1}è¡Œ â†’ å½“å‰${u-1}è¡Œ, æ–°å¢è¡ŒèŒƒå›´: ç¬¬${d}~${p}è¡Œ(contentç´¢å¼•)`);const m=t.content[0],f=m.findIndex(e=>String(e).trim()===n.indexColumnName);if(-1===f)return console.info(`[ACU IntegrityCheck] è¡¨æ ¼ "${i}" æ²¡æœ‰ç¼–ç ç´¢å¼•åˆ—ï¼Œè·³è¿‡æ£€æµ‹`),{sheetId:e,tableName:i,hasIssues:!1,issues:[]};let g=null;if(a?.content&&a.content.length>1){g=l(a.content[a.content.length-1][f])}for(let a=d;a<=p;a++){const o=t.content[a],r=a-1;if(n.checkEmptyCell)for(let t=0;t<m.length;t++){const l=String(m[t]||'').trim();if(n.emptyCheckColumns&&n.emptyCheckColumns.length>0&&!n.emptyCheckColumns.includes(l))continue;const s=o[t];''===(null!=s?String(s).trim():'')&&c.push({sheetId:e,tableName:i,rowIndex:r,colIndex:t,issueType:'empty_cell',description:`AIæ–°å¢çš„ç¬¬ ${a} è¡Œï¼Œ"${m[t]}" åˆ—ä¸ºç©º`,currentValue:''})}if(n.checkIndexGap){const n=l(o[f]);if(a===d&&null!==g&&null!==n)n!==g+1&&c.push({sheetId:e,tableName:i,rowIndex:r,colIndex:f,issueType:'index_gap',description:`AIæ–°å¢è¡Œç´¢å¼•ä» ${g} è·³åˆ° ${n}`,currentValue:String(o[f]??''),expectedValue:String(g+1)});else if(a>d){const s=a-1,u=l(t.content[s][f]);null!==u&&null!==n&&n!==u+1&&c.push({sheetId:e,tableName:i,rowIndex:r,colIndex:f,issueType:'index_gap',description:`AIæ–°å¢è¡Œä¹‹é—´ç´¢å¼•ä» ${u} è·³åˆ° ${n}`,currentValue:String(o[f]??''),expectedValue:String(u+1)})}}}return{sheetId:e,tableName:i,hasIssues:c.length>0,issues:c}}function u(e={}){const t={...n,...e},a=(0,o.ref)(new Map),l=(0,o.computed)(()=>{const e=[];return a.value.forEach(t=>{e.push(...t)}),e}),u=(0,o.computed)(()=>l.value.length>0),d=(0,o.computed)(()=>{const e=[];return a.value.forEach((t,a)=>{t.length>0&&e.push(a)}),e}),p=(0,o.computed)(()=>{let e=0,t=0;return l.value.forEach(a=>{'empty_cell'===a.issueType&&e++,'index_gap'===a.issueType&&t++}),{total:l.value.length,emptyCell:e,indexGap:t}});return{issuesByTable:a,allIssues:l,hasIssues:u,problematicTables:d,issueStats:p,checkIntegrity:function(e,o,n){const r=new Map;if(!e||!n||0===n.size)return void(a.value=r);const d=new Map;for(const e of n){const t=i(e),a=c(e);t&&null!==a&&(d.has(t)||d.set(t,new Set),d.get(t).add(a))}for(const a in e){if('mate'===a||'updated'===a||'created'===a||a.startsWith('_'))continue;const n=e[a];if(!n||!n.name)continue;const l=n.name,i=d.get(l);if(!i||0===i.size)continue;let c=null;if(o)for(const e in o)if(o[e]?.name===l){c=o[e];break}const u=s(a,n,c,0,t);u.hasIssues&&(r.set(u.tableName,u.issues),console.warn(`[ACU IntegrityCheck] è¡¨æ ¼ "${u.tableName}" å‘ç° ${u.issues.length} ä¸ªé—®é¢˜`))}a.value=r,u.value?console.warn(`[ACU IntegrityCheck] å…±å‘ç° ${l.value.length} ä¸ªå®Œæ•´æ€§é—®é¢˜`):console.info('[ACU IntegrityCheck] AIå¡«è¡¨å®Œæ•´æ€§æ£€æµ‹é€šè¿‡')},hasTableIssues:function(e){const t=a.value.get(e);return!!t&&t.length>0},getTableIssues:function(e){return a.value.get(e)||[]},clearIssues:function(){a.value=new Map},getSummaryText:function(){if(!u.value)return'æ‰€æœ‰è¡¨æ ¼å®Œæ•´æ€§æ£€æµ‹é€šè¿‡';const e=p.value,t=[];return e.emptyCell>0&&t.push(`${e.emptyCell} ä¸ªç©ºå€¼`),e.indexGap>0&&t.push(`${e.indexGap} ä¸ªç´¢å¼•æ–­è£‚`),`å‘ç° ${t.join('ã€')}ï¼Œå…± ${e.total} ä¸ªé—®é¢˜`},isSummaryOrOutlineTable:r}}},162(e,t,a){a.d(t,{d:()=>d,toast:()=>p});var o=a(4061);const n=(0,o.ref)({visible:!1,message:'',type:'info',timer:null});function r(e,t='info',a=3e3){n.value.timer&&clearTimeout(n.value.timer),n.value.visible=!0,n.value.message=e,n.value.type=t,n.value.timer=setTimeout(()=>{n.value.visible=!1,n.value.timer=null},a)}function l(){n.value.timer&&clearTimeout(n.value.timer),n.value.visible=!1,n.value.timer=null}function i(e,t=3e3){r(e,'success',t)}function c(e,t=4e3){r(e,'error',t)}function s(e,t=3500){r(e,'warning',t)}function u(e,t=3e3){r(e,'info',t)}function d(){return{state:n,show:r,hide:l,success:i,error:c,warning:s,info:u}}const p={show:r,hide:l,success:i,error:c,warning:s,info:u}},465(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var a='',o=void 0!==t[5];return t[4]&&(a+='@supports ('.concat(t[4],') {')),t[2]&&(a+='@media '.concat(t[2],' {')),o&&(a+='@layer'.concat(t[5].length>0?' '.concat(t[5]):'',' {')),a+=e(t),o&&(a+='}'),t[2]&&(a+='}'),t[4]&&(a+='}'),a}).join('')},t.i=function(e,a,o,n,r){'string'==typeof e&&(e=[[null,e,void 0]]);var l={};if(o)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(l[c]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);o&&l[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]='@layer'.concat(u[5].length>0?' '.concat(u[5]):'',' {').concat(u[1],'}')),u[5]=r),a&&(u[2]?(u[1]='@media '.concat(u[2],' {').concat(u[1],'}'),u[2]=a):u[2]=a),n&&(u[4]?(u[1]='@supports ('.concat(u[4],') {').concat(u[1],'}'),u[4]=n):u[4]=''.concat(n)),t.push(u))}},t}},492(e,t,a){var o=a(6571);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('ad22373e',o,!1,{ssrId:!0})},567(e,t,a){a.d(t,{C:()=>g});var o=a(3035),n=a(4061),r=a(2448),l=a(4182),i=a(3926);const c='acu_theme_config_global_v1',s='acu_theme_presets_v1',u='acu_custom_css_v1',d={manualColor:'orange',manualHex:'#d35400',aiColor:'blue',aiHex:'#3498db',titleColor:'orange',titleHex:'#d35400'};function p(e,t=.1){const a=e.startsWith('#')?e:`#${e}`;return`rgba(${parseInt(a.slice(1,3),16)}, ${parseInt(a.slice(3,5),16)}, ${parseInt(a.slice(5,7),16)}, ${t})`}function m(e,t){const a=e.startsWith('#')?e:`#${e}`;return`rgba(${parseInt(a.slice(1,3),16)}, ${parseInt(a.slice(3,5),16)}, ${parseInt(a.slice(5,7),16)}, ${t})`}function f(e,t){if('custom'===e&&t)return t;const a=i.um[e];return a?.main||'#d35400'}const g=(0,o.defineStore)('acu-theme',()=>{const e=(0,n.ref)([]),t=(0,n.ref)(null),o=(0,n.ref)({}),g=(0,n.ref)({}),v=(0,n.ref)({...d}),b=(0,n.ref)({...l.o6}),h=(0,n.ref)(''),x=(0,n.ref)(!1),y=(0,i.JH)(),w=(0,n.computed)(()=>y.config.theme),k=(0,n.computed)(()=>f(v.value.manualColor,v.value.manualHex)),C=(0,n.computed)(()=>f(v.value.aiColor,v.value.aiHex)),N=(0,n.computed)(()=>f(v.value.titleColor,v.value.titleHex)),V=(0,n.computed)(()=>p(N.value,.08)),E=(0,n.computed)(()=>t.value&&e.value.find(e=>e.id===t.value)||null);async function B(e){if(t.value=null,e.themeVars&&(o.value=e.themeVars),e.themeVarOpacities&&(g.value=e.themeVarOpacities),e.backgroundConfig&&(b.value=e.backgroundConfig,b.value.enabled&&b.value.hasIndexedDBImage))try{const e=await(0,r.$H)(r.Aq);e&&(b.value.imageUrl=e,console.info('[ACU Theme] å·²ä» IndexedDB æ¢å¤èƒŒæ™¯å›¾ç‰‡'))}catch(e){console.warn('[ACU Theme] æ¢å¤èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',e)}e.customCSS&&(h.value=e.customCSS)}function S(){try{if(localStorage.setItem(s,JSON.stringify(e.value)),localStorage.setItem(u,h.value),'function'==typeof getVariables&&'function'==typeof replaceVariables){const a={themePresets:e.value,activePresetId:t.value||null};t.value||(a.themeVars=o.value,a.themeVarOpacities=g.value,a.backgroundConfig=b.value,a.customCSS=h.value);const n=getVariables({type:'global'});n[c]=a,replaceVariables(n,{type:'global'})}D(),console.info('[ACU Theme] å·²ä¿å­˜ä¸»é¢˜é…ç½® (Global)')}catch(e){console.error('[ACU Theme] ä¿å­˜é…ç½®å¤±è´¥:',e)}}function T(){const e=y.config;v.value={manualColor:e.highlightManualColor||e.highlightColor||'orange',manualHex:e.customHighlightManualHex,aiColor:e.highlightAiColor||'blue',aiHex:e.customHighlightAiHex,titleColor:e.titleColor||'orange',titleHex:e.customTitleHex}}function D(){y.updateConfig({highlightManualColor:v.value.manualColor,highlightColor:v.value.manualColor,customHighlightManualHex:v.value.manualHex,highlightAiColor:v.value.aiColor,customHighlightAiHex:v.value.aiHex,titleColor:v.value.titleColor,customTitleHex:v.value.titleHex,highlightNew:!0,customTitleColor:!0})}function A(t){const a={id:`preset_${Date.now()}`,name:t,createdAt:(new Date).toISOString(),baseTheme:w.value,themeVars:{...o.value},themeVarOpacities:{...g.value},highlight:{...v.value},backgroundConfig:{...b.value},customCSS:h.value};return e.value.push(a),S(),a}async function I(e){try{let o=null;if(b.value.imageUrl&&b.value.imageUrl.startsWith('blob:')?o=b.value.imageUrl:(o=await(0,r.$H)(r.Aq),!o&&t.value&&t.value!==e&&(o=await(0,r.$H)(t.value))),o){const t=await fetch(o),n=await t.blob(),{saveBackground:r}=await Promise.resolve().then(a.bind(a,2448));await r(e,n,n.type),console.info('[ACU Theme] å·²å°†èƒŒæ™¯å›¾ç‰‡ç»‘å®šåˆ°é¢„è®¾:',e)}}catch(e){console.warn('[ACU Theme] ç»‘å®šèƒŒæ™¯å›¾ç‰‡åˆ°é¢„è®¾å¤±è´¥:',e)}}function M(t,a){const o=e.value.findIndex(e=>e.id===t);o>-1&&(e.value[o]={...e.value[o],...a},S())}function U(){const e=[];for(const[t,a]of Object.entries(o.value))if(a){const o=l.DR[t];if(o){const n=g.value[t]??100;if(n<100&&a.startsWith('#')){const t=m(a,n/100);e.push(`${o}: ${t};`)}else e.push(`${o}: ${a};`)}}if(e.push(`--acu-highlight: ${k.value};`),e.push(`--acu-highlight-manual: ${k.value};`),e.push(`--acu-highlight-manual-bg: ${p(k.value)};`),e.push(`--acu-highlight-ai: ${C.value};`),e.push(`--acu-highlight-ai-bg: ${p(C.value)};`),e.push(`--acu-title-color: ${N.value};`),e.push(`--acu-title-color-bg: ${V.value};`),e.push(`--acu-accent: ${N.value};`),b.value.enabled&&b.value.imageUrl){const t=b.value,a=(t.offsetX,t.offsetY,(t.scale||100)/100),o='auto'===t.size?'100%':t.size;e.push(`--acu-bg-image: url("${t.imageUrl}");`),e.push('--acu-bg-position: center center;'),e.push(`--acu-bg-size: ${o};`),e.push(`--acu-bg-scale: ${a};`),e.push(`--acu-bg-offset-x: ${t.offsetX||0}%;`),e.push(`--acu-bg-offset-y: ${t.offsetY||0}%;`),e.push('--acu-bg-repeat: no-repeat;'),e.push(`--acu-bg-opacity: ${t.opacity/100};`),e.push(`--acu-bg-blur: ${t.blur}px;`)}else e.push('--acu-bg-image: none;');if(0===e.length)return'';let t=`.acu-app, .acu-wrapper, .acu-modal-container { ${e.join(' ')} }`;return b.value.enabled&&b.value.imageUrl&&(t+='\n        .acu-data-display::before {\n          content: "";\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background-image: var(--acu-bg-image);\n          background-position: var(--acu-bg-position);\n          background-size: var(--acu-bg-size);\n          background-repeat: var(--acu-bg-repeat);\n          transform: translate(var(--acu-bg-offset-x), var(--acu-bg-offset-y)) scale(var(--acu-bg-scale));\n          transform-origin: center center;\n          opacity: var(--acu-bg-opacity);\n          filter: blur(var(--acu-bg-blur));\n          pointer-events: none;\n          z-index: -1;\n          border-radius: 12px; /* ä¿æŒåœ†è§’ä¸€è‡´ */\n        }\n        .acu-data-display {\n          position: relative;\n          z-index: 0;\n          background: transparent !important; /* è®©èƒŒæ™¯é€å‡ºæ¥ */\n        }\n      '),t}const L=(0,n.ref)(!1);return(0,n.watch)([v,o,g,b,h],()=>{x.value&&!L.value&&S()},{deep:!0}),{presets:e,activePresetId:t,currentThemeVars:o,currentThemeVarOpacities:g,currentHighlight:v,backgroundConfig:b,customCSS:h,isLoaded:x,baseTheme:w,manualHighlightColor:k,aiHighlightColor:C,titleColor:N,titleBgColor:V,activePreset:E,loadFromStorage:async function(a=!1){if(!x.value||a)try{const a=localStorage.getItem(s);a&&(e.value=JSON.parse(a));const n=localStorage.getItem(u);if(n&&(h.value=n),'function'==typeof getVariables){const a=getVariables({type:'global'});let n=a[c];if(!n){const e=getVariables({type:'script',script_id:'acu_visualizer_ui'});e&&(e.themeVars||e.backgroundConfig)&&(console.info('[ACU Theme] æ£€æµ‹åˆ°æ—§ç‰ˆé…ç½®ï¼Œæ­£åœ¨è¿ç§»åˆ°å…¨å±€å˜é‡...'),n=e,setTimeout(()=>S(),1e3))}if(n)if(n.themePresets&&(e.value=n.themePresets),n.activePresetId){const a=e.value.find(e=>e.id===n.activePresetId);if(a){if(t.value=a.id,y.setTheme(a.baseTheme),o.value={...a.themeVars},g.value={...a.themeVarOpacities},v.value={...a.highlight},b.value=a.backgroundConfig||{...l.o6},h.value=a.customCSS||'',b.value.enabled&&b.value.hasIndexedDBImage)try{let e=await(0,r.$H)(a.id);e||(e=await(0,r.$H)(r.Aq)),e&&(b.value.imageUrl=e,console.info('[ACU Theme] å·²ä» IndexedDB æ¢å¤èƒŒæ™¯å›¾ç‰‡, key:',e?a.id:r.Aq))}catch(e){console.warn('[ACU Theme] æ¢å¤èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',e)}D(),console.info('[ACU Theme] å·²åº”ç”¨ä¸Šæ¬¡æ¿€æ´»çš„é¢„è®¾:',a.name)}else await B(n),T()}else await B(n),T();else T()}else T();x.value=!0,console.info('[ACU Theme] å·²åŠ è½½ä¸»é¢˜é…ç½®')}catch(e){console.error('[ACU Theme] åŠ è½½é…ç½®å¤±è´¥:',e),x.value=!0}},saveToStorage:S,syncFromConfigStore:T,syncToConfigStore:D,createPreset:A,saveCurrentToPreset:function(a){const n=e.value.findIndex(e=>e.name===a);if(n>-1){const a=e.value[n],r={...a,baseTheme:w.value,themeVars:{...o.value},themeVarOpacities:{...g.value},highlight:{...v.value},backgroundConfig:{...b.value},customCSS:h.value};return e.value[n]=r,t.value=a.id,b.value.enabled&&b.value.hasIndexedDBImage&&I(a.id),S(),r}{const e=A(a);return t.value=e.id,b.value.enabled&&b.value.hasIndexedDBImage&&I(e.id),S(),e}},deletePreset:function(a){const o=e.value.findIndex(e=>e.id===a);o>-1&&(e.value.splice(o,1),t.value===a&&(t.value=null),S())},applyPreset:async function(a){const n=e.value.find(e=>e.id===a);if(n){L.value=!0;try{t.value=a,y.setTheme(n.baseTheme),o.value={...n.themeVars||{}},g.value={...n.themeVarOpacities||{}},v.value={...n.highlight};const e=n.backgroundConfig||{...l.o6};if(e.imageUrl='',b.value={...e},b.value.enabled)if(b.value.hasIndexedDBImage){const e=n.id;try{let t=await(0,r.$H)(e);t||(t=await(0,r.$H)(r.Aq),t&&console.info('[ACU Theme] é¢„è®¾åº”ç”¨ï¼šä½¿ç”¨å…¨å±€èƒŒæ™¯ (å…¼å®¹)')),t?(b.value.imageUrl=t,console.info('[ACU Theme] é¢„è®¾åº”ç”¨ï¼šå·²æ¢å¤èƒŒæ™¯å›¾ç‰‡')):(console.warn('[ACU Theme] é¢„è®¾åº”ç”¨ï¼šIndexedDB ä¸­æœªæ‰¾åˆ°èƒŒæ™¯å›¾ç‰‡'),b.value.hasIndexedDBImage=!1)}catch(e){console.warn('[ACU Theme] é¢„è®¾åº”ç”¨ï¼šæ¢å¤èƒŒæ™¯å›¾ç‰‡å¤±è´¥',e)}}else b.value.externalUrl&&(b.value.imageUrl=b.value.externalUrl,console.info('[ACU Theme] é¢„è®¾åº”ç”¨ï¼šä½¿ç”¨å¤–éƒ¨èƒŒæ™¯ URL'));h.value=n.customCSS||'',D()}finally{L.value=!1}S()}},updatePreset:M,renamePreset:function(e,t){M(e,{name:t})},setManualHighlightColor:function(e,t){v.value.manualColor=e,v.value.manualHex=t,S()},setAiHighlightColor:function(e,t){v.value.aiColor=e,v.value.aiHex=t,S()},setTitleColor:function(e,t){v.value.titleColor=e,v.value.titleHex=t,S()},setThemeVar:function(e,t){o.value[e]=t},removeThemeVar:function(e){delete o.value[e]},clearThemeVars:function(){o.value={}},setThemeVarOpacity:function(e,t){g.value[e]=Math.max(0,Math.min(100,t))},removeThemeVarOpacity:function(e){delete g.value[e]},clearThemeVarOpacities:function(){g.value={}},setBackgroundConfig:function(e){b.value={...b.value,...e},S()},getBackgroundConfig:function(){return b.value},setCustomCSS:function(e){h.value=e,S()},clearCustomCSS:function(){h.value='',S()},getInjectedStyles:U,getFullInjectedCSS:function(){return[U(),h.value].filter(Boolean).join('\n\n')}}})},590(e,t,a){var o=a(9988);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('ce24e6b6',o,!1,{ssrId:!0})},953(e,t,a){a.d(t,{$r:()=>b,D_:()=>g,Gv:()=>i,Hr:()=>N,Jv:()=>v,Q0:()=>k,QW:()=>V,T3:()=>T,TO:()=>B,Th:()=>S,Uo:()=>n,lQ:()=>c,lW:()=>d,oc:()=>r,rd:()=>E,un:()=>s});var o=a(4061);function n(e){return!!(0,o.getCurrentScope)()&&((0,o.onScopeDispose)(e),!0)}const r='undefined'!=typeof window&&'undefined'!=typeof document,l=('undefined'!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),i=e=>'[object Object]'===l.call(e),c=()=>{},s=u();function u(){var e,t;return r&&(null==(e=null==window?void 0:window.navigator)?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||(null==(t=null==window?void 0:window.navigator)?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(null==window?void 0:window.navigator.userAgent))}function d(...e){if(1!==e.length)return(0,o.toRef)(...e);const t=e[0];return'function'==typeof t?(0,o.readonly)((0,o.customRef)(()=>({get:t,set:c}))):(0,o.ref)(t)}function p(e,t){return function(...a){return new Promise((o,n)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(o).catch(n)})}}const m=e=>e();function f(e,t={}){let a,n,r=c;const l=e=>{clearTimeout(e),r(),r=c};let i;return c=>{const s=(0,o.toValue)(e),u=(0,o.toValue)(t.maxWait);return a&&l(a),s<=0||void 0!==u&&u<=0?(n&&(l(n),n=void 0),Promise.resolve(c())):new Promise((e,o)=>{r=t.rejectOnCancel?o:e,i=c,u&&!n&&(n=setTimeout(()=>{a&&l(a),n=void 0,e(i())},u)),a=setTimeout(()=>{n&&l(n),n=void 0,e(c())},s)})}}function g(e){return e}function v(e){let t;function a(){return t||(t=e()),t}return a.reset=async()=>{const e=t;t=void 0,e&&await e},a}function b(e){return Array.isArray(e)?e:[e]}function h(e){const t=Object.create(null);return a=>t[a]||(t[a]=e(a))}const x=/\B([A-Z])/g,y=(h(e=>e.replace(x,'-$1').toLowerCase()),/-(\w)/g);h(e=>e.replace(y,(_,e)=>e?e.toUpperCase():''));function w(e){return e||(0,o.getCurrentInstance)()}function k(e,t=200,a={}){return p(f(t,a),e)}function C(e,t,a={}){const{eventFilter:n=m,...r}=a;return(0,o.watch)(e,p(n,t),r)}function N(e,t,a={}){const{eventFilter:n,initialState:r='active',...l}=a,{eventFilter:i,pause:c,resume:s,isActive:u}=function(e=m,t={}){const{initialState:a='active'}=t,n=d('active'===a);return{isActive:(0,o.readonly)(n),pause:function(){n.value=!1},resume:function(){n.value=!0},eventFilter:(...t)=>{n.value&&e(...t)}}}(n,{initialState:r});return{stop:C(e,t,{...l,eventFilter:i}),pause:c,resume:s,isActive:u}}function V(e,t={}){if(!(0,o.isRef)(e))return(0,o.toRefs)(e);const a=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const n in e.value)a[n]=(0,o.customRef)(()=>({get:()=>e.value[n],set(a){var r;if(null==(r=(0,o.toValue)(t.replaceRef))||r)if(Array.isArray(e.value)){const t=[...e.value];t[n]=a,e.value=t}else{const t={...e.value,[n]:a};Object.setPrototypeOf(t,Object.getPrototypeOf(e.value)),e.value=t}else e.value[n]=a}}));return a}function E(e,t=!0,a){w(a)?(0,o.onMounted)(e,a):t?e():(0,o.nextTick)(e)}function B(e,t,a={}){const{immediate:l=!0,immediateCallback:i=!1}=a,c=(0,o.shallowRef)(!1);let s;function u(){s&&(clearTimeout(s),s=void 0)}function d(){c.value=!1,u()}function p(...a){i&&e(),u(),c.value=!0,s=setTimeout(()=>{c.value=!1,s=void 0,e(...a)},(0,o.toValue)(t))}return l&&(c.value=!0,r&&p()),n(d),{isPending:(0,o.shallowReadonly)(c),start:p,stop:d}}function S(e,t,a={}){const{debounce:o=0,maxWait:n,...r}=a;return C(e,t,{...r,eventFilter:f(o,{maxWait:n})})}function T(e,t,a){return(0,o.watch)(e,t,{...a,immediate:!0})}},1037(e,t,a){a.d(t,{o:()=>i});var o=a(4061);const n='avatars';let r=null;const l=new Map;function i(){const e=(0,o.ref)(!1),t=(0,o.ref)(null);async function a(){return r||new Promise((a,o)=>{const l=indexedDB.open('acu_avatars',1);l.onerror=()=>{const e=`[AvatarManager] æ‰“å¼€æ•°æ®åº“å¤±è´¥: ${l.error?.message}`;console.error(e),t.value=e,o(l.error)},l.onsuccess=()=>{r=l.result,r.onclose=()=>{console.warn('[AvatarManager] æ•°æ®åº“è¿æ¥å·²å…³é—­ï¼Œé‡ç½®å®ä¾‹'),r=null,e.value=!1},r.onerror=e=>{console.error('[AvatarManager] æ•°æ®åº“é”™è¯¯:',e.target.error)},e.value=!0,console.info('[AvatarManager] æ•°æ®åº“è¿æ¥æˆåŠŸ'),a(r)},l.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(n)||(t.createObjectStore(n,{keyPath:'name'}),console.info('[AvatarManager] åˆ›å»ºæ•°æ®åº“è¡¨æˆåŠŸ'))}})}async function i(e){const t=await a();return new Promise((a,o)=>{const r=t.transaction(n,'readwrite').objectStore(n);l.has(e.name)&&(URL.revokeObjectURL(l.get(e.name)),l.delete(e.name));const i={...e,updatedAt:e.updatedAt||Date.now()},c=r.put(i);c.onsuccess=()=>{console.info(`[AvatarManager] ä¿å­˜å¤´åƒæˆåŠŸ: ${e.name}`),a()},c.onerror=()=>{console.error(`[AvatarManager] ä¿å­˜å¤´åƒå¤±è´¥: ${c.error}`),o(c.error)}})}async function c(e){if(!e)return null;const t=await a();return new Promise(a=>{const o=t.transaction(n,'readonly').objectStore(n).get(e);o.onsuccess=()=>{a(o.result||null)},o.onerror=()=>{console.error(`[AvatarManager] è·å–å¤´åƒå¤±è´¥: ${o.error}`),a(null)}})}async function s(){const e=await a();return new Promise(t=>{const a=e.transaction(n,'readonly').objectStore(n).getAll();a.onsuccess=()=>{t(a.result||[])},a.onerror=()=>{console.error(`[AvatarManager] è·å–æ‰€æœ‰å¤´åƒå¤±è´¥: ${a.error}`),t([])}})}function u(){try{const e=window.parent||window,$=e.jQuery||window.jQuery;if($){const e=$('.mes[is_user="true"]').last().find('.avatar img');if(e.length&&e.attr('src')){const t=e.attr('src');if(t&&!t.includes('default')&&!t.includes('placeholder'))return t}const t=$('#user_avatar_block img').first();if(t.length&&t.attr('src'))return t.attr('src')}const t=e.SillyTavern||window.SillyTavern;if(t?.getContext){const e=t.getContext();if(e?.userAvatar)return e.userAvatar}}catch(e){console.warn('[AvatarManager] getSillyTavernUserAvatar error:',e)}return null}function d(){try{const e=(window.parent||window).AutoCardUpdaterAPI;if(e?.exportTableAsJson){const t=e.exportTableAsJson();for(const e in t){const a=t[e];if(a?.name?.includes('ä¸»è§’')&&a.content?.[1]?.[1])return a.content[1][1]}}}catch(e){console.warn('[AvatarManager] getPlayerNameFromTable error:',e)}return null}function p(e){if(!e)return!1;const t=['<user>','{{user}}','ä¸»è§’','player','protagonist'],a=e.toLowerCase();for(const e of t)if(a===e.toLowerCase())return!0;const o=d();return!(!o||e!==o)}async function m(e){if(!e)return e;const t=await s();for(const a of t)if(a.aliases?.includes(e))return a.name;return e}return{isReady:e,error:t,initDB:a,saveAvatar:i,getAvatar:c,deleteAvatar:async function(e){if(!e)return;l.has(e)&&(URL.revokeObjectURL(l.get(e)),l.delete(e));const t=await a();return new Promise(a=>{const o=t.transaction(n,'readwrite').objectStore(n).delete(e);o.onsuccess=()=>{console.info(`[AvatarManager] åˆ é™¤å¤´åƒæˆåŠŸ: ${e}`),a()},o.onerror=()=>{console.error(`[AvatarManager] åˆ é™¤å¤´åƒå¤±è´¥: ${o.error}`),a()}})},deleteAvatars:async function(e){if(!e.length)return;for(const t of e)l.has(t)&&(URL.revokeObjectURL(l.get(t)),l.delete(t));const t=await a();return new Promise((a,o)=>{const r=t.transaction(n,'readwrite'),l=r.objectStore(n);let i=0;const c=e.length;for(const t of e){const e=l.delete(t);e.onsuccess=()=>{i++,i===c&&(console.info(`[AvatarManager] æ‰¹é‡åˆ é™¤å®Œæˆ: ${c} ä¸ª`),a())},e.onerror=()=>{console.error(`[AvatarManager] åˆ é™¤å¤±è´¥: ${t}`),i++,i===c&&a()}}r.onerror=()=>o(r.error)})},getAllAvatars:s,hasAvatar:async function(e){if(!e)return!1;const t=await a();return new Promise(a=>{const o=t.transaction(n,'readonly').objectStore(n).getKey(e);o.onsuccess=()=>a(void 0!==o.result),o.onerror=()=>a(!1)})},getStats:async function(){const e=await a();return new Promise(t=>{const a=e.transaction(n,'readonly').objectStore(n).getAll();a.onsuccess=()=>{const e=a.result||[],o=e.reduce((e,t)=>e+(t.blob?.size||0),0);t({count:e.length,totalSizeBytes:o,totalSizeMB:(o/1024/1024).toFixed(2)})},a.onerror=()=>{t({count:0,totalSizeBytes:0,totalSizeMB:'0.00'})}})},clearAll:async function(){l.forEach(e=>URL.revokeObjectURL(e)),l.clear();const e=await a();return new Promise(t=>{const a=e.transaction(n,'readwrite').objectStore(n).clear();a.onsuccess=()=>{console.info('[AvatarManager] æ¸…ç©ºæ‰€æœ‰å¤´åƒæˆåŠŸ'),t()},a.onerror=()=>{console.error(`[AvatarManager] æ¸…ç©ºå¤±è´¥: ${a.error}`),t()}})},getAvatarUrl:async function e(t){if(!t)return null;if(l.has(t))return l.get(t);const a=await c(t);if(a){if(a.blob){const e=URL.createObjectURL(a.blob);return l.set(t,e),e}if(a.url)return a.url}const o=await m(t);if(o!==t)return e(o);if(p(t)){const e=u();if(e)return e}return null},getAvatarDisplayConfig:async function(e){const t=await c(e);return t?{offsetX:t.offsetX??50,offsetY:t.offsetY??50,scale:t.scale??150}:{offsetX:50,offsetY:50,scale:150}},getSillyTavernUserAvatar:u,getSillyTavernCharacterAvatar:function(){try{const e=window.parent||window,$=e.jQuery||window.jQuery;if($){const e=$('#avatar_img_holder img').first();if(e.length&&e.attr('src'))return e.attr('src');const t=$('.mes:not([is_user="true"])').last().find('.avatar img');if(t.length&&t.attr('src'))return t.attr('src')}const t=e.SillyTavern||window.SillyTavern;if(t?.getContext){const e=t.getContext();if(e?.characterAvatar)return e.characterAvatar}}catch(e){console.warn('[AvatarManager] getSillyTavernCharacterAvatar error:',e)}return null},getPlayerNameFromTable:d,isPlayerNode:p,resolvePrimaryName:m,addAlias:async function(e,t){const a=await c(e);if(!a)return;const o=a.aliases||[];o.includes(t)||(o.push(t),await i({...a,aliases:o,updatedAt:Date.now()}))},removeAlias:async function(e,t){const a=await c(e);if(!a)return;const o=(a.aliases||[]).filter(e=>e!==t);await i({...a,aliases:o,updatedAt:Date.now()})},getAliasMap:async function(){const e=await s(),t=new Map;for(const a of e)if(a.aliases?.length)for(const e of a.aliases)t.set(e,a.name);return t},getAliases:async function(e){const t=await c(e);return t?.aliases||[]},setAliases:async function(e,t){let a=await c(e);a=a?{...a,aliases:t,updatedAt:Date.now()}:{name:e,offsetX:50,offsetY:50,scale:150,aliases:t,updatedAt:Date.now()},await i(a)},getDisplayLabel:async function(e){return e},setDisplayLabel:async function(e,t){console.warn('[AvatarManager] setDisplayLabel å·²åºŸå¼ƒï¼Œè¯·ä½¿ç”¨èŠå¤©å˜é‡ä¿å­˜æ ‡ç­¾é…ç½®')},getDisplayChars:function(e){if(!e)return[];if('undefined'!=typeof Intl&&Intl.Segmenter){const t=new Intl.Segmenter('zh',{granularity:'grapheme'});return Array.from(t.segment(e),e=>e.segment)}return[...e]},cleanup:function(){l.forEach(e=>URL.revokeObjectURL(e)),l.clear(),console.info('[AvatarManager] å·²æ¸…ç† ObjectURL ç¼“å­˜')}}}},1107(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},1296(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},1699(e,t,a){a.d(t,{KX:()=>i,R3:()=>c,_V:()=>n,dK:()=>r,o9:()=>l});a(4061);var o=a(1768);function n(e){const t=(0,o.M1)().getDB(),a=t?.exportTableAsJson?.();if(!a)return e;const n=a[`sheet_${e}`];return n?.name||e}function r(){const e=(0,o.M1)().getDB(),t=e?.exportTableAsJson?e.exportTableAsJson():null;if(!t)return console.info('[useWordPool] ACU API ä¸å¯ç”¨æˆ–è¿”å›ç©ºï¼Œæ— æ³•æ£€æµ‹è¯åº“è¡¨'),[];const a=[];for(const[e,o]of Object.entries(t)){if(!e.startsWith('sheet_'))continue;const t=e.replace('sheet_',''),n=o.name||'',r=['éšæœº','éšæœºè¯','random','dict','chaos'].some(e=>n.toLowerCase().includes(e.toLowerCase())),l=['éšæœº','éšæœºè¯','random','dict','chaos'].some(e=>t.toLowerCase().includes(e.toLowerCase()));(r||l)&&a.push(t)}return console.info(`[useWordPool] æ‰«æäº† ${Object.keys(t).length} ä¸ªè¡¨ï¼Œæ£€æµ‹åˆ° ${a.length} ä¸ªè¯åº“è¡¨:`,a),a}function l(e){const t=(0,o.M1)().getDB(),a=t?.exportTableAsJson?t.exportTableAsJson():null;if(!a)return[];const n=a[`sheet_${e}`];return Array.isArray(n)?n:n&&'object'==typeof n&&Array.isArray(n.content)?n.content:[]}function i(e,t,a,o){const n=r(),i=[],s=new Map;for(const e of n){const t=o[e];if(t&&!t.enabled)continue;const a=l(e);if(a.length<=1)continue;const n=a[a.length-1],r=[];if(Array.isArray(n))for(const e of n)if(e&&'string'==typeof e){const t=e.trim();t&&r.push(t)}r.length>0&&s.set(e,r)}if('perItem'===e){for(const[e,a]of s){const e=Math.min(t,a.length),o=c([...a]);i.push(...o.slice(0,e))}console.info(`[useWordPool] perItem æ¨¡å¼ä»è¡¨æ ¼æŠ½å– ${i.length} ä¸ªè¯:`,i)}else if('custom'===e){let e=a;for(const[a,n]of s){if(e<=0)break;const r=o[a],l=r?.limit||0,s=l>0?Math.min(l,e):Math.min(t,e),u=Math.min(s,n.length),d=c([...n]);i.push(...d.slice(0,u)),e-=u}console.info(`[useWordPool] custom æ¨¡å¼ä»è¡¨æ ¼æŠ½å– ${i.length} ä¸ªè¯:`,i)}else{const e=[];for(const t of s.values())e.push(...t);const t=c(e),o=Math.min(a,t.length);i.push(...t.slice(0,o)),console.info(`[useWordPool] mixed æ¨¡å¼ä»è¡¨æ ¼æŠ½å– ${i.length} ä¸ªè¯:`,i)}return i}function c(e){const t=[...e];for(let e=t.length-1;e>0;e--){const a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}return t}},1768(e,t,a){a.d(t,{w4:()=>E.w4,Y3:()=>N,bB:()=>E.bB,n2:()=>D,M1:()=>B,cq:()=>c,ev:()=>s,tu:()=>S,j5:()=>E.j5,_C:()=>h,Et:()=>x,Zg:()=>V,iF:()=>w,tE:()=>T});const o=[{level:'S',name:'çˆ±/æ²‰è¿·',color:'#E91E63',keywords:['æ‹','ç”·å‹','å¥³å‹','çˆ±','æš§æ˜§','æƒ…äºº','ä¼´ä¾£','è€å©†','è€å…¬','ä¸ˆå¤«','å¦»å­','ç²‰ä¸','è¿·','å€¾å¿ƒ','å¿ƒä¸Šäºº']},{level:'A',name:'äº²å±',color:'#2196F3',keywords:['çˆ¶','æ¯','çˆ¹','å¨˜','å¦ˆ','çˆ¸','å…„','å“¥','å¼Ÿ','å§','å¦¹','çˆ·','å¥¶','å”','å§‘','èˆ…','å§¨','äº²','æ—','ç¥–','å„¿','å¥³','å­™']},{level:'B',name:'å¸ˆ/å‹/åŒä¼´',color:'#4CAF50',keywords:['å‹','ç›Ÿ','çŸ¥å·±','æ•…äº¤','é’æ¢…ç«¹é©¬','å‘å°','é—ºèœœ','æ­»å…š','ä¼™','åŒçª—','å¸ˆ','å¼Ÿå­','å­¦ç”Ÿ','é˜Ÿå‹','æ­æ¡£','åŒä¼´','åŒé—¨','å¾’','æ•™å®˜','å­¦å¾’','å‘å¯¼','å“¨å…µ']},{level:'C',name:'ç¤¾ä¼šå…³ç³»/æœªåˆ†ç±»',color:'#9E9E9E',keywords:['åŒäº‹','é‚»å±…','èˆå‹','å®¤å‹','é¡¾å®¢','å®¢æˆ·','ä¸Šå¸','ä¸‹å±','åŒå­¦','è·¯äºº','ç†Ÿäºº','è®¤è¯†','ç›¸è¯†','åŒä¹¡','è€ä¹¡','æˆ¿ä¸œ','ç§Ÿå®¢','åº—å‘˜','è€æ¿','å‘˜å·¥','ä¸»ç®¡','ç»ç†','åŠ©æ‰‹','ç§˜ä¹¦','ç®¡å®¶','ä»†äºº','ä¾ä»','æŠ¤å«','ä¿é•–']},{level:'D',name:'åˆ©ç›Šå…³ç³»',color:'#FF9800',keywords:['åˆä½œ','é›‡ä½£','äº¤æ˜“','å€ºåŠ¡','ç‚®å‹','åˆ©ç”¨','å·¥å…·äºº','æ£‹å­','æ“æ§','å‚€å„¡','ä¹°å–','å€ºä¸»','æ¬ å€º','å•†ä¸š','åˆä¼™','æŠ•èµ„','èµåŠ©','é‡‘ä¸»','èµ„åŠ©','åŒ…å…»','å¥‘çº¦','åè®®']},{level:'E',name:'æ•Œå¯¹å…³ç³»',color:'#F44336',keywords:['ä»‡','æ•Œ','æ­»','å¯¹æ‰‹','ç«äº‰','ä»‡æ•Œ','æ­»æ•Œ','å®¿æ•Œ','å¨èƒ','æ•Œå¯¹','ä»‡äºº','ä»‡å®¶','æ•Œäºº','å¯¹å¤´','å†¤å®¶','æ€çˆ¶','æ€æ¯','è¡€ä»‡','æ·±ä»‡','ä¸–ä»‡','å¤™æ•Œ','åŠ²æ•Œ','å¼ºæ•Œ','æ­»å¯¹å¤´','çœ¼ä¸­é’‰','å®¿ä¸»','å¤ºèˆ','å¯„ç”Ÿ']}],n='?',r='å¤æ‚/æœªçŸ¥',l='#9C27B0';function i(e,t){return t.keywords.some(t=>e.includes(t))}function c(e,t){const a=e.split(/[,ï¼Œã€;ï¼›|]/).map(e=>e.trim()).filter(e=>e.length>0);if(0===a.length)return{color:o.find(e=>'C'===e.level).color,level:'C',typeName:'ç¤¾ä¼šå…³ç³»',isComplex:!1};if(t&&t.length>0)for(const e of t)if(e.keywords&&e.keywords.length>0)for(const t of a)if(e.keywords.some(e=>t.includes(e)))return{color:e.color,level:'C',typeName:e.label,isComplex:!1};const c=new Set;if(a.forEach(e=>{for(const t of o)if(i(e,t)){c.add(t.level);break}}),0===c.size)return{color:o.find(e=>'C'===e.level).color,level:'C',typeName:'ç¤¾ä¼šå…³ç³»',isComplex:!1};const s=['S','A','B'].some(e=>c.has(e)),u=c.has('E');if(s&&u)return{color:l,level:n,typeName:r,isComplex:!0};const d=['S','A','E','D','B','C'];for(const e of d)if(c.has(e)){const t=o.find(t=>t.level===e);return{color:t.color,level:t.level,typeName:t.name,isComplex:!1}}return{color:o.find(e=>'C'===e.level).color,level:'C',typeName:'ç¤¾ä¼šå…³ç³»',isComplex:!1}}function s(){const e={S:'ğŸ’—',A:'ğŸ’™',B:'ğŸ’š',C:'âšª',D:'ğŸŸ¡',E:'ğŸ”´','?':'ğŸŸ£'};return[...o.map(t=>({level:t.level,name:t.name,color:t.color,emoji:e[t.level]})),{level:n,name:r,color:l,emoji:e['?']},{level:'dashed',name:'è¿‡å¾€/éšè—',color:'#888888',emoji:'â”„',isDashed:!0}]}function u(e,t){const a=(e||'')+(t||'');return['è¿‡å»','è¿‡å¾€','ä»å‰','æ›¾ç»','æ›¾','å‰','åŸ','æ•…','æ˜”','å·²æ•…','å·²é€','å‰ä»»','æ—§','æš—','ç§˜','éš','ä¼ª','å‡','è¡¨é¢','ç–‘','å¯èƒ½','æ½œåœ¨','ç–‘ä¼¼'].some(e=>a.includes(e))}function d(e){return e?e.replace(/[ã€‚.]+$/,'').replace(/\s+/g,'').trim():''}a(4061);const p=/[;ï¼›|\n]/,m=/[ã€,ï¼Œ/&]/,f=/[ï¼š:]/;function g(e,t){const a=e.cells.find(e=>e.colIndex===t);return a?String(a.value??'').trim():''}function v(e,t){return t&&e&&t.get(e)||e}function b(e,t){const a=e.map(e=>e.toLowerCase());for(const e of t){const t=a.findIndex(t=>t.includes(e.toLowerCase()));if(-1!==t)return t}return-1}function h(e,t){const a=e.toLowerCase(),o=t.toLowerCase();return['äººç‰©','è§’è‰²','npc','character','ä¸»è§’','protagonist','player'].some(e=>a.includes(e)||o.includes(e))}function x(e){return/^[A-Za-z\s'-]+$/.test(e)&&e.includes(' ')}function y(e){if(x(e)){const t=e.split(' ')[0];return t.length>6?t.slice(0,6):t}return e.length>0?e[e.length-1]:e}function w(e,t=[],a,o,n){const r=[],l=[],i=[],s=new Set;if(!e||0===e.rows.length)return{elements:[],nodeCount:0,edgeCount:0,warnings:['å…³ç³»è¡¨ä¸ºç©ºæˆ–ä¸å­˜åœ¨']};const d=e.headers,p=b(d,['source','æº','ä¸»ä½“','å‘èµ·æ–¹','from']),m=b(d,['target','ç›®æ ‡','å®¢ä½“','æ¥æ”¶æ–¹','to']),f=b(d,['å…³ç³»','relation','å…³ç³»è¯']),h=b(d,['å¤‡æ³¨','note','è¯´æ˜','remark']);if(-1===p||-1===m)return{elements:[],nodeCount:0,edgeCount:0,warnings:['å…³ç³»è¡¨ç¼ºå°‘ source/target åˆ—ï¼Œæ— æ³•è§£æ']};const x=new Set,w=new Set,k=new Set;if(t.forEach(e=>{const t=e.name.toLowerCase(),a=t.includes('ä¸»è§’')||t.includes('protagonist'),o=b(e.headers,['å§“å','name','åç§°','è§’è‰²å']);-1!==o&&e.rows.forEach(e=>{const t=g(e,o);t&&(a?x.add(t):w.add(t))})}),a){const e=b(a.headers,['åç§°','name','åŠ¿åŠ›å']);-1!==e&&a.rows.forEach(t=>{const a=g(t,e);a&&k.add(a)})}function C(e){if(!e||s.has(e))return;s.add(e);const t=function(e){return x.has(e)?'protagonist':w.has(e)?'character':k.has(e)?'faction':'unknown'}(e),a=y(e);l.push({data:{id:e,label:a,type:t},classes:t})}return e.rows.forEach((e,t)=>{const a=g(e,p),l=g(e,m),s=-1!==f?g(e,f):'',d=-1!==h?g(e,h):'';if(!a||!l)return void((a||l)&&r.push(`ç¬¬ ${t+1} è¡Œæ•°æ®ä¸å®Œæ•´ï¼ˆsource: "${a}", target: "${l}"ï¼‰`));const b=v(a,o),x=v(l,o);C(b),C(x);const y=c(s,n);i.push({data:{id:`edge-${t}`,source:b,target:x,label:s||'å…³ç³»',note:d,color:y.color,lineStyle:u(d)?'dashed':'solid',level:y.level}})}),{elements:[...l,...i],nodeCount:l.length,edgeCount:i.length,warnings:r}}function k(e,t){const a=[],o=[],n=new Set;let r=0;const l=new Set(t.validTargets||[]);function i(e,o=t.nodeType){if(!e||n.has(e))return;n.add(e);const r=y(e);a.push({data:{id:e,label:r,type:o},classes:o})}const s=new Map;e.forEach(e=>{const a=b(e.headers,t.nameColKeywords),o=b(e.headers,t.relationColKeywords);-1!==a&&-1!==o&&e.rows.forEach(e=>{const n=g(e,a),r=g(e,o);if(!n||!r)return;const b=v(n,t.aliasMap);i(b),l.add(b);const h=function(e,t=new Set){if(!e||'string'!=typeof e)return[];const a=[],o=e.split(p).map(e=>e.trim()).filter(Boolean);for(const e of o){let o='',n=e;const r=e.match(/[ï¼ˆ(]([^ï¼‰)]+)[ï¼‰)]/);r&&(o=r[1],n=e.replace(/[ï¼ˆ(][^ï¼‰)]+[ï¼‰)]/g,'').trim()),n=n.replace(/[""]([^""]+)[""]/g,'$1');const l=n.match(/^(.+?)ä¸(.+?)çš„(.+)$/);if(l){const e=l[1].trim(),t=l[2].trim(),n=l[3].split(m).map(e=>e.trim()).filter(Boolean);for(const r of n){const n=d(r);n&&a.push({targets:[e,t],relation:n,note:o})}continue}const i=n.match(/^(.+?[ã€,ï¼Œ].+?)çš„(.+)$/);if(i){const e=i[1],t=i[2],n=e.split(m).map(e=>e.trim()).filter(Boolean);if(n.length>1){const e=t.split(m).map(e=>e.trim()).filter(Boolean);for(const t of e){const e=d(t);e&&a.push({targets:n,relation:e,note:o})}continue}}const c=n.match(/^(.+?)çš„(.+)$/);if(c){const e=c[1].trim(),t=c[2];let n;n=t.includes('ä¸')?t.split(/ä¸/).map(e=>e.trim()).filter(Boolean):t.split(m).map(e=>e.trim()).filter(Boolean);for(const t of n){const n=d(t);n&&a.push({targets:[e],relation:n,note:o})}continue}const s=n.match(/^ä¸(.+?)([^ã€,ï¼Œ\s]+)$/);if(s){const e=s[1].trim(),t=s[2].trim(),n=e.split(m).map(e=>e.trim()).filter(Boolean),r=t.split(m).map(e=>e.trim()).filter(Boolean);let l=!1;for(const e of r){const t=d(e);n.length>0&&t&&(a.push({targets:n,relation:t,note:o}),l=!0)}if(l)continue}const u=n.match(new RegExp(`^(.+?)${f.source}(.+)$`));if(u){let e=u[1].trim(),n=u[2].trim(),r=!1;const l=e=>e.split(m).map(e=>e.trim()).some(e=>t.has(e));if(t.size>0){const t=l(e),a=l(n);!t&&a&&(r=!0)}r&&([e,n]=[n,e]);const i=n,c=e.split(m).map(e=>e.trim()).filter(Boolean),s=i.split(m).map(e=>e.trim()).filter(Boolean);for(const e of s){const t=d(e);t&&a.push({targets:c,relation:t,note:o})}continue}console.info(`[RelationshipParser] æ— æ³•è§£æ: "${e}"`)}return a}(r,l);for(const e of h){const a=d(e.relation);if(a)for(const o of e.targets){const n=v(o,t.aliasMap);if(t.validTargets&&!t.validTargets.has(n))continue;i(n);const r=`${b}->${n}`,l=c(a,t.customLegendItems),d=u(e.note,a);if(s.has(r)){const t=s.get(r);t.relations.includes(a)||t.relations.push(a),e.note&&!t.notes.includes(e.note)&&t.notes.push(e.note);const o=['S','A','E','D','B','C','?'],n=o.indexOf(t.level);(o.indexOf(l.level)<n||-1===n)&&(t.color=l.color,t.level=l.level),d&&(t.useDashed=!0)}else s.set(r,{relations:[e.relation],notes:e.note?[e.note]:[],color:l.color,level:l.level,useDashed:d})}}})});const h=new Set;return s.forEach((e,t)=>{const[a,n]=t.split('->'),l=[a,n].sort().join('<->');if(h.has(l))return;const i=`${n}->${a}`,c=s.get(i);let u=!1;if(c){u=[...e.relations].sort().join(',')===[...c.relations].sort().join(',')}const d=e.relations.join('/'),p=e.notes.join('; ');u?(h.add(l),o.push({data:{id:'edge-'+r++,source:a,target:n,label:d||'å…³ç³»',note:p,color:e.color,lineStyle:e.useDashed?'dashed':'solid',level:e.level,bidirectional:!0}})):o.push({data:{id:'edge-'+r++,source:a,target:n,label:d||'å…³ç³»',note:p,color:e.color,lineStyle:e.useDashed?'dashed':'solid',level:e.level,bidirectional:!1}})}),{elements:[...a,...o],nodeCount:a.length,edgeCount:o.length,warnings:[]}}function C(e){const t=['åŠ¿åŠ›','faction','ç»„ç»‡','organization','é˜µè¥'];return e.find(e=>{const a=e.name.toLowerCase(),o=e.id.toLowerCase();return t.some(e=>a.includes(e)||o.includes(e))})||null}function N(e,t){const a=function(e){const t=C(e);if(!t)return console.info('[FactionMapping] æœªæ‰¾åˆ°åŠ¿åŠ›è¡¨'),[];const a=b(t.headers,['åç§°','name','åŠ¿åŠ›å','ç»„ç»‡å','é˜µè¥å']);if(-1===a)return console.info('[FactionMapping] åŠ¿åŠ›è¡¨ä¸­æœªæ‰¾åˆ°åç§°åˆ—'),[];const o=[];return t.rows.forEach(e=>{const t=g(e,a);t&&!o.includes(t)&&o.push(t)}),console.info(`[FactionMapping] ä»åŠ¿åŠ›è¡¨æå– ${o.length} ä¸ªåŠ¿åŠ›:`,o),o}(e),o=function(e,t){const a=new Map,o=['æ‰€å±','åŠ¿åŠ›','é˜µè¥','ç»„ç»‡','èº«ä»½','èŒä¸š','faction','affiliation','organization'];for(const n of e){const e=b(n.headers,['å§“å','name','åç§°','è§’è‰²å']),r=b(n.headers,o);-1!==e&&-1!==r&&n.rows.forEach(o=>{const n=g(o,e),l=g(o,r);if(!n||!l)return;const i=[...t].sort((e,t)=>t.length-e.length);for(const e of i)if(l.includes(e)){a.set(n,e),console.info(`[FactionMapping] è§’è‰² "${n}" åŒ¹é…åŠ¿åŠ› "${e}" (æ¥è‡ª "${l}")`);break}})}return console.info(`[FactionMapping] ä»äººç‰©è¡¨æå– ${a.size} ä¸ªè§’è‰²çš„åŠ¿åŠ›å½’å±`),a}(t,a),n=C(e),r=[];if(n&&a.length>0){k([n],{nameColKeywords:['åç§°','name','åŠ¿åŠ›å','ç»„ç»‡å','é˜µè¥å'],relationColKeywords:['å…³ç³»','å¤–äº¤','relation','relationship','åŠ¿åŠ›å…³ç³»'],nodeType:'faction',validTargets:new Set(a)}).elements.forEach(e=>{e.data.source&&e.data.target&&r.push({source:e.data.source,target:e.data.target,relation:e.data.label||'å…³ç³»'})}),console.info(`[FactionMapping] ä½¿ç”¨é€šç”¨è§£æå™¨è§£æå‡º ${r.length} æ¡åŠ¿åŠ›é—´å…³ç³»`)}return{factionList:a,characterToFaction:o,factionRelations:r}}function V(e=[],t,a,o){const n=[],r=[];e.forEach(e=>{const t=e.name.toLowerCase();t.includes('ä¸»è§’')||t.includes('protagonist')?n.push(e):r.push(e)});const l=k(n,{nameColKeywords:['å§“å','name','åç§°','è§’è‰²å'],relationColKeywords:['äººé™…å…³ç³»','å…³ç³»','relationship','relations'],nodeType:'protagonist',aliasMap:a,customLegendItems:o}),i=k(r,{nameColKeywords:['å§“å','name','åç§°','è§’è‰²å'],relationColKeywords:['äººé™…å…³ç³»','å…³ç³»','relationship','relations'],nodeType:'character',aliasMap:a,customLegendItems:o}),c=new Map,s=[],u=[...l.warnings,...i.warnings],d=e=>{e.elements.forEach(e=>{if(e.data.source&&e.data.target){const t={...e};t.data.id=`edge-${s.length}`,s.push(t)}else{const t=e.data.id;c.has(t)||c.set(t,e)}})};d(l),d(i);const p=new Set(c.keys()),m=['æ‰€å±','åŠ¿åŠ›','é˜µè¥','ç»„ç»‡','èº«ä»½','èŒä¸š','faction','affiliation','organization'];return e.forEach(e=>{const t=b(e.headers,['å§“å','name','åç§°','è§’è‰²å']),a=b(e.headers,m);-1!==t&&-1!==a&&e.rows.forEach(o=>{const n=g(o,t),r=g(o,a);if(n&&r&&!p.has(n)){const t=e.name.toLowerCase().includes('ä¸»è§’')?'protagonist':'character',a=y(n);c.set(n,{data:{id:n,label:a,type:t},classes:t}),p.add(n)}})}),{elements:[...c.values(),...s],nodeCount:c.size,edgeCount:s.length,warnings:u}}var E=a(8889);function B(){const e=window.parent||window;return{$:window.jQuery||e.jQuery,getDB:()=>e.AutoCardUpdaterAPI||window.AutoCardUpdaterAPI}}function S(){const e=B().getDB();try{return e&&e.exportTableAsJson?e.exportTableAsJson():null}catch(e){return console.warn('[ACU] getTableData error:',e),null}}function T(e){if(!e||'object'!=typeof e)return{};const t={};for(const a in e)if(e[a]?.name){const o=e[a];t[o.name]={key:a,headers:o.content?.[0]||[],rows:o.content?.slice(1)||[]}}return Object.keys(t).length>0?t:null}function D(e){if(!e)return'';const t=String(e);return'True'===t||'Yes'===t||'å®Œæˆ'===t||'å·²å®Œæˆ'===t?'acu-badge-success':'False'===t||'No'===t||'å¤±è´¥'===t||'æœªå®Œæˆ'===t?'acu-badge-danger':'è¿›è¡Œä¸­'===t||'Doing'===t?'acu-badge-warning':/^\d+%$/.test(t)?'acu-badge-info':/^Lv\.?\d+$/i.test(t)?'acu-badge-primary':''}},1958(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'\n','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},2158(e,t,a){a.d(t,{t:()=>d});var o=a(4061);const n='acu_locked_fields_v2_',r={å…¨å±€æ•°æ®è¡¨:null,ä¸–ç•Œåœ°å›¾ç‚¹:'è¯¦ç»†åœ°ç‚¹',åœ°å›¾å…ƒç´ è¡¨:'å…ƒç´ åç§°',ä¸»è§’ä¿¡æ¯:'å§“å',é‡è¦äººç‰©è¡¨:'å§“å',æŠ€èƒ½è¡¨:'æŠ€èƒ½åç§°',ç‰©å“è¡¨:'ç‰©å“åç§°',è£…å¤‡è¡¨:'è£…å¤‡åç§°',ä»»åŠ¡è¡¨:'åç§°',æ€»ç»“è¡¨:'ç¼–ç ç´¢å¼•',æ€»ä½“å¤§çº²:'ç¼–ç ç´¢å¼•',é‡è¦æƒ…æŠ¥:'æƒ…æŠ¥åç§°',åŠ¿åŠ›:'åç§°'};function l(){try{const e=window.SillyTavern?.getContext?.();if(e?.chatId)return e.chatId;if(e?.characterId&&e?.chat?.length>0)return`${e.characterId}_${e.chat.length}`}catch{}return'default'}function i(e){return n+(e||l())}const c=(0,o.ref)({}),s=(0,o.ref)({});let u=null;function d(){function e(){const e=l();if(u!==e){u=e;try{const t=localStorage.getItem(i(e));if(t){const e=JSON.parse(t);delete e._lastAccess,c.value=e}else c.value={}}catch{c.value={}}}return c.value}function t(){try{const e={...c.value,_lastAccess:Date.now()};localStorage.setItem(i(),JSON.stringify(e)),function(){try{const e=[];for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);a?.startsWith(n)&&e.push(a)}if(e.length<=20)return;const t=e.map(e=>{try{const t=JSON.parse(localStorage.getItem(e)||'{}');return{key:e,time:t?._lastAccess||0}}catch{return{key:e,time:0}}});t.sort((e,t)=>t.time-e.time);const a=t.slice(20);a.forEach(e=>localStorage.removeItem(e.key)),a.length>0&&console.log(`[CellLock] æ¸…ç†äº† ${a.length} ä¸ªè¿‡æœŸçš„é”å®šæ•°æ®`)}catch(e){console.warn('[CellLock] æ¸…ç†å¤±è´¥',e)}}()}catch(e){console.warn('[CellLock] ä¿å­˜å¤±è´¥',e)}}function a(e,t,a,o){const n=r[e];if(null===n)return'_row_0';let l=1;if(n){const e=a.indexOf(n);-1!==e&&(l=e)}const i=t[l];if(i)return`${n||a[l]}=${i}`;if(void 0!==o)return`_row_${o}`;for(let e=0;e<t.length;e++)if(t[e]&&0!==e)return`${a[e]||`col${e}`}=${t[e]}`;return null}function d(e,t){const a=t._fullRow?t._snapshot:t._fields;if(!a||0===Object.keys(a).length)return null;const o=new Array(e.length).fill(null);for(const[t,n]of Object.entries(a)){const a=e.indexOf(t);-1!==a&&(o[a]=n)}return o}const p=(0,o.computed)(()=>{let e=0;for(const t of Object.values(s.value))if('object'==typeof t)for(const a of Object.values(t))a._fullRow?e+=Object.keys(a._snapshot||{}).length:e+=Object.keys(a._fields||{}).length;return e});return{loadLocks:e,initPendingLocks:function(){e(),s.value=JSON.parse(JSON.stringify(c.value))},getRowKey:a,pendingLocks:s,toggleCellLock:function(e,t,a,o){const n=JSON.parse(JSON.stringify(s.value));n[e]||(n[e]={}),n[e][t]||(n[e][t]={_fullRow:!1,_fields:{},_snapshot:null});const r=n[e][t];let l;return r._fullRow&&r._snapshot?void 0!==r._snapshot[a]?(delete r._snapshot[a],0===Object.keys(r._snapshot).length&&(r._fullRow=!1,r._snapshot=null),l=!1):(r._fields[a]=o,l=!0):void 0!==r._fields[a]?(delete r._fields[a],l=!1):(r._fields[a]=o,l=!0),r._fullRow||0!==Object.keys(r._fields).length||(delete n[e][t],0===Object.keys(n[e]).length&&delete n[e]),s.value=n,console.log('[CellLock] toggleCellLock:',e,t,a,'->',l,'count:',function(e){let t=0;for(const a of Object.values(e))if('object'==typeof a)for(const e of Object.values(a))e._fullRow?t+=Object.keys(e._snapshot||{}).length:t+=Object.keys(e._fields||{}).length;return t}(n)),l},toggleRowLock:function(e,t,a,o){const n=JSON.parse(JSON.stringify(s.value));n[e]||(n[e]={});const r=n[e]?.[t];if(r?._fullRow)return delete n[e][t],0===Object.keys(n[e]).length&&delete n[e],s.value=n,console.log('[CellLock] toggleRowLock: è§£é”æ•´è¡Œ',e,t),!1;const l={};return a.forEach((e,t)=>{e&&null!=o[t]&&''!==o[t]&&(l[e]=o[t])}),n[e][t]={_fullRow:!0,_fields:{},_snapshot:l},s.value=n,console.log('[CellLock] toggleRowLock: é”å®šæ•´è¡Œ',e,t,'fields:',Object.keys(l).length),!0},savePendingLocks:function(){c.value=JSON.parse(JSON.stringify(s.value)),t()},discardPendingLocks:function(){s.value={}},isCellLockedPending:function(e,t,a){const o=s.value[e]?.[t];return!!o&&(o._fullRow?void 0!==o._snapshot?.[a]:void 0!==o._fields?.[a])},isRowLockedPending:function(e,t){return!0===s.value[e]?.[t]?._fullRow},getLockedFieldsPending:function(e,t){const a=s.value[e]?.[t];return a?a._fullRow?Object.keys(a._snapshot||{}):Object.keys(a._fields||{}):[]},hasRowAnyLockPending:function(e,t){const a=s.value[e]?.[t];return!!a&&(!!a._fullRow||Object.keys(a._fields||{}).length>0)},isCellLocked:function(t,a,o){e();const n=c.value[t]?.[a];return!!n&&(n._fullRow?void 0!==n._snapshot?.[o]:void 0!==n._fields?.[o])},isRowLocked:function(t,a){return e(),!0===c.value[t]?.[a]?._fullRow},applyLocks:function(t,o){e();const n=c.value[t];if(!n||!o||o.length<2)return{modified:!1,restored:[]};const r=o[0],l=[];let i=!1;const s={};for(let e=1;e<o.length;e++){const n=a(t,o[e],r,e-1);n&&(s[n]=e)}for(const[e,a]of Object.entries(n)){const n=s[e];if(void 0===n){const t=d(r,a);t&&(o.push(t),l.push(e),i=!0,console.info(`[CellLock] æ¢å¤è¢«åˆ é™¤çš„é”å®šè¡Œ: ${e}`));continue}const c=o[n],u=a._fullRow?a._snapshot:a._fields;if(u)for(const[a,o]of Object.entries(u)){const n=r.indexOf(a);-1!==n&&c[n]!==o&&(console.info(`[CellLock] æ¢å¤é”å®šå€¼: ${t}[${e}].${a} = "${o}" (åŸå€¼: "${c[n]}")`),c[n]=o,i=!0)}}return{modified:i,restored:l}},updateLockedValue:function(a,o,n,r){e();const l=c.value[a]?.[o];if(!l)return!1;let i=!1;return l._fullRow&&l._snapshot&&void 0!==l._snapshot[n]&&(l._snapshot[n]=r,i=!0),l._fields&&void 0!==l._fields[n]&&(l._fields[n]=r,i=!0),i&&(t(),console.log('[CellLock] updateLockedValue:',a,o,n,'->',r)),i},pendingLockCount:p}}},2357(e,t,a){var o=a(7615);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('0db8b676',o,!1,{ssrId:!0})},2448(e,t,a){a.d(t,{$H:()=>c,Aq:()=>n,DZ:()=>u,dQ:()=>p,e$:()=>s,eO:()=>d,saveBackground:()=>i});const o='backgrounds',n='global_theme_background';let r=null;async function l(){return r||new Promise((e,t)=>{const a=indexedDB.open('acu_background_db',1);a.onerror=()=>{console.error('[ACU Background] æ‰“å¼€æ•°æ®åº“å¤±è´¥:',a.error),t(a.error)},a.onsuccess=()=>{r=a.result,console.info('[ACU Background] æ•°æ®åº“è¿æ¥æˆåŠŸ'),e(r)},a.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(o)||(t.createObjectStore(o,{keyPath:'chatId'}),console.info('[ACU Background] åˆ›å»ºèƒŒæ™¯å›¾ç‰‡è¡¨æˆåŠŸ'))}})}async function i(e,t,a='image/png'){const n=await l();return new Promise((r,l)=>{const i=n.transaction(o,'readwrite').objectStore(o),c={chatId:e,imageData:t,mimeType:a,timestamp:Date.now()},s=i.put(c);s.onsuccess=()=>{console.info('[ACU Background] ä¿å­˜èƒŒæ™¯å›¾ç‰‡æˆåŠŸ, chatId:',e),r()},s.onerror=()=>{console.error('[ACU Background] ä¿å­˜èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',s.error),l(s.error)}})}async function c(e){const t=await l();return new Promise((a,n)=>{const r=t.transaction(o,'readonly').objectStore(o).get(e);r.onsuccess=()=>{const t=r.result;if(t?.imageData){const o=URL.createObjectURL(t.imageData);console.info('[ACU Background] åŠ è½½èƒŒæ™¯å›¾ç‰‡æˆåŠŸ, chatId:',e),a(o)}else a(null)},r.onerror=()=>{console.error('[ACU Background] åŠ è½½èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',r.error),n(r.error)}})}async function s(e){const t=await l();return new Promise((a,n)=>{const r=t.transaction(o,'readwrite').objectStore(o).delete(e);r.onsuccess=()=>{console.info('[ACU Background] åˆ é™¤èƒŒæ™¯å›¾ç‰‡æˆåŠŸ, chatId:',e),a()},r.onerror=()=>{console.error('[ACU Background] åˆ é™¤èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',r.error),n(r.error)}})}async function u(e){return{blob:e,mimeType:e.type||'image/png'}}async function d(e){if(e.startsWith('data:')){const t=await fetch(e),a=await t.blob();return{blob:a,mimeType:a.type}}try{const t=await fetch(e,{mode:'cors'});if(!t.ok)throw new Error(`HTTP ${t.status}`);const a=await t.blob();return{blob:a,mimeType:a.type}}catch{throw new Error('æ— æ³•åŠ è½½å¤–éƒ¨å›¾ç‰‡ï¼Œå¯èƒ½æ˜¯è·¨åŸŸé™åˆ¶')}}function p(e){e.startsWith('blob:')&&URL.revokeObjectURL(e)}},2523(e,t,a){var o=a(9625);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('029a7e6d',o,!1,{ssrId:!0})},2717(e,t,a){var o=a(5372);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('5e1fe17a',o,!1,{ssrId:!0})},2778(e,t,a){var o=a(3564);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('d442c36e',o,!1,{ssrId:!0})},3024(e,t,a){a.d(t,{D:()=>m});var o=a(4015),n=a(2158),r=a(9842),l=a(8),i=a(1768),c=a(3035),s=a(4061);const u='acu_data_snapshot_v18_5',d='shujuku_v34_allSettings_v2';function p(e){if(null==e)return'';const t=String(e).trim();return'null'===t||'undefined'===t?'':t}const m=(0,c.defineStore)('acu-data',()=>{const e=(0,s.ref)(null),t=(0,s.ref)({}),a=(0,s.ref)(null),c=(0,s.ref)(null),m=(0,s.reactive)(new Set),f=(0,s.reactive)(new Set),g=(0,s.computed)(()=>{const e=new Set;return m.forEach(t=>e.add(t)),f.forEach(t=>e.add(t)),e}),v=(0,s.reactive)(new Set),b=(0,s.ref)(!1),h=(0,s.ref)(!1),x=(0,s.ref)(null),y=(0,l.te)(),w=(0,n.t)(),k=y.issuesByTable,C=y.hasIssues,N=y.problematicTables,V=y.issueStats,E=(0,s.computed)(()=>v.size>0),B=(0,s.computed)(()=>m.size>0||f.size>0||v.size>0),S=B,T=(0,s.computed)(()=>null!==c.value);function D(){try{const e=localStorage.getItem(u);return e?JSON.parse(e):null}catch{return null}}function A(e){try{a.value=(0,o.klona)(e),localStorage.setItem(u,JSON.stringify(e))}catch(e){console.error('[ACU] Save snapshot failed:',e)}}function I(){try{localStorage.removeItem(u)}catch{}}function M(e,t){return`${e}-row-${t}`}function U(e,t,a){return`${e}-${t}-${a}`}function L(){let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);return!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern),e}function P(e,t,o){if(!a.value)return'';for(const n in a.value){const r=a.value[n];if(r&&r.name===e&&r.content){const e=r.content[t+1];if(e&&void 0!==e[o])return String(e[o])}}return''}function F(){if(!e.value)return;const a=(0,o.klona)(e.value);for(const e in a){const o=a[e];if(!o||!o.name||!o.content)continue;const n=t.value[o.name];if(!n)continue;const r=o.content[0]||[],l=[r];for(const e of n){const t=[];for(let a=0;a<r.length;a++){const o=e.cells[a];t.push(o?o.value:'')}l.push(t)}o.content=l}e.value=a}function j(e=!1){m.clear(),f.clear(),e&&v.clear()}function O(e){const t={};for(const a in e){const o=e[a];if(!o?.name)continue;if(!o.content||!Array.isArray(o.content))continue;const n=o.name,r=o.content[0]||[],l=[];for(let e=1;e<o.content.length;e++){const t=o.content[e],a=[];for(let e=0;e<r.length;e++)a.push({key:String(r[e]||`col_${e}`),value:String(t[e]??'')});l.push({index:e-1,cells:a})}t[n]=l}return t}function R(e){if(0===v.size)return e;const t=(0,o.klona)(e);for(const e in t){if('mate'===e)continue;const a=t[e];if(!a||!a.name||!a.content)continue;const o=[a.content[0]];for(let e=1;e<a.content.length;e++){const t=e-1,n=M(a.name,t);v.has(n)||o.push(a.content[e])}a.content=o}return t}async function H(e,t){const a=L();if(!a||!a.chat||!a.chat[e])throw new Error(`æ¥¼å±‚ ${e} ä¸å­˜åœ¨`);const n=a.chat[e];let r=function(){let e='';try{let t=window.localStorage;if(!t.getItem(d)&&window.parent)try{t=window.parent.localStorage}catch{}const a=t.getItem(d);if(a){const t=JSON.parse(a);t.dataIsolationEnabled&&t.dataIsolationCode&&(e=t.dataIsolationCode)}}catch{}return e}();if(n.TavernDB_ACU_IsolatedData){const e=Object.keys(n.TavernDB_ACU_IsolatedData);e.length>0&&(r=e[0])}else n.TavernDB_ACU_IsolatedData={};n.TavernDB_ACU_IsolatedData[r]||(n.TavernDB_ACU_IsolatedData[r]={independentData:{},modifiedKeys:[],updateGroupKeys:[]});const l=n.TavernDB_ACU_IsolatedData[r];l.independentData||(l.independentData={});const i=Object.keys(t).filter(e=>e.startsWith('sheet_'));i.forEach(e=>{l.independentData[e]=(0,o.klona)(t[e])});const c=l.modifiedKeys||[];l.modifiedKeys=[...new Set([...c,...i])]}async function W(){const e=(0,i.M1)().getDB();if(e&&e.syncWorldbookEntries)try{await e.syncWorldbookEntries({createIfNeeded:!0})}catch(e){console.warn('[ACU] Worldbook sync failed:',e)}}async function G(){const e=L();e?.saveChatDebounced?await e.saveChatDebounced():e?.saveChat&&await e.saveChat()}function Y(e){v.has(e)?(v.delete(e),console.info(`[ACU] å–æ¶ˆåˆ é™¤æ ‡è®°: ${e}`)):(v.add(e),console.info(`[ACU] æ·»åŠ åˆ é™¤æ ‡è®°: ${e}`))}function X(e){const t=e.split('-');if(t.length>=2){const e=[];for(let a=0;a<t.length&&('row'!==t[a]&&!/^\d+$/.test(t[a]));a++)e.push(t[a]);if(e.length>0)return e.join('-')}return null}function q(t){if(!e.value)return null;for(const a in e.value)if(e.value[a]?.name===t)return a;return null}function K(e){return f.has(e)?'manual':m.has(e)?'ai':null}function J(e,a,o){const n=M(e,a);if(f.has(n))return'manual';if(m.has(n))return'ai';if(v.has(n))return'manual';const r=t.value[e],l=o??(r?.[a]?.cells.length||0);let i=!1,c=!1;for(let t=0;t<l;t++){const o=U(e,a,t);f.has(o)&&(i=!0),m.has(o)&&(c=!0)}return i?'manual':c?'ai':null}return{stagedData:e,tables:t,snapshot:a,aiDiffMap:m,manualDiffMap:f,diffMap:g,pendingDeletes:v,isSaving:b,isLoading:h,targetFloorInfo:x,lastSavedData:c,hasPendingDeletes:E,hasUnsavedChanges:B,hasChanges:S,getModifiedTableIds:function(){const t=new Set;for(const e of f){const a=X(e);a&&t.add(a)}for(const e of m){const a=X(e);a&&t.add(a)}for(const e of v){const a=X(e);a&&t.add(a)}const a=new Set;for(const o of t){const t=q(o);t?a.add(t):e.value&&e.value[o]&&a.add(o)}return Array.from(a)},hasUndoData:T,getStagedData:function(){return e.value},loadFromDatabase:async function(){if(h.value)console.warn('[ACU] åŠ è½½è¿›è¡Œä¸­ï¼Œè·³è¿‡é‡å¤è¯·æ±‚');else try{h.value=!0,console.info('[ACU] å¼€å§‹åŠ è½½æ•°æ®...');const n=(0,i.tu)();if(!n)return void console.warn('[ACU] æœªè·å–åˆ°è¡¨æ ¼æ•°æ®');const r=(0,o.klona)(n);let l=0;for(const e in r){const t=r[e];if(!t?.name||!t.content||!Array.isArray(t.content))continue;const a=w.applyLocks(t.name,t.content);a.modified&&(l+=a.restored.length,console.info(`[ACU] è¡¨ "${t.name}" åº”ç”¨äº†é”å®šä¿æŠ¤ï¼Œæ¢å¤äº† ${a.restored.length} é¡¹`))}l>0&&console.info(`[ACU] å…±æ¢å¤ ${l} ä¸ªè¢« AI ä¿®æ”¹çš„é”å®šå€¼`),e.value=r;const c=O(r);Object.entries(c).reduce((e,[t,a])=>(e[t]=a,e),{});t.value=c,a.value=(0,o.klona)(r),m.clear(),f.clear(),v.clear(),A(r),y.checkIntegrity(r,null,new Set),console.info('[ACU] æ•°æ®åŠ è½½å®Œæˆï¼Œè¡¨æ ¼æ•°é‡:',Object.keys(c).length)}catch(e){throw console.error('[ACU] åŠ è½½æ•°æ®å¤±è´¥:',e),e}finally{h.value=!1}},processToTableData:O,setStagedData:function(a){const n=(0,o.klona)(a);let r=0;for(const e in n){const t=n[e];if(!t?.name||!t.content||!Array.isArray(t.content))continue;const a=w.applyLocks(t.name,t.content);a.modified&&(r+=a.restored.length,console.info(`[ACU] è¡¨ "${t.name}" åº”ç”¨äº†é”å®šä¿æŠ¤`))}r>0&&console.info(`[ACU] å…±æ¢å¤ ${r} ä¸ªè¢« AI ä¿®æ”¹çš„é”å®šå€¼`),e.value=n;const l=O(n);return t.value=l,console.info('[ACU] æš‚å­˜æ•°æ®å·²è®¾ç½®'),n},generateDiffMap:function(e){if(m.clear(),!a.value)return;const t=a.value;for(const a in e){if('mate'===a||'updated'===a||'created'===a||a.startsWith('_'))continue;const o=e[a],n=t[a];if(!o||!o.content)continue;const r=o.name||a.replace('sheet_','');if(!n||!n.content){for(let e=1;e<o.content.length;e++){const t=M(r,e-1);f.has(t)||m.add(t)}continue}const l=Math.max(o.content.length,n.content.length);for(let e=1;e<l;e++){const t=o.content[e],a=n.content[e],l=e-1;if(!t||!a){const e=M(r,l);if(f.has(e)||m.add(e),t&&!a)for(let e=0;e<t.length;e++){const t=U(r,l,e);f.has(t)||m.add(t)}continue}const i=Math.max(t.length,a.length);for(let e=0;e<i;e++){if(p(t[e])!==p(a[e])){const t=U(r,l,e);f.has(t)||m.add(t)}}}}console.info(`[ACU] AIå·®å¼‚æ˜ å°„å·²ç”Ÿæˆï¼ŒAIå˜æ›´: ${m.size}, æ‰‹åŠ¨å˜æ›´: ${f.size}`)},saveToDatabase:async function(){if(b.value)return console.warn('[ACU] ä¿å­˜è¿›è¡Œä¸­ï¼Œè·³è¿‡é‡å¤è¯·æ±‚'),{success:!1,savedToFloor:-1,error:'ä¿å­˜è¿›è¡Œä¸­'};try{b.value=!0,console.info('[ACU] å¼€å§‹ä¿å­˜æ•°æ®...');let t=e.value;if(t||(t=(0,i.tu)()),!t)throw new Error('æ— æ•°æ®å¯ä¿å­˜');const n=R((0,o.klona)(t)),r=function(){const e=L();if(!e||!e.chat||0===e.chat.length)return-1;for(let t=e.chat.length-1;t>=0;t--){const a=e.chat[t];if(!a.is_user&&a.TavernDB_ACU_IsolatedData)return x.value={index:t,isAuto:!0,reason:'å·²å­˜åœ¨æ•°æ®'},t}for(let t=e.chat.length-1;t>=0;t--)if(!e.chat[t].is_user)return x.value={index:t,isAuto:!0,reason:'æ–°å»ºæ•°æ®ä½ç½®'},t;return-1}();if(-1===r)throw new Error('æœªæ‰¾åˆ°åˆé€‚çš„ç›®æ ‡æ¥¼å±‚');return await H(r,n),await W(),await G(),a.value=(0,o.klona)(n),e.value=(0,o.klona)(n),j(!0),A(n),console.info(`[ACU] æ•°æ®ä¿å­˜å®Œæˆï¼Œç›®æ ‡æ¥¼å±‚: ${r}`),{success:!0,savedToFloor:r}}catch(e){const t=e.message;return console.error('[ACU] ä¿å­˜æ•°æ®å¤±è´¥:',e),{success:!1,savedToFloor:-1,error:t}}finally{b.value=!1}},saveToFloor:async function(t){if(b.value)return console.warn('[ACU] ä¿å­˜è¿›è¡Œä¸­ï¼Œè·³è¿‡é‡å¤è¯·æ±‚'),{success:!1,savedToFloor:-1,error:'ä¿å­˜è¿›è¡Œä¸­'};try{b.value=!0,console.info(`[ACU] ä¿å­˜åˆ°ç¬¬ ${t} æ¥¼...`);let n=e.value;if(n||(n=(0,i.tu)()),!n)throw new Error('æ— æ•°æ®å¯ä¿å­˜');const r=R((0,o.klona)(n));return await H(t,r),await W(),await G(),a.value=(0,o.klona)(r),e.value=(0,o.klona)(r),j(!0),A(r),console.info(`[ACU] å·²ä¿å­˜åˆ°ç¬¬ ${t} æ¥¼`),{success:!0,savedToFloor:t}}catch(e){const t=e.message;return console.error('[ACU] ä¿å­˜åˆ°æŒ‡å®šæ¥¼å±‚å¤±è´¥:',e),{success:!1,savedToFloor:-1,error:t}}finally{b.value=!1}},purgeFloorRange:async function(e,t){if(b.value)console.warn('[ACU] æ“ä½œè¿›è¡Œä¸­ï¼Œè·³è¿‡é‡å¤è¯·æ±‚');else try{b.value=!0,console.info(`[ACU] æ¸…é™¤ç¬¬ ${e} åˆ° ${t} æ¥¼çš„æ•°æ®...`);const a=L();if(!a||!a.chat)throw new Error('æ— æ³•è®¿é—®èŠå¤©è®°å½•');const o=a.chat.length-1,n=Math.max(0,e),r=Math.min(o,t);if(isNaN(n)||isNaN(r)||n>r)throw new Error('æ— æ•ˆçš„æ¥¼å±‚èŒƒå›´');const l=['TavernDB_ACU_Data','TavernDB_ACU_SummaryData','TavernDB_ACU_IndependentData','TavernDB_ACU_Identity','TavernDB_ACU_IsolatedData','TavernDB_ACU_ModifiedKeys','TavernDB_ACU_UpdateGroupKeys'];let i=0;for(let e=n;e<=r;e++){const t=a.chat[e];if(!t)continue;let o=!1;for(const e of l)Object.prototype.hasOwnProperty.call(t,e)&&(delete t[e],o=!0);o&&i++}i>0&&(await G(),I(),j(!0),await W()),console.info(`[ACU] å·²æ¸…é™¤ ${i} ä¸ªæ¥¼å±‚çš„æ•°æ®`)}catch(e){throw console.error('[ACU] æ¸…é™¤æ¥¼å±‚æ•°æ®å¤±è´¥:',e),e}finally{b.value=!1}},insertRow:function(e,a){const o=t.value[e];if(!o||0===o.length)return void console.warn(`[ACU] è¡¨æ ¼ ${e} ä¸å­˜åœ¨æˆ–ä¸ºç©º`);const n=o[0],r={index:o.length,cells:n.cells.map(e=>({key:e.key,value:''}))};o.splice(a+1,0,r),o.forEach((e,t)=>{e.index=t});const l=M(e,a+1);f.add(l),F(),console.info(`[ACU] åœ¨ ${e} ç¬¬ ${a} è¡Œåæ’å…¥æ–°è¡Œ`)},updateCell:function(e,a,o,n,l){const i=t.value[e];if(!i||!i[a])return void console.warn(`[ACU] æ— æ•ˆçš„å•å…ƒæ ¼ä½ç½®: ${e}[${a}][${o}]`);const c=i[a];if(c.cells[o]){const t=c.cells[o].value;c.cells[o].value=n;const i=U(e,a,o);if(n!==P(e,a,o)){if(f.add(i),m.delete(i),!l?.skipHistory){const l=function(){const e=L();if(e?.getCurrentChatId){const t=e.getCurrentChatId();if(t)return t}return e?.chat_metadata?.chat_id?String(e.chat_metadata.chat_id):e?.chat?.length>0&&e.chat[0]?.chat_id?e.chat[0].chat_id:'default'}();if(console.info('[ACU] ä¿å­˜å†å²è®°å½•, å‚æ•°:',{chatId:l,tableId:e,rowIndex:a,colIndex:o,oldValue:t.substring(0,50)+(t.length>50?'...':''),newValue:n.substring(0,50)+(n.length>50?'...':'')}),l){const n={index:a,key:M(e,a),cells:c.cells.map((e,a)=>({colIndex:a,key:e.key,value:a===o?t:e.value}))};(0,r.O)(l,e,n,'manual').then(()=>{console.info('[ACU] å†å²è®°å½•ä¿å­˜æˆåŠŸ')}).catch(e=>{console.warn('[ACU] å†å²è®°å½•ä¿å­˜å¤±è´¥:',e)})}else console.warn('[ACU] æ— æ³•è·å– chatIdï¼Œè·³è¿‡å†å²è®°å½•ä¿å­˜')}}else{f.delete(i),m.delete(i);c.cells.every((t,o)=>t.value===P(e,a,o))&&c.cells.forEach((_,t)=>{const o=U(e,a,t);f.delete(o),m.delete(o)})}F(),console.info(`[ACU] æ›´æ–° ${e}[${a}][${o}]: "${t}" -> "${n}"`)}},toggleDelete:Y,toggleDeleteRow:function(e,t){Y(M(e,t))},markForDelete:function(e,t){const a=M(e,t);v.add(a)},unmarkForDelete:function(e,t){const a=M(e,t);v.delete(a)},getCellChangeType:K,getRowChangeType:J,hasTableAiChanges:function(e){for(const t of m)if(t.startsWith(`${e}-`))return!0;return!1},getTablesWithAiChanges:function(){const e=new Set;for(const t of m){const a=X(t);a&&e.add(a)}return Array.from(e)},isRowChanged:function(e,t,a){return null!==J(e,t,a)},isRowPendingDelete:function(e,t){return v.has(M(e,t))},isPendingDelete:function(e){return v.has(e)},isCellChanged:function(e){return null!==K(e)},getRowKey:M,getCellKey:U,clearChanges:j,syncToStagedData:F,loadSnapshot:D,saveSnapshot:A,clearSnapshot:I,saveLastState:function(){const e=a.value||D();e?(c.value=(0,o.klona)(e),console.info('[ACU] å·²ä¿å­˜å½“å‰å¿«ç…§åˆ°æ’¤å›ç¼“å­˜')):console.warn('[ACU] æ— å¿«ç…§æ•°æ®å¯ä¿å­˜åˆ°æ’¤å›ç¼“å­˜')},undoToLastSave:function(){if(!c.value)return console.warn('[ACU] æ— å¯æ’¤å›çš„æ•°æ®'),!1;const n=(0,o.klona)(c.value);e.value=n;const r=O(n);t.value=r,m.clear(),v.clear();const l=[];if(a.value)for(const e in n){if('mate'===e||'updated'===e||'created'===e||e.startsWith('_'))continue;const t=n[e],o=a.value[e];if(!t?.content)continue;const r=t.name||e.replace('sheet_','');if(!o?.content){for(let e=1;e<t.content.length;e++){const t=M(r,e-1);l.push(t)}continue}const i=Math.max(t.content.length,o.content.length);for(let e=1;e<i;e++){const a=t.content[e],n=o.content[e],i=e-1;if(!a||!n){const e=M(r,i);l.push(e);continue}const c=Math.max(a.length,n.length);for(let e=0;e<c;e++){if(String(a[e]??'')!==String(n[e]??'')){const t=U(r,i,e);l.push(t)}}}}return f.clear(),l.forEach(e=>f.add(e)),f.add('__undo_pending__'),console.info(`[ACU] æ’¤å›åå·®å¼‚: æ‰‹åŠ¨å˜æ›´ ${f.size} é¡¹`),console.info('[ACU] å·²æ’¤å›åˆ°ä¸Šæ¬¡ä¿å­˜å‰çš„çŠ¶æ€ï¼ˆéœ€æ‰‹åŠ¨ä¿å­˜ï¼‰'),!0},clearUndoCache:function(){c.value=null,console.info('[ACU] å·²æ¸…é™¤æ’¤å›ç¼“å­˜')},getUndoData:function(){return c.value?(0,o.klona)(c.value):null},integrityIssues:k,hasIntegrityIssues:C,problematicTables:N,integrityStats:V,checkIntegrity:e=>{y.checkIntegrity(e,a.value,m)},hasTableIssues:y.hasTableIssues,getTableIssues:y.getTableIssues,getIntegritySummary:y.getSummaryText,clearIntegrityIssues:y.clearIssues,isSummaryOrOutlineTable:l.qy}})},3035(t,a,o){t.exports=(e=>{var t={};return o.d(t,e),t})({createPinia:()=>e.createPinia,defineStore:()=>e.defineStore,storeToRefs:()=>e.storeToRefs})},3564(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},3651(e,t,a){var o=a(7365);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('1e8020cb',o,!1,{ssrId:!0})},3671(e,t,a){var o=a(1958);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('0453dc84',o,!1,{ssrId:!0})},3926(e,t,a){a.d(t,{$P:()=>i,JH:()=>v,MP:()=>b,mu:()=>c,pQ:()=>f,um:()=>g,zG:()=>m});var o=a(3981),n=a(3035),r=a(4061);const l='acu_visualizer_config',i={type:'icon',content:'fa-layer-group',size:50,notifyAnimation:'ripple',borderColor:'#ffffff',borderOpacity:40,bgColor:'#ffffff',bgOpacity:25,imageInvert:!1},c=[{id:'save',icon:'fa-save',label:'ä¿å­˜'},{id:'saveAs',icon:'fa-file-export',label:'å¦å­˜ä¸º'},{id:'undo',icon:'fa-undo',label:'æ’¤å›'},{id:'refresh',icon:'fa-sync-alt',label:'åˆ·æ–°'},{id:'manualUpdate',icon:'fa-hand-sparkles',label:'æ‰‹åŠ¨æ›´æ–°'},{id:'purge',icon:'fa-eraser',label:'æ¸…é™¤èŒƒå›´'},{id:'pin',icon:'fa-thumbtack',label:'å›ºå®šé¢æ¿'},{id:'toggle',icon:'fa-compress',label:'æ”¶èµ·é¢æ¿'},{id:'openNative',icon:'fa-external-link-alt',label:'åŸç”Ÿç¼–è¾‘å™¨'},{id:'collapseTab',icon:'fa-box-open',label:'æ”¶çº³Tab'},{id:'director',icon:'fa-clapperboard',label:'å¯¼æ¼”æ§åˆ¶å°'},{id:'settings',icon:'fa-cog',label:'è®¾ç½®'}],s=['save','collapseTab','refresh','director','toggle','settings'],u=['save','collapseTab','refresh','director','toggle','settings','saveAs','undo','manualUpdate','purge','pin','openNative'],d=[],p={theme:'retro',fontFamily:'default',cardWidth:280,fontSize:13,itemsPerPage:20,highlightNew:!0,highlightColor:'orange',highlightManualColor:'orange',highlightAiColor:'blue',customTitleColor:!1,titleColor:'orange',layout:'vertical',limitLongText:!1,showDashboard:!0,showPagination:!0,lockPanel:!1,purgeConfirmation:!0,gridColumns:0,autoSave:!1,autoSaveDelay:5e3,visibleButtons:s,buttonOrder:u,buttonGroups:d,longPressDirectExec:!1,clearTableOnSwipe:!0,collapseTabBar:!1,showCollapseTabButton:!0,mobileSafeAreaBottom:50,autoImportInteractions:!1},m=[{id:'retro',name:'å¤å¤ç¾Šçš®',icon:'fa-scroll'},{id:'dark',name:'æå¤œæ·±ç©º',icon:'fa-moon'},{id:'modern',name:'ç°ä»£æ¸…çˆ½',icon:'fa-sun'},{id:'forest',name:'æ£®ä¹‹ç‰©è¯­',icon:'fa-tree'},{id:'ocean',name:'æ·±æµ·å¹½è“',icon:'fa-water'},{id:'cyber',name:'èµ›åšéœ“è™¹',icon:'fa-bolt'},{id:'purple',name:'æ¢¦å¹»æµ…ç´«',icon:'fa-magic'}],f=[{id:'default',name:'ç³»ç»Ÿé»˜è®¤ (Modern)',val:'\'Segoe UI\', \'Microsoft YaHei\', sans-serif'},{id:'hanchan',name:'å¯’è‰å…¨åœ†ä½“',val:'"å¯’è‰å…¨åœ†ä½“", sans-serif'},{id:'maple',name:'Maple Mono (ä»£ç é£)',val:'"Maple Mono NF CN", monospace'},{id:'huiwen',name:'æ±‡æ–‡æ˜æœä½“ (Huiwen)',val:'"Huiwen-mincho", serif'},{id:'cooper',name:'Cooperæ­£æ¥·',val:'"CooperZhengKai", serif'},{id:'yffyt',name:'YFFYT (è‰ºæœ¯ä½“)',val:'"YFFYT", sans-serif'},{id:'fusion',name:'Fusion Pixel (åƒç´ é£)',val:'"Fusion Pixel 12px M latin", monospace'},{id:'wenkai',name:'éœé¹œæ–‡æ¥· (WenKai)',val:'"LXGW WenKai", serif'},{id:'notosans',name:'æ€æºé»‘ä½“ (Noto Sans)',val:'"Noto Sans CJK", sans-serif'},{id:'zhuque',name:'æœ±é›€ä»¿å®‹ (Zhuque)',val:'"Zhuque Fangsong (technical preview)", serif'}],g={orange:{main:'#d35400',bg:'rgba(211, 84, 0, 0.1)',name:'æ´»åŠ›æ©™'},red:{main:'#e74c3c',bg:'rgba(231, 76, 60, 0.1)',name:'è­¦ç¤ºçº¢'},blue:{main:'#3498db',bg:'rgba(52, 152, 219, 0.1)',name:'å¤©ç©ºè“'},green:{main:'#27ae60',bg:'rgba(39, 174, 96, 0.1)',name:'è‡ªç„¶ç»¿'},purple:{main:'#9b59b6',bg:'rgba(155, 89, 182, 0.1)',name:'ç½—å…°ç´«'},teal:{main:'#1abc9c',bg:'rgba(26, 188, 156, 0.1)',name:'é’ç»¿'},pink:{main:'#e91e63',bg:'rgba(233, 30, 99, 0.1)',name:'å°‘å¥³ç²‰'},lime:{main:'#82c91e',bg:'rgba(130, 201, 30, 0.1)',name:'é…¸æ©™'},indigo:{main:'#3f51b5',bg:'rgba(63, 81, 181, 0.1)',name:'é›è“'},cyan:{main:'#00bcd4',bg:'rgba(0, 188, 212, 0.1)',name:'é’è‰²'},brown:{main:'#795548',bg:'rgba(121, 85, 72, 0.1)',name:'å’–å•¡'},grey:{main:'#607d8b',bg:'rgba(96, 125, 139, 0.1)',name:'è“ç°'}},v=(0,n.defineStore)('acu-config',()=>{const e=(0,o.rXt)('acu_ui_config_v18',p,localStorage,{mergeDefaults:!0}),t=(0,r.computed)(()=>e.value.theme),a=(0,r.computed)(()=>e.value.fontFamily),n=(0,r.computed)(()=>{const t=f.find(t=>t.id===e.value.fontFamily);return t?.val||f[0].val});function l(e){const t=e.startsWith('#')?e:`#${e}`,a=parseInt(t.slice(1,3),16),o=parseInt(t.slice(3,5),16),n=parseInt(t.slice(5,7),16);return{main:t,bg:`rgba(${a}, ${o}, ${n}, 0.1)`,name:'è‡ªå®šä¹‰é¢œè‰²'}}const i=(0,r.computed)(()=>g[e.value.highlightColor]||g.orange),m=(0,r.computed)(()=>{if('custom'===e.value.highlightManualColor&&e.value.customHighlightManualHex)return l(e.value.customHighlightManualHex);const t=e.value.highlightManualColor||e.value.highlightColor;return g[t]||g.orange}),v=(0,r.computed)(()=>{if('custom'===e.value.highlightAiColor&&e.value.customHighlightAiHex)return l(e.value.customHighlightAiHex);const t=e.value.highlightAiColor||'blue';return g[t]||g.blue}),b=(0,r.computed)(()=>e.value.customTitleColor?'custom'===e.value.titleColor&&e.value.customTitleHex?l(e.value.customTitleHex):g[e.value.titleColor]||g.orange:m.value),h=(0,r.computed)(()=>e.value.gridColumns&&e.value.gridColumns>0?`repeat(${e.value.gridColumns}, 1fr)`:'repeat(auto-fill, minmax(110px, 1fr))');function x(t){e.value={...e.value,...t}}const y=(0,r.computed)(()=>{const t=e.value.buttonOrder,a=e.value.visibleButtons;return t.filter(e=>a.includes(e))}),w=(0,r.computed)(()=>{const t=e.value.visibleButtons,a=(e.value.buttonGroups||[]).map(e=>e.secondaryId).filter(Boolean);return c.filter(e=>!e.hidden&&!t.includes(e.id)&&!a.includes(e.id))}),k=(0,r.computed)(()=>w.value.length>0);const C=(0,r.computed)(()=>e.value.buttonGroups||[]),N=(0,r.computed)(()=>e.value.longPressDirectExec||!1);return{config:e,theme:t,fontFamily:a,fontFamilyValue:n,highlightColorObj:i,highlightManualColorObj:m,highlightAiColorObj:v,titleColorObj:b,gridColumnsCss:h,updateConfig:x,resetConfig:function(){e.value={...p}},setTheme:function(e){x({theme:e})},setFontFamily:function(e){x({fontFamily:e})},setLayout:function(e){x({layout:e})},setHighlightColor:function(e){x({highlightColor:e,highlightManualColor:e})},setHighlightManualColor:function(e){x({highlightManualColor:e,highlightColor:e})},setHighlightAiColor:function(e){x({highlightAiColor:e})},setTitleColor:function(e){x({titleColor:e})},toggleHighlightNew:function(){x({highlightNew:!e.value.highlightNew})},toggleCustomTitleColor:function(){x({customTitleColor:!e.value.customTitleColor})},toggleShowDashboard:function(){x({showDashboard:!e.value.showDashboard})},toggleShowPagination:function(){x({showPagination:!e.value.showPagination})},toggleLockPanel:function(){x({lockPanel:!e.value.lockPanel})},toggleLimitLongText:function(){x({limitLongText:!e.value.limitLongText})},setVisibleButtons:function(t){e.value.visibleButtons=t},setButtonOrder:function(t){e.value.buttonOrder=t},isButtonVisible:function(t){return e.value.visibleButtons.includes(t)},toggleButtonVisibility:function(t){const a=[...e.value.visibleButtons],o=a.indexOf(t);o>-1?a.splice(o,1):a.push(t),e.value.visibleButtons=a},sortedVisibleButtons:y,hiddenButtons:w,hasHiddenButtons:k,getButtonConfig:function(e){return c.find(t=>t.id===e)},buttonGroups:C,longPressDirectExec:N,setButtonGroups:function(t){e.value.buttonGroups=t},addButtonGroup:function(t,a){const o=(e.value.buttonGroups||[]).filter(e=>e.secondaryId!==a&&e.primaryId!==t);o.push({primaryId:t,secondaryId:a}),e.value.buttonGroups=[...o],console.log('[ACU] addButtonGroup:',t,'->',a,'groups:',e.value.buttonGroups)},removeButtonGroupSecondary:function(t){const a=(e.value.buttonGroups||[]).filter(e=>e.primaryId!==t);e.value.buttonGroups=[...a],console.log('[ACU] removeButtonGroupSecondary:',t,'groups:',e.value.buttonGroups)},getSecondaryButtonId:function(t){const a=(e.value.buttonGroups||[]).find(e=>e.primaryId===t);return a?.secondaryId||null},isSecondaryButton:function(t){return(e.value.buttonGroups||[]).some(e=>e.secondaryId===t)},toggleLongPressDirectExec:function(){e.value.longPressDirectExec=!e.value.longPressDirectExec},setLongPressDirectExec:function(t){e.value.longPressDirectExec=t},resetButtonConfig:function(){e.value.visibleButtons=[...s],e.value.buttonOrder=[...u],e.value.buttonGroups=[...d],e.value.longPressDirectExec=!1}}}),b=(0,n.defineStore)('acu-ball-appearance',()=>{const e=(0,r.ref)({...i}),t=(0,r.ref)([]),a=(0,r.ref)(!1);function o(){try{if('function'!=typeof getVariables||'function'!=typeof replaceVariables)return void console.warn('[ACU] å˜é‡ API ä¸å¯ç”¨');const a=getVariables({type:'global'}),o={...a[l]||{},configVersion:1,ballAppearance:e.value,customFonts:t.value};replaceVariables({...a,[l]:o},{type:'global'}),console.info('[ACU] å·²ä¿å­˜é…ç½®åˆ°å…¨å±€å˜é‡')}catch(e){console.error('[ACU] ä¿å­˜å…¨å±€å˜é‡å¤±è´¥:',e)}}(0,r.watch)([e,t],()=>{a.value&&o()},{deep:!0});const n=(0,r.computed)(()=>t.value.filter(e=>e.importUrl).map(e=>e.importUrl)),c=(0,r.computed)(()=>[...f,...t.value.map(e=>({id:e.id,name:e.name,val:e.fontFamily}))]);function s(e,t){const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!a)return e;return`rgba(${parseInt(a[1],16)}, ${parseInt(a[2],16)}, ${parseInt(a[3],16)}, ${t/100})`}const u=(0,r.computed)(()=>{const t=e.value;return{'--ball-size':`${t.size}px`,'--ball-border-color':t.borderColor,'--ball-border-color-rgba':s(t.borderColor,t.borderOpacity),'--ball-bg-color':s(t.bgColor,t.bgOpacity)}});return{appearance:e,customFonts:t,isLoaded:a,loadFromGlobalVariables:function(){try{if('function'!=typeof getVariables)return console.warn('[ACU] getVariables ä¸å¯ç”¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®'),void(a.value=!0);const o=getVariables({type:'global'})[l];o?.ballAppearance&&(e.value={...i,...o.ballAppearance}),o?.customFonts&&(t.value=o.customFonts),a.value=!0,console.info('[ACU] å·²ä»å…¨å±€å˜é‡åŠ è½½é…ç½®')}catch(e){console.error('[ACU] åŠ è½½å…¨å±€å˜é‡å¤±è´¥:',e),a.value=!0}},saveToGlobalVariables:o,updateAppearance:function(t){e.value={...e.value,...t}},setIcon:function(t,a){e.value.type=t,e.value.content=a},setSize:function(t){e.value.size=Math.max(40,Math.min(100,t))},setBorderColor:function(t,a){e.value.borderColor=t,void 0!==a&&(e.value.borderOpacity=a)},setBgColor:function(t,a){e.value.bgColor=t,void 0!==a&&(e.value.bgOpacity=a)},setNotifyAnimation:function(t){e.value.notifyAnimation=t},resetAppearance:function(){e.value={...i}},addFont:function(e){const a={...e,id:`custom_${Date.now()}`};return t.value.push(a),a},removeFont:function(e){const a=t.value.findIndex(t=>t.id===e);a>-1&&t.value.splice(a,1)},fontImportUrls:n,allFonts:c,cssVariables:u,hexToRgba:s}})},3981(e,t,a){a.d(t,{AHd:()=>E,MLh:()=>c,PMY:()=>C,X2F:()=>u,fOm:()=>V,iDZ:()=>m,niW:()=>S,rXt:()=>k,wYm:()=>N});var o=a(953),n=a(4061);const r=o.oc?window:void 0,l=(o.oc&&window.document,o.oc?window.navigator:void 0);o.oc&&window.location;function i(e){var t;const a=(0,n.toValue)(e);return null!=(t=null==a?void 0:a.$el)?t:a}function c(...e){const t=[],a=()=>{t.forEach(e=>e()),t.length=0},l=(0,n.computed)(()=>{const t=(0,o.$r)((0,n.toValue)(e[0])).filter(e=>null!=e);return t.every(e=>'string'!=typeof e)?t:void 0}),c=(0,o.T3)(()=>{var t,a;return[null!=(a=null==(t=l.value)?void 0:t.map(e=>i(e)))?a:[r].filter(e=>null!=e),(0,o.$r)((0,n.toValue)(l.value?e[1]:e[0])),(0,o.$r)((0,n.unref)(l.value?e[2]:e[1])),(0,n.toValue)(l.value?e[3]:e[2])]},([e,n,r,l])=>{if(a(),!(null==e?void 0:e.length)||!(null==n?void 0:n.length)||!(null==r?void 0:r.length))return;const i=(0,o.Gv)(l)?{...l}:l;t.push(...e.flatMap(e=>n.flatMap(t=>r.map(a=>((e,t,a,o)=>(e.addEventListener(t,a,o),()=>e.removeEventListener(t,a,o)))(e,t,a,i)))))},{flush:'post'});return(0,o.Uo)(a),()=>{c(),a()}}let s=!1;function u(e,t,a={}){const{window:l=r,ignore:u=[],capture:d=!0,detectIframe:p=!1,controls:m=!1}=a;if(!l)return m?{stop:o.lQ,cancel:o.lQ,trigger:o.lQ}:o.lQ;if(o.un&&!s){s=!0;const e={passive:!0};Array.from(l.document.body.children).forEach(t=>t.addEventListener('click',o.lQ,e)),l.document.documentElement.addEventListener('click',o.lQ,e)}let f=!0;const g=e=>(0,n.toValue)(u).some(t=>{if('string'==typeof t)return Array.from(l.document.querySelectorAll(t)).some(t=>t===e.target||e.composedPath().includes(t));{const a=i(t);return a&&(e.target===a||e.composedPath().includes(a))}});const v=a=>{const o=i(e);null!=a.target&&(o instanceof Element||!function(e){const t=(0,n.toValue)(e);return t&&16===t.$.subTree.shapeFlag}(e)||!function(e,t){const a=(0,n.toValue)(e),o=a.$.subTree&&a.$.subTree.children;return!(null==o||!Array.isArray(o))&&o.some(e=>e.el===t.target||t.composedPath().includes(e.el))}(e,a))&&o&&o!==a.target&&!a.composedPath().includes(o)&&('detail'in a&&0===a.detail&&(f=!g(a)),f?t(a):f=!0)};let b=!1;const h=[c(l,'click',e=>{b||(b=!0,setTimeout(()=>{b=!1},0),v(e))},{passive:!0,capture:d}),c(l,'pointerdown',t=>{const a=i(e);f=!g(t)&&!(!a||t.composedPath().includes(a))},{passive:!0}),p&&c(l,'blur',a=>{setTimeout(()=>{var o;const n=i(e);'IFRAME'!==(null==(o=l.document.activeElement)?void 0:o.tagName)||(null==n?void 0:n.contains(l.document.activeElement))||t(a)},0)},{passive:!0})].filter(Boolean),x=()=>h.forEach(e=>e());return m?{stop:x,cancel:()=>{f=!1},trigger:e=>{f=!0,v(e),f=!1}}:x}function d(e){const t=function(){const e=(0,n.shallowRef)(!1),t=(0,n.getCurrentInstance)();return t&&(0,n.onMounted)(()=>{e.value=!0},t),e}();return(0,n.computed)(()=>(t.value,Boolean(e())))}Symbol('vueuse-ssr-width');function p(e,t={}){const{controls:a=!1,navigator:r=l}=t,i=d(()=>r&&'permissions'in r),s=(0,n.shallowRef)(),u='string'==typeof e?{name:e}:e,p=(0,n.shallowRef)(),m=()=>{var e,t;p.value=null!=(t=null==(e=s.value)?void 0:e.state)?t:'prompt'};c(s,'change',m,{passive:!0});const f=(0,o.Jv)(async()=>{if(i.value){if(!s.value)try{s.value=await r.permissions.query(u)}catch(e){s.value=void 0}finally{m()}return a?(0,n.toRaw)(s.value):void 0}});return f(),a?{state:p,isSupported:i,query:f}:p}function m(e={}){const{navigator:t=l,read:a=!1,source:r,copiedDuring:i=1500,legacy:s=!1}=e,u=d(()=>t&&'clipboard'in t),m=p('clipboard-read'),f=p('clipboard-write'),g=(0,n.computed)(()=>u.value||s),v=(0,n.shallowRef)(''),b=(0,n.shallowRef)(!1),h=(0,o.TO)(()=>b.value=!1,i,{immediate:!1});function x(e){return'granted'===e||'prompt'===e}return g.value&&a&&c(['copy','cut'],async function(){let e=!(u.value&&x(m.value));if(!e)try{v.value=await t.clipboard.readText()}catch(t){e=!0}var a,o,n;e&&(v.value=null!=(n=null==(o=null==(a=null==document?void 0:document.getSelection)?void 0:a.call(document))?void 0:o.toString())?n:'')},{passive:!0}),{isSupported:g,text:v,copied:b,copy:async function(e=(0,n.toValue)(r)){if(g.value&&null!=e){let a=!(u.value&&x(f.value));if(!a)try{await t.clipboard.writeText(e)}catch(e){a=!0}a&&function(e){const t=document.createElement('textarea');t.value=null!=e?e:'',t.style.position='absolute',t.style.opacity='0',document.body.appendChild(t),t.select(),document.execCommand('copy'),t.remove()}(e),v.value=e,b.value=!0,h.start()}}}}const f='undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof self?self:{},g='__vueuse_ssr_handlers__',v=b();function b(){return g in f||(f[g]=f[g]||{}),f[g]}function h(e,t){return v[e]||t}function x(e){return null==e?'any':e instanceof Set?'set':e instanceof Map?'map':e instanceof Date?'date':'boolean'==typeof e?'boolean':'string'==typeof e?'string':'object'==typeof e?'object':Number.isNaN(e)?'any':'number'}const y={boolean:{read:e=>'true'===e,write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},w='vueuse-storage';function k(e,t,a,l={}){var i;const{flush:s='pre',deep:u=!0,listenToStorageChanges:d=!0,writeDefaults:p=!0,mergeDefaults:m=!1,shallow:f,window:g=r,eventFilter:v,onError:b=e=>{console.error(e)},initOnMounted:k}=l,C=(f?n.shallowRef:n.ref)('function'==typeof t?t():t),N=(0,n.computed)(()=>(0,n.toValue)(e));if(!a)try{a=h('getDefaultStorage',()=>{var e;return null==(e=r)?void 0:e.localStorage})()}catch(e){b(e)}if(!a)return C;const V=(0,n.toValue)(t),E=x(V),B=null!=(i=l.serializer)?i:y[E],{pause:S,resume:T}=(0,o.Hr)(C,e=>function(e){try{const t=a.getItem(N.value);if(null==e)I(t,null),a.removeItem(N.value);else{const o=B.write(e);t!==o&&(a.setItem(N.value,o),I(t,o))}}catch(e){b(e)}}(e),{flush:s,deep:u,eventFilter:v});(0,n.watch)(N,()=>M(),{flush:s});let D=!1;const A=e=>{k&&!D||M(e.detail)};function I(e,t){if(g){const o={key:N.value,oldValue:e,newValue:t,storageArea:a};g.dispatchEvent(a instanceof Storage?new StorageEvent('storage',o):new CustomEvent(w,{detail:o}))}}function M(e){if(!e||e.storageArea===a)if(e&&null==e.key)C.value=V;else if(!e||e.key===N.value){S();try{const t=B.write(C.value);void 0!==e&&(null==e?void 0:e.newValue)===t||(C.value=function(e){const t=e?e.newValue:a.getItem(N.value);if(null==t)return p&&null!=V&&a.setItem(N.value,B.write(V)),V;if(!e&&m){const e=B.read(t);return'function'==typeof m?m(e,V):'object'!==E||Array.isArray(e)?e:{...V,...e}}return'string'!=typeof t?t:B.read(t)}(e))}catch(e){b(e)}finally{e?(0,n.nextTick)(T):T()}}}return g&&d&&(a instanceof Storage?c(g,'storage',e=>{k&&!D||M(e)},{passive:!0}):c(g,w,A)),k?(0,o.rd)(()=>{D=!0,M()}):M(),C}function C(e,t={}){var a;const{pointerTypes:l,preventDefault:i,stopPropagation:s,exact:u,onMove:d,onEnd:p,onStart:m,initialValue:f,axis:g='both',draggingElement:v=r,containerElement:b,handle:h=e,buttons:x=[0]}=t,y=(0,n.ref)(null!=(a=(0,n.toValue)(f))?a:{x:0,y:0}),w=(0,n.ref)(),k=e=>!l||l.includes(e.pointerType),C=e=>{(0,n.toValue)(i)&&e.preventDefault(),(0,n.toValue)(s)&&e.stopPropagation()},N=a=>{var o;if(!(0,n.toValue)(x).includes(a.button))return;if((0,n.toValue)(t.disabled)||!k(a))return;if((0,n.toValue)(u)&&a.target!==(0,n.toValue)(e))return;const r=(0,n.toValue)(b),l=null==(o=null==r?void 0:r.getBoundingClientRect)?void 0:o.call(r),i=(0,n.toValue)(e).getBoundingClientRect(),c={x:a.clientX-(r?i.left-l.left+r.scrollLeft:i.left),y:a.clientY-(r?i.top-l.top+r.scrollTop:i.top)};!1!==(null==m?void 0:m(c,a))&&(w.value=c,C(a))},V=a=>{if((0,n.toValue)(t.disabled)||!k(a))return;if(!w.value)return;const o=(0,n.toValue)(b),r=(0,n.toValue)(e).getBoundingClientRect();let{x:l,y:i}=y.value;'x'!==g&&'both'!==g||(l=a.clientX-w.value.x,o&&(l=Math.min(Math.max(0,l),o.scrollWidth-r.width))),'y'!==g&&'both'!==g||(i=a.clientY-w.value.y,o&&(i=Math.min(Math.max(0,i),o.scrollHeight-r.height))),y.value={x:l,y:i},null==d||d(y.value,a),C(a)},E=e=>{!(0,n.toValue)(t.disabled)&&k(e)&&w.value&&(w.value=void 0,null==p||p(y.value,e),C(e))};if(o.oc){const e=()=>{var e;return{capture:null==(e=t.capture)||e,passive:!(0,n.toValue)(i)}};c(h,'pointerdown',N,e),c(v,'pointermove',V,e),c(v,'pointerup',E,e)}return{...(0,o.QW)(y),position:y,isDragging:(0,n.computed)(()=>!!w.value),style:(0,n.computed)(()=>`left:${y.value.x}px;top:${y.value.y}px;`)}}function N(e,t,a={}){const{window:l=r,...c}=a;let s;const u=d(()=>l&&'ResizeObserver'in l),p=()=>{s&&(s.disconnect(),s=void 0)},m=(0,n.computed)(()=>{const t=(0,n.toValue)(e);return Array.isArray(t)?t.map(e=>i(e)):[i(t)]}),f=(0,n.watch)(m,e=>{if(p(),u.value&&l){s=new ResizeObserver(t);for(const t of e)t&&s.observe(t,c)}},{immediate:!0,flush:'post'}),g=()=>{p(),f()};return(0,o.Uo)(g),{isSupported:u,stop:g}}function V(e={}){const{window:t=r}=e,a=(0,n.ref)(null),o=(0,n.computed)(()=>{var e,t;return null!=(t=null==(e=a.value)?void 0:e.toString())?t:''}),l=(0,n.computed)(()=>a.value?function(e){var t;const a=null!=(t=e.rangeCount)?t:0;return Array.from({length:a},(_,t)=>e.getRangeAt(t))}(a.value):[]),i=(0,n.computed)(()=>l.value.map(e=>e.getBoundingClientRect()));return t&&c(t.document,'selectionchange',function(){a.value=null,t&&(a.value=t.getSelection())},{passive:!0}),{text:o,rects:i,ranges:l,selection:a}}function E(e={}){var t,a;const{window:l=r}=e,i=(0,o.lW)(null==e?void 0:e.element),c=(0,o.lW)(null!=(t=null==e?void 0:e.input)?t:''),s=null!=(a=null==e?void 0:e.styleProp)?a:'height',u=(0,n.shallowRef)(1),d=(0,n.shallowRef)(0);function p(){var t;if(!i.value)return;let a='';i.value.style[s]='1px',u.value=null==(t=i.value)?void 0:t.scrollHeight;const o=(0,n.toValue)(null==e?void 0:e.styleTarget);o?o.style[s]=`${u.value}px`:a=`${u.value}px`,i.value.style[s]=a}return(0,n.watch)([c,i],()=>(0,n.nextTick)(p),{immediate:!0}),(0,n.watch)(u,()=>{var t;return null==(t=null==e?void 0:e.onResize)?void 0:t.call(e)}),N(i,([{contentRect:e}])=>{d.value!==e.width&&function(e=r,t){e&&'function'==typeof e.requestAnimationFrame?e.requestAnimationFrame(t):t()}(l,()=>{d.value=e.width,p()})}),(null==e?void 0:e.watch)&&(0,n.watch)(e.watch,p,{immediate:!0,deep:!0}),{textarea:i,input:c,triggerResize:p}}Number.POSITIVE_INFINITY;const B={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};o.D_;function S(e,t){const{containerStyle:a,wrapperProps:o,scrollTo:r,calculateRange:l,currentList:i,containerRef:c}='itemHeight'in t?function(e,t){const a=T(t),{state:o,source:r,currentList:l,size:i,containerRef:c}=a,s={overflowY:'auto'},{itemHeight:u,overscan:d=5}=e,p=D(o,r,u),m=A(r,u),f=I('vertical',d,m,p,a),g=M(u,r),v=(0,n.computed)(()=>g(o.value.start)),b=L(u,r);U(i,t,c,f);const h=F('vertical',f,g,c),x=(0,n.computed)(()=>({style:{width:'100%',height:b.value-v.value+'px',marginTop:`${v.value}px`}}));return{calculateRange:f,scrollTo:h,containerStyle:s,wrapperProps:x,currentList:l,containerRef:c}}(t,e):function(e,t){const a=T(t),{state:o,source:r,currentList:l,size:i,containerRef:c}=a,s={overflowX:'auto'},{itemWidth:u,overscan:d=5}=e,p=D(o,r,u),m=A(r,u),f=I('horizontal',d,m,p,a),g=M(u,r),v=(0,n.computed)(()=>g(o.value.start)),b=L(u,r);U(i,t,c,f);const h=F('horizontal',f,g,c),x=(0,n.computed)(()=>({style:{height:'100%',width:b.value-v.value+'px',marginLeft:`${v.value}px`,display:'flex'}}));return{scrollTo:h,calculateRange:f,wrapperProps:x,containerStyle:s,currentList:l,containerRef:c}}(t,e);return{list:i,scrollTo:r,containerProps:{ref:c,onScroll:()=>{l()},style:a},wrapperProps:o}}function T(e){const t=(0,n.shallowRef)(null),a=function(e,t={width:0,height:0},a={}){const{window:l=r,box:c='content-box'}=a,s=(0,n.computed)(()=>{var t,a;return null==(a=null==(t=i(e))?void 0:t.namespaceURI)?void 0:a.includes('svg')}),u=(0,n.shallowRef)(t.width),d=(0,n.shallowRef)(t.height),{stop:p}=N(e,([t])=>{const a='border-box'===c?t.borderBoxSize:'content-box'===c?t.contentBoxSize:t.devicePixelContentBoxSize;if(l&&s.value){const t=i(e);if(t){const e=t.getBoundingClientRect();u.value=e.width,d.value=e.height}}else if(a){const e=(0,o.$r)(a);u.value=e.reduce((e,{inlineSize:t})=>e+t,0),d.value=e.reduce((e,{blockSize:t})=>e+t,0)}else u.value=t.contentRect.width,d.value=t.contentRect.height},a);(0,o.rd)(()=>{const a=i(e);a&&(u.value='offsetWidth'in a?a.offsetWidth:t.width,d.value='offsetHeight'in a?a.offsetHeight:t.height)});const m=(0,n.watch)(()=>i(e),e=>{u.value=e?t.width:0,d.value=e?t.height:0});return{width:u,height:d,stop:function(){p(),m()}}}(t),l=(0,n.ref)([]),c=(0,n.shallowRef)(e);return{state:(0,n.ref)({start:0,end:10}),source:c,currentList:l,size:a,containerRef:t}}function D(e,t,a){return o=>{if('number'==typeof a)return Math.ceil(o/a);const{start:n=0}=e.value;let r=0,l=0;for(let e=n;e<t.value.length;e++){if(r+=a(e),l=e,r>o)break}return l-n}}function A(e,t){return a=>{if('number'==typeof t)return Math.floor(a/t)+1;let o=0,n=0;for(let r=0;r<e.value.length;r++){if(o+=t(r),o>=a){n=r;break}}return n+1}}function I(e,t,a,o,{containerRef:n,state:r,currentList:l,source:i}){return()=>{const c=n.value;if(c){const n=a('vertical'===e?c.scrollTop:c.scrollLeft),s=o('vertical'===e?c.clientHeight:c.clientWidth),u=n-t,d=n+s+t;r.value={start:u<0?0:u,end:d>i.value.length?i.value.length:d},l.value=i.value.slice(r.value.start,r.value.end).map((e,t)=>({data:e,index:t+r.value.start}))}}}function M(e,t){return a=>{if('number'==typeof e){return a*e}return t.value.slice(0,a).reduce((t,_,a)=>t+e(a),0)}}function U(e,t,a,o){(0,n.watch)([e.width,e.height,()=>(0,n.toValue)(t),a],()=>{o()})}function L(e,t){return(0,n.computed)(()=>'number'==typeof e?t.value.length*e:t.value.reduce((t,_,a)=>t+e(a),0))}const P={horizontal:'scrollLeft',vertical:'scrollTop'};function F(e,t,a,o){return n=>{o.value&&(o.value[P[e]]=a(n),t())}}},4015(e,a,o){e.exports=(e=>{var t={};return o.d(t,e),t})({klona:()=>t.klona})},4061(e){e.exports=Vue},4182(e,t,a){a.d(t,{DR:()=>n,JT:()=>s,Qo:()=>l,b3:()=>c,bT:()=>i,j7:()=>r,o6:()=>o});const o={enabled:!1,hasIndexedDBImage:!1,externalUrl:void 0,imageUrl:'',opacity:30,size:'cover',blur:0,offsetX:0,offsetY:0,scale:100},n={bgNav:'--acu-bg-nav',bgPanel:'--acu-bg-panel',cardBg:'--acu-card-bg',tableHead:'--acu-table-head',tableHover:'--acu-table-hover',badgeBg:'--acu-badge-bg',inputBg:'--acu-input-bg',menuBg:'--acu-menu-bg',overlayBg:'--acu-overlay-bg',textMain:'--acu-text-main',textSub:'--acu-text-sub',menuText:'--acu-menu-text',border:'--acu-border',btnBg:'--acu-btn-bg',btnHover:'--acu-btn-hover',btnActiveBg:'--acu-btn-active-bg',btnActiveText:'--acu-btn-active-text',shadow:'--acu-shadow'},r=[{id:'background',name:'èƒŒæ™¯è‰²',icon:'fa-fill-drip',vars:[{key:'bgNav',label:'å¯¼èˆªæ èƒŒæ™¯'},{key:'bgPanel',label:'é¢æ¿èƒŒæ™¯'},{key:'cardBg',label:'å¡ç‰‡èƒŒæ™¯'},{key:'tableHead',label:'è¡¨å¤´èƒŒæ™¯'},{key:'tableHover',label:'æ‚¬æµ®èƒŒæ™¯'},{key:'badgeBg',label:'å¾½ç« èƒŒæ™¯'},{key:'inputBg',label:'è¾“å…¥æ¡†èƒŒæ™¯'},{key:'menuBg',label:'èœå•èƒŒæ™¯'},{key:'overlayBg',label:'é®ç½©èƒŒæ™¯'}]},{id:'text',name:'æ–‡æœ¬è‰²',icon:'fa-font',vars:[{key:'textMain',label:'ä¸»æ–‡æœ¬è‰²'},{key:'textSub',label:'æ¬¡è¦æ–‡æœ¬è‰²'},{key:'menuText',label:'èœå•æ–‡æœ¬è‰²'}]},{id:'button',name:'è¾¹æ¡†ä¸æŒ‰é’®',icon:'fa-square',vars:[{key:'border',label:'è¾¹æ¡†è‰²'},{key:'btnBg',label:'æŒ‰é’®èƒŒæ™¯'},{key:'btnHover',label:'æŒ‰é’®æ‚¬æµ®'},{key:'btnActiveBg',label:'æŒ‰é’®æ¿€æ´»èƒŒæ™¯'},{key:'btnActiveText',label:'æŒ‰é’®æ¿€æ´»æ–‡æœ¬'}]},{id:'effect',name:'æ•ˆæœ',icon:'fa-magic',vars:[{key:'shadow',label:'é˜´å½±è‰²'}]}],l=[{value:'list',label:'æ™®é€šåˆ—è¡¨'},{value:'grid',label:'æ™®é€šç½‘æ ¼'},{value:'global',label:'å…¨å±€çŠ¶æ€'},{value:'interaction',label:'äº¤äº’è¡¨'}],i={goToTable:{id:'goToTable',icon:'fa-external-link-alt',label:'è·³è½¬',tooltip:'è·³è½¬åˆ°è¡¨æ ¼'},clear:{id:'clear',icon:'fa-eraser',label:'æ¸…é™¤',tooltip:'æ¸…é™¤è¡¨æ ¼æ•°æ®'},undo:{id:'undo',icon:'fa-undo',label:'æ’¤å›',tooltip:'æ’¤å›ä¸Šæ¬¡ä¿®æ”¹'},manualUpdate:{id:'manualUpdate',icon:'fa-hand-sparkles',label:'æ›´æ–°',tooltip:'æ‰‹åŠ¨æ›´æ–°'},relationshipGraph:{id:'relationshipGraph',icon:'fa-project-diagram',label:'å…³ç³»å›¾',tooltip:'äººç‰©å…³ç³»å›¾'},settings:{id:'settings',icon:'fa-cog',label:'è®¾ç½®',tooltip:'çœ‹æ¿è®¾ç½®'},nativeEdit:{id:'nativeEdit',icon:'fa-external-link-alt',label:'åŸç”Ÿç¼–è¾‘å™¨',tooltip:'æ‰“å¼€åŸç”Ÿç¼–è¾‘å™¨'},divination:{id:'divination',icon:'fa-dice',label:'æŠ½ç­¾',tooltip:'èµ›åšç®—å¦ - æ³¨å…¥éšè—æç¤ºè¯'},console:{id:'console',icon:'fa-solid fa-clapperboard',label:'å¯¼æ¼”æ§åˆ¶å°',tooltip:'æ‰“å¼€å¯¼æ¼”æ§åˆ¶å°'},quickReroll:{id:'quickReroll',icon:'fa-dice',secondaryIcon:'fa-redo-alt',label:'å¿«æ·é‡æŠ½',tooltip:'æŠ½ç­¾å¹¶æ›¿æ¢æœ€åä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ä¸­çš„å‰§æƒ…å…ƒæŒ‡ä»¤'}},c={task:{type:'table',title:'ä»»åŠ¡',icon:'fa-tasks',displayColumns:['åç§°','ä»»åŠ¡å','name','Name','ç±»å‹','çŠ¶æ€'],maxRows:5,actions:['goToTable'],colSpan:1,displayStyle:'list'},item:{type:'table',title:'ç‰©å“',icon:'fa-box-open',displayColumns:['åç§°','ç‰©å“å','name','Name','æ•°é‡'],maxRows:12,actions:['goToTable','clear'],colSpan:1,displayStyle:'grid'},character:{type:'table',title:'ä¸»è§’',icon:'fa-user',displayColumns:[],maxRows:1,actions:['goToTable'],colSpan:2,displayStyle:'list'},location:{type:'table',title:'åœ°ç‚¹',icon:'fa-map-marker-alt',displayColumns:['åç§°','åœ°ç‚¹','name','Name','æè¿°'],maxRows:5,actions:['goToTable'],colSpan:1,displayStyle:'list'}},s={task:['ä»»åŠ¡','Task','task','Quest','quest','æ—¥ç¨‹'],item:['ç‰©å“','é“å…·','Item','item','èƒŒåŒ…','åº“å­˜','è£…å¤‡'],character:['ä¸»è§’','ç©å®¶','Player','player','protagonist'],location:['åœ°ç‚¹','ä½ç½®','Location','location','åœºæ™¯']}},4279(e,t,a){a.d(t,{EZ:()=>o});a(4061);const o=[{id:'superLucky',name:'ä¸­ï¼',weight:5,color:'#ffd700',prompt:'å¦‚æœ‰ç¥åŠ©ï¼Œæ— å¾€ä¸åˆ©ã€‚ç”šè‡³æœ‰æ„æƒ³ä¸åˆ°çš„æ”¶è·ã€‚'},{id:'lucky',name:'å¤§å‰',weight:15,color:'#fbc02d',prompt:'åˆå¿ƒåˆæ„ï¼Œé¡ºé£é¡ºæ°´ã€‚å†å¤§çš„é˜»ç¢ä¹Ÿèƒ½ä»¥å¥‡æ€ªçš„æ–¹å¼ä¸æ»‘è§£å†³ã€‚'},{id:'slightlyLucky',name:'æœ«å‰',weight:20,color:'#e6b000',prompt:'æœ‰æƒŠæ— é™©ã€‚å°½ç®¡ä¸€æ³¢ä¸‰æŠ˜ï¼Œç»“æœä¹Ÿå‹‰å¼ºè®©äººæ»¡æ„ã€‚'},{id:'neutral',name:'å¹³',weight:20,color:'#808080',prompt:'å®¢è§‚ä¸­ç«‹ã€‚ä¸¥æ ¼éµå¾ªä¸–ç•Œè§‚ä¸‹çš„ç°å®é€»è¾‘ï¼Œæˆè´¥å®Œå…¨å–å†³äºæ“ä½œçš„å¯è¡Œæ€§ã€‚'},{id:'slightlyUnlucky',name:'å°å‡¶',weight:20,color:'#ffa07a',prompt:'äº‹å€åŠŸåŠã€‚è™½ç„¶æ²¡æœ‰å½»åº•å¤±è´¥ï¼Œä½†å¿…é¡»ä»˜å‡ºé¢å¤–çš„ä»£ä»·æ‰èƒ½å‹‰å¼ºç»´æŒç°çŠ¶ã€‚'},{id:'unlucky',name:'å¤§å‡¶',weight:15,color:'#ff6347',prompt:'å¢¨è²å®šå¾‹ç”Ÿæ•ˆï¼šå¦‚æœäº‹æƒ…å¯èƒ½å˜ç³Ÿï¼Œå®ƒå°±å¿…é¡»å˜ç³Ÿã€‚'},{id:'superUnlucky',name:'ä¸ä¸­å˜...',weight:5,color:'#8b0000',prompt:'ç¾éš¾æ€§çš„è¿é”ååº”ã€‚æœ€åçš„æƒ…å†µä¸ä»…å‘ç”Ÿäº†ï¼Œè¿˜ä¼šå¼•å‘æ›´å¤šçš„ç¾éš¾ã€‚'}]},4424(e,t,a){function o(e,t){for(var a=[],o={},n=0;n<t.length;n++){var r=t[n],l=r[0],i={id:e+':'+n,css:r[1],media:r[2],sourceMap:r[3]};o[l]?o[l].parts.push(i):a.push(o[l]={id:l,parts:[i]})}return a}a.d(t,{A:()=>f});var n='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!n)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var r={},l=n&&(document.head||document.getElementsByTagName('head')[0]),i=null,c=0,s=!1,u=function(){},d=null,p='data-vue-ssr-id',m='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,a,n){s=a,d=n||{};var l=o(e,t);return g(l),function(t){for(var a=[],n=0;n<l.length;n++){var i=l[n];(c=r[i.id]).refs--,a.push(c)}t?g(l=o(e,t)):l=[];for(n=0;n<a.length;n++){var c;if(0===(c=a[n]).refs){for(var s=0;s<c.parts.length;s++)c.parts[s]();delete r[c.id]}}}}function g(e){for(var t=0;t<e.length;t++){var a=e[t],o=r[a.id];if(o){o.refs++;for(var n=0;n<o.parts.length;n++)o.parts[n](a.parts[n]);for(;n<a.parts.length;n++)o.parts.push(b(a.parts[n]));o.parts.length>a.parts.length&&(o.parts.length=a.parts.length)}else{var l=[];for(n=0;n<a.parts.length;n++)l.push(b(a.parts[n]));r[a.id]={id:a.id,refs:1,parts:l}}}}function v(){var e=document.createElement('style');return e.type='text/css',l.appendChild(e),e}function b(e){var t,a,o=document.querySelector('style['+p+'~="'+e.id+'"]');if(o){if(s)return u;o.parentNode.removeChild(o)}if(m){var n=c++;o=i||(i=v()),t=y.bind(null,o,n,!1),a=y.bind(null,o,n,!0)}else o=v(),t=w.bind(null,o),a=function(){o.parentNode.removeChild(o)};return t(e),function(o){if(o){if(o.css===e.css&&o.media===e.media&&o.sourceMap===e.sourceMap)return;t(e=o)}else a()}}var h,x=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join('\n')});function y(e,t,a,o){var n=a?'':o.css;if(e.styleSheet)e.styleSheet.cssText=x(t,n);else{var r=document.createTextNode(n),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(r,l[t]):e.appendChild(r)}}function w(e,t){var a=t.css,o=t.media,n=t.sourceMap;if(o&&e.setAttribute('media',o),d.ssrId&&e.setAttribute(p,t.id),n&&(a+='\n/*# sourceURL='+n.sources[0]+' */',a+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+' */'),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},4493(e,t,a){var o=a(1107);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('782b601f',o,!1,{ssrId:!0})},4503(e,t,a){var o=a(9149);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('1d8c4adf',o,!1,{ssrId:!0})},4919(e,t,a){a.d(t,{E:()=>f});var o=a(3035),n=a(4061),r=a(4279),l=a(1699),i=a(1768),c=a(8889);const s='ACU_Divination',u={id:'luck',name:'è¿åŠ¿',enabled:!0,tiers:r.EZ},d={id:'sanity',name:'æ‰­æ›²åº¦',enabled:!1,tiers:[{id:'normal',name:'æ­£å¸¸é€»è¾‘',weight:50,prompt:''},{id:'absurd',name:'â€œå¤©ç„¶åˆç†â€',weight:50,prompt:'ç‰¹åˆ«è¦æ±‚ï¼šè‹¥éœ€è¦èåˆéæ—¥å¸¸è¦ç´ ï¼Œåœºæ™¯ä¸­çš„æ‰€æœ‰è§’è‰²å¿…é¡»å°†å…¶è§†ä¸ºæ—¥å¸¸ç”Ÿæ´»ä¸­ç†æ‰€å½“ç„¶çš„ä¸€éƒ¨åˆ†ï¼Œç»ä¸è¦æœ‰ç‰¹æ®Šååº”ã€‚'}]},p={id:'misunderstanding',name:'è¯¯ä¼šæœºåˆ¶',enabled:!1,tiers:[{id:'semantic',name:'è¯­ä¹‰æ­§ä¹‰',weight:1,prompt:'è¯·è®¾è®¡ä¸€æ®µå¯¹è¯ï¼Œè®©è§’è‰²Aåœ¨è°ˆè®ºæŸç‰©å“æˆ–äº‹ä»¶æ—¶çœç•¥å…³é”®ä¸»è¯­ï¼Œå¯¼è‡´è§’è‰²Bè¯¯ä¼šè°ˆè®ºå¯¹è±¡ï¼Œäº§ç”Ÿé”™è¯¯è”æƒ³è€Œå¯¼è‡´çš„è¯¯ä¼šã€‚'},{id:'projection',name:'é¢„è®¾åè§',weight:1,prompt:'è¯·åŸºäºè§’è‰²Bå½“å‰çš„å¿ƒç†é˜´å½±æˆ–ç§˜å¯†ï¼ˆå¦‚è‡ªå‘ã€æ„§ç–šã€æš—æ‹ï¼‰ï¼Œå¼ºè¡Œå°†è§’è‰²Açš„ä¸€ä¸ªå–„æ„æˆ–æ— å¿ƒçš„ä¸¾åŠ¨ï¼Œè§£è¯»ä¸ºè´Ÿé¢ï¼Œä»è€Œäº§ç”Ÿä½è½æƒ…ç»ªã€‚'},{id:'fragment',name:'æ–­ç« å–ä¹‰',weight:1,prompt:'è¯·æ„å»ºä¸€ä¸ªåœºæ™¯ï¼Œå®‰æ’è§’è‰²Båœ¨â€˜æœ€å®¹æ˜“å¼•èµ·è¯¯è§£çš„æ—¶é—´ç‚¹â€™é—¯å…¥æˆ–è·¯è¿‡ï¼Œåªç›®å‡»åˆ°äº‹ä»¶çš„â€˜ç»“æœâ€™è€Œå®Œå…¨é”™è¿‡äº†â€˜èµ·å› â€™ï¼Œå¯¼è‡´Bé€šè¿‡é€»è¾‘è¡¥å…¨æ¨å¯¼å‡ºåå·®è®¤çŸ¥ã€‚'},{id:'jargon',name:'ç”µæ³¢æ¥é”™',weight:1,prompt:'è¯·è®©è§’è‰²Aä½¿ç”¨æ„æœ‰æ‰€æŒ‡çš„è¯ã€åœˆå­é»‘è¯æˆ–ç½‘ç»œæ¢—è¿›è¡Œè¡¨è¾¾ï¼Œè€Œè§’è‰²Bå®Œå…¨æŒ‰å­—é¢æ„æ€ç†è§£ï¼Œäº§ç”Ÿæœ‰è¶£æˆ–ä¸¥è‚ƒçš„æŒç»­æ€§è¯¯ä¼šã€‚'}]},m={enabled:!0,drawCount:4,enableBias:!0,autoSync:!0,cardBackImage:'',themeColor:'#6b4c9a',themeId:'wafuku',flipMode:'auto',peepMode:!1,dimensions:[u,d,p],customTemplate:'',enableWordDrawing:!0,enableTableWords:!0,enableWordPool:!1,wordDrawMode:'perItem',wordsPerItem:1,tableColumnConfig:void 0,tablePoolConfig:{},categoryConfig:{},tableSyncConfig:{}},f=(0,o.defineStore)('acu-divination',()=>{const e=(0,n.ref)({...m}),t=(0,n.ref)([]),a=(0,n.ref)(!1),o=(0,n.ref)([]),r=(0,n.ref)(null);function f(){try{if('function'!=typeof getVariables||'function'!=typeof replaceVariables)return;const t={...getVariables({type:'global'}),divinationConfig:e.value,divinationPresets:o.value,activeDivinationPresetId:r.value};replaceVariables(t,{type:'global'}),console.info('[Divination] Config saved to global variables')}catch(e){console.error('[Divination] Failed to save config:',e)}}function g(t){const a={id:`preset_${Date.now()}`,name:t,createdAt:(new Date).toISOString(),dimensions:JSON.parse(JSON.stringify(e.value.dimensions))};return o.value.push(a),r.value=a.id,a}function v(e){const t=e.split('|'),a=t[0];let o='neutral',n=0;if(t.length>1){const e=t[1];o='æ­£'===e||'positive'===e?'positive':'è´Ÿ'===e||'negative'===e?'negative':'neutral'}return t.length>2&&(n=parseInt(t[2],10)||0),{name:a,bias:o,limit:n}}async function b(){try{if('function'!=typeof getWorldbook)return void console.warn('[Divination] getWorldbook API unavailable');await(getWorldbookNames?.());const e=await getWorldbook(s);t.value=e.map(e=>{const{name:t,bias:a,limit:o}=v(e.name),n=e.content.split('\n').map(e=>e.trim()).filter(e=>e);return{id:e.uid,name:t,bias:a,limit:o,path:[...e.strategy.keys,t],words:n,enabled:e.enabled,rawEntry:e}}),console.info(`[Divination] Loaded ${t.value.length} categories from worldbook`)}catch(e){console.warn('[Divination] Failed to load worldbook (it might not exist yet):',e),t.value=[]}}function h(e,t){if(0===e.length||e.length!==t.length)return null;const a=t.reduce((e,t)=>e+t,0);let o=Math.random()*a;for(let a=0;a<e.length;a++)if(o-=t[a],o<=0)return e[a];return e[e.length-1]}return(0,n.watch)([e,o,r],()=>{a.value&&f()},{deep:!0}),{config:e,categories:t,isLoaded:a,loadConfig:function(){try{if('function'!=typeof getVariables)return console.warn('[Divination] getVariables API unavailable'),void(a.value=!0);const t=getVariables({type:'global'});t&&(t.divinationPresets&&(o.value=t.divinationPresets),t.activeDivinationPresetId&&(r.value=t.activeDivinationPresetId),t.divinationConfig&&(e.value={...m,...t.divinationConfig,dimensions:t.divinationConfig.dimensions||m.dimensions,tablePoolConfig:t.divinationConfig.tablePoolConfig||{},tableSyncConfig:t.divinationConfig.tableSyncConfig||{}},t.divinationConfig.tableColumnConfig&&Object.keys(t.divinationConfig.tableColumnConfig).length>0&&0===Object.keys(e.value.tablePoolConfig).length&&(e.value.tablePoolConfig={...t.divinationConfig.tableColumnConfig},e.value.tableColumnConfig=void 0,console.info('[Divination] Migrated tableColumnConfig â†’ tablePoolConfig')),console.info('[Divination] Config loaded from global variables'))),a.value=!0}catch(e){console.error('[Divination] Failed to load config:',e),a.value=!0}},saveConfig:f,loadFromWorldbook:b,syncFromACU:async function(){console.info('[Divination] Starting sync from ACU...');try{const t=(0,i.tu)();if(!t)return void console.warn('[Divination] No ACU table data found');const a=[],o=e.value.tableSyncConfig||{};for(const e in t){const n=t[e];if(n.name&&(n.name.includes('Random')||n.name.includes('éšæœº'))){const t=n.id||e;if(!1===o[t]){console.info(`[Divination] Table ${n.name} (${t}) sync disabled by config`);continue}a.push(n)}}if(0===a.length)return void console.info('[Divination] No tables found to sync (or all disabled)');const n=new Map;for(const e of a){const t=e.content?.[0]||[],a=e.content?.slice(1)||[],o=e.name||'Random';t.forEach((e,t)=>{const r=String(e).trim();if(!r)return;const l=/^(åˆ—\d+|Column\s*\d+|Col\s*\d+|[A-Z])$/i.test(r)?o:r;let{name:i,bias:c,limit:s}=v(l);-1===r.indexOf('|')&&(i.includes('å‰')||i.includes('å¥½')||i.includes('æ­£')||i.includes('èµ')?c='positive':(i.includes('å‡¶')||i.includes('å')||i.includes('è´Ÿ')||i.includes('ç½š'))&&(c='negative'));const u=`${i}|${c}|${s}`;if(n.has(u)){const e=n.get(u);e.keys.includes(o)||e.keys.push(o)}else n.set(u,{name:i,bias:c,limit:s,words:new Set,keys:[o]});a.forEach(e=>{const a=e[t];if(a){const e=String(a).trim();e&&n.get(u).words.add(e)}})})}let r=[];try{r=await getWorldbook(s)}catch{}const l=[];for(const[e,t]of n){const e=`${t.name}|${t.bias}|${t.limit}`,a=r.find(t=>t.name===e),o=a?a.content.split('\n').map(e=>e.trim()).filter(e=>e):[],n=new Set([...o,...t.words]),i=Array.from(n).join('\n');if(a){const e=a.strategy?.keys||[],o=Array.from(new Set([...e,...t.keys]));l.push({...a,content:i,strategy:{...a.strategy,keys:o}})}else l.push({name:e,enabled:!0,strategy:{type:'constant',keys:t.keys,keys_secondary:{logic:'not_all',keys:[]},scan_depth:'same_as_global'},position:{type:'before_character_definition',role:'system',depth:0,order:0},content:i,probability:100,recursion:{prevent_incoming:!1,prevent_outgoing:!1,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}})}const c=new Set(l.map(e=>e.name)),u=r.filter(e=>!c.has(e.name));l.push(...u),'function'==typeof createOrReplaceWorldbook?(await createOrReplaceWorldbook(s,l,{render:'debounced'}),console.info('[Divination] Synced to worldbook successfully'),await b()):console.warn('[Divination] createOrReplaceWorldbook API unavailable')}catch(e){console.error('[Divination] Sync failed:',e)}},performDivination:function(){const a=[];let o=null;for(const t of e.value.dimensions)if(t.enabled&&t.tiers.length>0){const e=t.tiers.map(e=>e.weight),n=h(t.tiers,e);n&&(a.push({dimension:t,tier:n}),'luck'===t.id&&(o=n))}let n=[];if(e.value.enableTableWords){const t=(0,l.KX)(e.value.wordDrawMode,e.value.wordsPerItem,e.value.drawCount,e.value.tablePoolConfig);n.push(...t),console.info(`[Divination] ä»è¡¨æ ¼æŠ½è¯ï¼Œæ¨¡å¼: ${e.value.wordDrawMode}ï¼Œç»“æœ:`,t)}if(e.value.enableWordPool){const a='perItem'===e.value.wordDrawMode?e.value.wordsPerItem:Math.max(0,e.value.drawCount-n.length),r=function(t,a,o,n,r,i){const c=[],s=n.filter(e=>{const t=r[e.id];return(t?t.enabled:e.enabled)&&e.words.length>0});if(0===s.length)return c;if('perItem'===t){for(const e of s){const t=Math.min(a,e.words.length),o=(0,l.R3)([...e.words]);c.push(...o.slice(0,t))}console.info(`[Divination] perItem æ¨¡å¼ä»ä¸–ç•Œä¹¦æŠ½å– ${c.length} ä¸ªè¯:`,c)}else if('custom'===t){let e=o;for(const t of s){if(e<=0)break;const o=r[t.id],n=o?.limit??t.limit??0,i=n>0?Math.min(n,e):Math.min(a,e),s=Math.min(i,t.words.length),u=(0,l.R3)([...t.words]);c.push(...u.slice(0,s)),e-=s}console.info(`[Divination] custom æ¨¡å¼ä»ä¸–ç•Œä¹¦æŠ½å– ${c.length} ä¸ªè¯:`,c)}else{const t=s.map(t=>e.value.enableBias&&i?function(e,t){const a=e.id;return'superLucky'===a||'lucky'===a?'positive'===t?3:1:'slightlyLucky'===a?'positive'===t?2:1:'neutral'===a?1:'slightlyUnlucky'===a?'negative'===t||'neutral'===t?2:1:'unlucky'===a||'superUnlucky'===a?'negative'===t?3:'neutral'===t?2:1:1}(i,t.bias):1);let a=o;for(;a>0;){const e=h(s,t);if(!e)break;const o=e.words[Math.floor(Math.random()*e.words.length)];c.push(o),a--}console.info(`[Divination] mixed æ¨¡å¼ä»ä¸–ç•Œä¹¦æŠ½å– ${c.length} ä¸ªè¯:`,c)}return c}(e.value.wordDrawMode,e.value.wordsPerItem,a,t.value,e.value.categoryConfig,o);n.push(...r),console.info(`[Divination] ä»ä¸–ç•Œä¹¦æŠ½è¯ï¼Œæ¨¡å¼: ${e.value.wordDrawMode}ï¼Œç»“æœ:`,r)}e.value.enableTableWords&&e.value.enableWordPool&&n.length>0&&(n=(0,l.R3)(n),console.info('[Divination] æ··åˆæŠ½è¯åæ‰“ä¹±é¡ºåº:',n));const r=a.find(e=>'luck'===e.dimension.id),i=a.filter(e=>'luck'!==e.dimension.id).map(e=>({name:e.dimension.name,value:e.tier.name,prompt:e.tier.prompt}));return{luck:r?{name:r.tier.name,color:r.tier.color||'#808080',prompt:r.tier.prompt}:{name:'æœªçŸ¥',color:'#808080',prompt:''},dimensions:i,words:n,timestamp:Date.now()}},addDimension:function(t){e.value.dimensions.push(t)},updateDimension:function(t,a){t>=0&&t<e.value.dimensions.length&&(e.value.dimensions[t]=a)},removeDimension:function(t){if(t>=0&&t<e.value.dimensions.length){if('luck'===e.value.dimensions[t].id)return void console.warn('[Divination] Cannot remove luck dimension');e.value.dimensions.splice(t,1)}},uploadCardBack:async function(t){try{const a=await(0,c.bB)(t),o=await(0,c.w4)(a,1024,.9);e.value.cardBackImage=o,console.info('[Divination] Card back image uploaded')}catch(e){throw console.error('[Divination] Failed to upload card back:',e),e}},updateCategory:async function(e){try{const a=t.value.findIndex(t=>t.id===e.id);-1!==a&&(t.value[a]=e);let o=[];try{o=await getWorldbook(s)}catch{console.warn('[Divination] Worldbook not found, creating new...')}const n=o.findIndex(t=>t.uid===e.id),r=e.words.join('\n');if(-1===n)return void console.warn(`[Divination] Entry with uid ${e.id} not found in worldbook`);o[n]={...o[n],content:r,enabled:e.enabled},'function'==typeof createOrReplaceWorldbook&&(await createOrReplaceWorldbook(s,o,{render:'debounced'}),console.info('[Divination] Category updated in worldbook'))}catch(e){console.error('[Divination] Failed to update category:',e)}},presets:o,activePresetId:r,createPreset:g,saveCurrentToPreset:function(t){const a=o.value.findIndex(e=>e.name===t);if(a>-1){const t=o.value[a],n={...t,dimensions:JSON.parse(JSON.stringify(e.value.dimensions))};return o.value[a]=n,r.value=t.id,n}return g(t)},deletePreset:function(e){const t=o.value.findIndex(t=>t.id===e);t>-1&&(o.value.splice(t,1),r.value===e&&(r.value=null))},applyPreset:function(t){const a=o.value.find(e=>e.id===t);a&&(e.value.dimensions=JSON.parse(JSON.stringify(a.dimensions)),r.value=t)},restoreDefaultDimensions:function(){e.value.dimensions=[JSON.parse(JSON.stringify(u)),JSON.parse(JSON.stringify(d)),JSON.parse(JSON.stringify(p))],r.value=null},migrateDimensionsToPreset:function(e,t){const a=o.value.findIndex(e=>e.id===t);if(-1===a)return void console.warn('[Divination] Target preset not found:',t);const n=o.value[a];e.map(e=>JSON.parse(JSON.stringify(e))).forEach(e=>{const t=n.dimensions.findIndex(t=>t.id===e.id);t>-1?n.dimensions[t]=e:n.dimensions.push(e)}),o.value[a]={...n}}}})},5372(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'\n','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},5699(e){e.exports=function(e){var t=e[1],a=e[3];if(!a)return t;if('function'==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),n='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(o),r='/*# '.concat(n,' */');return[t].concat([r]).join('\n')}return[t].join('\n')}},5877(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'.template-settings-group[data-v-2a4c34ca]{padding:12px;display:flex;flex-direction:column;gap:12px}.template-shortcuts-row[data-v-2a4c34ca]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.template-shortcuts-row .hint[data-v-2a4c34ca]{font-size:12px;color:var(--acu-text-sub)}.acu-wildcard-btn[data-v-2a4c34ca]{background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:4px;padding:2px 6px;cursor:pointer;font-size:12px;color:var(--acu-title-color);transition:all 0.2s}.acu-wildcard-btn[data-v-2a4c34ca]:hover{background:var(--acu-btn-hover);border-color:var(--acu-title-color)}.acu-wildcard-btn code[data-v-2a4c34ca]{font-family:monospace}.template-textarea[data-v-2a4c34ca]{min-height:120px;resize:vertical;line-height:1.5;font-family:monospace;width:100%;pointer-events:auto !important}.acu-wildcard-help[data-v-2a4c34ca]{background:rgba(0,0,0,0.05);border-radius:8px;padding:8px 12px}.acu-help-header[data-v-2a4c34ca]{display:flex;align-items:center;gap:8px;cursor:pointer;font-size:12px;color:var(--acu-text-sub);-webkit-user-select:none;user-select:none}.acu-help-header strong[data-v-2a4c34ca]{flex:1}.acu-wildcard-help ul[data-v-2a4c34ca]{margin:8px 0 0 0;padding-left:20px;list-style-type:disc;font-size:12px;color:var(--acu-text-sub)}.acu-wildcard-help li[data-v-2a4c34ca]{margin-bottom:4px}.acu-wildcard-help code[data-v-2a4c34ca]{background:rgba(0,0,0,0.1);padding:0 4px;border-radius:3px;font-family:monospace;color:var(--acu-text-main)}\n','',{version:3,sources:['webpack://./src/å¯è§†åŒ–è¡¨æ ¼/components/settings/divination/DimensionManagerPanel.vue'],names:[],mappings:'AA+eA,0CACE,YAAa,CACb,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,yCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,cACF,CAEA,+CACE,cAAe,CACf,yBACF,CAEA,mCACE,8BAA+B,CAC/B,kCAAmC,CACnC,iBAAkB,CAClB,eAAgB,CAChB,cAAe,CACf,cAAe,CACf,4BAA6B,CAC7B,mBACF,CAEA,yCACE,+BAAgC,CAChC,mCACF,CAEA,wCACE,qBACF,CAEA,oCACE,gBAAiB,CACjB,eAAgB,CAChB,eAAgB,CAChB,qBAAsB,CACtB,UAAW,CACX,8BACF,CAEA,oCACE,2BAA+B,CAC/B,iBAAkB,CAClB,gBACF,CAEA,kCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,cAAe,CACf,cAAe,CACf,yBAA0B,CAC1B,wBAAiB,CAAjB,gBACF,CAEA,yCACE,MACF,CAEA,uCACE,gBAAiB,CACjB,iBAAkB,CAClB,oBAAqB,CACrB,cAAe,CACf,yBACF,CAEA,uCACE,iBACF,CAEA,yCACE,0BAA8B,CAC9B,aAAc,CACd,iBAAkB,CAClB,qBAAsB,CACtB,0BACF',sourcesContent:['<template>\n  <div class="acu-dimension-manager">\n    \x3c!-- é¢„è®¾ç®¡ç†å¤´éƒ¨ --\x3e\n    <PresetManagerHeader\n      :presets="divinationStore.presets"\n      :active-preset-id="divinationStore.activePresetId"\n      :show-toolbar="true"\n      :is-migrating="isMigrating"\n      :selected-count="selectedDimensionIds.size"\n      title="ç»´åº¦é¢„è®¾"\n      hint="ä¿å­˜å’ŒåŠ è½½ç»´åº¦é…ç½®"\n      @select="handleSelectPreset"\n      @restore-default="handleRestoreDefault"\n      @delete="handleDeletePreset"\n      @save="handleQuickSave"\n      @save-as="openSaveDialog"\n      @collapse-all="collapseAll"\n      @expand-all="expandAll"\n      @import="triggerImport"\n      @export-current="handleExportCurrentPreset"\n      @export-all="handleExportPresets"\n      @toggle-migrate="toggleMigrateMode"\n      @migrate-to="handleMigrateTo"\n    />\n\n    \x3c!-- ç»´åº¦åˆ—è¡¨ --\x3e\n    <div\n      v-for="(dim, dimIndex) in divinationStore.config.dimensions"\n      :key="dim.id"\n      class="acu-settings-section dimension-container"\n      :class="{\n        \'is-collapsed\': collapsedDimensions[dim.id],\n        \'is-selected\': isMigrating && selectedDimensionIds.has(dim.id),\n      }"\n      @click="isMigrating ? toggleDimensionSelection(dim.id) : null"\n    >\n      \x3c!-- ç»´åº¦æ ‡é¢˜è¡Œ --\x3e\n      <div class="acu-settings-title dimension-header" @click="!isMigrating && toggleCollapse(dim.id)">\n        <div class="header-left">\n          <i class="fas fa-chevron-right collapse-icon" :class="{ \'is-expanded\': !collapsedDimensions[dim.id] }"></i>\n          <input v-model="dim.name" class="acu-input-minimal dimension-name-input" placeholder="ç»´åº¦åç§°" @click.stop />\n        </div>\n        <div class="header-right">\n          <label class="acu-switch" @click.stop>\n            <input v-model="dim.enabled" type="checkbox" />\n            <span class="slider"></span>\n          </label>\n          <button\n            class="acu-icon-btn danger"\n            :disabled="dim.id === \'luck\'"\n            :title="dim.id === \'luck\' ? \'è¿åŠ¿ç»´åº¦ä¸å¯åˆ é™¤\' : \'åˆ é™¤ç»´åº¦\'"\n            @click.stop="handleRemoveDimension(dimIndex)"\n          >\n            <i class="fas fa-trash"></i>\n          </button>\n        </div>\n      </div>\n\n      \x3c!-- æ¡£ä½åˆ—è¡¨ (å±•å¼€åŒºåŸŸ) --\x3e\n      <div v-show="!collapsedDimensions[dim.id]" class="dimension-content">\n        <div class="tier-list">\n          <div v-for="(tier, tierIndex) in dim.tiers" :key="tier.id" class="tier-item">\n            \x3c!-- ç¬¬ä¸€è¡Œ: åŸºæœ¬ä¿¡æ¯ --\x3e\n            <div class="tier-row basic-info">\n              <div class="tier-name-wrapper">\n                <input v-model="tier.name" class="acu-input-minimal tier-name-input" placeholder="æ¡£ä½åç§°" />\n                \x3c!-- é¢œè‰²é€‰æ‹©å™¨ (ä»…è¿åŠ¿ç»´åº¦æ˜¾ç¤º) --\x3e\n                <input\n                  v-if="dim.id === \'luck\'"\n                  v-model="tier.color"\n                  type="color"\n                  class="acu-color-picker-mini"\n                  title="æ¡£ä½é¢œè‰²"\n                />\n              </div>\n              <button class="acu-icon-btn small danger" title="åˆ é™¤æ¡£ä½" @click="removeTier(dimIndex, tierIndex)">\n                <i class="fas fa-times"></i>\n              </button>\n            </div>\n\n            \x3c!-- ç¬¬äºŒè¡Œ: æƒé‡è°ƒèŠ‚ --\x3e\n            <div class="tier-row weight-control">\n              <span class="label">æƒé‡</span>\n              <input v-model.number="tier.weight" type="range" min="0" max="100" step="1" class="acu-range-input" />\n              <span class="acu-badge">{{ tier.weight }}</span>\n            </div>\n\n            \x3c!-- ç¬¬ä¸‰è¡Œ: æç¤ºè¯ --\x3e\n            <div class="tier-row prompt-editor">\n              <textarea\n                v-model="tier.prompt"\n                class="acu-textarea-scrollable compact"\n                placeholder="åœ¨æ­¤è¾“å…¥è¯¥æ¡£ä½çš„æç¤ºè¯..."\n                rows="2"\n              ></textarea>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- æ·»åŠ æ¡£ä½æŒ‰é’® --\x3e\n        <button class="acu-btn-dashed full-width" @click="addTier(dimIndex)">\n          <i class="fas fa-plus"></i> æ·»åŠ æ–°æ¡£ä½\n        </button>\n      </div>\n    </div>\n\n    \x3c!-- æ–°å»ºç»´åº¦æŒ‰é’® --\x3e\n    <button class="acu-btn-dashed full-width add-dimension-btn" @click="handleAddDimension">\n      <i class="fas fa-layer-group"></i> æ–°å»ºç»´åº¦\n    </button>\n\n    \x3c!-- é«˜çº§è®¾ç½®ï¼šè‡ªå®šä¹‰æ¨¡æ¿ --\x3e\n    <div class="acu-settings-section advanced-settings">\n      <div class="acu-settings-title">\n        <div class="header-left">\n          <i class="fas fa-file-alt"></i>\n          æç¤ºè¯æ¨¡æ¿\n        </div>\n      </div>\n      <div class="acu-settings-group template-settings-group">\n        \x3c!-- 1. å¿«æ·æŒ‰é’®è¡Œ --\x3e\n        <div class="template-shortcuts-row">\n          <span class="hint">å¿«æ·æ’å…¥:</span>\n          <button class="acu-wildcard-btn" @click="insertTemplatePlaceholder(\'{{luck}}\')">\n            <code>{{ \'\\{\\{luck\\}\\}\' }}</code>\n          </button>\n          <button class="acu-wildcard-btn" @click="insertTemplatePlaceholder(\'{{words}}\')">\n            <code>{{ \'\\{\\{words\\}\\}\' }}</code>\n          </button>\n          <button class="acu-wildcard-btn" @click="insertTemplatePlaceholder(\'{{dimensions}}\')">\n            <code>{{ \'\\{\\{dimensions\\}\\}\' }}</code>\n          </button>\n        </div>\n\n        \x3c!-- 2. æ–‡æœ¬æ¡†è¡Œ --\x3e\n        <div class="template-editor-row">\n          <textarea\n            ref="templateInputRef"\n            v-model="divinationStore.config.customTemplate"\n            class="acu-edit-textarea template-textarea"\n            placeholder="åœ¨æ­¤è¾“å…¥è‡ªå®šä¹‰æ¨¡æ¿..."\n            rows="6"\n          ></textarea>\n        </div>\n\n        \x3c!-- 3. è¯´æ˜è¡Œ --\x3e\n        <div class="template-help-row">\n          <div class="acu-wildcard-help">\n            <div class="acu-help-header" @click="toggleHelp">\n              <i class="fas fa-lightbulb"></i>\n              <strong>é€šé…ç¬¦è¯´æ˜</strong>\n              <i class="fas" :class="showHelp ? \'fa-chevron-up\' : \'fa-chevron-down\'"></i>\n            </div>\n            <ul v-show="showHelp">\n              <li>\n                <code>{{ \'\\{\\{luck\\}\\}\' }}</code> - è¿åŠ¿ç»“æœï¼ˆå¦‚ï¼šå¤§å‰...ï¼‰\n              </li>\n              <li>\n                <code>{{ \'\\{\\{words\\}\\}\' }}</code> - éšæœºè¯åˆ—è¡¨ï¼ˆå¦‚ï¼šè‹¹æœã€é¦™è•‰ï¼‰\n              </li>\n              <li>\n                <code>{{ \'\\{\\{dimensions\\}\\}\' }}</code> - å…¶ä»–ç»´åº¦ç»“æœæ‹¼æ¥\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- éšè—çš„æ–‡ä»¶è¾“å…¥ --\x3e\n    <input ref="fileInputRef" type="file" accept=".json" style="display: none" @change="handleImportPresets" />\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { useTextareaAutosize } from \'@vueuse/core\';\nimport { v4 as uuidv4 } from \'uuid\';\nimport { onMounted, ref, toRef } from \'vue\';\nimport { TEMPLATE_WITH_DIMENSIONS } from \'../../../composables/usePromptBuild\';\nimport { useToast } from \'../../../composables/useToast\';\nimport { useDivinationStore } from \'../../../stores/useDivinationStore\';\nimport { useUIStore } from \'../../../stores/useUIStore\';\nimport type { Dimension, DimensionTier, DivinationPreset } from \'../../../types\';\nimport PresetManagerHeader from \'../PresetManagerHeader.vue\';\n\nconst divinationStore = useDivinationStore() as any;\nconst uiStore = useUIStore();\nconst toast = useToast();\n\n// æŠ˜å çŠ¶æ€ç®¡ç†\nconst collapsedDimensions = ref<Record<string, boolean>>({});\nconst fileInputRef = ref<HTMLInputElement | null>(null);\nconst templateInputRef = ref<HTMLTextAreaElement | null>(null);\nconst showHelp = ref(true);\n\n// è¿ç§»æ¨¡å¼çŠ¶æ€\nconst isMigrating = ref(false);\nconst selectedDimensionIds = ref<Set<string>>(new Set());\n\n// è‡ªåŠ¨è°ƒæ•´é«˜åº¦\nconst customTemplateRef = toRef(divinationStore.config, \'customTemplate\');\nuseTextareaAutosize({ element: templateInputRef, input: customTemplateRef });\n\nconst toggleHelp = () => {\n  showHelp.value = !showHelp.value;\n};\n\n// åˆå§‹åŒ–ï¼šå¦‚æœè‡ªå®šä¹‰æ¨¡æ¿ä¸ºç©ºï¼Œå¡«å……é»˜è®¤æ¨¡æ¿\nonMounted(() => {\n  if (!divinationStore.config.customTemplate) {\n    divinationStore.config.customTemplate = TEMPLATE_WITH_DIMENSIONS;\n  }\n});\n\n// ============================================================\n// é¢„è®¾ç®¡ç†\n// ============================================================\n\nfunction handleSelectPreset(id: string) {\n  divinationStore.applyPreset(id);\n  toast.success(\'å·²åº”ç”¨ç»´åº¦é¢„è®¾\');\n}\n\nfunction handleRestoreDefault() {\n  if (confirm(\'ç¡®å®šè¦æ¢å¤é»˜è®¤ç»´åº¦é…ç½®å—ï¼Ÿå½“å‰æœªä¿å­˜çš„ä¿®æ”¹å°†ä¸¢å¤±ã€‚\')) {\n    divinationStore.restoreDefaultDimensions();\n    toast.success(\'å·²æ¢å¤é»˜è®¤ç»´åº¦é…ç½®\');\n  }\n}\n\nfunction handleDeletePreset(id: string) {\n  const preset = divinationStore.presets.find((p: DivinationPreset) => p.id === id);\n  if (!preset) return;\n\n  if (confirm(`ç¡®å®šè¦åˆ é™¤é¢„è®¾ã€Œ${preset.name}ã€å—ï¼Ÿ`)) {\n    divinationStore.deletePreset(id);\n    toast.info(\'é¢„è®¾å·²åˆ é™¤\');\n  }\n}\n\nfunction handleQuickSave() {\n  const activeId = divinationStore.activePresetId;\n  if (activeId) {\n    const preset = divinationStore.presets.find((p: DivinationPreset) => p.id === activeId);\n    if (preset) {\n      divinationStore.saveCurrentToPreset(preset.name);\n      toast.success(`é¢„è®¾ã€Œ${preset.name}ã€å·²æ›´æ–°`);\n      return;\n    }\n  }\n  // å¦‚æœæ²¡æœ‰æ¿€æ´»çš„é¢„è®¾ï¼Œåˆ™æ‰“å¼€å¦å­˜ä¸ºå¯¹è¯æ¡†\n  openSaveDialog();\n}\n\nfunction openSaveDialog() {\n  uiStore.openPresetSaveDialog(\n    {\n      presetType: \'divination\', // ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹æˆ–é€šç”¨ç±»å‹\n      summaryItems: [],\n      initialName: \'\',\n      checkDuplicate: (name: string) => divinationStore.presets.some((p: DivinationPreset) => p.name === name),\n    },\n    {\n      onSave: (name: string) => {\n        divinationStore.saveCurrentToPreset(name);\n        toast.success(`é¢„è®¾ã€Œ${name}ã€å·²ä¿å­˜`);\n      },\n    },\n  );\n}\n\n// å¯¼å‡ºå½“å‰é¢„è®¾\nfunction handleExportCurrentPreset() {\n  const activeId = divinationStore.activePresetId;\n  if (!activeId) {\n    toast.warning(\'è¯·å…ˆé€‰æ‹©ä¸€ä¸ªé¢„è®¾\');\n    return;\n  }\n  const preset = divinationStore.presets.find((p: DivinationPreset) => p.id === activeId);\n  if (!preset) return;\n\n  const data = {\n    type: \'acu_divination_presets\',\n    version: \'1.0\',\n    timestamp: new Date().toISOString(),\n    presets: [preset], // ä»…å¯¼å‡ºå½“å‰é¢„è®¾\n  };\n\n  downloadJson(data, `acu-preset-${preset.name}-${Date.now()}.json`);\n  toast.success(`é¢„è®¾ã€Œ${preset.name}ã€å·²å¯¼å‡º`);\n}\n\n// å¤‡ä»½æ‰€æœ‰é¢„è®¾\nfunction handleExportPresets() {\n  const data = {\n    type: \'acu_divination_presets\',\n    version: \'1.0\',\n    timestamp: new Date().toISOString(),\n    presets: divinationStore.presets,\n  };\n\n  downloadJson(data, `acu-divination-backup-${Date.now()}.json`);\n  toast.success(\'æ‰€æœ‰é¢„è®¾å·²å¤‡ä»½\');\n}\n\nfunction downloadJson(data: any, filename: string) {\n  const blob = new Blob([JSON.stringify(data, null, 2)], { type: \'application/json\' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement(\'a\');\n  a.href = url;\n  a.download = filename;\n  a.click();\n  URL.revokeObjectURL(url);\n}\n\n// è§¦å‘å¯¼å…¥\nfunction triggerImport() {\n  fileInputRef.value?.click();\n}\n\n// å¯¼å…¥é¢„è®¾\nfunction handleImportPresets(event: Event) {\n  const file = (event.target as HTMLInputElement).files?.[0];\n  if (!file) return;\n\n  const reader = new FileReader();\n  reader.onload = e => {\n    try {\n      const content = e.target?.result as string;\n      const data = JSON.parse(content);\n\n      if (data.type === \'acu_divination_presets\' && Array.isArray(data.presets)) {\n        let importedCount = 0;\n        data.presets.forEach((importedPreset: DivinationPreset) => {\n          // æ£€æŸ¥ ID å†²çªï¼Œå¦‚æœæœ‰å†²çªåˆ™é‡æ–°ç”Ÿæˆ ID\n          const existing = divinationStore.presets.find((p: DivinationPreset) => p.id === importedPreset.id);\n          if (existing) {\n            // å¦‚æœ ID å†²çªä½†å†…å®¹ä¸åŒï¼Œæˆ–è€…åªæ˜¯æƒ³åˆå¹¶ï¼Œè¿™é‡Œç®€å•å¤„ç†ä¸ºè¿½åŠ å¹¶é‡å‘½å\n            // å®é™…ç­–ç•¥å¯ä»¥æ˜¯ï¼šè¦†ç›–ã€è·³è¿‡æˆ–é‡å‘½åã€‚è¿™é‡Œé‡‡ç”¨ï¼šå¦‚æœ ID ç›¸åŒåˆ™è¦†ç›–\n            const index = divinationStore.presets.findIndex((p: DivinationPreset) => p.id === importedPreset.id);\n            divinationStore.presets[index] = importedPreset;\n          } else {\n            divinationStore.presets.push(importedPreset);\n          }\n          importedCount++;\n        });\n\n        // å¼ºåˆ¶ä¿å­˜ä¸€æ¬¡\n        divinationStore.saveConfig();\n        toast.success(`æˆåŠŸå¯¼å…¥ ${importedCount} ä¸ªé¢„è®¾`);\n      } else {\n        toast.error(\'æ— æ•ˆçš„é¢„è®¾æ–‡ä»¶æ ¼å¼\');\n      }\n    } catch (err) {\n      console.error(\'å¯¼å…¥å¤±è´¥:\', err);\n      toast.error(\'å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ ¼å¼é”™è¯¯\');\n    }\n  };\n  reader.readAsText(file);\n  // é‡ç½® input\n  (event.target as HTMLInputElement).value = \'\';\n}\n\n// åˆ‡æ¢æŠ˜å \nconst toggleCollapse = (id: string) => {\n  collapsedDimensions.value[id] = !collapsedDimensions.value[id];\n};\n\n// å…¨éƒ¨æŠ˜å \nfunction collapseAll() {\n  divinationStore.config.dimensions.forEach((dim: any) => {\n    collapsedDimensions.value[dim.id] = true;\n  });\n}\n\n// å…¨éƒ¨å±•å¼€\nfunction expandAll() {\n  divinationStore.config.dimensions.forEach((dim: any) => {\n    collapsedDimensions.value[dim.id] = false;\n  });\n}\n\n// åˆ‡æ¢è¿ç§»æ¨¡å¼\nfunction toggleMigrateMode() {\n  isMigrating.value = !isMigrating.value;\n  if (isMigrating.value) {\n    selectedDimensionIds.value.clear();\n    toast.info(\'è¿ç§»æ¨¡å¼ï¼šç‚¹å‡»é€‰ä¸­è¦è¿ç§»çš„ç»´åº¦ï¼Œç„¶åé€‰æ‹©ç›®æ ‡é¢„è®¾\');\n  } else {\n    selectedDimensionIds.value.clear();\n  }\n}\n\n// åˆ‡æ¢ç»´åº¦é€‰ä¸­\nfunction toggleDimensionSelection(dimId: string) {\n  if (selectedDimensionIds.value.has(dimId)) {\n    selectedDimensionIds.value.delete(dimId);\n  } else {\n    selectedDimensionIds.value.add(dimId);\n  }\n  // å¼ºåˆ¶è§¦å‘å“åº”å¼æ›´æ–°\n  selectedDimensionIds.value = new Set(selectedDimensionIds.value);\n}\n\n// è¿ç§»åˆ°ç›®æ ‡é¢„è®¾\nfunction handleMigrateTo(targetPresetId: string) {\n  if (selectedDimensionIds.value.size === 0) {\n    toast.warning(\'è¯·å…ˆé€‰ä¸­è¦è¿ç§»çš„ç»´åº¦\');\n    return;\n  }\n\n  const targetPreset = divinationStore.presets.find((p: any) => p.id === targetPresetId);\n  if (!targetPreset) return;\n\n  // æ‰§è¡Œè¿ç§»\n  const selectedDims = divinationStore.config.dimensions.filter((d: any) => selectedDimensionIds.value.has(d.id));\n\n  divinationStore.migrateDimensionsToPreset(selectedDims, targetPresetId);\n\n  toast.success(`å·²è¿ç§» ${selectedDims.length} ä¸ªç»´åº¦åˆ°ã€Œ${targetPreset.name}ã€`);\n\n  // é€€å‡ºè¿ç§»æ¨¡å¼\n  isMigrating.value = false;\n  selectedDimensionIds.value.clear();\n}\n\n// æ·»åŠ æ–°ç»´åº¦\nconst handleAddDimension = () => {\n  const newDim: Dimension = {\n    id: uuidv4(),\n    name: \'æ–°ç»´åº¦\',\n    enabled: true,\n    tiers: [\n      {\n        id: uuidv4(),\n        name: \'é»˜è®¤æ¡£ä½\',\n        weight: 50,\n        prompt: \'\',\n      },\n    ],\n  };\n  divinationStore.addDimension(newDim);\n  // è‡ªåŠ¨å±•å¼€æ–°ç»´åº¦\n  collapsedDimensions.value[newDim.id] = false;\n};\n\n// åˆ é™¤ç»´åº¦\nconst handleRemoveDimension = (index: any) => {\n  if (confirm(\'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç»´åº¦å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚\')) {\n    divinationStore.removeDimension(index);\n  }\n};\n\n// æ·»åŠ æ¡£ä½\nconst addTier = (dimIndex: any) => {\n  const newTier: DimensionTier = {\n    id: uuidv4(),\n    name: \'æ–°æ¡£ä½\',\n    weight: 10,\n    prompt: \'\',\n    color: \'#808080\',\n  };\n  divinationStore.config.dimensions[dimIndex].tiers.push(newTier);\n};\n\n// åˆ é™¤æ¡£ä½\nconst removeTier = (dimIndex: any, tierIndex: any) => {\n  divinationStore.config.dimensions[dimIndex].tiers.splice(tierIndex, 1);\n};\n\n// æ’å…¥æ¨¡æ¿å ä½ç¬¦ (è¿½åŠ åˆ°æœ«å°¾)\nconst insertTemplatePlaceholder = (placeholder: string) => {\n  const current = divinationStore.config.customTemplate || \'\';\n  divinationStore.config.customTemplate = current + placeholder;\n\n  // æ»šåŠ¨åˆ°åº•éƒ¨å¹¶èšç„¦\n  const textarea = templateInputRef.value;\n  if (textarea) {\n    setTimeout(() => {\n      textarea.focus();\n      textarea.scrollTop = textarea.scrollHeight;\n      // ç§»åŠ¨å…‰æ ‡åˆ°æœ«å°¾\n      const len = divinationStore.config.customTemplate.length;\n      textarea.setSelectionRange(len, len);\n    }, 0);\n  }\n};\n<\/script>\n\n<style scoped>\n/*\n  æ³¨æ„ï¼šç”±äºæ ·å¼éš”ç¦»é™åˆ¶ï¼Œä¸»è¦æ ·å¼åº”å†™åœ¨ src/å¯è§†åŒ–è¡¨æ ¼/styles/components/settings-panel.scss\n  æˆ– src/å¯è§†åŒ–è¡¨æ ¼/styles/components/divination-settings.scss ä¸­ã€‚\n  è¿™é‡Œåªä¿ç•™æå°‘é‡æ— æ³•æå–çš„æ ·å¼æˆ–ä¸´æ—¶æ ·å¼ã€‚\n*/\n.template-settings-group {\n  padding: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.template-shortcuts-row {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n\n.template-shortcuts-row .hint {\n  font-size: 12px;\n  color: var(--acu-text-sub);\n}\n\n.acu-wildcard-btn {\n  background: var(--acu-bg-panel);\n  border: 1px solid var(--acu-border);\n  border-radius: 4px;\n  padding: 2px 6px;\n  cursor: pointer;\n  font-size: 12px;\n  color: var(--acu-title-color);\n  transition: all 0.2s;\n}\n\n.acu-wildcard-btn:hover {\n  background: var(--acu-btn-hover);\n  border-color: var(--acu-title-color);\n}\n\n.acu-wildcard-btn code {\n  font-family: monospace;\n}\n\n.template-textarea {\n  min-height: 120px;\n  resize: vertical;\n  line-height: 1.5;\n  font-family: monospace;\n  width: 100%;\n  pointer-events: auto !important; /* å¼ºåˆ¶å¯ç‚¹å‡» */\n}\n\n.acu-wildcard-help {\n  background: rgba(0, 0, 0, 0.05);\n  border-radius: 8px;\n  padding: 8px 12px;\n}\n\n.acu-help-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  font-size: 12px;\n  color: var(--acu-text-sub);\n  user-select: none;\n}\n\n.acu-help-header strong {\n  flex: 1;\n}\n\n.acu-wildcard-help ul {\n  margin: 8px 0 0 0;\n  padding-left: 20px;\n  list-style-type: disc;\n  font-size: 12px;\n  color: var(--acu-text-sub);\n}\n\n.acu-wildcard-help li {\n  margin-bottom: 4px;\n}\n\n.acu-wildcard-help code {\n  background: rgba(0, 0, 0, 0.1);\n  padding: 0 4px;\n  border-radius: 3px;\n  font-family: monospace;\n  color: var(--acu-text-main);\n}\n</style>\n'],sourceRoot:''}]);const i=l},6314(e,t,a){a.d(t,{TY:()=>l,X8:()=>i,nD:()=>c,zI:()=>p});var o=a(4015),n=a(3035),r=a(4061);const l=[{border:'#E91E63',background:'rgba(233, 30, 99, 0.1)',opacity:10},{border:'#2196F3',background:'rgba(33, 150, 243, 0.1)',opacity:10},{border:'#4CAF50',background:'rgba(76, 175, 80, 0.1)',opacity:10},{border:'#FF9800',background:'rgba(255, 152, 0, 0.1)',opacity:10},{border:'#9C27B0',background:'rgba(156, 39, 176, 0.1)',opacity:10},{border:'#00BCD4',background:'rgba(0, 188, 212, 0.1)',opacity:10},{border:'#795548',background:'rgba(121, 85, 72, 0.1)',opacity:10},{border:'#607D8B',background:'rgba(96, 125, 139, 0.1)',opacity:10}],i={border:'#666666',background:'rgba(128, 128, 128, 0.1)',opacity:10},c={size:60,borderColor:'#333333',borderWidth:2,backgroundColor:'#dcd0c0',shape:'ellipse'},s={enabled:!1,position:'top-right',items:[{id:'legend-love',label:'æ‹çˆ±/æš§æ˜§',color:'#E91E63',emoji:'â¤ï¸',keywords:['æ‹','çˆ±','æš§æ˜§','æƒ…äºº','ä¼´ä¾£']},{id:'legend-family',label:'äº²å±',color:'#2196F3',emoji:'ğŸ’™',keywords:['çˆ¶','æ¯','å…„','å¼Ÿ','å§','å¦¹','äº²']},{id:'legend-friend',label:'å‹å¥½/åŒä¼´',color:'#4CAF50',emoji:'ğŸ’š',keywords:['å‹','æœ‹','ä¼™ä¼´','åŒä¼´','ç›Ÿ']},{id:'legend-neutral',label:'ä¸­ç«‹/ä¸€èˆ¬',color:'#9E9E9E',emoji:'âšª',keywords:['åŒäº‹','é‚»å±…','è®¤è¯†']},{id:'legend-interest',label:'åˆ©ç›Šå…³ç³»',color:'#FF9800',emoji:'ğŸŸ¡',keywords:['åˆä½œ','é›‡ä½£','äº¤æ˜“','åˆ©ç”¨']},{id:'legend-enemy',label:'æ•Œå¯¹/ä»‡æ¨',color:'#F44336',emoji:'ğŸ”´',keywords:['æ•Œ','ä»‡','å¯¹æ‰‹','ç«äº‰']},{id:'legend-complex',label:'å¤æ‚/æœªçŸ¥',color:'#9C27B0',emoji:'ğŸŸ£',keywords:[]}]},u={nodeSize:50,edgeWidth:2.5,relationLabelFontSize:10,nameLabelFontSize:12,factionLabelFontSize:14,showLegend:!0,showBackground:!0,factionColors:{},factionAvatars:{},nodeOverrides:{},legendConfig:{...s}},d='acu_graph_style_config',p=(0,n.defineStore)('graphConfig',()=>{const e=(0,r.ref)(t());function t(){try{const e=getVariables({type:'chat'})[d];if(e&&'object'==typeof e)return{...u,...e}}catch(e){console.warn('[GraphConfigStore] åŠ è½½é…ç½®å¤±è´¥:',e)}return{...u}}function a(){try{insertOrAssignVariables({[d]:(0,o.klona)(e.value)},{type:'chat'})}catch(e){console.warn('[GraphConfigStore] ä¿å­˜é…ç½®å¤±è´¥:',e)}}return(0,r.watchEffect)(()=>{JSON.stringify(e.value);void 0!==e.value&&a()}),{config:e,saveConfig:a,resetToDefault:function(){e.value={...u,factionColors:{}},a()},refresh:function(){e.value=t()},setFactionColor:function(t,a){e.value.factionColors={...e.value.factionColors,[t]:a}},getFactionColor:function(t,a=[],o=!1){if(e.value.factionColors[t])return e.value.factionColors[t];if(o)return i;const n=(Object.keys(e.value.factionColors).length+a.indexOf(t))%l.length;return l[Math.max(0,n)]},hasFactionColor:function(t){return!!e.value.factionColors[t]},initFactionColors:function(t){const a={...e.value.factionColors};let o=Object.keys(a).length;for(const e of t)a[e]||(a[e]=l[o%l.length],o++);e.value.factionColors=a},setFactionAvatar:function(t,a){e.value.factionAvatars||(e.value.factionAvatars={}),e.value.factionAvatars={...e.value.factionAvatars,[t]:a}},getFactionAvatar:function(t){return e.value.factionAvatars?.[t]},removeFactionAvatar:function(t){if(e.value.factionAvatars?.[t]){const a={...e.value.factionAvatars};delete a[t],e.value.factionAvatars=a}},hasFactionAvatar:function(t){return!!e.value.factionAvatars?.[t]},getAllFactionAvatars:function(){return e.value.factionAvatars||{}},setFactionOverride:function(t,a){const o=t.replace('faction-container-',''),n=e.value.factionColors[o]||{...i};e.value.factionColors={...e.value.factionColors,[o]:{...n,...a}}},getFactionOverride:function(t){const a=t.replace('faction-container-','');return e.value.factionColors[a]},removeFactionOverride:function(t){const a=t.replace('faction-container-','');if(e.value.factionColors[a]){const t={...e.value.factionColors};delete t[a],e.value.factionColors=t}},setNodeStyleOverride:function(t,a){e.value.nodeOverrides||(e.value.nodeOverrides={});const o=e.value.nodeOverrides[t]||{};e.value.nodeOverrides={...e.value.nodeOverrides,[t]:{...o,...a}}},getNodeStyleOverride:function(t){return e.value.nodeOverrides?.[t]},removeNodeStyleOverride:function(t){if(e.value.nodeOverrides?.[t]){const a={...e.value.nodeOverrides};delete a[t],e.value.nodeOverrides=a}},hasNodeStyleOverride:function(t){return!!e.value.nodeOverrides?.[t]},setLegendEnabled:function(t){e.value.legendConfig||(e.value.legendConfig={...s}),e.value.legendConfig.enabled=t},setLegendPosition:function(t){e.value.legendConfig||(e.value.legendConfig={...s}),e.value.legendConfig.position=t},addLegendItem:function(t){e.value.legendConfig||(e.value.legendConfig={...s});const a={...t,id:`legend-${Date.now()}`};e.value.legendConfig.items=[...e.value.legendConfig.items,a]},updateLegendItem:function(t,a){e.value.legendConfig?.items&&(e.value.legendConfig.items=e.value.legendConfig.items.map(e=>e.id===t?{...e,...a}:e))},removeLegendItem:function(t){e.value.legendConfig?.items&&(e.value.legendConfig.items=e.value.legendConfig.items.filter(e=>e.id!==t))},getLegendConfig:function(){return e.value.legendConfig||s},resetLegendConfig:function(){e.value.legendConfig={...s}},matchLegendColor:function(t){const a=e.value.legendConfig;if(!a?.enabled||!a.items?.length)return null;for(const e of a.items)if(e.keywords.some(e=>t.includes(e)))return e.color;return null},setShowBackground:function(t){e.value.showBackground=t,a()}}})},6390(e,t,a){var o=a(9929);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('2ae638b2',o,!1,{ssrId:!0})},6444(e,t,a){a.d(t,{f:()=>m});var o=a(3035),n=a(4061),r=a(1699),l=a(4182),i=a(1768);const c={widgets:[],layout:'grid',columns:2,showStats:!0,hasInitializedDefaults:!1,configVersion:0},s='acu_dashboard_config_backup',u=3,d=500;function p(e){return new Promise(t=>setTimeout(t,e))}const m=(0,o.defineStore)('acu-dashboard',()=>{const e=(0,n.ref)({...c}),t=(0,n.ref)(!1),a=(0,n.ref)(0),o=(0,n.computed)(()=>e.value.widgets.filter(e=>e.enabled).sort((e,t)=>e.order-t.order)),m=(0,n.computed)(()=>[...e.value.widgets].sort((e,t)=>e.order-t.order)),f=(0,n.computed)(()=>e.value.showStats),g=(0,n.computed)(()=>e.value.columns),v=(0,n.computed)(()=>e.value.layout);function b(){try{localStorage.setItem(s,JSON.stringify(e.value))}catch(e){console.warn('[ACU Dashboard] localStorage å¤‡ä»½ä¿å­˜å¤±è´¥:',e)}}async function h(t=!0){if(e.value.hasInitializedDefaults)return void console.log('[ACU Dashboard] å·²å®Œæˆé¦–æ¬¡åˆå§‹åŒ–ï¼Œè·³è¿‡é»˜è®¤ç»„ä»¶æ·»åŠ ');let a=!1;e.value.widgets.some(e=>'updateStatus'===e.type)||(k('updateStatus',!1),a=!0);const o=(0,r.dK)();o.length>0&&(e.value.widgets.some(e=>'randomWordPool'===e.type)||(k('randomWordPool',!1),a=!0,console.log(`[ACU Dashboard] æ£€æµ‹åˆ° ${o.length} ä¸ªéšæœºè¡¨ï¼Œå·²è‡ªåŠ¨æ·»åŠ éšæœºè¯è¡¨ç»„ä»¶`)));const n=(0,i.tu)();if(!n)return void(a&&t&&(e.value.hasInitializedDefaults=!0,x()));const l=(0,i.tE)(n);if(!l)return void(a&&t&&(e.value.hasInitializedDefaults=!0,x()));const c=[{keywords:['ä»»åŠ¡','task','Task','quest','Quest','æ—¥ç¨‹'],templateKey:'task'},{keywords:['ç‰©å“','é“å…·','item','Item','èƒŒåŒ…','åº“å­˜','è£…å¤‡'],templateKey:'item'},{keywords:['å…¨å±€','Global'],templateKey:'global'},{keywords:['äº¤äº’','äº’åŠ¨'],templateKey:'interaction'}];for(const[t,o]of Object.entries(l)){const n=o.key,r=t.toLowerCase();for(const o of c)if(o.keywords.some(e=>r.includes(e.toLowerCase()))){e.value.widgets.some(e=>e.tableId===n)||(y(n,t,o.templateKey,!1),console.log(`[ACU Dashboard] è‡ªåŠ¨æ·»åŠ è¡¨æ ¼: ${t} (æ¨¡æ¿: ${o.templateKey})`),a=!0);break}}e.value.hasInitializedDefaults=!0,a&&t?(x(),console.log('[ACU Dashboard] é»˜è®¤ç»„ä»¶å·²æ›´æ–°ï¼ˆé¦–æ¬¡åˆå§‹åŒ–ï¼‰')):t&&(x(),console.log('[ACU Dashboard] é¦–æ¬¡åˆå§‹åŒ–å®Œæˆï¼Œå·²ä¿å­˜åˆå§‹åŒ–æ ‡è®°'))}async function x(){try{const t=getVariables({type:'global'})||{},o=t.acu_dashboard_config,n=o?.configVersion||0;if(n>a.value)return console.warn(`[ACU Dashboard] æ£€æµ‹åˆ°æ›´æ–°çš„é…ç½® (å­˜å‚¨ç‰ˆæœ¬=${n}, åŠ è½½ç‰ˆæœ¬=${a.value})ï¼Œå–æ¶ˆä¿å­˜`),e.value={...c,...o},void(a.value=n);e.value.configVersion=n+1,a.value=e.value.configVersion,replaceVariables({...t,acu_dashboard_config:e.value},{type:'global'}),b(),console.log('[ACU Dashboard] é…ç½®ä¿å­˜æˆåŠŸ (ç‰ˆæœ¬:',e.value.configVersion,')')}catch(e){console.warn('[ACU Dashboard] ä¿å­˜åˆ°é…’é¦†å˜é‡å¤±è´¥ï¼Œå°è¯•ä¿å­˜åˆ° localStorage:',e),b()}}function y(t,a,o,n=!0){let r=o?l.b3[o]:void 0;const i=a||t;if(!r)for(const[e,t]of Object.entries(l.JT))if(t.some(e=>i.toLowerCase().includes(e.toLowerCase()))){r=l.b3[e];break}let c=r?.actions||['goToTable'];const s=i.toLowerCase();(s.includes('äººç‰©')||s.includes('npc'))&&(c.includes('relationshipGraph')||(c=[...c,'relationshipGraph']));let u=r?.displayStyle||'list';r||!a?.includes('äº¤äº’')&&!a?.includes('äº’åŠ¨')&&'sheet_Interaction_CN'!==t||(u='interaction');const d={id:`widget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:'table',tableId:t,title:r?.title||a||t,icon:r?.icon||'fa-table',displayColumns:r?.displayColumns||[],maxRows:r?.maxRows||8,actions:c,order:e.value.widgets.length,enabled:!0,colSpan:r?.colSpan||1,displayStyle:u};return e.value.widgets.push(d),n&&x(),d}function w(t,a){const o=e.value.widgets.find(e=>e.id===t);o&&(Object.assign(o,a),x())}function k(t,a=!0){const o={updateStatus:{type:'updateStatus',title:'è¡¨æ ¼çŠ¶æ€',icon:'fa-sync-alt',colSpan:2,actions:['nativeEdit']},optionsPanel:{type:'optionsPanel',title:'é€‰é¡¹èšåˆé¢æ¿',icon:'fa-list-check',colSpan:2},randomWordPool:{type:'randomWordPool',title:'éšæœºè¯è¡¨',icon:'fa-dice',colSpan:1,actions:['settings']}}[t],n={id:`special_${t}_${Date.now()}`,type:t,title:o.title||t,icon:o.icon||'fa-cog',displayColumns:[],maxRows:10,actions:o.actions||[],order:e.value.widgets.length,enabled:!0,colSpan:o.colSpan||2,displayStyle:'list'};return e.value.widgets.push(n),a&&x(),n}return{config:e,isInitialized:t,enabledWidgets:o,allWidgets:m,showStats:f,columns:g,layout:v,loadConfig:async function(){try{let o=!1,n=!1;const r=await async function(){for(let e=1;e<=u;e++){try{const t=getVariables({type:'global'});if(t&&t.acu_dashboard_config&&Array.isArray(t.acu_dashboard_config.widgets))return console.log(`[ACU Dashboard] ç¬¬ ${e} æ¬¡å°è¯•æˆåŠŸä»é…’é¦†å˜é‡åŠ è½½é…ç½®`),t.acu_dashboard_config;if(null!=t)return console.log(`[ACU Dashboard] ç¬¬ ${e} æ¬¡å°è¯•ï¼šAPI å¯ç”¨ä½†æ— é…ç½®`),null}catch(t){console.warn(`[ACU Dashboard] ç¬¬ ${e} æ¬¡å°è¯•å¤±è´¥:`,t)}e<u&&(console.log(`[ACU Dashboard] ç­‰å¾… ${d}ms åé‡è¯•...`),await p(d))}return console.warn(`[ACU Dashboard] ${u} æ¬¡å°è¯•åä»æ— æ³•ä»é…’é¦†å˜é‡åŠ è½½`),null}();if(r)e.value={...c,...r},o=!0,n=!0,a.value=e.value.configVersion||0,console.log('[ACU Dashboard] æˆåŠŸä»é…’é¦†å˜é‡åŠ è½½é…ç½®ï¼Œwidgets æ•°é‡:',e.value.widgets.length,'ç‰ˆæœ¬:',a.value),b();else{const t=function(){try{const e=localStorage.getItem(s);if(e){const t=JSON.parse(e);if(t&&Array.isArray(t.widgets))return t}}catch(e){console.warn('[ACU Dashboard] localStorage å¤‡ä»½è§£æå¤±è´¥:',e)}return null}();if(t){e.value={...c,...t},o=!0,console.log('[ACU Dashboard] ä» localStorage å¤‡ä»½æ¢å¤é…ç½®ï¼Œwidgets æ•°é‡:',e.value.widgets.length);try{x()}catch(e){console.warn('[ACU Dashboard] åŒæ­¥åˆ°é…’é¦†å˜é‡å¤±è´¥ï¼ˆéé˜»å¡ï¼‰:',e)}}else console.log('[ACU Dashboard] æœªæ‰¾åˆ°ä»»ä½•å·²æœ‰é…ç½®ï¼Œä½¿ç”¨é»˜è®¤é…ç½®')}await h(o);const i=['äººç‰©','npc','NPC','è§’è‰²','å…³ç³»','å¥½æ„Ÿ','é‡è¦äººç‰©'],m=l.JT.global||[];let f=!1;e.value.widgets.forEach(e=>{const t=e.title||e.tableId||'';'grid'===e.displayStyle&&'table'===e.type&&i.some(e=>t.includes(e))&&(console.log(`[ACU Dashboard] è¿ç§»è¡¨æ ¼æ ·å¼ä¸ºæ™®é€šåˆ—è¡¨: ${t}`),e.displayStyle='list',e.displayColumns=[],f=!0),'table'===e.type&&'global'!==e.displayStyle&&m.some(e=>t.toLowerCase().includes(e.toLowerCase()))&&(console.log(`[ACU Dashboard] è¿ç§»è¡¨æ ¼æ ·å¼ä¸ºå…¨å±€çŠ¶æ€è§†å›¾: ${t}`),e.displayStyle='global',e.displayColumns=[],e.maxRows=1,e.colSpan=2,f=!0)}),f||e.value.widgets.forEach(e=>{if('table'===e.type&&'global'!==e.displayStyle){const t=e.title||e.tableId||'';['å…¨å±€','çŠ¶æ€','Global','Status','Environment','ç¯å¢ƒ'].some(e=>t.toLowerCase().includes(e.toLowerCase()))&&(console.log(`[ACU Dashboard] å¼ºåˆ¶è¿ç§»è¡¨æ ¼æ ·å¼ä¸ºå…¨å±€çŠ¶æ€è§†å›¾ (Backup): ${t}`),e.displayStyle='global',e.maxRows=1,e.colSpan=2,f=!0)}}),f&&x(),t.value=!0,console.log('[ACU Dashboard] é…ç½®åŠ è½½æˆåŠŸ (å…¨å±€å˜é‡):',e.value)}catch(a){console.warn('[ACU Dashboard] åŠ è½½é…ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é…ç½®:',a),e.value={...c},t.value=!0}},saveConfig:x,updateConfig:function(t){e.value={...e.value,...t},x()},addWidget:y,removeWidget:function(t){const a=e.value.widgets.findIndex(e=>e.id===t);-1!==a&&(e.value.widgets.splice(a,1),e.value.widgets.forEach((e,t)=>{e.order=t}),x())},updateWidget:w,toggleWidget:function(t){const a=e.value.widgets.find(e=>e.id===t);a&&(a.enabled=!a.enabled,x())},moveWidget:function(t,a){const o=[...e.value.widgets],n=o.findIndex(e=>e.id===t);if(-1===n)return;const[r]=o.splice(n,1);o.splice(a,0,r),o.forEach((e,t)=>{e.order=t}),e.value.widgets=o,x()},setWidgetActions:function(e,t){w(e,{actions:t})},resetConfig:function(){e.value={...c},x()},findWidgetByTableId:function(t){return e.value.widgets.find(e=>e.tableId===t)},hasWidget:function(t){return e.value.widgets.some(e=>e.tableId===t)},hasSpecialWidget:function(t){return e.value.widgets.some(e=>e.type===t)},addSpecialWidget:k,removeSpecialWidget:function(t){const a=e.value.widgets.findIndex(e=>e.type===t);-1!==a&&(e.value.widgets.splice(a,1),e.value.widgets.forEach((e,t)=>{e.order=t}),x())},getWidgetById:function(t){return e.value.widgets.find(e=>e.id===t)},ensureDefaultWidgets:h}})},6571(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'\n','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},6758(e,t,a){a.d(t,{$P:()=>o.$P,Ct:()=>l.C,D$:()=>n.D,H6:()=>i.H6,JH:()=>o.JH,MP:()=>o.MP,j_:()=>i.j_,mu:()=>o.mu,zI:()=>r.zI});var o=a(3926),n=(a(6444),a(3024)),r=(a(4919),a(6314)),l=(a(7285),a(567)),i=a(7002)},7002(e,t,a){a.d(t,{$9:()=>y,H6:()=>x,SC:()=>w,Sj:()=>k,j_:()=>C});var o=a(3981),n=a(4061),r=a(3024),l=a(4919),i=a(3035);const c='acu_ui_collapse_state',s='acu_pin_state',u='acu_active_tab',d='acu_table_order',p='acu_table_heights',m='acu_table_styles',f='acu_reverse_tables',g='acu_float_ball_pos',v='acu_layout',b='acu_visible_tabs',h='acu_tab_order',x='acu_tab_dashboard_home',y='acu_tab_options_panel',w='acu_tab_relationship_graph';function k(e){return/åŠ¿åŠ›|ç»„ç»‡|é˜µè¥/.test(e)?'fas fa-fist-raised':/æŠ€èƒ½/.test(e)?'fas fa-magic':/äººç‰©|è§’è‰²|npc/i.test(e)?'fas fa-users':/äº¤äº’|è¡ŒåŠ¨/.test(e)?'fas fa-hand-pointer':/éšæœº/.test(e)?'fas fa-dice':/å…¨å±€/.test(e)?'fas fa-globe':/åœ°ç‚¹|åœ°å›¾/.test(e)?'fas fa-map-marked-alt':/å¤§çº²/.test(e)?'fas fa-book':'fas fa-table'}const C=(0,i.defineStore)('acu-ui',()=>{const e=(0,o.rXt)(c,!1),t=(0,o.rXt)(s,!1),a=(0,o.rXt)(u,null),i=(0,o.rXt)(d,[]),w=(0,o.rXt)(p,{}),k=(0,o.rXt)(m,{}),C=(0,o.rXt)(f,[]),N=(0,o.rXt)(g,{x:20,y:'undefined'!=typeof window?window.innerHeight-150:500}),V=(0,o.rXt)(v,'horizontal'),E=(0,o.rXt)(b,[]),B=(0,o.rXt)(h,[]),S=(0,n.ref)(1),T=(0,n.ref)(''),D=(0,n.ref)(0),A=(0,n.ref)(!1),I=(0,n.ref)(!1),M=(0,n.ref)(!1),U=(0,n.ref)(!1),L=(0,n.ref)(!1),P=(0,n.ref)(!1),F=(0,n.ref)(null),j=(0,n.reactive)({visible:!1,props:{tableName:'',tableId:'',rowIndex:0,currentRowData:null}}),O=(0,n.reactive)({visible:!1,props:{widgetId:'',widgetConfig:null,tableHeaders:[]}}),R=(0,n.reactive)({visible:!1,props:{tableName:'',tableId:'',rowIndex:0,currentRowData:null,titleColIndex:0}}),H=(0,n.reactive)({visible:!1,props:{imageUrl:'',name:'',initialOffsetX:50,initialOffsetY:50,initialScale:150,initialInvert:!1,showInvertOption:!1}}),W=(0,n.shallowRef)(null),G=(0,n.shallowRef)(null),Y=(0,n.reactive)({visible:!1,props:{widgetId:'',currentActions:[]}}),X=(0,n.reactive)({visible:!1,props:{nodes:[],factions:[]}}),q=(0,n.shallowRef)(null),K=(0,n.shallowRef)(null),J=(0,n.reactive)({visible:!1,props:{nodeId:'',fullName:'',currentLabel:'',selectedIndices:[]}}),Q=(0,n.shallowRef)(null),Z=(0,n.shallowRef)(null),ee=(0,n.shallowRef)(null),te=(0,n.reactive)({visible:!1,props:{fullName:'',initialIndices:[]}}),ae=(0,n.shallowRef)(null),oe=(0,n.shallowRef)(null);function ne(){te.visible=!1,ae.value=null,oe.value=null}const re=(0,n.reactive)({visible:!1,props:{factions:[]}}),le=(0,n.reactive)({visible:!1,props:{factionId:'',factionName:''}}),ie=(0,n.ref)(!1),ce=(0,n.ref)(!1),se=(0,n.reactive)({visible:!1,props:{currentFloor:0}}),ue=(0,n.reactive)({visible:!1,props:{maxFloor:0}}),de=(0,n.reactive)({visible:!1,props:{initialStartFloor:void 0,initialEndFloor:void 0},state:{selectedTableKeys:[]}}),pe=(0,n.shallowRef)(null),me=(0,n.ref)(!1),fe=(0,n.reactive)({visible:!1,props:{tableName:'',tableId:'',rowIndex:0,currentRowData:null,titleColIndex:1}}),ge=(0,n.ref)(!1),ve=(0,n.reactive)({visible:!1,props:{presetType:'manual-update',summaryItems:[],initialName:''}}),be=(0,n.shallowRef)(null),he=(0,n.reactive)({visible:!1,props:{categoryId:'',rowContext:{title:'',value:''},widgetId:''}}),xe=(0,n.reactive)({visible:!1,props:{tagLabel:'',resolvedPrompt:'',showCompanions:!1,widgetId:''}}),ye=(0,n.reactive)({visible:!1,props:{widgetId:'',displayedTagIds:[],displayedCategoryIds:[]}}),we=(0,n.shallowRef)(null),ke=(0,n.reactive)({visible:!1,props:{currentIcon:''}}),Ce=(0,n.shallowRef)(null);function Ne(){ke.visible=!1,Ce.value=null}const Ve=(0,n.reactive)({visible:!1,result:null,isQuickRerollMode:!1}),Ee=(0,n.reactive)({visible:!1,props:{prompt:''}}),Be=(0,n.computed)(()=>!e.value&&null!==a.value),Se=(0,n.computed)(()=>a.value===x),Te=(0,n.computed)(()=>a.value===y);const De=(0,n.computed)(()=>T.value);const Ae=(0,n.computed)(()=>'horizontal'===V.value);function ze(e){if(!B.value||0===B.value.length)return e;return[...B.value.filter(t=>e.includes(t)),...e.filter(e=>!B.value.includes(e))]}function Ie(){H.visible=!1,W.value=null,G.value=null}function _e(){J.visible=!1,Q.value=null,Z.value=null,ee.value=null}function Me(e='main'){'main'!==e&&(F.value=e),ie.value=!0}function Ue(){de.visible=!1,pe.value=null}function $e(){ve.visible=!1,be.value=null}function Le(){ye.visible=!1,we.value=null}const Pe=(0,n.ref)(0),Fe=(0,n.ref)(!1);return{isCollapsed:e,isPinned:t,activeTab:a,tableOrder:i,tableHeights:w,tableStyles:k,reverseTables:C,ballPosition:N,layout:V,visibleTabs:E,currentPage:S,searchTerm:T,currentSearchTerm:De,scrollTop:D,isEditingOrder:A,isInitialized:I,isContentHidden:M,isMobile:U,isLockEditMode:L,showLockedOnly:P,initialSettingsPanel:F,isPanelVisible:Be,isDashboardActive:Se,isOptionsActive:Te,reverseOrderTables:C,isHorizontalLayout:Ae,toggleCollapse:function(){e.value=!e.value},togglePin:function(){t.value=!t.value},setActiveTab:function(e){a.value=e,S.value=1,T.value=''},setTableOrder:function(e){i.value=e},setTableHeight:function(e,t){w.value={...w.value,[e]:t}},resetTableHeight:function(e){const t={...w.value};delete t[e],w.value=t},getTableHeight:function(e){return w.value[e]},setTableStyle:function(e,t){k.value={...k.value,[e]:t}},getTableStyle:function(e){return k.value[e]||'list'},toggleTableReverse:function(e){const t=[...C.value],a=t.indexOf(e);a>-1?t.splice(a,1):t.push(e),C.value=t},isTableReversed:function(e){return C.value.includes(e)},setCurrentPage:function(e){S.value=Math.max(1,e)},setSearchTerm:function(e){T.value=e.toLowerCase(),S.value=1},saveScrollTop:function(e){D.value=e},enterEditingOrder:function(){A.value=!0},exitEditingOrder:function(){A.value=!1},setEditingOrder:function(e){A.value=e},setMobile:function(e){U.value=e},setLayout:function(e){V.value=e},toggleLayout:function(){V.value='horizontal'===V.value?'vertical':'horizontal'},closePanel:function(){e.value=!0,M.value=!1},openPanel:function(){M.value=!1,e.value=!1,null===a.value&&(a.value=x)},setInitialized:function(e){I.value=e},updateSaveBtnState:function(){const{$}=window.jQuery?{$:window.jQuery}:{$:window.parent.$};if(!$)return;const e=(0,r.D)().hasUnsavedChanges,t=$(window.parent.document).find('#acu-btn-save-global');t.length&&(e?(t.addClass('acu-has-changes'),t.find('i').addClass('fa-beat-fade'),t.css('color','#e67e22')):(t.removeClass('acu-has-changes'),t.find('i').removeClass('fa-beat-fade'),t.css('color','')))},autoFitPanelHeight:function(e=!1){const{$}=window.jQuery?{$:window.jQuery}:{$:window.parent.$};if(!$)return;const t=$(window.parent.document).find('#acu-data-area');if(!t.length)return;const o=a.value;!e&&o&&w.value[o]||setTimeout(()=>{const e=t[0].scrollHeight,a=($(window.parent).height()||800)-200;let o=Math.min(e+20,a);o<200&&(o=200),t.css('height',o+'px')},100)},saveBallPosition:function(e){N.value=e},getBallPosition:function(){return N.value},resetBallPosition:function(){const e='undefined'!=typeof window?window.parent?.innerHeight??window.innerHeight:500;N.value={x:20,y:Math.max(100,e-150)}},setVisibleTabs:function(e){E.value=e},isTabVisible:function(e){return 0===E.value.length||E.value.includes(e)},toggleTabVisibility:function(e){const t=[...E.value],a=t.indexOf(e);a>-1?t.splice(a,1):t.push(e),E.value=t},resetVisibleTabs:function(){E.value=[]},tabOrder:B,setTabOrder:function(e){B.value=e},getSortedTabIds:ze,moveTab:function(e,t,a){const o=ze(a),n=o.indexOf(e);if(-1===n)return;const r=[...o];r.splice(n,1),r.splice(t,0,e),B.value=r},showTab:function(e){E.value.includes(e)||(E.value=[...E.value,e])},hideTab:function(e){E.value=E.value.filter(t=>t!==e)},resetTabConfig:function(){E.value=[],B.value=[]},syncNewTablesToVisibleTabs:function(e){if(0===E.value.length)return[];const t=e.filter(e=>!E.value.includes(e));return t.length>0&&(E.value=[...E.value,...t],console.info(`[ACU] æ£€æµ‹åˆ° ${t.length} ä¸ªæ–°è¡¨æ ¼ï¼Œå·²è‡ªåŠ¨æ·»åŠ åˆ°å¯è§åˆ—è¡¨:`,t)),t},rowEditDialog:j,widgetSettingsDialog:O,dashboardHistoryDialog:R,avatarCropDialog:H,widgetActionsDialog:Y,avatarManagerDialog:X,nodeConfigDialog:J,nodeLabelDialog:te,graphSettingsDialog:re,factionSettingsDialog:le,settingsDialog:ie,directorDialog:ce,inputFloorDialog:se,purgeRangeDialog:ue,advancedPurgeDialog:de,manualUpdateDialog:me,historyDialog:fe,tabsPopup:ge,presetSaveDialog:ve,openRowEditDialog:function(e){j.props={...e},j.visible=!0},closeRowEditDialog:function(){j.visible=!1},openWidgetSettingsDialog:function(e){O.props={...e},O.visible=!0},closeWidgetSettingsDialog:function(){O.visible=!1},openDashboardHistoryDialog:function(e){R.props={...e},R.visible=!0},closeDashboardHistoryDialog:function(){R.visible=!1},switchFromRowEditToHistory:function(){R.props={tableName:j.props.tableName,tableId:j.props.tableId,rowIndex:j.props.rowIndex,currentRowData:j.props.currentRowData,titleColIndex:0},j.visible=!1,R.visible=!0},openAvatarCropDialog:function(e,t){H.props={imageUrl:e.imageUrl,name:e.name,initialOffsetX:e.initialOffsetX??50,initialOffsetY:e.initialOffsetY??50,initialScale:e.initialScale??150,initialInvert:e.initialInvert??!1,showInvertOption:e.showInvertOption??!1},W.value=t.onApply,G.value=t.onUpload??null,H.visible=!0},closeAvatarCropDialog:Ie,handleAvatarCropApply:function(e){W.value&&W.value(e),Ie()},handleAvatarCropUpload:function(e){G.value&&G.value(e)},openWidgetActionsDialog:function(e){Y.props={...e},Y.visible=!0},closeWidgetActionsDialog:function(){Y.visible=!1},openAvatarManagerDialog:function(e,t){X.props={...e},q.value=t.onUpdate??null,K.value=t.onLabelChange??null,X.visible=!0},closeAvatarManagerDialog:function(){X.visible=!1,q.value=null,K.value=null},handleAvatarManagerUpdate:function(){q.value&&q.value()},handleAvatarManagerLabelChange:function(){K.value&&K.value()},openNodeConfigDialog:function(e,t){J.props={...e},Q.value=t.onConfirm,Z.value=t.onResetToFullName,ee.value=t.onStyleUpdate??null,J.visible=!0},closeNodeConfigDialog:_e,handleNodeConfigConfirm:function(e,t,a){Q.value&&Q.value(e,t,a),_e()},handleNodeConfigResetToFullName:function(e,t){Z.value&&Z.value(e,t),_e()},handleNodeConfigStyleUpdate:function(e){ee.value&&ee.value(e)},openNodeLabelDialog:function(e,t){te.props={...e},ae.value=t.onApply,oe.value=t.onReset,te.visible=!0},closeNodeLabelDialog:ne,handleNodeLabelApply:function(e){ae.value&&ae.value(e.selectedIndices),ne()},handleNodeLabelReset:function(){oe.value&&oe.value(),ne()},openGraphSettingsDialog:function(e=[]){re.props.factions=e,re.visible=!0},closeGraphSettingsDialog:function(){re.visible=!1},openFactionSettingsDialog:function(e,t){le.props={factionId:e,factionName:t},le.visible=!0},closeFactionSettingsDialog:function(){le.visible=!1},openSettingsDialog:Me,closeSettingsDialog:function(){ie.value=!1},openDirectorDialog:function(){ce.value=!0},closeDirectorDialog:function(){ce.value=!1},openInputFloorDialog:function(e=0){se.props.currentFloor=e,se.visible=!0},closeInputFloorDialog:function(){se.visible=!1},openPurgeRangeDialog:function(e=0){ue.props.maxFloor=e,ue.visible=!0},closePurgeRangeDialog:function(){ue.visible=!1},openAdvancedPurgeDialog:function(e,t,a){de.props={...e},a&&(de.state.selectedTableKeys=[...a.selectedTableKeys]),pe.value=t.onConfirm,de.visible=!0},closeAdvancedPurgeDialog:Ue,handleAdvancedPurgeConfirm:function(e){pe.value&&pe.value(e),Ue()},openManualUpdateDialog:function(){me.value=!0},closeManualUpdateDialog:function(){me.value=!1},openHistoryDialog:function(e){fe.props={...e},fe.visible=!0},closeHistoryDialog:function(){fe.visible=!1},openTabsPopup:function(){ge.value=!0},closeTabsPopup:function(){ge.value=!1},toggleTabsPopup:function(){ge.value=!ge.value},openPresetSaveDialog:function(e,t){ve.props={...e},be.value=t.onSave,ve.visible=!0},closePresetSaveDialog:$e,handlePresetSave:function(e){be.value&&be.value(e),$e()},categorySelectDialog:he,tagPreEditDialog:xe,tagManagerDialog:ye,openCategorySelectDialog:function(e){he.props={...e},he.visible=!0},closeCategorySelectDialog:function(){he.visible=!1},openTagPreEditDialog:function(e){xe.props={...e},xe.visible=!0},closeTagPreEditDialog:function(){xe.visible=!1},openTagManagerDialog:function(e,t){ye.props={...e},we.value=t??null,ye.visible=!0},closeTagManagerDialog:Le,handleTagManagerSave:function(e,t){we.value&&we.value(e,t),Le()},iconSelectDialog:ke,openIconSelectDialog:function(e,t){ke.props={...e},Ce.value=t.onSelect,ke.visible=!0},closeIconSelectDialog:Ne,handleIconSelect:function(e){Ce.value&&Ce.value(e),Ne()},divinationOverlay:Ve,openDivinationOverlay:function(e,t=!1){Ve.result=e,Ve.isQuickRerollMode=t,Ve.visible=!0},closeDivinationOverlay:function(){Ve.visible=!1,Ve.isQuickRerollMode=!1},promptEditorDialog:Ee,openPromptEditorDialog:function(e){Ee.props.prompt=e,Ee.visible=!0},closePromptEditorDialog:function(){Ee.visible=!1},initDivinationSystem:async function(){const e=(0,l.E)();e.isLoaded||(e.loadConfig(),await e.loadFromWorldbook())},openDivinationSettingsDialog:()=>{Me('divination')},aiNotifySignal:(0,n.computed)(()=>Pe.value),triggerAiNotify:function(){Pe.value++,Fe.value=!1},isAiGenerating:(0,n.computed)(()=>Fe.value),setAiGenerating:function(e){Fe.value=e}}})},7141(e,t,l){l.d(t,{default:()=>k}),l.r(t);var i=l(4061),c=l(953),s=l(1037),u=l(2448),d=l(6758),p=l(6314),m=l(1768),f=l(7499);const g={class:'acu-relationship-graph'},v={key:1,class:'acu-graph-legend'},b={class:'label'},h={class:'acu-graph-toolbar'},x={key:2,class:'acu-graph-empty'},y='acu_graph_config',w=(0,i.defineComponent)({__name:'RelationshipGraph',props:{relationshipTable:{default:null},characterTables:{default:()=>[]},factionTable:{default:null},allTables:{default:()=>[]},showLegend:{type:Boolean,default:!0},initialLayout:{default:'fcose'}},emits:['node-click','edge-click'],setup(e,{expose:t,emit:l}){a.use(n),a.use(o),r(a);const w=(0,d.JH)(),k=(0,d.j_)(),C=(0,d.zI)(),N=(0,d.Ct)(),V=(0,s.o)(),E=(0,i.ref)(new Map),B=(0,i.ref)(new Map),S=(0,i.ref)(null),T=e,D=l,A=(0,i.ref)(null);let I=null;const M=(0,i.ref)(!1),U=(0,i.ref)(''),L=(0,i.ref)(null),P=(0,i.ref)(null),F=(0,i.ref)(new Set);const j=(0,i.ref)(R().lastLayout||T.initialLayout),O=(0,i.ref)(null);function R(){try{const e=getVariables({type:'chat'})[y]||{};return e.positions&&!e.layoutPositions&&(console.info('[RelationshipGraph] è¿ç§»æ—§æ ¼å¼ä½ç½®æ•°æ®åˆ° fcose'),e.layoutPositions={fcose:e.positions},delete e.positions,H(e)),e}catch(e){return console.warn('[RelationshipGraph] è·å–èŠå¤©å˜é‡å¤±è´¥:',e),{}}}function H(e){try{insertOrAssignVariables({[y]:e},{type:'chat'})}catch(e){console.warn('[RelationshipGraph] ä¿å­˜èŠå¤©å˜é‡å¤±è´¥:',e)}}function W(e){const t=e||j.value;return R().layoutPositions?.[t]}function G(e,t){try{const a=window.parent?.document||document,o=a.querySelector('.acu-wrapper');if(o){const t=getComputedStyle(o).getPropertyValue(e).trim();if(t)return t}return getComputedStyle(a.documentElement).getPropertyValue(e).trim()||t}catch{return t}}function Y(){return{textMain:G('--acu-text-main','#333333'),textSub:G('--acu-text-sub','#666666'),cardBg:G('--acu-card-bg','#ffffff'),border:G('--acu-border','#e0e0e0'),titleColor:G('--acu-title-color','#d35400'),bgPanel:G('--acu-bg-panel','#e6e2d3'),btnBg:G('--acu-btn-bg','#dcd0c0'),highlight:G('--acu-highlight','#d35400'),fontFamily:G('--acu-font-family','Source Han Sans SC, sans-serif')}}async function X(){const e=Y().fontFamily.split(',')[0].trim().replace(/['"]/g,'');if(e)try{const t=window.parent?.document||document;await t.fonts.load(`16px "${e}"`),console.info('[RelationshipGraph] å­—ä½“é¢„åŠ è½½å®Œæˆ:',e)}catch(t){console.warn('[RelationshipGraph] å­—ä½“é¢„åŠ è½½å¤±è´¥:',e,t)}}const q=(0,i.computed)(()=>(0,m.ev)()),K=(0,i.computed)(()=>{if(!C.config.showBackground)return{enabled:!1,style:{}};const e=N.backgroundConfig,t=S.value||e.externalUrl||'';if(!e.enabled||!t)return{enabled:!1,style:{}};const a=(e.scale||100)/100;return{enabled:!0,style:{backgroundImage:`url(${t})`,backgroundPosition:'center center',backgroundSize:'auto'===e.size?'100%':e.size,backgroundRepeat:'no-repeat',transform:`translate(${e.offsetX||0}%, ${e.offsetY||0}%) scale(${a})`,transformOrigin:'center center',opacity:e.opacity/100,filter:e.blur>0?`blur(${e.blur}px)`:'none',position:'absolute',top:'0',left:'0',width:'100%',height:'100%',zIndex:'0',pointerEvents:'none'}}}),J=(0,i.computed)(()=>{const e=C.getLegendConfig();if(e.enabled&&e.items?.length)return e.items.map(e=>({label:e.label,color:e.color,keywords:e.keywords}))}),Q=(0,i.computed)(()=>{console.info('[RelationshipGraph] è§£ææ•°æ® - props:',{relationshipTable:T.relationshipTable?.name,characterTablesCount:T.characterTables?.length,characterTablesNames:T.characterTables?.map(e=>e.name),factionTable:T.factionTable?.name,aliasMapSize:B.value.size,customLegendEnabled:!!J.value});const e=(0,m.iF)(T.relationshipTable,T.characterTables,T.factionTable,B.value,J.value);if(console.info('[RelationshipGraph] ä¸“ç”¨å…³ç³»è¡¨è§£æç»“æœ:',{nodeCount:e.nodeCount,edgeCount:e.edgeCount,warnings:e.warnings}),0===e.nodeCount&&T.characterTables&&T.characterTables.length>0){console.info('[RelationshipGraph] æ— ä¸“ç”¨å…³ç³»è¡¨ï¼Œå°è¯•ä»è§’è‰²è¡¨å†…åµŒå­—æ®µè§£æ');const e=(0,m.Zg)(T.characterTables,T.factionTable,B.value,J.value);return console.info('[RelationshipGraph] å†…åµŒå­—æ®µè§£æç»“æœ:',{nodeCount:e.nodeCount,edgeCount:e.edgeCount,warnings:e.warnings}),e}return e}),Z=(0,i.computed)(()=>Q.value.nodeCount>0),ee=(0,i.computed)(()=>{const{factionList:e,characterToFaction:t}=(0,m.Y3)(T.allTables||[],T.characterTables||[]);return e.filter(e=>{for(const[_,a]of t)if(a===e)return!0;return!1})});function te(){k.setActiveTab(d.H6)}function ae(e){switch(e){case'cola':return{name:'fcose',quality:'proof',randomize:!1,animate:!0,animationDuration:500,fit:!0,padding:30,nodeSeparation:75,idealEdgeLength:100,edgeElasticity:.45,nestingFactor:.1,gravity:.25,numIter:2500,nodeRepulsion:4500,tilingPaddingVertical:10,tilingPaddingHorizontal:10};case'circle':return{name:'concentric',concentric:e=>O.value&&e.id()===O.value?100:O.value||'protagonist'!==e.data('type')?1:100,levelWidth:()=>1,minNodeSpacing:80,animate:!0,animationDuration:500,fit:!0,padding:30};default:return{name:'fcose',quality:'proof',randomize:!1,animate:!0,animationDuration:500,fit:!0,padding:30,nodeSeparation:100,idealEdgeLength:120,edgeElasticity:.45,nestingFactor:.1,gravity:.25,numIter:2500,nodeRepulsion:4500}}}function oe(){if(!A.value)return;const e=Y(),t=W(),o=t?Object.keys(t).length:0,n=Q.value.nodeCount,r=o>0&&n>0&&o>=.8*n;console.info('[RelationshipGraph] å¸ƒå±€æ£€æŸ¥:',{ä¿å­˜çš„ä½ç½®æ•°:o,å½“å‰èŠ‚ç‚¹æ•°:n,ä½¿ç”¨ä¿å­˜ä½ç½®:r});const l=Q.value.elements.map(e=>{const a=e.data?.id;if(a&&!e.data?.source){const o=E.value.get(a);let n;r&&t&&(t[a]?(console.info('[RelationshipGraph] æ¢å¤èŠ‚ç‚¹ä½ç½®:',a,t[a]),n=t[a]):n={x:200*(Math.random()-.5),y:200*(Math.random()-.5)});const l=e.data?.fullName||e.data?.id||'',i=C.getNodeStyleOverride(a),c=i?.size??C.config.nodeSize,s=i?.shape??'ellipse',u=i?.borderWidth??0,d=Y().textMain,p=i?.borderColor??d;return{...e,data:{...e.data,avatarUrl:o?.url||void 0,avatarOffsetX:o?.offsetX??50,avatarOffsetY:o?.offsetY??50,avatarScale:o?.scale??150,fullName:l,nodeSize:c,nodeShape:s,nodeBorderWidth:u,nodeBorderColor:p},...n?{position:n}:{}}}return e});I=a({container:A.value,elements:l,style:[{selector:'node',style:{label:'data(label)','text-valign':'center','text-halign':'center','text-wrap':'wrap','text-max-width':C.config.nodeSize-4+'px','background-color':e.btnBg,color:e.textMain,'font-family':e.fontFamily,'font-size':e=>{const t=(e.data('label')||'').length,a=C.config.nodeSize;let o;return o=t<=1?.6:t<=2?.45:t<=3?.35:t<=4?.28:.22,`${Math.round(a*o)}px`},'font-weight':'bold',width:C.config.nodeSize,height:C.config.nodeSize,'border-width':1.5,'border-color':e.textMain}},{selector:'node.protagonist',style:{'background-color':e.highlight,color:e.textMain,'border-width':1.5,'border-color':e.textMain}},{selector:'node.character',style:{}},{selector:'node.faction',style:{'background-color':e.btnBg,color:e.textMain,'border-width':1.5,'border-color':e.textMain,shape:'round-rectangle',width:70,height:35,'font-size':'14px'}},{selector:'node.unknown',style:{'background-color':e.btnBg,color:e.textMain,'border-width':1.5,'border-color':e.textMain}},{selector:'node[avatarUrl]',style:{'background-color':'transparent','background-opacity':0,'border-width':0,width:C.config.nodeSize,height:C.config.nodeSize,label:''}},{selector:'edge',style:{'curve-style':'bezier','target-arrow-shape':'triangle','target-arrow-color':'data(color)','line-color':'data(color)','line-style':'solid',width:C.config.edgeWidth,label:'data(label)','font-size':`${C.config.relationLabelFontSize}px`,'font-family':e.fontFamily,'text-rotation':'autorotate','text-margin-y':-8,color:'#fff','text-background-color':'data(color)','text-background-opacity':.95,'text-background-padding':`${Math.max(3,Math.round(.25*C.config.relationLabelFontSize))}px`,'text-background-shape':'roundrectangle'}},{selector:'edge[lineStyle = "dashed"]',style:{'line-style':'dashed'}},{selector:'edge[?bidirectional]',style:{'source-arrow-shape':'triangle','source-arrow-color':'data(color)','curve-style':'straight'}},{selector:'node:selected',style:{'border-width':4,'border-color':'#FFC107','overlay-opacity':.2,'overlay-color':'#FFC107'}},{selector:'edge:selected',style:{width:4,'line-color':'#FFC107','target-arrow-color':'#FFC107'}},{selector:'.search-dimmed',style:{display:'none'}}],layout:r?{name:'preset'}:ae(j.value),userZoomingEnabled:!0,userPanningEnabled:!0,boxSelectionEnabled:!1,minZoom:.3,maxZoom:3}),I.on('tap','node',e=>{const t=e.target,a=t.id(),o=t.data('type')||'unknown';M.value?ie(a):('circle'===j.value&&function(e){if(!I)return;if(O.value===e)return;console.info(`[RelationshipGraph] åˆ‡æ¢ç¯å½¢ä¸­å¿ƒèŠ‚ç‚¹: ${O.value||'(ä¸»è§’)'} â†’ ${e}`),O.value=e;I.layout(ae('circle')).run()}(a),D('node-click',{id:a,type:o}))}),I.on('dbltap','node:childless',e=>{const t=e.target;t.hasClass('faction-container')||function(e,t){const a=fe()[e],o=a?.displayLabel||t,n=a?.selectedIndices||function(e){const t=function(e){if((0,m.Et)(e))return e.split(' ').filter(Boolean);return e.split('')}(e);if((0,m.Et)(e))return[0];return t.length>0?[t.length-1]:[]}(t);k.openNodeConfigDialog({nodeId:e,fullName:t,currentLabel:o,selectedIndices:n},{onConfirm:be,onResetToFullName:he,onStyleUpdate:xe})}(t.id(),t.id())}),I.on('dbltap','node.faction-container',e=>{const t=e.target,a=t.id(),o=t.data('label')||a.replace('faction-container-','');k.openFactionSettingsDialog(a,o)}),I.on('tap','edge',e=>{const t=e.target;D('edge-click',{source:t.source().id(),target:t.target().id(),relation:t.data('label')||''})});const i=(0,c.Q0)(()=>{pe()},1e3);I.on('dragfree','node',()=>{i()}),r&&I.fit(void 0,30),ve(),'cola'===j.value&&(console.info('[RelationshipGraph] åˆå§‹åŒ–æ—¶æ£€æµ‹åˆ° cola å¸ƒå±€ï¼Œåˆ›å»ºåŠ¿åŠ›å®¹å™¨'),ue(),we()),ke(),I.nodeHtmlLabel([{query:'node[avatarUrl]',halign:'center',valign:'center',halignBox:'center',valignBox:'center',tpl:e=>{const t=e.avatarUrl||'',a=e.avatarOffsetX??50,o=e.avatarOffsetY??50,n=e.avatarScale??150,r=e.fullName||e.id||'',l=C.config.nameLabelFontSize||14,i=e.nodeSize||C.config.nodeSize||50,c=e.nodeShape||'ellipse',s=e.nodeBorderWidth??0,u=Y().textMain;let d,p='none';'ellipse'===c?d='50%':'round-rectangle'===c?d='12px':'hexagon'===c?(d='0',p='polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)'):d='0';const m=i-2*s;return`\n          <div class="acu-graph-avatar-wrapper">\n            <div class="acu-graph-avatar" style="\n              width: ${m}px;\n              height: ${m}px;\n              border-radius: ${d};\n              border: ${s}px solid ${e.nodeBorderColor??u};\n              background-image: url('${t}');\n              background-position: ${a}% ${o}%;\n              background-size: ${n}%;\n              background-repeat: no-repeat;\n              box-sizing: content-box;\n              clip-path: ${p};\n            "></div>\n            <div class="acu-graph-avatar-name" style="font-size: ${l}px;">${r}</div>\n          </div>\n        `}}])}function ne(){I&&(I.elements().remove(),I.add(Q.value.elements),I.layout(ae(j.value)).run())}function re(){M.value=!M.value,M.value?setTimeout(()=>{L.value?.focus()},100):ce()}function le(e){if(!I)return;const t=e.trim().toLowerCase();if(!t)return void ce();const a=I.nodes().filter(e=>{if(e.hasClass('faction-container')||e.hasClass('hidden-in-cola'))return!1;const a=(e.id()||'').toLowerCase(),o=(e.data('label')||'').toLowerCase(),n=(e.data('fullName')||'').toLowerCase();return a.includes(t)||o.includes(t)||n.includes(t)}).first();a&&a.length>0&&ie(a.id())}function ie(e){if(!I)return;const t=I.getElementById(e);if(!t||0===t.length)return;P.value=e,U.value=t.data('label')||e,I.batch(()=>{0===F.value.size&&I.elements('.hidden-in-cola').forEach(e=>{F.value.add(e.id())});let e=t.neighborhood('node').filter(e=>!e.hasClass('hidden-in-cola')).add(t),a=t.connectedEdges().filter(e=>!e.hasClass('hidden-in-cola'));if('cola'===j.value){const t=new Set;e.forEach(e=>{const a=e.parent();a.length>0&&a.hasClass('faction-container')&&t.add(a.id())}),t.forEach(t=>{const a=I.getElementById(t);a.length>0&&(e=e.add(a))}),I.edges('.faction-edge').forEach(e=>{const o=e.source().id(),n=e.target().id();t.has(o)&&t.has(n)&&(a=a.add(e))})}I.elements().addClass('search-dimmed'),e.removeClass('search-dimmed'),a.removeClass('search-dimmed')});const a=I.elements().not('.search-dimmed');I.animate({fit:{eles:a,padding:50},duration:400})}function ce(){I&&(P.value=null,U.value='',I.batch(()=>{I.elements().removeClass('search-dimmed'),F.value.size>0&&F.value.forEach(e=>{const t=I.getElementById(e);t.length>0&&t.addClass('hidden-in-cola')})}),F.value.clear())}function se(){I?.fit(void 0,30)}function ue(){if(!I)return!1;const e=Y(),{factionList:t,characterToFaction:a,factionRelations:o}=(0,m.Y3)(T.allTables||[],T.characterTables||[]);if(0===t.length)return console.info('[RelationshipGraph] æœªæ‰¾åˆ°åŠ¿åŠ›æ•°æ®ï¼Œè·³è¿‡å®¹å™¨åˆ›å»º'),!1;console.info(`[RelationshipGraph] åˆ›å»ºåŠ¿åŠ›å®¹å™¨: ${t.length} ä¸ªåŠ¿åŠ›`),I.nodes('.faction-container').remove();for(const e of t){const t=I.getElementById(e);t&&t.length>0&&!t.hasClass('faction-container')&&(t.addClass('hidden-in-cola'),console.info(`[RelationshipGraph] éšè—ä¸åŠ¿åŠ›åŒåçš„èŠ‚ç‚¹: "${e}"`))}for(const e of t){let o=!1;for(const[_,t]of a)if(t===e){o=!0;break}if(!o){console.info(`[RelationshipGraph] è·³è¿‡æ— æˆå‘˜åŠ¿åŠ›: "${e}"`);continue}let n;if(C.hasFactionColor(e))n=C.getFactionColor(e,t);else{const a=t.indexOf(e);n=a>=0&&a<8?C.getFactionColor(e,t):p.X8}I.add({group:'nodes',data:{id:`faction-container-${e}`,label:e,type:'faction-container',borderColor:n.border,backgroundColor:n.background},classes:'faction-container'})}a.forEach((e,t)=>{const a=I?.getElementById(t);a&&a.length>0&&(a.move({parent:`faction-container-${e}`}),console.info(`[RelationshipGraph] è§’è‰² "${t}" â†’ åŠ¿åŠ› "${e}"`))});let n=0;const r=new Set;for(const e of o){const t=`faction-container-${e.source}`,a=`faction-container-${e.target}`,l=[e.source,e.target].sort().join('<->');if(!r.has(l)&&(I.getElementById(t).length>0&&I.getElementById(a).length>0)){const i=o.find(t=>t.source===e.target&&t.target===e.source),c=i&&i.relation===e.relation;c&&r.add(l);const s=(0,m.cq)(e.relation);I.add({group:'edges',data:{id:'faction-edge-'+n++,source:t,target:a,label:e.relation,color:s.color,level:s.level,bidirectional:c},classes:'faction-edge'}),console.info(`[RelationshipGraph] åŠ¿åŠ›è¾¹: "${e.source}" ${c?'â†”':'â†’'} "${e.target}" (${e.relation})`)}}return I.style().selector('node.faction-container').style({'background-color':'data(backgroundColor)','background-opacity':1,'border-width':2,'border-style':'dashed','border-color':'data(borderColor)',shape:'roundrectangle',padding:'20px',label:'data(label)','text-valign':'top','text-halign':'center','font-size':`${C.config.factionLabelFontSize}px`,'font-family':e.fontFamily,'font-weight':'bold',color:'data(borderColor)','text-background-color':'data(backgroundColor)','text-background-opacity':1,'text-background-padding':`${Math.max(4,Math.round(.4*C.config.factionLabelFontSize))}px`,'text-background-shape':'roundrectangle','text-border-width':2,'text-border-color':'data(borderColor)','text-margin-y':-8}).selector('edge.faction-edge').style({'curve-style':'bezier','target-arrow-shape':'triangle','target-arrow-color':'data(color)','line-color':'data(color)','line-style':'solid',width:3,label:'data(label)','font-size':`${C.config.relationLabelFontSize}px`,'font-family':e.fontFamily,'text-rotation':'autorotate','text-margin-y':-10,color:'#fff','text-background-color':'data(color)','text-background-opacity':.95,'text-background-padding':`${Math.max(3,Math.round(.25*C.config.relationLabelFontSize))}px`,'text-background-shape':'roundrectangle'}).selector('node.hidden-in-cola').style({display:'none'}).selector('edge.hidden-in-cola').style({display:'none'}).update(),I.nodes('.hidden-in-cola').connectedEdges().addClass('hidden-in-cola'),!0}function de(e){if(!I)return;if(e===j.value)return;const t=j.value;'cola'===t&&'cola'!==e&&I&&(I.nodes().forEach(e=>{e.parent().length>0&&e.parent().is('.faction-container')&&e.move({parent:null})}),I.elements('.hidden-in-cola').removeClass('hidden-in-cola'),I.edges('.faction-edge').remove(),I.nodes('.faction-container').remove(),console.info('[RelationshipGraph] å·²ç§»é™¤åŠ¿åŠ›å®¹å™¨')),j.value=e,console.info(`[RelationshipGraph] å¸ƒå±€åˆ‡æ¢: ${t} â†’ ${e}`);const a=R();a.lastLayout=e,H(a),'cola'===e&&(ue(),we());const o=function(e){const t=e||j.value,a=R();console.info(`[RelationshipGraph] hasSavedPositions(${t}):`,{layoutPositions:a.layoutPositions?Object.keys(a.layoutPositions):'undefined',targetLayoutData:a.layoutPositions?.[t]?Object.keys(a.layoutPositions[t]).length+' ä¸ªèŠ‚ç‚¹':'æ— '});const o=a.layoutPositions?.[t];return!!(o&&Object.keys(o).length>0)}(e);if(console.info(`[RelationshipGraph] æ£€æŸ¥ [${e}] æ˜¯å¦æœ‰ä¿å­˜ä½ç½®: ${o}`),o)console.info(`[RelationshipGraph] æ¢å¤ [${e}] ä¿å­˜çš„ä½ç½®`),function(e){if(!I)return!1;const t=e||j.value,a=W(t);if(!a)return!1;const o=Object.keys(a)[0],n=a[o];console.info(`[RelationshipGraph] å‡†å¤‡æ¢å¤ [${t}] ä½ç½®ï¼Œå…± ${Object.keys(a).length} ä¸ªèŠ‚ç‚¹ (é¦–èŠ‚ç‚¹ "${o}": ä¿å­˜=${n?.x?.toFixed(0)}, ${n?.y?.toFixed(0)})`);let r=!1,l=0;I.nodes().forEach(e=>{const t=e.id(),o=a[t];if(o){const a=e.position();console.info(`[RelationshipGraph] è®¾ç½®èŠ‚ç‚¹ "${t}": ç›®æ ‡=(${o.x?.toFixed?.(0)??o.x}, ${o.y?.toFixed?.(0)??o.y}), å½“å‰=(${a.x.toFixed(0)}, ${a.y.toFixed(0)})`),e.position({x:o.x,y:o.y});const n=e.position();console.info(`[RelationshipGraph] èŠ‚ç‚¹ "${t}": (${a.x.toFixed(0)}, ${a.y.toFixed(0)}) â†’ (${n.x.toFixed(0)}, ${n.y.toFixed(0)})`),r=!0,l++}}),r&&(console.info(`[RelationshipGraph] ä» [${t}] æ¢å¤äº† ${l} ä¸ªèŠ‚ç‚¹ä½ç½®`),I.fit(void 0,30))}(e);else{console.info(`[RelationshipGraph] [${e}] æ— ä¿å­˜ä½ç½®ï¼Œè¿è¡Œå¸ƒå±€ç®—æ³•`);I.layout(ae(e)).run()}}function pe(e){if(!I)return;const t=e||j.value,a={};let o=!0;if(I.nodes().forEach(e=>{const t=e.position();t&&isFinite(t.x)&&isFinite(t.y)&&(a[e.id()]={x:t.x,y:t.y},0===t.x&&0===t.y||(o=!1))}),o&&Object.keys(a).length>0)return void console.warn('[RelationshipGraph] è·³è¿‡ä¿å­˜ï¼šæ‰€æœ‰ä½ç½®éƒ½æ˜¯ (0, 0)ï¼Œå¸ƒå±€å¯èƒ½æœªå®Œæˆ');const n=Object.keys(a)[0],r=a[n];console.info(`[RelationshipGraph] ä¿å­˜èŠ‚ç‚¹ä½ç½®åˆ° [${t}]:`,Object.keys(a).length,`ä¸ªèŠ‚ç‚¹ (é¦–èŠ‚ç‚¹ "${n}": ${r?.x?.toFixed(0)}, ${r?.y?.toFixed(0)})`);const l=R();l.layoutPositions||(l.layoutPositions={}),l.layoutPositions[t]=a,H(l)}function me(){const e=R();e.layoutPositions&&(delete e.layoutPositions[j.value],H(e));const t=j.value;console.info(`[RelationshipGraph] æ¸…é™¤ [${t}] å¸ƒå±€ä½ç½®ï¼Œé‡æ–°è¿è¡Œå¸ƒå±€`);const a=ae(t);'fcose'!==t&&'cola'!==t||(a.randomize=!0);const o=I?.layout(a);o?.one('layoutstop',()=>{pe(t)}),o?.run()}function fe(){return R().labels||{}}function ge(e){const t=R();t.labels=e,H(t)}function ve(){if(!I)return;const e=fe();I.nodes().forEach(t=>{const a=t.id(),o=e[a];o&&o.displayLabel?t.data('label',o.displayLabel):t.data('label',a)}),console.info('[RelationshipGraph] æ ‡ç­¾é…ç½®å·²åº”ç”¨ï¼Œå…±é…ç½®:',Object.keys(e).length,'ä¸ªèŠ‚ç‚¹')}function be(e,t,a){const o=fe();if(o[e]={displayLabel:t,selectedIndices:a},ge(o),I){const a=I.getElementById(e);a&&a.data('label',t)}}function he(e,t){const a=fe();if(delete a[e],ge(a),I){const a=I.getElementById(e);a&&a.data('label',t)}}function xe(e){if(!I)return;const t=I.getElementById(e);if(!t||0===t.length)return;const a=C.getNodeStyleOverride(e),o=C.config.nodeSize||50,n=a?.size??o,r=a?.borderWidth??0,l=a?.borderColor??'transparent',i=a?.shape??'ellipse';t.style({width:n,height:n}),t.data('nodeSize',n),t.data('nodeBorderWidth',r),t.data('nodeBorderColor',l),t.data('nodeShape',i),t.trigger('data'),console.info(`[RelationshipGraph] åº”ç”¨èŠ‚ç‚¹æ ·å¼è¦†ç›–: ${e}, size=${n}, border=${r}px ${l}, shape=${i}`)}function ye(){if(!I)return;const e=C.config.nodeOverrides||{},t=Object.entries(e);0!==t.length&&(I.batch(()=>{for(const[e,a]of t){const t=I.getElementById(e);t&&0!==t.length&&(void 0!==a.size&&(t.style({width:a.size,height:a.size}),t.data('nodeSize',a.size)),void 0!==a.borderWidth&&t.data('nodeBorderWidth',a.borderWidth),void 0!==a.borderColor&&t.data('nodeBorderColor',a.borderColor),void 0!==a.shape&&t.data('nodeShape',a.shape))}}),console.info(`[RelationshipGraph] åº”ç”¨äº† ${t.length} ä¸ªèŠ‚ç‚¹æ ·å¼è¦†ç›–`))}function we(){if(!I)return;const e=I.nodes('.faction-container');if(0===e.length)return;Y();const{factionList:t}=(0,m.Y3)(T.allTables||[],T.characterTables||[]);I.batch(()=>{e.forEach(e=>{const a=e.id(),o=a.replace('faction-container-',''),n=C.getFactionOverride(a)||C.getFactionColor(o,t);e.data('borderColor',n.border),e.data('backgroundColor',n.background);const r={},l=n.opacity??function(e,t=10){const a=e.match(/rgba?\s*\([^)]+,\s*([\d.]+)\s*\)/);return a?Math.round(100*parseFloat(a[1])):t}(n.background,10);r['background-opacity']=l/100;const i=n.labelPosition??'top';if('none'===i)r['text-opacity']=0,r['text-background-opacity']=0;else switch(r['text-opacity']=1,r['text-background-opacity']=1,r.label=o,r['text-valign']=function(e){switch(e){case'top':case'top-left':case'top-right':case'none':default:return'top';case'bottom':case'bottom-left':case'bottom-right':return'bottom'}}(i),r['text-halign']=function(e){switch(e){case'top-left':case'bottom-left':return'left';case'top-right':case'bottom-right':return'right';default:return'center'}}(i),i){case'top':default:r['text-margin-y']=-8,r['text-margin-x']=0;break;case'bottom':r['text-margin-y']=8,r['text-margin-x']=0;break;case'top-left':r['text-valign']='top',r['text-halign']='left',r['text-margin-x']=25,r['text-margin-y']=25;break;case'top-right':r['text-valign']='top',r['text-halign']='right',r['text-margin-x']=-25,r['text-margin-y']=25;break;case'bottom-left':r['text-valign']='bottom',r['text-halign']='left',r['text-margin-x']=25,r['text-margin-y']=-25;break;case'bottom-right':r['text-valign']='bottom',r['text-halign']='right',r['text-margin-x']=-25,r['text-margin-y']=-25}void 0!==n.labelFontSize&&(r['font-size']=`${n.labelFontSize}px`),r['text-background-color']=n.background,r['text-background-opacity']=l/100,r.color=n.border,r['text-border-color']=n.border,e.style(r)})}),console.info(`[RelationshipGraph] åº”ç”¨äº† ${e.length} ä¸ªåŠ¿åŠ›å®¹å™¨æ ·å¼`)}function ke(){I&&(console.info('[RelationshipGraph] åº”ç”¨æ‰€æœ‰é…ç½®...'),I.batch(()=>{ye(),we()}),I.style().update(),console.info('[RelationshipGraph] æ‰€æœ‰é…ç½®åº”ç”¨å®Œæˆ'))}const Ce=(0,i.computed)(()=>Q.value&&Q.value.elements?Q.value.elements.filter(e=>!e.data.source&&!e.data.target).map(e=>({id:e.data.id,name:e.data.id,label:e.data.label||e.data.id,type:e.data.type||'character'})):[]),Ne=(0,i.computed)(()=>ee.value.map((e,t)=>({id:`faction_${t}`,name:e})));function Ve(){k.openGraphSettingsDialog(ee.value)}async function Ee(){try{const e=await V.getAliasMap();B.value=e,console.info(`[RelationshipGraph] åˆ«åæ˜ å°„åŠ è½½å®Œæˆ: ${e.size} ä¸ªåˆ«å`)}catch(e){console.warn('[RelationshipGraph] åŠ è½½åˆ«åæ˜ å°„å¤±è´¥:',e)}}async function Be(){const e=Q.value.elements.filter(e=>!e.data.source&&!e.data.target),t=new Map;for(const a of e){const e=a.data.id;if(e)try{const a=await V.getAvatarUrl(e);if(a){const o=await V.getAvatarDisplayConfig(e);t.set(e,{url:a,offsetX:o.offsetX,offsetY:o.offsetY,scale:o.scale})}}catch(t){console.warn(`[RelationshipGraph] è·å–å¤´åƒå¤±è´¥: ${e}`,t)}}E.value=t,console.info(`[RelationshipGraph] å¤´åƒé¢„åŠ è½½å®Œæˆ: ${t.size}/${e.length}`)}async function Se(){console.log('[RelationshipGraph] handleAvatarUpdate è¢«è°ƒç”¨'),await Ee(),await Be(),I&&(I.nodes().forEach(e=>{const t=e.id(),a=E.value.get(t);a?(e.data('avatarUrl',a.url),e.data('avatarOffsetX',a.offsetX),e.data('avatarOffsetY',a.offsetY),e.data('avatarScale',a.scale)):(e.removeData('avatarUrl'),e.removeData('avatarOffsetX'),e.removeData('avatarOffsetY'),e.removeData('avatarScale'))}),ve(),I.nodes().trigger('data'),I.style().update())}function Te(){console.log('[RelationshipGraph] handleLabelChange è¢«è°ƒç”¨'),I&&(ve(),I.style().update())}(0,i.watch)(()=>k.avatarManagerDialog.visible,e=>{if(!e){const{$}=(0,m.M1)();$('.acu-data-display').removeClass('has-modal')}}),(0,i.watch)(()=>C.config,()=>{!function(){if(!I)return;const e=C.config;console.info('[RelationshipGraph] å®æ—¶æ›´æ–°å›¾å½¢æ ·å¼'),I.batch(()=>{I.style().selector('node').style({width:e.nodeSize,height:e.nodeSize,'text-max-width':e.nodeSize-4+'px'}).selector('node[avatarUrl]').style({width:e.nodeSize,height:e.nodeSize}).selector('edge').style({width:e.edgeWidth,'font-size':`${e.relationLabelFontSize}px`}).selector('node.faction-container').style({'font-size':`${e.factionLabelFontSize}px`}).selector('edge.faction-edge').style({'font-size':`${e.relationLabelFontSize}px`}).update()}),ke()}()},{deep:!0}),(0,i.watch)(()=>C.config.nodeOverrides,()=>{I&&(ye(),I.style().update())},{deep:!0}),(0,i.watch)(()=>C.config.factionColors,()=>{I&&(we(),I.style().update())},{deep:!0}),(0,i.watch)(()=>C.config.legendConfig,()=>{I&&Z.value&&(console.info('[RelationshipGraph] å›¾ä¾‹é…ç½®å˜åŒ–ï¼Œé‡æ–°åº”ç”¨è¾¹é¢œè‰²'),I.batch(()=>{const e=Q.value.elements.filter(e=>e.data.source&&e.data.target);for(const t of e){const e=t.data.id;if(!e)continue;const a=I.getElementById(e);a&&a.length>0&&(a.data('color',t.data.color),a.data('level',t.data.level))}}),I.style().update())},{deep:!0}),(0,i.watch)(()=>[N.backgroundConfig.hasIndexedDBImage,N.backgroundConfig.externalUrl],()=>{Ae()});const De=(0,i.ref)(!1);async function Ae(){const e=N.backgroundConfig;if(S.value?.startsWith('blob:')&&((0,u.dQ)(S.value),S.value=null),e.externalUrl)S.value=e.externalUrl;else if(e.hasIndexedDBImage)try{const e=await(0,u.$H)(u.Aq);S.value=e}catch(e){console.warn('[RelationshipGraph] åŠ è½½èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',e),S.value=null}else S.value=null}function ze(){if(!I)return;const e=Y();I.batch(()=>{I.nodes().forEach(t=>{const a={'font-family':e.fontFamily,color:e.textMain,'border-width':1.5,'border-color':e.textMain};t.hasClass('protagonist')?a['background-color']=e.highlight:t.hasClass('faction-container')||t.data('avatarUrl')||(a['background-color']=e.btnBg),t.style(a)}),I.edges().forEach(t=>{t.style('font-family',e.fontFamily)})}),I.style().update(),console.info('[RelationshipGraph] èŠ‚ç‚¹é¢œè‰²å’Œå­—ä½“å·²æ›´æ–°')}return(0,i.onMounted)(async()=>{await Promise.all([Ee(),Ae()]),Z.value&&(await Be(),await X(),oe(),De.value=!0)}),(0,i.watch)(Z,async e=>{e&&!De.value&&A.value&&(console.info('[RelationshipGraph] æ•°æ®å‡†å¤‡å°±ç»ªï¼Œé¢„åŠ è½½å¤´åƒå’Œå­—ä½“...'),await Be(),await X(),console.info('[RelationshipGraph] åˆå§‹åŒ–å›¾å½¢'),oe(),De.value=!0)},{immediate:!0}),(0,i.onBeforeUnmount)(()=>{I?.destroy(),I=null,S.value?.startsWith('blob:')&&((0,u.dQ)(S.value),S.value=null)}),(0,i.watch)(()=>T.relationshipTable,()=>{I&&ne()},{deep:!0}),(0,i.watch)(()=>w.config.theme,()=>{I&&setTimeout(()=>{ze()},50)}),(0,i.watch)(()=>w.config.fontFamily,async()=>{I&&(await X(),ze())}),t({fitToView:se,zoomIn:function(){I&&I.zoom(1.2*I.zoom())},zoomOut:function(){I&&I.zoom(I.zoom()/1.2)},setLayout:de,refresh:function(){ne()},applyAllConfigs:ke,applyAllNodeStyleOverrides:ye,applyAllFactionStyles:we,openAvatarManager:function(){const{$}=(0,m.M1)();$('.acu-data-display').addClass('has-modal'),k.openAvatarManagerDialog({nodes:Ce.value,factions:Ne.value},{onUpdate:Se,onLabelChange:Te})}}),(e,t)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',g,[(0,i.createCommentVNode)(' èƒŒæ™¯å±‚ '),K.value.enabled?((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,class:'acu-graph-background',style:(0,i.normalizeStyle)(K.value.style)},null,4)):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' å›¾ä¾‹ï¼ˆé¡¶éƒ¨ï¼‰ '),(0,i.unref)(C).config.showLegend?((0,i.openBlock)(),(0,i.createElementBlock)('div',v,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(q.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.level,class:'acu-legend-item'},[(0,i.createElementVNode)('span',{class:(0,i.normalizeClass)(['dot',{dashed:e.isDashed}]),style:(0,i.normalizeStyle)({backgroundColor:e.isDashed?'transparent':e.color,borderColor:e.color})},null,6),(0,i.createElementVNode)('span',b,(0,i.toDisplayString)(e.emoji)+' '+(0,i.toDisplayString)(e.name),1)]))),128))])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' å›¾å®¹å™¨ï¼ˆä¸­é—´ï¼‰ '),(0,i.createElementVNode)('div',{ref_key:'containerRef',ref:A,class:'acu-graph-container'},null,512),(0,i.createCommentVNode)(' æœç´¢æ¡†ï¼ˆå·¥å…·æ ä¸Šæ–¹ï¼Œä»…æœç´¢æ¨¡å¼æ˜¾ç¤ºï¼‰ '),(0,i.createVNode)(i.Transition,{name:'acu-slide-up'},{default:(0,i.withCtx)(()=>[M.value?((0,i.openBlock)(),(0,i.createBlock)(f.A,{key:0,ref_key:'searchInputRef',ref:L,modelValue:U.value,'onUpdate:modelValue':t[0]||(t[0]=e=>U.value=e),class:'acu-graph-search-input',placeholder:'æœç´¢äººç‰©...',autofocus:!0,'show-result-count':!1,onSearch:le,onClear:ce},null,8,['modelValue'])):(0,i.createCommentVNode)('v-if',!0)]),_:1}),(0,i.createCommentVNode)(' å·¥å…·æ ï¼ˆåº•éƒ¨ï¼‰ '),(0,i.createElementVNode)('div',h,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-graph-btn',{active:M.value}]),title:'æœç´¢æ¨¡å¼',onClick:re},[...t[4]||(t[4]=[(0,i.createElementVNode)('i',{class:'fas fa-search'},null,-1)])],2),t[12]||(t[12]=(0,i.createElementVNode)('span',{class:'acu-toolbar-divider'},null,-1)),(0,i.createElementVNode)('button',{class:'acu-graph-btn',title:'é€‚åº”è§†å›¾',onClick:se},[...t[5]||(t[5]=[(0,i.createElementVNode)('i',{class:'fas fa-compress-arrows-alt'},null,-1)])]),t[13]||(t[13]=(0,i.createElementVNode)('span',{class:'acu-toolbar-divider'},null,-1)),(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-graph-btn',{active:'fcose'===j.value}]),title:'åŠ›å¯¼å‘å¸ƒå±€',onClick:t[1]||(t[1]=e=>de('fcose'))},[...t[6]||(t[6]=[(0,i.createElementVNode)('i',{class:'fas fa-project-diagram'},null,-1)])],2),(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-graph-btn',{active:'cola'===j.value}]),title:'åŠ¿åŠ›åˆ†ç»„å¸ƒå±€',onClick:t[2]||(t[2]=e=>de('cola'))},[...t[7]||(t[7]=[(0,i.createElementVNode)('i',{class:'fas fa-object-group'},null,-1)])],2),(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-graph-btn',{active:'circle'===j.value}]),title:'ç¯å½¢å¸ƒå±€',onClick:t[3]||(t[3]=e=>de('circle'))},[...t[8]||(t[8]=[(0,i.createElementVNode)('i',{class:'fas fa-circle-notch'},null,-1)])],2),t[14]||(t[14]=(0,i.createElementVNode)('span',{class:'acu-toolbar-divider'},null,-1)),(0,i.createElementVNode)('button',{class:'acu-graph-btn',title:'é‡ç½®å¸ƒå±€',onClick:me},[...t[9]||(t[9]=[(0,i.createElementVNode)('i',{class:'fas fa-undo'},null,-1)])]),t[15]||(t[15]=(0,i.createElementVNode)('span',{class:'acu-toolbar-divider'},null,-1)),(0,i.createElementVNode)('button',{class:'acu-graph-btn',title:'å›¾å½¢è®¾ç½®',onClick:(0,i.withModifiers)(Ve,['stop'])},[...t[10]||(t[10]=[(0,i.createElementVNode)('i',{class:'fas fa-cog'},null,-1)])]),t[16]||(t[16]=(0,i.createElementVNode)('span',{class:'acu-toolbar-divider'},null,-1)),(0,i.createElementVNode)('button',{class:'acu-graph-btn',title:'è¿”å›ä»ªè¡¨ç›˜',onClick:(0,i.withModifiers)(te,['stop'])},[...t[11]||(t[11]=[(0,i.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])])]),(0,i.createCommentVNode)(' ç©ºçŠ¶æ€ '),Z.value?(0,i.createCommentVNode)('v-if',!0):((0,i.openBlock)(),(0,i.createElementBlock)('div',x,[...t[17]||(t[17]=[(0,i.createElementVNode)('i',{class:'fas fa-project-diagram'},null,-1),(0,i.createElementVNode)('p',null,'æš‚æ— å…³ç³»æ•°æ®',-1),(0,i.createElementVNode)('p',{class:'hint'},'è¯·ç¡®ä¿å­˜åœ¨"å…³ç³»è¡¨"å¹¶åŒ…å«æœ‰æ•ˆæ•°æ®',-1)])]))]))}});l(492);const k=w},7285(e,t,a){a.d(t,{A:()=>u});var o=a(4015),n=a(3035),r=a(4061);const l='acu_global_tag_library',i={categories:[],tags:[]},c=[{name:'å…¨éƒ¨',icon:'',hasChildren:!1},{name:'æœªåˆ†ç±»',icon:'ğŸ“¦',hasChildren:!1}];function s(e){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const u=(0,n.defineStore)('acu-tag-library',()=>{const e=(0,r.ref)({...i}),t=(0,r.ref)(''),a=(0,r.ref)(''),n=(0,r.ref)(''),u=(0,r.ref)(!1);let d=null;const p=(0,r.ref)('normal'),m=(0,r.ref)(new Set),f=(0,r.ref)(new Set),g=(0,r.ref)(null);async function v(){d&&clearTimeout(d),d=setTimeout(()=>{try{if('function'!=typeof getVariables||'function'!=typeof replaceVariables)return void console.warn('[ACU TagLibrary] è„šæœ¬å˜é‡ API ä¸å¯ç”¨');const t=getVariables({type:'global'})||{},a=(0,o.klona)(e.value);replaceVariables({...t,[l]:a},{type:'global'}),console.info('[ACU TagLibrary] å·²ä¿å­˜æ ‡ç­¾åº“åˆ°å…¨å±€å˜é‡')}catch(e){console.error('[ACU TagLibrary] ä¿å­˜æ ‡ç­¾åº“å¤±è´¥:',e)}},300)}function b(e){const t=e.path.split('/');return{category:e,level1:t[0]||'',level2:t[1]||'',rest:t.slice(2).join('/')}}(0,r.watch)(e,()=>{u.value&&v()},{deep:!0});const h=(0,r.computed)(()=>{const t=new Map;e.value.categories.forEach(e=>{const a=b(e);if(a.level1){const o=t.get(a.level1),n=''!==a.level2;o?o.hasChildren=o.hasChildren||n:t.set(a.level1,{icon:e.icon,hasChildren:n})}});const a=[];return t.forEach((e,t)=>{a.push({name:t,icon:e.icon,hasChildren:e.hasChildren})}),a.sort((e,t)=>e.name.localeCompare(t.name,'zh-CN')),[...c,...a]}),x=(0,r.computed)(()=>{if(!t.value||'å…¨éƒ¨'===t.value||'æœªåˆ†ç±»'===t.value)return[];const a=[],o=new Set;return e.value.categories.forEach(e=>{const n=b(e);n.level1===t.value&&n.level2&&!o.has(n.level2)&&(o.add(n.level2),a.push({name:n.level2,fullPath:`${n.level1}/${n.level2}`}))}),a.sort((e,t)=>e.name.localeCompare(t.name,'zh-CN')),a});function y(t,a){const o=t.split('/');for(let t=1;t<o.length;t++){const a=o.slice(0,t).join('/');if(!e.value.categories.find(e=>e.path===a)){const t={id:s('cat'),path:a,createdAt:(new Date).toISOString()};e.value.categories.push(t),console.info('[ACU TagLibrary] è‡ªåŠ¨åˆ›å»ºçˆ¶çº§åˆ†ç±»:',a)}}const n=e.value.categories.find(e=>e.path===t);if(n)return void 0!==a&&a!==n.icon&&(n.icon=a,console.info('[ACU TagLibrary] æ›´æ–°åˆ†ç±»å›¾æ ‡:',t)),n;const r={id:s('cat'),path:t,icon:a,createdAt:(new Date).toISOString()};return e.value.categories.push(r),console.info('[ACU TagLibrary] åˆ›å»ºåˆ†ç±»:',t),r}function w(t,a){const o=e.value.categories.find(e=>e.id===t);o&&(void 0!==a.path&&(o.path=a.path),void 0!==a.icon&&(o.icon=a.icon))}function k(t){return e.value.categories.find(e=>e.id===t)}const C=(0,r.computed)(()=>{let o=[...e.value.tags];if(n.value.trim()){const e=n.value.toLowerCase();o=o.filter(t=>t.label.toLowerCase().includes(e)||t.promptTemplate.toLowerCase().includes(e))}if('æœªåˆ†ç±»'===t.value)o=o.filter(t=>!t.categoryId||!e.value.categories.find(e=>e.id===t.categoryId));else if(t.value&&'å…¨éƒ¨'!==t.value){const n=new Set;e.value.categories.forEach(e=>{const o=b(e);o.level1===t.value&&(a.value?o.level2===a.value&&n.add(e.id):n.add(e.id))}),o=o.filter(e=>n.has(e.categoryId))}return o.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),o});function N(t,a='',o=''){const n={id:s('tag'),label:t,categoryId:a,promptTemplate:o,createdAt:(new Date).toISOString()};return e.value.tags.push(n),n}function V(t,a){const o=new Set(t);e.value.tags.forEach(e=>{o.has(e.id)&&(e.categoryId=a)})}function E(){m.value=new Set,f.value=new Set,g.value=null}const B=(0,r.computed)(()=>e.value.tags.length),S=(0,r.computed)(()=>e.value.categories.length),T=(0,r.computed)(()=>e.value.tags.filter(t=>!t.categoryId||!e.value.categories.find(e=>e.id===t.categoryId)).length);return{library:e,selectedLevel1:t,selectedLevel2:a,searchKeyword:n,isLoaded:u,currentMode:p,selectedTagIds:m,selectedCategoryIds:f,selectionType:g,loadLibrary:async function(){try{if('function'!=typeof getVariables)return console.warn('[ACU TagLibrary] getVariables ä¸å¯ç”¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®'),void(u.value=!0);const t=getVariables({type:'global'});if(t&&t[l]){const a=t[l];e.value={categories:a.categories||[],tags:a.tags||[]},console.info('[ACU TagLibrary] å·²ä»å…¨å±€å˜é‡åŠ è½½æ ‡ç­¾åº“:',{categories:e.value.categories.length,tags:e.value.tags.length})}else await async function(){try{console.info('[ACU TagLibrary] é¦–æ¬¡ä½¿ç”¨ï¼Œåˆå§‹åŒ–ç©ºæ ‡ç­¾åº“'),e.value={...i}}catch(e){console.warn('[ACU TagLibrary] è¿ç§»æ—§é…ç½®å¤±è´¥:',e)}}();u.value=!0}catch(t){console.error('[ACU TagLibrary] åŠ è½½æ ‡ç­¾åº“å¤±è´¥:',t),e.value={...i},u.value=!0}},saveLibrary:v,parseCategoryPath:b,level1Categories:h,level2Categories:x,addCategory:y,deleteCategory:function(t){const a=e.value.categories.find(e=>e.id===t);if(!a)return void console.warn('[ACU TagLibrary] åˆ†ç±»ä¸å­˜åœ¨:',t);const o=new Set;e.value.categories.forEach(e=>{(e.path===a.path||e.path.startsWith(a.path+'/'))&&o.add(e.id)}),e.value.tags=e.value.tags.filter(e=>!o.has(e.categoryId)),e.value.categories=e.value.categories.filter(e=>!o.has(e.id)),console.info('[ACU TagLibrary] å·²åˆ é™¤åˆ†ç±»åŠå…¶å†…å®¹:',a.path,'(å­åˆ†ç±»æ•°:',o.size-1,')')},updateCategory:w,getCategoryById:k,getCategoryByPath:function(t){return e.value.categories.find(e=>e.path===t)},getChildCategories:function(t){return e.value.categories.filter(e=>{if(''===t)return!e.path.includes('/');if(!e.path.startsWith(t+'/'))return!1;return!e.path.slice(t.length+1).includes('/')})},getCategoryTagCount:function(t){const a=k(t);if(!a)return 0;const o=new Set;return e.value.categories.forEach(e=>{(e.path===a.path||e.path.startsWith(a.path+'/'))&&o.add(e.id)}),e.value.tags.filter(e=>o.has(e.categoryId)).length},getLevel1TagCount:function(t){if('å…¨éƒ¨'===t)return e.value.tags.length;if('æœªåˆ†ç±»'===t)return T.value;const a=new Set;return e.value.categories.forEach(e=>{b(e).level1===t&&a.add(e.id)}),e.value.tags.filter(e=>a.has(e.categoryId)).length},filteredTags:C,upsertTag:function(t){const a=e.value.tags.findIndex(e=>e.id===t.id);a>=0?e.value.tags[a]={...t}:e.value.tags.push({...t,createdAt:t.createdAt||(new Date).toISOString()})},createTag:N,deleteTag:function(t){e.value.tags=e.value.tags.filter(e=>e.id!==t)},deleteTags:function(t){const a=new Set(t);e.value.tags=e.value.tags.filter(e=>!a.has(e.id))},getTagById:function(t){return e.value.tags.find(e=>e.id===t)},getTagsByCategory:function(t){return e.value.tags.filter(e=>e.categoryId===t)},moveTagToCategory:function(t,a){const o=e.value.tags.find(e=>e.id===t);o&&(o.categoryId=a)},moveTagsToCategory:V,setMode:function(e){'migrate'!==e&&'export'!==e&&E(),p.value=e},toggleTagSelection:function(e){'category'===g.value&&f.value.clear(),g.value='tag',m.value.has(e)?m.value.delete(e):m.value.add(e),m.value=new Set(m.value)},toggleCategorySelection:function(e){'tag'===g.value&&m.value.clear(),g.value='category',f.value.has(e)?f.value.delete(e):f.value.add(e),f.value=new Set(f.value)},clearSelection:E,migrateSelectedTags:function(e){'tag'===g.value&&m.value.size>0&&(V(Array.from(m.value),e),E())},migrateSelectedCategories:function(e){'category'===g.value&&f.value.size>0&&(f.value.forEach(t=>{const a=k(t);if(a){const o=a.path.split('/'),n=o[o.length-1];w(t,{path:e?`${e}/${n}`:n})}}),E())},migrateSelectedItems:function(t){const a=t?k(t):null,o=a?.path||'';'tag'===g.value&&m.value.size>0?(V(Array.from(m.value),t),E()):'category'===g.value&&f.value.size>0&&(f.value.forEach(a=>{const n=k(a);if(n&&a!==t){const t=n.path,r=t.split('/'),l=r[r.length-1],i=o?`${o}/${l}`:l;w(a,{path:i}),e.value.categories.forEach(e=>{if(e.path.startsWith(t+'/')){const a=i+e.path.slice(t.length);w(e.id,{path:a})}})}}),E())},exportLibrary:function(t,a){let o=[],n=[];if('all'===t)o=[...e.value.categories],n=[...e.value.tags];else if('category'===t&&a){const t=k(a);if(t){o=e.value.categories.filter(e=>e.path===t.path||e.path.startsWith(t.path+'/'));const a=new Set(o.map(e=>e.id));n=e.value.tags.filter(e=>a.has(e.categoryId))}}else if('selected'===t){n=e.value.tags.filter(e=>m.value.has(e.id));const t=new Set(n.map(e=>e.categoryId).filter(Boolean));o=e.value.categories.filter(e=>t.has(e.id))}return{version:'1.0',exportedAt:(new Date).toISOString(),categories:o.map(e=>({id:e.id,path:e.path,icon:e.icon})),tags:n.map(e=>{const t=k(e.categoryId);return{id:e.id,label:e.label,category:t?.path||'',prompt:e.promptTemplate,allowPreEdit:e.allowPreEdit}})}},importLibrary:function(t,a){try{let o=0,n=0,r=0,l=0;const i=new Map;return e.value.categories.forEach(e=>{i.set(e.path,e.id)}),t.categories.forEach(e=>{if(!i.has(e.path)){const t=y(e.path,e.icon);i.set(e.path,t.id),o++}}),t.tags.forEach(t=>{const o=i.get(t.category)||'',c=e.value.tags.find(e=>e.label===t.label&&e.categoryId===o);if(c)if('overwrite'===a.conflictStrategy)c.promptTemplate=t.prompt,c.allowPreEdit=t.allowPreEdit,r++;else{let a=t.label,n=1;for(;e.value.tags.some(e=>e.label===a&&e.categoryId===o);)a=`${t.label}_${n}`,n++;N(a,o,t.prompt);const r=e.value.tags[e.value.tags.length-1];r&&t.allowPreEdit&&(r.allowPreEdit=t.allowPreEdit),l++}else{N(t.label,o,t.prompt);const a=e.value.tags[e.value.tags.length-1];a&&t.allowPreEdit&&(a.allowPreEdit=t.allowPreEdit),n++}}),{success:!0,addedCategories:o,addedTags:n,updatedTags:r,renamedTags:l}}catch(e){return console.error('[ACU TagLibrary] å¯¼å…¥å¤±è´¥:',e),{success:!1,addedCategories:0,addedTags:0,updatedTags:0,renamedTags:0,error:e instanceof Error?e.message:'æœªçŸ¥é”™è¯¯'}}},clearAll:function(){e.value.tags=[],e.value.categories=[],console.info('[ACU TagLibrary] å·²æ¸…ç©ºæ‰€æœ‰æ ‡ç­¾å’Œåˆ†ç±»')},selectLevel1:function(e){t.value=e,a.value=''},selectLevel2:function(e){a.value=e},resetSelection:function(){t.value='',a.value='',n.value=''},totalTags:B,totalCategories:S,uncategorizedCount:T}})},7365(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},7499(e,t,a){a.d(t,{A:()=>s});var o=a(4061),n=a(953);const r={class:'acu-search-input-wrapper'},l=['placeholder'],i={key:0,class:'acu-search-result'},c={key:1,class:'no-result'},s=(0,o.defineComponent)({__name:'SearchBox',props:{modelValue:{},resultCount:{},debounce:{default:300},autofocus:{type:Boolean,default:!1},placeholder:{default:'æœç´¢...'},showResultCount:{type:Boolean,default:!0}},emits:['update:modelValue','search','clear','searchImmediate'],setup(e,{expose:t,emit:a}){const s=e,u=a,d=(0,o.ref)(),p=(0,o.ref)(s.modelValue),m=(0,o.ref)(!1);s.autofocus&&(0,o.onMounted)(()=>{d.value?.focus()});const f=(0,n.Q0)(e=>{u('update:modelValue',e),u('search',e)},s.debounce);(0,o.watch)(p,e=>{f(e)}),(0,o.watch)(()=>s.modelValue,e=>{e!==p.value&&(p.value=e)});const g=()=>{p.value='',u('update:modelValue',''),u('search',''),u('clear'),d.value?.focus()},v=()=>{u('update:modelValue',p.value),u('search',p.value),u('searchImmediate',p.value)};return t({focus:()=>{d.value?.focus()},blur:()=>{d.value?.blur()},clear:g,selectAll:()=>{d.value?.select()},inputRef:d}),(t,a)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{class:(0,o.normalizeClass)(['acu-search-box',{focused:m.value,'has-value':p.value}])},[(0,o.createElementVNode)('div',r,[(0,o.createCommentVNode)(' æœç´¢å›¾æ ‡ '),a[4]||(a[4]=(0,o.createElementVNode)('i',{class:'fas fa-search acu-search-icon'},null,-1)),(0,o.createCommentVNode)(' æœç´¢è¾“å…¥æ¡† '),(0,o.withDirectives)((0,o.createElementVNode)('input',{ref_key:'inputRef',ref:d,'onUpdate:modelValue':a[0]||(a[0]=e=>p.value=e),type:'text',class:'acu-search-input',placeholder:e.placeholder,onFocus:a[1]||(a[1]=e=>m.value=!0),onBlur:a[2]||(a[2]=e=>m.value=!1),onKeydown:[(0,o.withKeys)(g,['escape']),(0,o.withKeys)(v,['enter'])]},null,40,l),[[o.vModelText,p.value]]),(0,o.createCommentVNode)(' æ¸…ç©ºæŒ‰é’® '),(0,o.createVNode)(o.Transition,{name:'acu-fade'},{default:(0,o.withCtx)(()=>[p.value?((0,o.openBlock)(),(0,o.createElementBlock)('button',{key:0,class:'acu-search-clear',title:'æ¸…ç©ºæœç´¢',onClick:g},[...a[3]||(a[3]=[(0,o.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])):(0,o.createCommentVNode)('v-if',!0)]),_:1})]),(0,o.createCommentVNode)(' æœç´¢ç»“æœè®¡æ•°ï¼ˆå¯é€‰ï¼‰ '),(0,o.createVNode)(o.Transition,{name:'acu-fade'},{default:(0,o.withCtx)(()=>[e.showResultCount&&void 0!==e.resultCount?((0,o.openBlock)(),(0,o.createElementBlock)('div',i,[e.resultCount>0?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[a[5]||(a[5]=(0,o.createTextVNode)(' æ‰¾åˆ° ',-1)),(0,o.createElementVNode)('strong',null,(0,o.toDisplayString)(e.resultCount),1),a[6]||(a[6]=(0,o.createTextVNode)(' æ¡ç»“æœ ',-1))],64)):p.value?((0,o.openBlock)(),(0,o.createElementBlock)('span',c,'æ— åŒ¹é…ç»“æœ')):(0,o.createCommentVNode)('v-if',!0)])):(0,o.createCommentVNode)('v-if',!0)]),_:1})],2))}})},7590(e,t,a){var o=a(1296);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('7dfe5621',o,!1,{ssrId:!0})},7615(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'.acu-word-pool-search[data-v-244ae7d6]{width:100%;padding:8px 12px;border-radius:var(--acu-radius-md);border:1px solid var(--acu-border);background:var(--acu-input-bg);color:var(--acu-text-main);font-size:13px}.acu-word-pool-search[data-v-244ae7d6]:focus{border-color:var(--acu-title-color);outline:none}.acu-word-pool-item[data-v-244ae7d6]:last-child{border-bottom:none !important}','',{version:3,sources:['webpack://./src/å¯è§†åŒ–è¡¨æ ¼/components/settings/divination/WordPoolPanel.vue'],names:[],mappings:'AAEA,uCACE,UAAA,CACA,gBAAA,CACA,kCAAA,CACA,kCAAA,CACA,8BAAA,CACA,0BAAA,CACA,cAAA,CAEA,6CACE,mCAAA,CACA,YAAA,CAIJ,gDACE,6BAAA',sourcesContent:['\n// æ ·å¼ä½¿ç”¨å…¨å±€ç±»ï¼Œè¿™é‡Œåªå†™å°‘é‡ç‰¹å®šçš„\n.acu-word-pool-search {\n  width: 100%;\n  padding: 8px 12px;\n  border-radius: var(--acu-radius-md);\n  border: 1px solid var(--acu-border);\n  background: var(--acu-input-bg);\n  color: var(--acu-text-main);\n  font-size: 13px;\n\n  &:focus {\n    border-color: var(--acu-title-color);\n    outline: none;\n  }\n}\n\n.acu-word-pool-item:last-child {\n  border-bottom: none !important;\n}\n'],sourceRoot:''}]);const i=l},8186(e,t,a){var o=a(9016);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('2e7b5b75',o,!1,{ssrId:!0})},8253(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},8546(e,t,a){var o=a(5877);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('54d6bcd6',o,!1,{ssrId:!0})},8889(e,t,a){function o(e){return new Promise((t,a)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>t(o.result),o.onerror=a})}function n(e,t=100,a=.8){return new Promise((o,n)=>{const r=new Image;r.onload=()=>{try{const e=document.createElement('canvas'),l=Math.min(1,t/Math.max(r.width,r.height));e.width=r.width*l,e.height=r.height*l;const i=e.getContext('2d');if(!i)return void n(new Error('æ— æ³•åˆ›å»º canvas context'));i.drawImage(r,0,0,e.width,e.height),o(e.toDataURL('image/jpeg',a))}catch(e){n(e)}},r.onerror=()=>n(new Error('å›¾ç‰‡åŠ è½½å¤±è´¥')),r.src=e})}function r(e,t){const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!a)return e;return`rgba(${parseInt(a[1],16)}, ${parseInt(a[2],16)}, ${parseInt(a[3],16)}, ${t/100})`}a.d(t,{bB:()=>o,j5:()=>r,w4:()=>n})},9016(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},9149(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},9625(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},9842(e,t,a){a.d(t,{O:()=>f,m:()=>m});var o=a(4061);const n='row_snapshots';let r=null;async function l(){return r||new Promise((e,t)=>{const a=indexedDB.open('acu_history_db',1);a.onerror=()=>{console.error('[ACU IndexedDB] æ‰“å¼€æ•°æ®åº“å¤±è´¥:',a.error),t(a.error)},a.onsuccess=()=>{r=a.result,console.info('[ACU IndexedDB] æ•°æ®åº“è¿æ¥æˆåŠŸ'),e(r)},a.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains(n)){const e=t.createObjectStore(n,{keyPath:'id',autoIncrement:!0});e.createIndex('by_chat_row',['chatId','rowKey'],{unique:!1}),e.createIndex('by_chat','chatId',{unique:!1}),e.createIndex('by_timestamp','timestamp',{unique:!1}),console.info('[ACU IndexedDB] åˆ›å»ºæ•°æ®åº“è¡¨å’Œç´¢å¼•æˆåŠŸ')}}})}async function i(e){const t=await l();return new Promise((a,o)=>{const r=t.transaction(n,'readwrite').objectStore(n).add(e);r.onsuccess=()=>{console.info('[ACU IndexedDB] æ·»åŠ å¿«ç…§æˆåŠŸ, ID:',r.result),a(r.result)},r.onerror=()=>{console.error('[ACU IndexedDB] æ·»åŠ å¿«ç…§å¤±è´¥:',r.error),o(r.error)}})}async function c(e,t){const a=await l();return new Promise((o,r)=>{const l=a.transaction(n,'readonly').objectStore(n).index('by_chat_row').getAll([e,t]);l.onsuccess=()=>{o(l.result||[])},l.onerror=()=>{console.error('[ACU IndexedDB] æŸ¥è¯¢å¿«ç…§å¤±è´¥:',l.error),r(l.error)}})}async function s(e){const t=await l();return new Promise((a,o)=>{const r=t.transaction(n,'readwrite').objectStore(n).delete(e);r.onsuccess=()=>{console.info('[ACU IndexedDB] åˆ é™¤å¿«ç…§æˆåŠŸ, ID:',e),a()},r.onerror=()=>{console.error('[ACU IndexedDB] åˆ é™¤å¿«ç…§å¤±è´¥:',r.error),o(r.error)}})}function u(){try{const e=window.SillyTavern||window.parent?.SillyTavern||window.top?.SillyTavern;if(e?.getCurrentChatId){const t=e.getCurrentChatId();if(t)return t}if(e?.chat?.length>0){const t=e.chat[0];if(t?.chat_id)return t.chat_id}}catch(e){console.warn('[ACU History] è·å– chatId å¤±è´¥:',e)}return'default'}function d(e,t){return`${e}-row-${t}`}function p(e,t){const a=Object.keys(e).map(Number),o=Object.keys(t).map(Number);if(a.length!==o.length)return!1;for(const o of a)if(e[o]!==t[o])return!1;return!0}function m(){const e=(0,o.ref)(!1);return{isLoading:e,saveSnapshot:async function(t,a,o,n){try{e.value=!0;const r=u(),l=d(t,a),m=(await c(r,l)).sort((e,t)=>t.timestamp-e.timestamp);if(m.length>0){if(p(o,m[0].cells))return void console.info('[ACU History] å†…å®¹æœªå˜åŒ–ï¼Œè·³è¿‡è®°å½•')}if(await i({chatId:r,rowKey:l,timestamp:Date.now(),source:n,cells:o}),console.info(`[ACU History] å·²è®°å½• ${l} çš„å¿«ç…§ (${n})`),m.length>=5){const e=m.slice(4);for(const t of e)void 0!==t.id&&await s(t.id);console.info(`[ACU History] æ¸…ç†æ—§å¿«ç…§ ${e.length} æ¡`)}}catch(e){console.error('[ACU History] ä¿å­˜å¿«ç…§å¤±è´¥:',e)}finally{e.value=!1}},getSnapshots:async function(t,a){try{e.value=!0;const o=u(),n=d(t,a);console.info('[ACU History] æŸ¥è¯¢å¿«ç…§, å‚æ•°:',{chatId:o,rowKey:n,tableName:t,rowIndex:a});const r=await c(o,n);return console.info('[ACU History] æŸ¥è¯¢ç»“æœ:',r.length,'æ¡'),r.sort((e,t)=>t.timestamp-e.timestamp).slice(0,5)}catch(e){return console.error('[ACU History] è·å–å¿«ç…§å¤±è´¥:',e),[]}finally{e.value=!1}},snapshotToTableRow:function(e,t){return{index:t.index,key:t.key,cells:t.cells.map((t,a)=>({...t,value:void 0!==e.cells[a]?e.cells[a]:t.value}))}},tableRowToCells:function(e){const t={};return e.cells.forEach((e,a)=>{t[a]=e.value}),t},getDiff:function(e,t){const a=new Set;for(const[o,n]of Object.entries(t)){const t=Number(o);e.cells[t]!==n&&a.add(t)}for(const o of Object.keys(e.cells)){const e=Number(o);void 0===t[e]&&a.add(e)}return a},formatRelativeTime:function(e){const t=Date.now()-e;return t<6e4?'åˆšåˆš':t<36e5?`${Math.floor(t/6e4)}åˆ†é’Ÿå‰`:t<864e5?`${Math.floor(t/36e5)}å°æ—¶å‰`:t<1728e5?'æ˜¨å¤©':new Date(e).toLocaleDateString('zh-CN',{month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'})},clearCurrentChatHistory:async function(){try{const e=u();await async function(e){const t=await l();return new Promise((a,o)=>{const r=t.transaction(n,'readwrite'),l=r.objectStore(n).index('by_chat').openCursor(IDBKeyRange.only(e));let i=0;l.onsuccess=e=>{const t=e.target.result;t&&(t.delete(),i++,t.continue())},r.oncomplete=()=>{console.info(`[ACU IndexedDB] æŒ‰èŠå¤©åˆ é™¤å®Œæˆ, å…±åˆ é™¤ ${i} æ¡`),a()},r.onerror=()=>{console.error('[ACU IndexedDB] æŒ‰èŠå¤©åˆ é™¤å¤±è´¥:',r.error),o(r.error)}})}(e),console.info('[ACU History] å·²æ¸…é™¤å½“å‰èŠå¤©çš„å†å²è®°å½•')}catch(e){console.error('[ACU History] æ¸…é™¤å†å²å¤±è´¥:',e)}},getCurrentChatId:u}}async function f(e,t,a,o){try{const n=d(t,a.index),r={};a.cells.forEach((e,t)=>{r[t]=String(e.value)});const l=(await c(e,n)).sort((e,t)=>t.timestamp-e.timestamp);if(l.length>0){const e=l[0];if(p(r,e.cells))return void console.info('[ACU History] å†…å®¹æœªå˜åŒ–ï¼Œè·³è¿‡è®°å½•')}if(await i({chatId:e,rowKey:n,timestamp:Date.now(),source:o,cells:r}),console.info(`[ACU History] å·²è®°å½• ${n} çš„å¿«ç…§ (${o})`),l.length>=5){const e=l.slice(4);for(const t of e)void 0!==t.id&&await s(t.id);console.info(`[ACU History] æ¸…ç†æ—§å¿«ç…§ ${e.length} æ¡`)}}catch(e){console.error('[ACU History] ä¿å­˜å¿«ç…§å¤±è´¥:',e)}}},9843(e,t,a){var o=a(8253);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,a(4424).A)('25f580a0',o,!1,{ssrId:!0})},9929(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'\n','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l},9946(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,o]of t)a[e]=o;return a}},9988(e,t,a){a.r(t),a.d(t,{default:()=>i});var o=a(5699),n=a.n(o),r=a(465),l=a.n(r)()(n());l.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const i=l}},u={};function d(e){var t=u[e];if(void 0!==t)return t.exports;var a=u[e]={id:e,exports:{}};return s[e](a,a.exports,d),a.exports}d.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return d.d(t,{a:t}),t},d.d=(e,t)=>{for(var a in t)d.o(t,a)&&!d.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};var p=d(3035),m=d(4061),f=d(3926),g=d(567),v=d(1768);const b='acu-styles',h='acu-dynamic-font',x='acu-theme-custom';function y(){const e=(0,f.JH)(),t=(0,g.C)(),{$}=(0,v.M1)(),a=()=>{try{return window.parent?.document||document}catch{return document}},o=(0,m.computed)(()=>{try{return getScriptId()}catch{return'acu-visualizer'}}),n=(0,m.ref)(null),r=(0,m.ref)(null),l=(0,m.ref)(null),i=(0,m.ref)(null),c=(0,m.ref)(!1),s=()=>{const t=a(),n=`${h}-${o.value}`;t.getElementById(n)?.remove();const r=t.createElement('style');r.id=n,r.setAttribute('data-source','acu-visualizer');const i=(()=>{const t=e.config.fontFamily||'default',a=f.pQ.find(e=>e.id===t);return a?.val||f.pQ[0].val})();r.textContent=`\n      \n      @import url("https://fontsapi.zeoseven.com/3/main/result.css");   /* å¯’è‰å…¨åœ†ä½“ */\n      @import url("https://fontsapi.zeoseven.com/442/main/result.css"); /* Maple Mono */\n      @import url("https://fontsapi.zeoseven.com/256/main/result.css"); /* æ±‡æ–‡æ˜æœ */\n      @import url("https://fontsapi.zeoseven.com/482/main/result.css"); /* Cooperæ­£æ¥· */\n      @import url("https://fontsapi.zeoseven.com/446/main/result.css"); /* YFFYT */\n      @import url("https://fontsapi.zeoseven.com/570/main/result.css"); /* Fusion Pixel */\n      @import url("https://fontsapi.zeoseven.com/292/main/result.css"); /* éœé¹œæ–‡æ¥· */\n      @import url("https://fontsapi.zeoseven.com/69/main/result.css");  /* æ€æºé»‘ä½“ */\n      @import url("https://fontsapi.zeoseven.com/7/main/result.css");   /* æœ±é›€ä»¿å®‹ */\n    \n\n      /* ä¸»å®¹å™¨å­—ä½“ */\n      .acu-wrapper,\n      .acu-modal-container,\n      .acu-attachment-picker-overlay,\n      .acu-toast,\n      .acu-edit-dialog,\n      .acu-cell-menu,\n      .acu-nav-container,\n      #acu-ghost-preview {\n        font-family: ${i} !important;\n      }\n\n      /* æ‰€æœ‰æ–‡æœ¬å…ƒç´ å­—ä½“ï¼ˆæ’é™¤å›¾æ ‡ï¼‰ */\n      .acu-wrapper p,\n      .acu-wrapper div:not(.fa):not(.fas):not(.far):not(.fab),\n      .acu-wrapper span:not(.fa):not(.fas):not(.far):not(.fab),\n      .acu-wrapper label,\n      .acu-wrapper button,\n      .acu-wrapper a,\n      .acu-wrapper input,\n      .acu-wrapper select,\n      .acu-wrapper textarea,\n      .acu-wrapper th,\n      .acu-wrapper td,\n      .acu-modal-container p,\n      .acu-modal-container div:not(.fa):not(.fas):not(.far):not(.fab),\n      .acu-modal-container span:not(.fa):not(.fas):not(.far):not(.fab),\n      .acu-modal-container label,\n      .acu-modal-container button,\n      .acu-modal-container a,\n      .acu-modal-container input,\n      .acu-modal-container select,\n      .acu-modal-container textarea,\n      .acu-modal-container th,\n      .acu-modal-container td {\n        font-family: ${i} !important;\n      }\n\n      /* Toast - å­—ä½“è·Ÿéšè®¾ç½®ï¼Œé¢œè‰²ä½¿ç”¨ä¸»æ–‡æœ¬è‰² */\n      .acu-toast,\n      .acu-toast p,\n      .acu-toast div,\n      .acu-toast span,\n      .acu-toast-message {\n        font-family: ${i} !important;\n        color: var(--acu-text-main) !important;\n        text-shadow: none !important;\n      }\n\n      /* Toast å›¾æ ‡ */\n      .acu-toast i {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n        color: var(--acu-text-main) !important;\n      }\n\n      /* Tab/å¯¼èˆªæŒ‰é’® - æ™®é€šæ€ï¼šä¸»æ–‡æœ¬è‰² */\n      .acu-tab-btn,\n      .acu-tab-btn span,\n      .acu-tab-btn i,\n      .acu-nav-btn,\n      .acu-nav-btn span,\n      .acu-nav-btn i {\n        font-family: ${i} !important;\n        text-shadow: none !important;\n        color: var(--acu-text-main) !important;\n      }\n\n      /* å¯¼èˆªæŒ‰é’®æ¿€æ´»çŠ¶æ€ - èƒŒæ™¯ä½¿ç”¨ä¸»æ–‡æœ¬è‰²ï¼Œæ–‡å­—ä½¿ç”¨é¢æ¿èƒŒæ™¯è‰²(åè‰²) */\n      .acu-nav-btn.active,\n      .acu-nav-btn.active span,\n      .acu-nav-btn.active i {\n        background: var(--acu-text-main) !important;\n        background-color: var(--acu-text-main) !important;\n        color: var(--acu-bg-panel) !important;\n      }\n\n      /* å¡ç‰‡æ–‡æœ¬ */\n      .acu-data-card,\n      .acu-data-card p,\n      .acu-data-card div:not(.fa):not(.fas):not(.far):not(.fab),\n      .acu-data-card span:not(.fa):not(.fas):not(.far):not(.fab),\n      .acu-card-label,\n      .acu-card-value,\n      .acu-grid-label,\n      .acu-grid-value,\n      .acu-full-label,\n      .acu-full-value,\n      .acu-editable-title {\n        font-family: ${i} !important;\n        text-shadow: none !important;\n      }\n\n      /* å…¶ä»–ç»„ä»¶ */\n      .acu-panel-title,\n      .acu-settings-label,\n      .acu-btn-block,\n      .acu-nav-btn,\n      .acu-edit-textarea {\n        font-family: ${i} !important;\n      }\n\n      /* ä¿æŠ¤ Font Awesome å›¾æ ‡å­—ä½“ */\n      .acu-wrapper i.fa,\n      .acu-wrapper i.fas,\n      .acu-wrapper i.far,\n      .acu-wrapper i.fab,\n      .acu-wrapper .fa,\n      .acu-wrapper .fas,\n      .acu-wrapper .far,\n      .acu-wrapper .fab,\n      .acu-modal-container i.fa,\n      .acu-modal-container i.fas,\n      .acu-modal-container i.far,\n      .acu-modal-container i.fab,\n      .acu-modal-container .fa,\n      .acu-modal-container .fas,\n      .acu-modal-container .far,\n      .acu-modal-container .fab {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n      }\n\n      /* é¢œè‰²æ±¡æŸ“é˜²æŠ¤ - åªé‡ç½® text-shadowï¼Œä¸è¦†ç›–é¢œè‰² */\n      .acu-wrapper p,\n      .acu-wrapper div,\n      .acu-wrapper span,\n      .acu-wrapper label,\n      .acu-wrapper button,\n      .acu-modal-container p,\n      .acu-modal-container div,\n      .acu-modal-container span,\n      .acu-modal-container label,\n      .acu-modal-container button {\n        text-shadow: none !important;\n      }\n\n      /* å¡ç‰‡æ ‡é¢˜ - ä½¿ç”¨ä¸»é¢˜è‰² + ç”¨æˆ·å­—ä½“ */\n      .acu-editable-title,\n      .acu-panel-title {\n        color: var(--acu-title-color) !important;\n        font-family: ${i} !important;\n      }\n\n      /* ä»ªè¡¨ç›˜æ ‡é¢˜å’Œå†…å®¹ */\n      .acu-dash-title,\n      .acu-dash-title span,\n      .acu-dash-title-text {\n        font-family: ${i} !important;\n        color: var(--acu-title-color) !important;\n        text-shadow: none !important;\n      }\n\n      /* ä»ªè¡¨ç›˜å›¾æ ‡ */\n      .acu-dash-title i,\n      .acu-dash-empty i,\n      .acu-dash-card i,\n      .acu-dash-npc-item i {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n        color: var(--acu-text-sub) !important;\n      }\n\n      /* ä»ªè¡¨ç›˜ç©ºçŠ¶æ€ */\n      .acu-dash-empty,\n      .acu-dash-empty span {\n        font-family: ${i} !important;\n        color: var(--acu-text-sub) !important;\n        text-shadow: none !important;\n      }\n\n      /* è¡¨æ ¼ç©ºçŠ¶æ€"æš‚æ— æ•°æ®" */\n      .acu-empty-state,\n      .acu-empty-state p,\n      .acu-empty-state span,\n      .acu-no-data {\n        font-family: ${i} !important;\n        color: var(--acu-text-sub) !important;\n        text-shadow: none !important;\n      }\n\n      /* ç©ºçŠ¶æ€å›¾æ ‡ */\n      .acu-empty-state i {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n        color: var(--acu-text-sub) !important;\n      }\n\n      /* å¡ç‰‡åˆ—å label - å­—ä½“å¤§å°å—è®¾ç½®æ§åˆ¶ */\n      label.acu-card-label,\n      label.acu-grid-label,\n      label.acu-full-label,\n      .acu-data-card label.acu-card-label,\n      .acu-data-card label.acu-grid-label,\n      .acu-data-card label.acu-full-label,\n      .acu-wrapper label.acu-card-label,\n      .acu-wrapper label.acu-grid-label,\n      .acu-wrapper label.acu-full-label {\n        font-family: ${i} !important;\n        font-size: calc(var(--acu-font-size, 13px) - 2px) !important;\n        text-shadow: none !important;\n      }\n\n      /* hintæ–‡æœ¬ - ä½¿ç”¨æ¬¡è¦æ–‡æœ¬è‰²ï¼Œå­—ä½“å¤§å°å—è®¾ç½®æ§åˆ¶ */\n      .acu-wrapper .hint,\n      .acu-wrapper .acu-text-sub,\n      .acu-modal-container .hint,\n      .acu-modal-container .acu-text-sub,\n      .acu-settings-label .hint {\n        color: var(--acu-text-sub) !important;\n        font-size: calc(var(--acu-font-size, 13px) - 2px) !important;\n      }\n\n      /* Tab/Nav å›¾æ ‡ä½¿ç”¨ Font Awesome */\n      .acu-tab-btn i,\n      .acu-nav-btn i {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n      }\n\n      /* æ‰‹åŠ¨æ›´æ–°å¼¹çª—æ–‡æœ¬ */\n      .acu-manual-update-dialog p,\n      .acu-manual-update-dialog div,\n      .acu-manual-update-dialog span,\n      .acu-manual-update-dialog label,\n      .acu-modal-body p,\n      .acu-modal-body div,\n      .acu-modal-body span,\n      .acu-modal-body label {\n        color: var(--acu-text-main) !important;\n        text-shadow: none !important;\n      }\n\n      /* è®¾ç½®é¢æ¿è¿”å›æŒ‰é’® - ä½¿ç”¨ä¸»æ–‡æœ¬è‰² */\n      .acu-modal-back,\n      .acu-modal-back i,\n      .acu-back-btn,\n      .acu-back-btn i {\n        color: var(--acu-text-main) !important;\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n      }\n\n      /* è®¾ç½®é¢æ¿å…³é—­æŒ‰é’® */\n      .acu-modal-close i,\n      .acu-close-pill i {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n        color: inherit !important;\n      }\n\n      /* æ‰€æœ‰æŒ‰é’®å­—ä½“ - ç»Ÿä¸€ä½¿ç”¨ç”¨æˆ·è®¾ç½®çš„å­—ä½“ */\n      .acu-wrapper button,\n      .acu-modal-container button,\n      .acu-close-pill,\n      .acu-tool-btn,\n      .acu-btn,\n      .acu-btn-primary,\n      .acu-btn-secondary,\n      .acu-btn-danger,\n      .acu-btn-save,\n      .btn-cancel,\n      .btn-confirm,\n      .acu-preset-dropdown-btn,\n      .acu-modal-btn,\n      .acu-action-btn,\n      .acu-page-btn,\n      .acu-dialog-btn {\n        font-family: ${i} !important;\n      }\n\n      /* ä¸»é¢˜é¢æ¿CSSæŒ‰é’® */\n      .acu-theme-panel button,\n      .acu-css-actions button,\n      .acu-css-actions .acu-tool-btn {\n        font-family: ${i} !important;\n      }\n\n      /* å¤´åƒç®¡ç†å¼¹çª— */\n      .acu-avatar-manager-modal button,\n      .acu-avatar-manager-modal label,\n      .acu-avatar-manager-modal span,\n      .acu-avatar-manager button,\n      .acu-avatar-manager label,\n      .acu-avatar-manager span,\n      .acu-avatar-dialog button,\n      .acu-avatar-dialog label,\n      .acu-avatar-dialog span {\n        font-family: ${i} !important;\n      }\n\n      /* è®¾ç½®é¢æ¿æ ‡é¢˜å›¾æ ‡ - ä½¿ç”¨ä¸»æ–‡æœ¬è‰² */\n      .acu-modal-header i:not(.acu-close-pill i),\n      .acu-settings-title i {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n        color: var(--acu-text-main) !important;\n      }\n    `,t.head.appendChild(r),l.value=r,console.info('[ACU Styles] Font styles injected')},u=()=>{if(!r.value)return;const t=e.config,a=e.highlightColorObj,o=e.highlightManualColorObj,n=e.highlightAiColorObj,l=e.titleColorObj,i=t.gridColumns&&t.gridColumns>0?`repeat(${t.gridColumns}, 1fr)`:'repeat(auto-fill, minmax(110px, 1fr))',c=`\n      .acu-wrapper,\n      .acu-modal-container,\n      .acu-attachment-picker-overlay,\n      .acu-toast,\n      .acu-cell-menu {\n        /* å¡ç‰‡é…ç½® */\n        --acu-card-width: ${t.cardWidth||280}px;\n        --acu-font-size: ${t.fontSize||13}px;\n\n        /* é«˜äº®è‰² (å…¼å®¹æ—§æ ·å¼) */\n        --acu-highlight: ${a.main};\n        --acu-highlight-bg: ${a.bg};\n        --acu-accent: ${a.main};\n\n        /* æ‰‹åŠ¨ä¿®æ”¹é«˜äº®è‰² */\n        --acu-highlight-manual: ${o.main};\n        --acu-highlight-manual-bg: ${o.bg};\n\n        /* AIå¡«è¡¨é«˜äº®è‰² */\n        --acu-highlight-ai: ${n.main};\n        --acu-highlight-ai-bg: ${n.bg};\n\n        /* æ ‡é¢˜è‰² */\n        --acu-title-color: ${l.main};\n        --acu-title-color-bg: ${l.bg};\n        --acu-title-color-rgb: ${function(e){const t=e.replace('#',''),a=parseInt(t,16);return`${a>>16&255}, ${a>>8&255}, ${255&a}`}(l.main)};\n\n        /* å¯¼èˆªæ  */\n        --acu-nav-cols: ${i};\n\n        /* æ–‡æœ¬é™åˆ¶ */\n        --acu-text-max-height: ${!1!==t.limitLongText?'80px':'none'};\n        --acu-text-overflow: ${!1!==t.limitLongText?'auto':'visible'};\n      }\n\n      /* ============================================================\n       * åŒè‰²é«˜äº®æ ·å¼ (å·²ç§»é™¤èƒŒæ™¯è‰²å’ŒåŠ¨ç”»æ•ˆæœ)\n       * ============================================================ */\n\n      /* æ‰‹åŠ¨ä¿®æ”¹é«˜äº® (æ©™è‰²ç³») - è¦†ç›–å€¼å…ƒç´ åŠå…¶æ‰€æœ‰å­å…ƒç´  */\n      .acu-cell-changed-manual .acu-grid-value,\n      .acu-cell-changed-manual .acu-full-value,\n      .acu-cell-changed-manual .acu-card-value,\n      .acu-cell-changed-manual .acu-grid-value *,\n      .acu-cell-changed-manual .acu-full-value *,\n      .acu-cell-changed-manual .acu-card-value *,\n      .acu-row-changed-manual .acu-editable-title {\n        color: var(--acu-highlight-manual) !important;\n        font-weight: 600;\n      }\n\n      /* AIå¡«è¡¨é«˜äº® (è“è‰²ç³») - è¦†ç›–å€¼å…ƒç´ åŠå…¶æ‰€æœ‰å­å…ƒç´  */\n      .acu-cell-changed-ai .acu-grid-value,\n      .acu-cell-changed-ai .acu-full-value,\n      .acu-cell-changed-ai .acu-card-value,\n      .acu-cell-changed-ai .acu-grid-value *,\n      .acu-cell-changed-ai .acu-full-value *,\n      .acu-cell-changed-ai .acu-card-value *,\n      .acu-row-changed-ai .acu-editable-title {\n        color: var(--acu-highlight-ai) !important;\n        font-weight: 600;\n      }\n\n      /* é€šç”¨å˜æ›´é«˜äº® (å…¼å®¹æ—§æ ·å¼) */\n      .acu-cell-changed:not(.acu-cell-changed-manual):not(.acu-cell-changed-ai) .acu-grid-value,\n      .acu-cell-changed:not(.acu-cell-changed-manual):not(.acu-cell-changed-ai) .acu-full-value,\n      .acu-cell-changed:not(.acu-cell-changed-manual):not(.acu-cell-changed-ai) .acu-card-value,\n      .acu-cell-changed:not(.acu-cell-changed-manual):not(.acu-cell-changed-ai) .acu-grid-value *,\n      .acu-cell-changed:not(.acu-cell-changed-manual):not(.acu-cell-changed-ai) .acu-full-value *,\n      .acu-cell-changed:not(.acu-cell-changed-manual):not(.acu-cell-changed-ai) .acu-card-value *,\n      .acu-highlight-changed {\n        color: var(--acu-title-color) !important;\n        font-weight: 600;\n      }\n\n      /* ============================================================\n       * é…’é¦†ä¸»é¢˜æ±¡æŸ“é˜²æŠ¤ - æœ€é«˜ä¼˜å…ˆçº§è¦†ç›–\n       * ä½¿ç”¨å…¨å±€é€‰æ‹©å™¨ + !important ç¡®ä¿ä¼˜å…ˆçº§é«˜äºé…’é¦†ä¸»é¢˜\n       * ============================================================ */\n\n      /* æ»‘å— (Range Input) å®Œå…¨é‡ç½® */\n      .acu-wrapper input[type="range"],\n      .acu-modal-container input[type="range"],\n      .acu-settings-control input[type="range"] {\n        -webkit-appearance: none !important;\n        -moz-appearance: none !important;\n        appearance: none !important;\n        background: transparent !important;\n        background-color: transparent !important;\n        background-image: none !important;\n        border: none !important;\n        box-shadow: none !important;\n        outline: none !important;\n        width: 120px !important;\n        height: 20px !important;\n      }\n\n      /* æ»‘å—åœ†ç‚¹ - Webkit */\n      .acu-wrapper input[type="range"]::-webkit-slider-thumb,\n      .acu-modal-container input[type="range"]::-webkit-slider-thumb,\n      .acu-settings-control input[type="range"]::-webkit-slider-thumb {\n        -webkit-appearance: none !important;\n        appearance: none !important;\n        width: 16px !important;\n        height: 16px !important;\n        background: var(--acu-title-color) !important;\n        background-color: var(--acu-title-color) !important;\n        background-image: none !important;\n        border-radius: 50% !important;\n        border: none !important;\n        margin-top: -5px !important;\n        cursor: pointer !important;\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;\n      }\n\n      /* æ»‘å—è½¨é“ - Webkit */\n      .acu-wrapper input[type="range"]::-webkit-slider-runnable-track,\n      .acu-modal-container input[type="range"]::-webkit-slider-runnable-track,\n      .acu-settings-control input[type="range"]::-webkit-slider-runnable-track {\n        -webkit-appearance: none !important;\n        width: 100% !important;\n        height: 6px !important;\n        background: var(--acu-border) !important;\n        background-color: var(--acu-border) !important;\n        background-image: none !important;\n        border-radius: 3px !important;\n        border: none !important;\n        cursor: pointer !important;\n        box-shadow: none !important;\n      }\n\n      /* æ»‘å—åœ†ç‚¹ - Firefox */\n      .acu-wrapper input[type="range"]::-moz-range-thumb,\n      .acu-modal-container input[type="range"]::-moz-range-thumb,\n      .acu-settings-control input[type="range"]::-moz-range-thumb {\n        -moz-appearance: none !important;\n        width: 16px !important;\n        height: 16px !important;\n        background: var(--acu-title-color) !important;\n        background-color: var(--acu-title-color) !important;\n        background-image: none !important;\n        border-radius: 50% !important;\n        border: none !important;\n        cursor: pointer !important;\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;\n      }\n\n      /* æ»‘å—è½¨é“ - Firefox */\n      .acu-wrapper input[type="range"]::-moz-range-track,\n      .acu-modal-container input[type="range"]::-moz-range-track,\n      .acu-settings-control input[type="range"]::-moz-range-track {\n        -moz-appearance: none !important;\n        width: 100% !important;\n        height: 6px !important;\n        background: var(--acu-border) !important;\n        background-color: var(--acu-border) !important;\n        background-image: none !important;\n        border-radius: 3px !important;\n        border: none !important;\n        cursor: pointer !important;\n        box-shadow: none !important;\n      }\n\n      /* è¾“å…¥æ¡†/é€‰æ‹©æ¡† æ±¡æŸ“é˜²æŠ¤ */\n      .acu-wrapper input[type="text"],\n      .acu-wrapper input[type="number"],\n      .acu-wrapper input[type="password"],\n      .acu-wrapper select,\n      .acu-wrapper textarea,\n      .acu-modal-container input[type="text"],\n      .acu-modal-container input[type="number"],\n      .acu-modal-container input[type="password"],\n      .acu-modal-container select,\n      .acu-modal-container textarea,\n      .acu-settings-control input[type="text"],\n      .acu-settings-control input[type="number"],\n      .acu-settings-control select {\n        background: var(--acu-card-bg) !important;\n        background-color: var(--acu-card-bg) !important;\n        background-image: none !important;\n        border: 1px solid var(--acu-border) !important;\n        border-radius: 6px !important;\n        color: var(--acu-text-main) !important;\n        font-family: inherit !important;\n        font-size: 13px !important;\n        text-shadow: none !important;\n        box-shadow: none !important;\n        backdrop-filter: none !important;\n        filter: none !important;\n      }\n\n      .acu-wrapper input[type="text"]:hover,\n      .acu-wrapper input[type="number"]:hover,\n      .acu-wrapper select:hover,\n      .acu-modal-container input[type="text"]:hover,\n      .acu-modal-container input[type="number"]:hover,\n      .acu-modal-container select:hover,\n      .acu-settings-control input:hover,\n      .acu-settings-control select:hover {\n        border-color: var(--acu-title-color) !important;\n        background: var(--acu-card-bg) !important;\n        background-color: var(--acu-card-bg) !important;\n        background-image: none !important;\n        box-shadow: 0 0 0 2px var(--acu-title-color-bg) !important;\n      }\n\n      .acu-wrapper input[type="text"]:focus,\n      .acu-wrapper input[type="number"]:focus,\n      .acu-wrapper select:focus,\n      .acu-modal-container input[type="text"]:focus,\n      .acu-modal-container input[type="number"]:focus,\n      .acu-modal-container select:focus,\n      .acu-settings-control input:focus,\n      .acu-settings-control select:focus {\n        border-color: var(--acu-title-color) !important;\n        background: var(--acu-card-bg) !important;\n        background-color: var(--acu-card-bg) !important;\n        background-image: none !important;\n        box-shadow: 0 0 0 2px var(--acu-title-color-bg) !important;\n        outline: none !important;\n      }\n\n      /* é€‰æ‹©æ¡†ä¸‹æ‹‰ç®­å¤´ */\n      .acu-wrapper select,\n      .acu-modal-container select,\n      .acu-settings-control select {\n        -webkit-appearance: none !important;\n        -moz-appearance: none !important;\n        appearance: none !important;\n        padding-right: 30px !important;\n        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23666'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") !important;\n        background-repeat: no-repeat !important;\n        background-position: right 8px center !important;\n        background-size: 16px !important;\n      }\n\n      /* æ»šåŠ¨æ¡ æ±¡æŸ“é˜²æŠ¤ */\n      .acu-wrapper::-webkit-scrollbar,\n      .acu-wrapper *::-webkit-scrollbar,\n      .acu-modal-container::-webkit-scrollbar,\n      .acu-modal-container *::-webkit-scrollbar {\n        width: 6px !important;\n        height: 6px !important;\n      }\n\n      .acu-wrapper::-webkit-scrollbar-track,\n      .acu-wrapper *::-webkit-scrollbar-track,\n      .acu-modal-container::-webkit-scrollbar-track,\n      .acu-modal-container *::-webkit-scrollbar-track {\n        background: transparent !important;\n        background-color: transparent !important;\n      }\n\n      .acu-wrapper::-webkit-scrollbar-thumb,\n      .acu-wrapper *::-webkit-scrollbar-thumb,\n      .acu-modal-container::-webkit-scrollbar-thumb,\n      .acu-modal-container *::-webkit-scrollbar-thumb {\n        background: var(--acu-border) !important;\n        background-color: var(--acu-border) !important;\n        background-image: none !important;\n        border-radius: 3px !important;\n        border: none !important;\n        box-shadow: none !important;\n      }\n\n      .acu-wrapper::-webkit-scrollbar-thumb:hover,\n      .acu-wrapper *::-webkit-scrollbar-thumb:hover,\n      .acu-modal-container::-webkit-scrollbar-thumb:hover,\n      .acu-modal-container *::-webkit-scrollbar-thumb:hover {\n        background: var(--acu-text-sub) !important;\n        background-color: var(--acu-text-sub) !important;\n      }\n\n      /* æ–‡æœ¬å…ƒç´  æ±¡æŸ“é˜²æŠ¤ - å¿…é¡»åŒæ—¶é‡ç½® font-family */\n      .acu-wrapper,\n      .acu-wrapper p,\n      .acu-wrapper div,\n      .acu-wrapper span,\n      .acu-wrapper label,\n      .acu-wrapper li,\n      .acu-wrapper a,\n      .acu-wrapper button,\n      .acu-wrapper th,\n      .acu-wrapper td,\n      .acu-modal-container,\n      .acu-modal-container p,\n      .acu-modal-container div,\n      .acu-modal-container span,\n      .acu-modal-container label,\n      .acu-modal-container li,\n      .acu-modal-container a,\n      .acu-modal-container button,\n      .acu-modal-container th,\n      .acu-modal-container td {\n        font-family: var(--acu-font-family) !important;\n        font-size: var(--acu-font-size, 13px) !important;\n        text-shadow: none !important;\n        line-height: 1.5 !important;\n      }\n\n      /* æ™®é€šæ–‡æœ¬é¢œè‰² - ç‰¹å®šé€‰æ‹©å™¨ */\n      .acu-settings-label,\n      .acu-card-label,\n      .acu-grid-label,\n      .acu-full-label,\n      .acu-wrapper .acu-card-value,\n      .acu-wrapper .acu-grid-value,\n      .acu-modal-container .acu-modal-body {\n        color: var(--acu-text-main) !important;\n        font-size: var(--acu-font-size, 13px) !important;\n      }\n\n      /* æ¬¡è¦æ–‡æœ¬é¢œè‰² */\n      .acu-wrapper .hint,\n      .acu-wrapper .acu-text-sub,\n      .acu-modal-container .hint,\n      .acu-modal-container .acu-text-sub,\n      .acu-settings-label .hint {\n        color: var(--acu-text-sub) !important;\n        font-size: 11px !important;\n      }\n\n      /* æ ‡é¢˜ - ä½¿ç”¨ --acu-title-color é˜²æ­¢é…’é¦†æ±¡æŸ“ */\n      .acu-wrapper h1,\n      .acu-wrapper h2,\n      .acu-wrapper h3,\n      .acu-wrapper h4,\n      .acu-wrapper h5,\n      .acu-wrapper h6,\n      .acu-modal-container h1,\n      .acu-modal-container h2,\n      .acu-modal-container h3,\n      .acu-modal-container h4,\n      .acu-modal-container h5,\n      .acu-modal-container h6 {\n        color: var(--acu-title-color) !important;\n        text-shadow: none !important;\n        font-weight: 600 !important;\n      }\n\n      /* å¼¹çª—æ ‡é¢˜ - ä½¿ç”¨ --acu-text-main */\n      .acu-settings-title,\n      .acu-modal-title {\n        color: var(--acu-text-main) !important;\n        text-shadow: none !important;\n        font-weight: 600 !important;\n      }\n\n      /* é¢æ¿æ ‡é¢˜å’Œè¡Œæ ‡é¢˜ - ä½¿ç”¨ --acu-title-color + ç”¨æˆ·å­—ä½“ */\n      .acu-panel-title,\n      .acu-editable-title,\n      .acu-card-label,\n      .acu-grid-label,\n      .acu-full-label {\n        color: var(--acu-title-color) !important;\n        font-family: var(--acu-font-family) !important;\n        text-shadow: none !important;\n        font-weight: 600 !important;\n      }\n\n      /* Tab æŒ‰é’® - ç²¾ç¡®ä¿æŠ¤ */\n      .acu-tab-btn,\n      .acu-tab-btn span,\n      .acu-nav-btn,\n      .acu-action-btn {\n        font-family: var(--acu-font-family) !important;\n        font-size: var(--acu-font-size, 13px) !important;\n        text-shadow: none !important;\n      }\n\n\n      /* Tab æŒ‰é’®å­—ä½“ */\n      .acu-tab-btn,\n      .acu-nav-btn,\n      .acu-action-btn {\n        font-family: var(--acu-font-family) !important;\n        font-size: var(--acu-font-size, 13px) !important;\n        text-shadow: none !important;\n      }\n\n      /* æŠ˜å æ æ ‡é¢˜ */\n      .acu-settings-section .acu-settings-title,\n      .acu-config-section h4,\n      .acu-collapse-header,\n      .acu-collapse-title,\n      summary {\n        font-family: var(--acu-font-family) !important;\n        font-size: var(--acu-font-size, 13px) !important;\n        color: var(--acu-text-main) !important;\n        text-shadow: none !important;\n      }\n\n      /* å›¾æ ‡å­—ä½“ä¿æŠ¤ - Font Awesome ä¸åº”è¢«è¦†ç›– */\n      .acu-wrapper i.fa,\n      .acu-wrapper i.fas,\n      .acu-wrapper i.far,\n      .acu-wrapper i.fab,\n      .acu-wrapper .fa,\n      .acu-wrapper .fas,\n      .acu-wrapper .far,\n      .acu-wrapper .fab,\n      .acu-modal-container i.fa,\n      .acu-modal-container i.fas,\n      .acu-modal-container i.far,\n      .acu-modal-container i.fab,\n      .acu-modal-container .fa,\n      .acu-modal-container .fas,\n      .acu-modal-container .far,\n      .acu-modal-container .fab {\n        font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important;\n      }\n    `;r.value.textContent=c},d=()=>{if(!i.value)return;const e=t.getFullInjectedCSS();i.value.textContent=e,console.info('[ACU Styles] Theme custom styles updated')},p=t=>{const o=a().querySelector('.acu-wrapper');if(!o)return;const n=t||e.config.theme||'retro';f.zG.forEach(e=>{o.classList.remove(`acu-theme-${e.id}`)}),o.classList.add(`acu-theme-${n}`),console.info(`[ACU Styles] Theme applied: ${n}`)},y=t=>{const o=a().querySelector('.acu-data-display');if(!o)return;const n=t||e.config.layout||'vertical';o.classList.remove('acu-layout-vertical','acu-layout-horizontal'),o.classList.add(`acu-layout-${n}`),console.info(`[ACU Styles] Layout applied: ${n}`)},w=t=>{s(),console.info(`[ACU Styles] Font applied: ${t||e.config.fontFamily}`)},k=()=>{const e=a(),t=o.value;e.getElementById(`${b}-base-${t}`)?.remove(),e.getElementById(`${b}-dynamic-${t}`)?.remove(),e.getElementById(`${h}-${t}`)?.remove(),e.getElementById(`${x}-${t}`)?.remove(),n.value=null,r.value=null,l.value=null,i.value=null,c.value=!1,console.info('[ACU Styles] Styles cleaned up')},C=()=>{c.value?console.info('[ACU Styles] Already initialized'):((()=>{const e=a(),t=`${b}-base-${o.value}`;if(e.getElementById(t))return console.info('[ACU Styles] Base styles already injected'),void(n.value=e.getElementById(t));const r=e.createElement('style');r.id=t,r.setAttribute('data-source','acu-visualizer'),r.textContent='/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */@import "https://fontsapi.zeoseven.com/69/main/result.css";@import "https://fontsapi.zeoseven.com/3/main/result.css";@import "https://fontsapi.zeoseven.com/442/main/result.css";@import "https://fontsapi.zeoseven.com/256/main/result.css";@import "https://fontsapi.zeoseven.com/482/main/result.css";@import "https://fontsapi.zeoseven.com/446/main/result.css";@import "https://fontsapi.zeoseven.com/570/main/result.css";@import "https://fontsapi.zeoseven.com/292/main/result.css";@import "https://fontsapi.zeoseven.com/7/main/result.css";:root{--acu-neutral-50:#fafafa;--acu-neutral-100:#f5f5f5;--acu-neutral-200:#eeeeee;--acu-neutral-300:#e0e0e0;--acu-neutral-400:#bdbdbd;--acu-neutral-500:#9e9e9e;--acu-neutral-600:#757575;--acu-neutral-700:#616161;--acu-neutral-800:#424242;--acu-neutral-900:#212121;--acu-success:#27ae60;--acu-warning:#f39c12;--acu-danger:#e74c3c;--acu-info:#3498db;--acu-z-ball:2147483646;--acu-z-overlay:2147483647;--acu-z-menu:2147483648;--acu-radius-sm:6px;--acu-radius-md:12px;--acu-radius-lg:16px;--acu-shadow-sm:0 2px 8px rgba(0,0,0,0.1);--acu-shadow-md:0 4px 16px rgba(0,0,0,0.15);--acu-shadow-lg:0 15px 50px rgba(0,0,0,0.3);--acu-transition-fast:0.15s;--acu-transition-normal:0.3s;--acu-transition-slow:0.5s}.acu-wrapper,.acu-theme-retro{--acu-bg-nav:#e6e2d3;--acu-bg-panel:#e6e2d3;--acu-card-bg:#fffef9;--acu-table-head:#efebe4;--acu-table-hover:#f0ebe0;--acu-badge-bg:#efebe4;--acu-input-bg:rgba(255,255,255,0.5);--acu-menu-bg:#fff;--acu-overlay-bg:rgba(94,75,53,0.4);--acu-text-main:#5e4b35;--acu-text-sub:#999;--acu-menu-text:#333;--acu-border:#dcd0c0;--acu-btn-bg:#dcd0c0;--acu-btn-hover:#cbbba8;--acu-btn-active-bg:#8d7b6f;--acu-btn-active-text:#fdfaf5;--acu-shadow:rgba(0,0,0,0.1);--acu-card-width:280px;--acu-font-size:13px;--acu-highlight:#d35400;--acu-title-color-bg:rgba(211,84,0,0.08);--acu-title-color:#d35400;--acu-accent:#d35400;--acu-nav-cols:repeat(auto-fill,minmax(90px,1fr));--acu-text-max-height:80px;--acu-text-overflow:auto;--acu-win-width:400px;--acu-win-left:100px;--acu-win-bottom:100px}.acu-theme-dark{--acu-bg-nav:rgba(43,43,43,0.95);--acu-bg-panel:rgba(37,37,37,0.95);--acu-border:#444;--acu-text-main:#eee;--acu-text-sub:#aaa;--acu-btn-bg:rgba(58,58,58,0.5);--acu-btn-hover:#4a4a4a;--acu-btn-active-bg:#6a5acd;--acu-btn-active-text:#fff;--acu-table-head:rgba(51,51,51,0.8);--acu-table-hover:rgba(58,58,58,0.5);--acu-shadow:rgba(0,0,0,0.6);--acu-card-bg:rgba(45,48,53,0.8);--acu-badge-bg:#3a3f4b;--acu-menu-bg:#333;--acu-menu-text:#eee;--acu-input-bg:rgba(0,0,0,0.3);--acu-overlay-bg:rgba(0,0,0,0.75)}.acu-theme-modern{--acu-bg-nav:#ffffff;--acu-bg-panel:#f8f9fa;--acu-border:#e0e0e0;--acu-text-main:#333;--acu-text-sub:#888;--acu-btn-bg:#f1f3f5;--acu-btn-hover:#e9ecef;--acu-btn-active-bg:#007bff;--acu-btn-active-text:#fff;--acu-table-head:#f8f9fa;--acu-table-hover:#f1f3f5;--acu-shadow:rgba(0,0,0,0.08);--acu-card-bg:#ffffff;--acu-badge-bg:#f1f3f5;--acu-menu-bg:#fff;--acu-menu-text:#333;--acu-input-bg:#ffffff;--acu-overlay-bg:rgba(0,0,0,0.3)}.acu-theme-forest{--acu-bg-nav:#e8f5e9;--acu-bg-panel:#e8f5e9;--acu-border:#c8e6c9;--acu-text-main:#2e7d32;--acu-text-sub:#81c784;--acu-btn-bg:#c8e6c9;--acu-btn-hover:#a5d6a7;--acu-btn-active-bg:#43a047;--acu-btn-active-text:#fff;--acu-table-head:#dcedc8;--acu-table-hover:#f1f8e9;--acu-shadow:rgba(0,0,0,0.1);--acu-card-bg:#ffffff;--acu-badge-bg:#dcedc8;--acu-menu-bg:#fff;--acu-menu-text:#2e7d32;--acu-input-bg:rgba(255,255,255,0.7);--acu-overlay-bg:rgba(46,125,50,0.2)}.acu-theme-ocean{--acu-bg-nav:#e3f2fd;--acu-bg-panel:#e3f2fd;--acu-border:#bbdefb;--acu-text-main:#1565c0;--acu-text-sub:#64b5f6;--acu-btn-bg:#bbdefb;--acu-btn-hover:#90caf9;--acu-btn-active-bg:#1976d2;--acu-btn-active-text:#fff;--acu-table-head:#bbdefb;--acu-table-hover:#e1f5fe;--acu-shadow:rgba(0,0,0,0.15);--acu-card-bg:#ffffff;--acu-badge-bg:#e3f2fd;--acu-menu-bg:#fff;--acu-menu-text:#1565c0;--acu-input-bg:rgba(255,255,255,0.7);--acu-overlay-bg:rgba(21,101,192,0.2)}.acu-theme-cyber{--acu-bg-nav:#000000;--acu-bg-panel:#0a0a0a;--acu-border:#333;--acu-text-main:#00ffcc;--acu-text-sub:#ff00ff;--acu-btn-bg:#1a1a1a;--acu-btn-hover:#333;--acu-btn-active-bg:#ff00ff;--acu-btn-active-text:#fff;--acu-table-head:#111;--acu-table-hover:#1a1a1a;--acu-shadow:0 0 10px rgba(0,255,204,0.3);--acu-card-bg:#050505;--acu-badge-bg:#222;--acu-menu-bg:#111;--acu-menu-text:#00ffcc;--acu-input-bg:#111;--acu-overlay-bg:rgba(0,0,0,0.85)}.acu-theme-purple{--acu-bg-nav:#ede7f6;--acu-bg-panel:#ede7f6;--acu-border:#d1c4e9;--acu-text-main:#4a148c;--acu-text-sub:#7b1fa2;--acu-btn-bg:#d1c4e9;--acu-btn-hover:#b39ddb;--acu-btn-active-bg:#7b1fa2;--acu-btn-active-text:#fff;--acu-table-head:#f5f0fa;--acu-table-hover:#f3e5f5;--acu-shadow:rgba(74,20,140,0.1);--acu-card-bg:#faf8fc;--acu-badge-bg:#f5f0fa;--acu-menu-bg:#faf8fc;--acu-menu-text:#4a148c;--acu-input-bg:rgba(255,255,255,0.8);--acu-overlay-bg:rgba(74,20,140,0.3)}.acu-wrapper[data-font=hanchan]{--acu-font-family:\'HanChanQuanYuan\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=maple]{--acu-font-family:\'Maple Mono\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=huiwen]{--acu-font-family:\'Huiwen-mincho\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=cooper]{--acu-font-family:\'Cooper Zhengkai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=yffyt]{--acu-font-family:\'YFFYT\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=fusion]{--acu-font-family:\'Fusion Pixel 12px M latin\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=lxgw]{--acu-font-family:\'LXGW WenKai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=siyuan]{--acu-font-family:\'Source Han Sans SC\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=zhuque]{--acu-font-family:\'Zhuque Fangsong (technical preview)\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-hanchan{--acu-font-family:\'HanChanQuanYuan\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-maple{--acu-font-family:\'Maple Mono\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-huiwen{--acu-font-family:\'Huiwen-mincho\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-cooper{--acu-font-family:\'Cooper Zhengkai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-yffyt{--acu-font-family:\'YFFYT\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-fusion{--acu-font-family:\'Fusion Pixel 12px M latin\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-lxgw{--acu-font-family:\'LXGW WenKai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-siyuan{--acu-font-family:\'Source Han Sans SC\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-zhuque{--acu-font-family:\'Zhuque Fangsong (technical preview)\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper,.acu-wrapper *,.acu-modal-container,.acu-modal-container *,#acu-ghost-preview{font-family:var(--acu-font-family,Source Han Sans SC,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif)}.acu-text-xs{font-size:11px}.acu-text-sm{font-size:12px}.acu-text-base{font-size:13px}.acu-text-md{font-size:14px}.acu-text-lg{font-size:15px}.acu-text-xl{font-size:16px}.acu-text-2xl{font-size:18px}.acu-text-3xl{font-size:20px}.acu-font-normal{font-weight:400}.acu-font-medium{font-weight:500}.acu-font-semibold{font-weight:600}.acu-font-bold{font-weight:700}.acu-font-extrabold{font-weight:800}.acu-title{font-weight:700;color:var(--acu-title-color);line-height:1.35}.acu-wrapper[data-font=fusion],.acu-font-fusion{-webkit-font-smoothing:none;-moz-osx-font-smoothing:unset;font-smooth:never;text-rendering:optimizeSpeed}:where(.acu-wrapper,.acu-modal-container) input,:where(.acu-wrapper,.acu-modal-container) select,:where(.acu-wrapper,.acu-modal-container) textarea{background:var(--acu-card-bg) !important;background-color:var(--acu-card-bg) !important;background-image:none !important;border:1px solid var(--acu-border) !important;border-radius:6px !important;font-family:inherit !important;font-size:inherit !important;color:var(--acu-text-main) !important;text-shadow:none !important;box-shadow:none !important;backdrop-filter:none !important;filter:none !important;transition:border-color .2s ease !important}:where(.acu-wrapper,.acu-modal-container) input:hover,:where(.acu-wrapper,.acu-modal-container) input:focus,:where(.acu-wrapper,.acu-modal-container) select:hover,:where(.acu-wrapper,.acu-modal-container) select:focus,:where(.acu-wrapper,.acu-modal-container) textarea:hover,:where(.acu-wrapper,.acu-modal-container) textarea:focus{background:var(--acu-card-bg) !important;background-color:var(--acu-card-bg) !important;background-image:none !important;border-color:var(--acu-title-color) !important;box-shadow:0 0 0 2px rgba(var(--acu-title-color-rgb,52,152,219),0.15) !important;outline:none !important}:where(.acu-wrapper,.acu-modal-container) input[type=range]{-webkit-appearance:none !important;appearance:none !important;background:rgba(0,0,0,0) !important;background-color:rgba(0,0,0,0) !important;background-image:none !important;border:none !important;box-shadow:none !important;height:20px !important}:where(.acu-wrapper,.acu-modal-container) input[type=range]::-webkit-slider-thumb{-webkit-appearance:none !important;appearance:none !important;width:16px !important;height:16px !important;background:var(--acu-title-color) !important;background-color:var(--acu-title-color) !important;background-image:none !important;border-radius:50% !important;border:none !important;margin-top:-5px !important;cursor:pointer !important;box-shadow:0 1px 3px rgba(0,0,0,.2) !important}:where(.acu-wrapper,.acu-modal-container) input[type=range]::-webkit-slider-runnable-track{-webkit-appearance:none !important;width:100% !important;height:6px !important;background:var(--acu-border) !important;background-color:var(--acu-border) !important;background-image:none !important;border-radius:3px !important;border:none !important;cursor:pointer !important;box-shadow:none !important}:where(.acu-wrapper,.acu-modal-container) input[type=range]::-moz-range-thumb{-moz-appearance:none !important;width:16px !important;height:16px !important;background:var(--acu-title-color) !important;background-color:var(--acu-title-color) !important;background-image:none !important;border-radius:50% !important;border:none !important;cursor:pointer !important;box-shadow:0 1px 3px rgba(0,0,0,.2) !important}:where(.acu-wrapper,.acu-modal-container) input[type=range]::-moz-range-track{-moz-appearance:none !important;width:100% !important;height:6px !important;background:var(--acu-border) !important;background-color:var(--acu-border) !important;background-image:none !important;border-radius:3px !important;border:none !important;cursor:pointer !important;box-shadow:none !important}:where(.acu-wrapper,.acu-modal-container) select{-webkit-appearance:none !important;appearance:none !important;padding-right:30px !important;background-image:url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 24 24\' fill=\'%23666\'%3E%3Cpath d=\'M7 10l5 5 5-5z\'/%3E%3C/svg%3E") !important;background-repeat:no-repeat !important;background-position:right 8px center !important;background-size:16px !important}:where(.acu-wrapper,.acu-modal-container),:where(.acu-wrapper,.acu-modal-container) p,:where(.acu-wrapper,.acu-modal-container) div,:where(.acu-wrapper,.acu-modal-container) span,:where(.acu-wrapper,.acu-modal-container) label,:where(.acu-wrapper,.acu-modal-container) li,:where(.acu-wrapper,.acu-modal-container) a,:where(.acu-wrapper,.acu-modal-container) button,:where(.acu-wrapper,.acu-modal-container) input,:where(.acu-wrapper,.acu-modal-container) select,:where(.acu-wrapper,.acu-modal-container) textarea,:where(.acu-wrapper,.acu-modal-container) th,:where(.acu-wrapper,.acu-modal-container) td{font-family:var(--acu-font-family,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif) !important;font-size:inherit;text-shadow:none !important;line-height:1.5}:where(.acu-wrapper,.acu-modal-container)>p,:where(.acu-wrapper,.acu-modal-container)>div:not([class*=title]):not([class*=Title]),:where(.acu-wrapper,.acu-modal-container)>span:not([class*=title]):not([class*=Title]),:where(.acu-wrapper,.acu-modal-container) .acu-settings-label,:where(.acu-wrapper,.acu-modal-container) .acu-card-label,:where(.acu-wrapper,.acu-modal-container) .acu-grid-label,:where(.acu-wrapper,.acu-modal-container) .acu-full-label{color:var(--acu-text-main);font-size:var(--acu-font-size,13px)}:where(.acu-wrapper,.acu-modal-container) .hint,:where(.acu-wrapper,.acu-modal-container) .acu-text-sub,:where(.acu-wrapper,.acu-modal-container) .acu-settings-label .hint{color:var(--acu-text-sub);font-size:11px}:where(.acu-wrapper,.acu-modal-container) h1,:where(.acu-wrapper,.acu-modal-container) h2,:where(.acu-wrapper,.acu-modal-container) h3,:where(.acu-wrapper,.acu-modal-container) h4,:where(.acu-wrapper,.acu-modal-container) h5,:where(.acu-wrapper,.acu-modal-container) h6{color:var(--acu-title-color);font-family:var(--acu-font-family,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif) !important;text-shadow:none !important;font-weight:600}:where(.acu-wrapper,.acu-modal-container) .acu-modal-title,:where(.acu-wrapper,.acu-modal-container) .acu-settings-title{color:var(--acu-text-main);font-family:var(--acu-font-family,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif) !important;text-shadow:none !important;font-weight:600}:where(.acu-wrapper,.acu-modal-container) .acu-panel-title,:where(.acu-wrapper,.acu-modal-container) .acu-editable-title,:where(.acu-wrapper,.acu-modal-container) .acu-card-label,:where(.acu-wrapper,.acu-modal-container) .acu-grid-label,:where(.acu-wrapper,.acu-modal-container) .acu-full-label{color:var(--acu-title-color);font-family:var(--acu-font-family,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif) !important;text-shadow:none !important;font-weight:600}:where(.acu-wrapper,.acu-modal-container) .acu-tab-btn,:where(.acu-wrapper,.acu-modal-container) .acu-tab-btn span,:where(.acu-wrapper,.acu-modal-container) .acu-nav-btn,:where(.acu-wrapper,.acu-modal-container) .acu-action-btn{font-family:var(--acu-font-family,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif) !important;font-size:var(--acu-font-size,13px);text-shadow:none !important}:where(.acu-wrapper,.acu-modal-container) .acu-toast,:where(.acu-wrapper,.acu-modal-container) .acu-toast-message,:where(.acu-wrapper,.acu-modal-container) .acu-toast span{font-family:var(--acu-font-family,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif) !important;font-size:var(--acu-font-size,13px);text-shadow:none !important;color:var(--acu-text-main)}:where(.acu-wrapper,.acu-modal-container) .acu-settings-section .acu-settings-title,:where(.acu-wrapper,.acu-modal-container) .acu-config-section h4,:where(.acu-wrapper,.acu-modal-container) .acu-collapse-header,:where(.acu-wrapper,.acu-modal-container) .acu-collapse-title,:where(.acu-wrapper,.acu-modal-container) summary{font-family:var(--acu-font-family,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif) !important;font-size:var(--acu-font-size,13px);color:var(--acu-text-main);text-shadow:none !important}:where(.acu-wrapper,.acu-modal-container) i.fa,:where(.acu-wrapper,.acu-modal-container) i.fas,:where(.acu-wrapper,.acu-modal-container) i.far,:where(.acu-wrapper,.acu-modal-container) i.fab,:where(.acu-wrapper,.acu-modal-container) .fa,:where(.acu-wrapper,.acu-modal-container) .fas,:where(.acu-wrapper,.acu-modal-container) .far,:where(.acu-wrapper,.acu-modal-container) .fab{font-family:"Font Awesome 6 Free","Font Awesome 5 Free",FontAwesome !important;font-weight:900 !important;font-style:normal !important;font-variant:normal !important;line-height:1 !important;text-rendering:auto !important;-webkit-font-smoothing:antialiased !important}.acu-wrapper,.acu-modal-container,.acu-wrapper *,.acu-modal-container *{scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-wrapper::-webkit-scrollbar,.acu-modal-container::-webkit-scrollbar,.acu-wrapper *::-webkit-scrollbar,.acu-modal-container *::-webkit-scrollbar{width:6px !important;height:6px !important}.acu-wrapper::-webkit-scrollbar-track,.acu-modal-container::-webkit-scrollbar-track,.acu-wrapper *::-webkit-scrollbar-track,.acu-modal-container *::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important;background-color:rgba(0,0,0,0) !important}.acu-wrapper::-webkit-scrollbar-thumb,.acu-modal-container::-webkit-scrollbar-thumb,.acu-wrapper *::-webkit-scrollbar-thumb,.acu-modal-container *::-webkit-scrollbar-thumb{background:var(--acu-border) !important;background-color:var(--acu-border) !important;background-image:none !important;border-radius:3px !important;border:none !important;box-shadow:none !important}.acu-wrapper::-webkit-scrollbar-thumb:hover,.acu-modal-container::-webkit-scrollbar-thumb:hover,.acu-wrapper *::-webkit-scrollbar-thumb:hover,.acu-modal-container *::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub) !important;background-color:var(--acu-text-sub) !important}.acu-wrapper::-webkit-scrollbar-corner,.acu-modal-container::-webkit-scrollbar-corner,.acu-wrapper *::-webkit-scrollbar-corner,.acu-modal-container *::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}.acu-wrapper,.acu-wrapper *,.acu-wrapper *::before,.acu-wrapper *::after{box-sizing:border-box}.acu-wrapper{font-family:var(--acu-font-family,Source Han Sans SC,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif);font-size:var(--acu-font-size,13px);color:var(--acu-text-main);line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.acu-wrapper{scrollbar-width:thin !important;scrollbar-color:var(--acu-title-color,var(--acu-border)) rgba(0,0,0,0) !important}.acu-wrapper::-webkit-scrollbar,.acu-wrapper *::-webkit-scrollbar{width:6px !important;height:6px !important}.acu-wrapper::-webkit-scrollbar-track,.acu-wrapper *::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important}.acu-wrapper::-webkit-scrollbar-thumb,.acu-wrapper *::-webkit-scrollbar-thumb{background:var(--acu-border) !important;border-radius:3px !important}.acu-wrapper::-webkit-scrollbar-thumb:hover,.acu-wrapper *::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub) !important}.acu-wrapper::-webkit-scrollbar-corner,.acu-wrapper *::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}.acu-wrapper *{scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-panel-content{scrollbar-width:thin !important;scrollbar-color:var(--acu-title-color) rgba(0,0,0,0) !important}.acu-panel-content::-webkit-scrollbar{width:6px !important;height:6px !important}.acu-panel-content::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important}.acu-panel-content::-webkit-scrollbar-thumb{background-color:var(--acu-title-color) !important;border-radius:3px !important}.acu-panel-content::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}.acu-modal-container{scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-modal-container::-webkit-scrollbar,.acu-modal-container *::-webkit-scrollbar{width:6px !important;height:6px !important}.acu-modal-container::-webkit-scrollbar-track,.acu-modal-container *::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important}.acu-modal-container::-webkit-scrollbar-thumb,.acu-modal-container *::-webkit-scrollbar-thumb{background:var(--acu-border) !important;border-radius:3px !important}.acu-modal-container::-webkit-scrollbar-thumb:hover,.acu-modal-container *::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub) !important}.acu-modal-container::-webkit-scrollbar-corner,.acu-modal-container *::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}.acu-modal-container *{scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-wrapper ::selection{background:var(--acu-title-color);color:#fff}.acu-wrapper ::-moz-selection{background:var(--acu-title-color);color:#fff}#acu-parent-container{position:fixed !important;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;z-index:var(--acu-z-overlay);pointer-events:none !important;display:flex;flex-direction:column-reverse;justify-content:flex-start}#acu-parent-container .acu-wrapper{position:absolute !important;width:var(--acu-win-width,600px) !important;left:var(--acu-win-left,50%) !important;bottom:var(--acu-win-bottom,50%) !important;max-width:98vw;pointer-events:none;display:flex;flex-direction:column-reverse;transform-origin:bottom center;will-change:transform;transition:none !important;touch-action:none}.acu-hidden{display:none !important}.acu-grid-value,.acu-full-value,.acu-card-value,.acu-editable-title,.acu-grid-label,.acu-full-label,.acu-card-label{user-select:text !important;-webkit-user-select:text !important;cursor:text}.acu-app{font-family:var(--acu-font-family,"Microsoft YaHei",sans-serif);font-size:var(--acu-font-size,13px);color:var(--acu-text-main,#333);position:relative;z-index:2147483640}.acu-no-data{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 24px;color:var(--acu-text-muted,#999);text-align:center}.acu-no-data i{font-size:48px;margin-bottom:16px;opacity:.5}.acu-no-data p{margin:0;font-size:var(--acu-font-size,13px)}@keyframes acu-shake{0%,100%{transform:rotate(0deg)}25%{transform:rotate(10deg)}50%{transform:rotate(0deg)}75%{transform:rotate(-10deg)}}@keyframes acu-shake-x{0%,100%{transform:translateX(0)}10%,30%,50%,70%,90%{transform:translateX(-4px)}20%,40%,60%,80%{transform:translateX(4px)}}@keyframes acu-fade-in{from{opacity:0}to{opacity:1}}@keyframes acu-fade-out{from{opacity:1}to{opacity:0}}@keyframes acu-pop-up{from{opacity:0;transform:scale(0.9) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}@keyframes acu-pop-down{from{opacity:1;transform:scale(1) translateY(0)}to{opacity:0;transform:scale(0.9) translateY(10px)}}@keyframes acu-slide-in-right{from{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}@keyframes acu-slide-in-left{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}@keyframes acu-slide-in-up{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes acu-slide-in-down{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}@keyframes acu-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@keyframes acu-bounce{0%,20%,50%,80%,100%{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}.acu-animate-spin{animation:acu-spin 1s linear infinite}.acu-highlight-changed:not(.acu-data-card){color:var(--acu-title-color) !important;font-weight:bold}.acu-save-alert{animation:acu-shake .4s ease-in-out infinite;color:#fff !important;background-color:#e74c3c !important;text-shadow:0 0 5px rgba(231,76,60,.5);border-color:#c0392b !important}.acu-badge-pending{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-15deg);width:80px;height:80px;border:4px solid #e74c3c;border-radius:50%;color:#e74c3c;font-size:20px;font-weight:900;display:flex;align-items:center;justify-content:center;z-index:50;pointer-events:none;opacity:.6;box-shadow:inset 0 0 10px rgba(231,76,60,.2);background:hsla(0,0%,100%,.1)}.acu-wrapper{position:fixed;left:var(--acu-win-left,50%);bottom:var(--acu-win-bottom,50%);width:var(--acu-win-width,400px);transform:translate(-50%,50%);display:flex;flex-direction:column-reverse;z-index:2147483645;pointer-events:auto !important;max-height:100vh;max-height:calc(100vh - var(--acu-win-bottom,50%))}.acu-wrapper.collapsed{display:none}#acu-parent-container{position:fixed !important;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;z-index:2147483647;pointer-events:none !important;display:flex;flex-direction:column-reverse;justify-content:flex-start}#acu-parent-container .acu-wrapper{position:relative;max-width:100vw;pointer-events:auto !important;display:flex;flex-direction:column-reverse;transform-origin:bottom center;will-change:transform;transition:none !important}#acu-parent-container .acu-wrapper{position:absolute !important;width:min(var(--acu-win-width,600px),100vw) !important;left:var(--acu-win-left,50%) !important;bottom:var(--acu-win-bottom,50%) !important;transform:translate(-50%,50%);touch-action:none;max-height:calc(100vh - var(--acu-win-bottom,50%)) !important}.acu-wrapper.acu-centered-mode{bottom:auto !important;top:50vh !important;left:50vw !important;transform:translate(-50%,-50%) !important;max-height:none !important}.acu-wrapper.acu-centered-mode .acu-data-display{display:none !important}#acu-parent-container .acu-wrapper.acu-centered-mode{position:fixed !important;bottom:auto !important;top:50vh !important;left:50vw !important;transform:translate(-50%,-50%) !important;max-height:none !important}.acu-data-display{order:2;flex:1 1 auto;min-height:150px;margin-bottom:3px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:12px;position:relative;display:none;flex-direction:column;backdrop-filter:blur(8px);box-shadow:0 -5px 25px rgba(0,0,0,.3);width:100%;overscroll-behavior:contain;isolation:isolate;pointer-events:auto !important;overflow:hidden}.acu-data-display.visible{display:flex}.acu-data-display.has-modal{z-index:100;overflow:visible !important}.acu-data-display.acu-layout-horizontal{touch-action:pan-x pan-y !important;overflow:hidden}.acu-data-display.acu-layout-vertical{touch-action:pan-y !important;overflow:hidden}.acu-panel-content{flex:1;display:flex;flex-direction:column;min-height:0;overflow:hidden;padding:0;scrollbar-width:thin;scrollbar-color:var(--acu-title-color) rgba(0,0,0,0)}.acu-panel-content::-webkit-scrollbar{width:6px;height:6px}.acu-panel-content::-webkit-scrollbar-thumb{background-color:var(--acu-title-color);border-radius:3px}.acu-panel-header{flex:0 0 auto;display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border);border-radius:12px 12px 0 0}.acu-panel-title{font-weight:bold;color:var(--acu-text-main);display:flex;align-items:center;gap:8px;white-space:nowrap;font-size:15px}.acu-header-actions{display:flex;align-items:center;gap:10px}.acu-resize-handle{display:block !important;pointer-events:auto !important;position:absolute;right:-12px;top:0;bottom:0;width:14px;cursor:ew-resize;z-index:2147483650;touch-action:none}.acu-resize-handle::after{content:"";position:absolute;left:0;top:0;bottom:0;width:2px;background:var(--acu-border);opacity:.3;transition:opacity .2s}.acu-resize-handle:hover::after{background:var(--acu-title-color);opacity:1;width:4px;left:0}@media (max-width:768px){.acu-resize-handle{display:none !important;pointer-events:none !important}}.acu-close-btn{background:none;border:none;color:var(--acu-text-sub);cursor:pointer;font-size:16px;padding:4px;transition:color .2s}.acu-close-btn:hover{color:#e74c3c}.acu-layout-horizontal .acu-panel-content{overflow:hidden !important;min-height:150px}.acu-data-display.acu-layout-horizontal{min-height:200px}.acu-data-display.acu-layout-horizontal.visible{display:flex;flex-direction:column}@media (max-width:768px){#acu-btn-pin{display:none !important}.acu-panel-header{padding:4px 10px !important;min-height:38px !important}.acu-panel-title{font-size:13px !important;margin-right:auto}.acu-search-input{height:28px !important;width:80px !important;font-size:12px !important}.acu-search-input:focus{width:120px !important}.acu-nav-container{padding:8px 6px !important;gap:0 !important}.acu-nav-separator{margin:1px 0 !important;opacity:.2}.acu-nav-tabs-area{gap:1px !important}.acu-nav-btn{padding:6px 2px !important;font-size:12px !important;min-height:32px !important}.acu-nav-actions-area{padding-top:2px !important;gap:8px !important;display:flex !important;width:100% !important}.acu-action-btn{width:auto !important;flex:1 !important;height:40px !important;border-radius:8px !important;background:var(--acu-btn-bg);margin:0 !important}.acu-action-btn i{font-size:18px !important}.acu-action-btn:active{background:var(--acu-btn-active-bg);color:#fff}}@media (max-width:700px){.acu-dash-container{grid-template-columns:1fr}}.acu-settings-modal{max-width:720px}.acu-settings-modal .acu-modal-body{padding:0}.acu-settings-section{padding:12px 16px}.acu-settings-section:first-child{padding-top:16px}.acu-settings-title{font-size:13px;font-weight:600;color:var(--acu-text-main);margin-bottom:8px;padding:0 4px;display:flex;align-items:center;gap:8px}.acu-settings-title i{color:var(--acu-text-main);font-size:14px}.acu-settings-group{padding:12px 16px;background:var(--acu-table-head);border-radius:12px;border:none}.acu-settings-row{display:flex;align-items:center;justify-content:space-between;padding:10px 0}.acu-settings-row:not(:last-child){border-bottom:1px solid var(--acu-border)}.acu-settings-row.column{flex-direction:column;align-items:stretch;gap:8px}.acu-settings-row.column .acu-settings-label{width:100%}.acu-settings-row.column .acu-settings-control{width:100%}.acu-settings-label{font-size:13px;font-weight:600;color:var(--acu-text-main);display:flex;flex-direction:column;gap:2px}.acu-settings-label .hint{font-size:11px;font-weight:400;color:var(--acu-text-sub)}.acu-settings-control{display:flex;align-items:center;gap:8px}.acu-settings-control select{appearance:auto !important;-webkit-appearance:menulist !important;-moz-appearance:menulist !important;padding:8px 12px !important;background:var(--acu-btn-bg) !important;border:1px solid var(--acu-border) !important;border-radius:6px !important;color:var(--acu-text-main) !important;font-size:13px !important;font-family:inherit !important;cursor:pointer !important;outline:none !important;box-shadow:none !important;min-height:auto !important;height:auto !important;line-height:normal !important;margin:0 !important}.acu-settings-control select:focus{border-color:var(--acu-title-color) !important}.acu-settings-control select option{background:var(--acu-bg-panel) !important;color:var(--acu-text-main) !important}.acu-settings-control input[type=text],.acu-settings-control input[type=number]{padding:8px 12px !important;background:var(--acu-btn-bg) !important;border:1px solid var(--acu-border) !important;border-radius:6px !important;color:var(--acu-text-main) !important;font-size:13px !important;font-family:inherit !important;outline:none !important}.acu-settings-control input[type=text]:focus,.acu-settings-control input[type=number]:focus{border-color:var(--acu-title-color) !important}.acu-settings-control input[type=color]{width:32px !important;height:32px !important}.acu-settings-control input[type=range]{-webkit-appearance:none;appearance:none;height:6px;background:var(--acu-border);border-radius:3px;outline:none;cursor:pointer}.acu-settings-control input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;background:var(--acu-title-color);border-radius:50%;cursor:pointer;-webkit-transition:transform .2s;transition:transform .2s;filter:none !important}.acu-settings-control input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.2)}.acu-settings-control input[type=range]::-moz-range-thumb{width:16px;height:16px;background:var(--acu-title-color);border-radius:50%;border:none;cursor:pointer;filter:none !important}.acu-nav-row{cursor:pointer;transition:background .2s ease}.acu-nav-row:hover{background:var(--acu-table-hover)}.acu-nav-row:active{opacity:.8}.acu-nav-row .acu-settings-control i.fa-chevron-right{font-size:12px;color:var(--acu-text-sub)}.acu-modal-back{display:flex;align-items:center;justify-content:center;width:32px;height:32px;margin-right:8px;background:rgba(0,0,0,0);border:none;border-radius:6px;cursor:pointer;color:inherit;opacity:.7;transition:all .2s ease}.acu-modal-back:hover{opacity:1;background:var(--acu-hover-bg,rgba(255,255,255,0.1))}.acu-modal-title{font-size:16px;font-weight:bold}.acu-bottom-spacer{height:calc(30px + var(--acu-safe-area-bottom,50px));padding-bottom:var(--acu-safe-area-bottom,50px);width:100%;text-align:center;color:var(--acu-text-sub,#999);font-size:10px;display:flex;align-items:center;justify-content:center;opacity:.5;flex-shrink:0}.acu-floating-ball-vue{--ball-size:50px;--ball-border-color:#ffffff;--ball-border-color-rgba:rgba(255,255,255,0.4);--ball-bg-color:rgba(255,255,255,0.25);position:fixed;width:var(--ball-size);height:var(--ball-size);font-size:calc(var(--ball-size)*.4);background:var(--ball-bg-color);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:2px solid var(--ball-border-color-rgba);border-radius:50%;box-shadow:0 4px 15px rgba(0,0,0,.3);z-index:2147483647;display:flex;align-items:center;justify-content:center;cursor:pointer;touch-action:none;color:var(--acu-text-main,#333);-webkit-user-select:none;user-select:none;transition:all .3s cubic-bezier(0.18,0.89,0.32,1.28);pointer-events:auto !important;overflow:visible;box-sizing:border-box}.acu-floating-ball-vue i{display:flex;align-items:center;justify-content:center;width:100%;height:100%;line-height:1;position:relative;z-index:2}.acu-floating-ball-vue .ball-emoji{display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:calc(var(--ball-size)*.46);position:relative;z-index:2}.acu-floating-ball-vue img{width:100%;height:100%;object-fit:cover;border-radius:50%;pointer-events:none;position:relative;z-index:2}.acu-floating-ball-vue .ball-image{width:100%;height:100%;border-radius:50%;pointer-events:none;position:relative;z-index:2}.acu-floating-ball-vue .ball-image.ball-image-invert{filter:invert(1)}.acu-floating-ball-vue:active{transform:scale(0.9);background:var(--ball-bg-color);filter:brightness(1.2)}.acu-floating-ball-vue.has-issues{animation:pulse-warning 1.5s ease-in-out infinite;border-color:rgba(245,108,108,.6);box-shadow:0 4px 15px rgba(245,108,108,.4)}.acu-floating-ball-vue.has-issues .acu-issue-badge{position:absolute;top:-4px;right:-4px;width:18px;height:18px;background:#f56c6c;border-radius:50%;font-size:12px;font-weight:bold;color:#fff;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 6px rgba(245,108,108,.5);animation:badge-bounce 1s ease-in-out infinite}.acu-floating-ball-vue.has-issues:hover{box-shadow:0 6px 20px rgba(245,108,108,.5)}.acu-floating-ball-vue.docked{left:0 !important;width:20px !important;height:50px !important;border-radius:0 8px 8px 0 !important;opacity:.3;background:#000;border:1px solid #666;border-left:none;font-size:0 !important;transform:none !important}.acu-floating-ball-vue.docked::after{content:"â€º";color:#fff;font-size:16px;font-weight:bold;display:block}.acu-floating-ball-vue.docked:hover,.acu-floating-ball-vue.docked:active{opacity:.8;width:30px !important}.acu-floating-ball-vue.docked .acu-issue-badge{display:none}@keyframes pulse-warning{0%,100%{box-shadow:0 4px 15px rgba(245,108,108,.4),0 0 0 0 rgba(245,108,108,.4)}50%{box-shadow:0 4px 15px rgba(245,108,108,.4),0 0 0 10px rgba(245,108,108,0)}}@keyframes badge-bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}@keyframes acu-notify-ripple-1{0%{transform:scale(1);opacity:.8}100%{transform:scale(2.5);opacity:0}}@keyframes acu-notify-ripple-2{0%{transform:scale(1);opacity:.6}100%{transform:scale(2.2);opacity:0}}@keyframes acu-notify-ripple-3{0%{transform:scale(1);opacity:.4}100%{transform:scale(1.9);opacity:0}}.acu-floating-ball-vue.ai-notify.anim-ripple{border-color:var(--ball-border-color-rgba)}.acu-floating-ball-vue.ai-notify.anim-ripple::before,.acu-floating-ball-vue.ai-notify.anim-ripple::after{content:"";position:absolute;width:100%;height:100%;border-radius:50%;border:2px solid var(--ball-border-color,#90cdf4);animation:acu-notify-ripple-1 1.5s ease-out infinite;pointer-events:none}.acu-floating-ball-vue.ai-notify.anim-ripple::after{animation:acu-notify-ripple-2 1.5s ease-out .5s infinite}@keyframes acu-arc-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes acu-arc-flash-1{0%,90%,100%{opacity:0}92%,95%{opacity:1}}@keyframes acu-arc-flash-2{0%,80%,100%{opacity:0}82%,88%{opacity:1}}.acu-floating-ball-vue.ai-notify.anim-arc{border-color:var(--ball-border-color-rgba)}.acu-floating-ball-vue.ai-notify.anim-arc::before{content:"";position:absolute;width:120%;height:120%;border-radius:50%;background:radial-gradient(circle at 20% 0%,var(--ball-border-color,#a29bfe) 0%,transparent 30%),radial-gradient(circle at 80% 100%,var(--ball-border-color,#a29bfe) 0%,transparent 30%);animation:acu-arc-rotate 1s linear infinite,acu-arc-flash-1 .3s ease infinite;opacity:.8;pointer-events:none}.acu-floating-ball-vue.ai-notify.anim-arc::after{content:"";position:absolute;width:130%;height:130%;border-radius:50%;background:radial-gradient(circle at 50% 0%,var(--ball-border-color,#74b9ff) 0%,transparent 25%),radial-gradient(circle at 50% 100%,var(--ball-border-color,#74b9ff) 0%,transparent 25%);animation:acu-arc-rotate 1.5s linear infinite reverse,acu-arc-flash-2 .5s ease infinite;opacity:.6;pointer-events:none}.acu-ball-preview{--ball-size:56px;--ball-border-color:#90cdf4;--ball-border-color-rgba:rgba(144,205,244,1);--ball-bg-color:rgba(43,43,43,1);width:var(--ball-size);height:var(--ball-size);font-size:calc(var(--ball-size)*.46);background:var(--ball-bg-color);border:2px solid var(--ball-border-color-rgba);border-radius:50%;display:flex;align-items:center;justify-content:center;position:relative;overflow:visible;box-sizing:border-box;transition:all .2s ease}.acu-ball-preview i{position:relative;z-index:2}.acu-ball-preview img{width:100%;height:100%;object-fit:cover;border-radius:50%;position:relative;z-index:2}.acu-ball-preview.p-anim-ripple{border-color:var(--ball-border-color-rgba)}.acu-ball-preview.p-anim-ripple::before,.acu-ball-preview.p-anim-ripple::after{content:"";position:absolute;width:100%;height:100%;border-radius:50%;border:2px solid var(--ball-border-color);animation:acu-notify-ripple-1 1.5s ease-out infinite;pointer-events:none}.acu-ball-preview.p-anim-ripple::after{animation:acu-notify-ripple-2 1.5s ease-out .5s infinite}.acu-ball-preview.p-anim-arc{border-color:var(--ball-border-color-rgba)}.acu-ball-preview.p-anim-arc::before{content:"";position:absolute;width:120%;height:120%;border-radius:50%;background:radial-gradient(circle at 20% 0%,var(--ball-border-color) 0%,transparent 30%),radial-gradient(circle at 80% 100%,var(--ball-border-color) 0%,transparent 30%);animation:acu-arc-rotate 1s linear infinite,acu-arc-flash-1 .3s ease infinite;opacity:.8;pointer-events:none}.acu-ball-preview.p-anim-arc::after{content:"";position:absolute;width:130%;height:130%;border-radius:50%;background:radial-gradient(circle at 50% 0%,var(--ball-border-color) 0%,transparent 25%),radial-gradient(circle at 50% 100%,var(--ball-border-color) 0%,transparent 25%);animation:acu-arc-rotate 1.5s linear infinite reverse,acu-arc-flash-2 .5s ease infinite;opacity:.6;pointer-events:none}.acu-ball-preview.p-notify{animation:acu-notify-glow 2s infinite ease-in-out}@keyframes acu-notify-glow{0%,100%{box-shadow:0 0 5px var(--ball-border-color,#55efc4);border-color:var(--ball-border-color,#55efc4)}50%{box-shadow:0 0 25px var(--ball-border-color,#55efc4);border-color:var(--ball-border-color,#55efc4)}}.acu-tab-bar{width:100%}.acu-nav-container{position:relative;order:1;flex:0 0 auto;display:flex;flex-direction:column;gap:0;padding:6px 10px;background:var(--acu-bg-nav);border-top:1px solid var(--acu-border);border-radius:14px 14px 0 0;backdrop-filter:blur(5px);box-shadow:0 -4px 20px rgba(0,0,0,.2);transition:transform .2s;touch-action:pan-y;width:100%;pointer-events:auto !important;cursor:move;z-index:10}.acu-nav-container.editing-order .acu-nav-btn{border:1px dashed #f0ad4e;cursor:grab;opacity:.8}.acu-nav-tabs-area{display:grid;grid-template-columns:var(--acu-nav-cols,repeat(auto-fill,minmax(110px,1fr)));gap:3px;width:100%}.acu-nav-btn{width:100%;display:flex;align-items:center;justify-content:center;gap:6px;padding:5px 3px;border:1px solid rgba(0,0,0,0);border-radius:8px;background:var(--acu-btn-bg);color:var(--acu-text-main);font-weight:600;font-size:13px;cursor:pointer;transition:all .2s ease;-webkit-user-select:none;user-select:none;text-align:center;white-space:nowrap;overflow:hidden}.acu-nav-btn span{overflow:hidden;text-overflow:ellipsis}.acu-nav-btn:hover{background:var(--acu-btn-hover);transform:translateY(-2px)}.acu-nav-btn.active{background:var(--acu-btn-active-bg);color:var(--acu-btn-active-text);box-shadow:0 2px 6px rgba(0,0,0,.15)}.acu-nav-separator{width:100%;height:1px;border-top:1px dashed var(--acu-border);margin:5px 0;opacity:.6}.acu-nav-actions-area{position:relative;display:flex;width:100%;justify-content:space-between;align-items:stretch;background:rgba(0,0,0,0);padding-top:0;gap:8px}.acu-order-controls{display:none;width:100%;text-align:center;background:var(--acu-table-head);padding:5px;margin-bottom:5px;border-radius:4px;border:1px dashed var(--acu-border)}.acu-order-controls.visible{display:block}.acu-order-controls{font-size:12px;color:var(--acu-text-sub)}.acu-order-done-btn{background:var(--acu-btn-active-bg);color:var(--acu-btn-active-text);border:none;border-radius:4px;padding:2px 8px;margin-left:8px;cursor:pointer;font-size:12px;transition:all .2s}.acu-order-done-btn:hover{opacity:.9;transform:scale(1.05)}.acu-nav-btn.drag-handle{border:1px dashed #f0ad4e;cursor:grab;opacity:.8}.acu-nav-btn.drag-handle:active{cursor:grabbing}.acu-nav-btn.dragging{opacity:.5;border:2px solid var(--acu-title-color)}.acu-nav-btn.has-ai-changes{border:2px solid var(--acu-highlight-ai,#3498db)}.acu-nav-btn.has-ai-changes:hover{border-color:var(--acu-highlight-ai,#3498db)}.acu-nav-btn.has-ai-changes.active{border-color:var(--acu-highlight-ai,#3498db)}.acu-nav-btn.has-issues{border:2px solid #f56c6c;animation:tab-issue-pulse 2s ease-in-out infinite;position:relative}.acu-nav-btn.has-issues::before{content:"";position:absolute;top:-3px;right:-3px;width:8px;height:8px;background:#f56c6c;border-radius:50%;box-shadow:0 0 4px rgba(245,108,108,.6)}.acu-nav-btn.has-issues:hover{border-color:#f56c6c;box-shadow:0 2px 8px rgba(245,108,108,.3)}.acu-nav-btn.has-issues.active{border-color:#f56c6c;box-shadow:0 2px 10px rgba(245,108,108,.4)}@keyframes tab-issue-pulse{0%,100%{border-color:#f56c6c}50%{border-color:rgba(245,108,108,.4)}}.acu-action-btn{display:flex;align-items:center;justify-content:center;flex:1;min-width:36px;height:36px;border:1px solid var(--acu-border);border-radius:8px;background:var(--acu-btn-bg);color:var(--acu-text-main);font-size:14px;cursor:pointer;transition:all .2s ease}.acu-action-btn:hover{background:var(--acu-btn-hover);transform:translateY(-1px)}.acu-action-btn:active{transform:translateY(0)}.acu-action-btn.refreshing i{animation:acu-spin 1s linear infinite}.acu-action-btn.has-changes{animation:acu-pulse 1.5s ease-in-out infinite;border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-action-btn.acu-btn-danger{color:#e74c3c}.acu-action-btn.acu-btn-danger:hover{background:rgba(231,76,60,.1);border-color:#e74c3c}.acu-action-btn.acu-btn-toggle.active{background:var(--acu-btn-hover);color:var(--acu-title-color);border-color:var(--acu-title-color)}@keyframes acu-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@keyframes acu-pulse{0%,100%{box-shadow:0 0 0 0 rgba(var(--acu-title-color-rgb,211,84,0),0.4)}50%{box-shadow:0 0 0 8px rgba(var(--acu-title-color-rgb,211,84,0),0)}}.acu-data-card{background:var(--acu-card-bg);border:none;box-shadow:0 2px 8px var(--acu-shadow);border-radius:12px;transition:all .25s ease;display:flex;flex-direction:column;position:relative;-webkit-user-select:none;user-select:none;touch-action:pan-x pan-y;overflow-y:auto;overflow-x:hidden;overscroll-behavior:contain;scrollbar-width:thin;scrollbar-color:hsla(0,0%,100%,.2) rgba(0,0,0,0)}.acu-data-card::-webkit-scrollbar{width:4px;height:4px}.acu-data-card::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-data-card::-webkit-scrollbar-thumb{background:hsla(0,0%,100%,.2);border-radius:2px;-webkit-transition:background .2s ease;transition:background .2s ease}.acu-data-card::-webkit-scrollbar-thumb:hover{background:hsla(0,0%,100%,.4)}.acu-data-card.acu-editing-lock{border-color:var(--acu-title-color) !important;box-shadow:0 0 0 1px var(--acu-title-color) !important;z-index:5;-webkit-user-select:text !important;user-select:text !important;touch-action:none !important}@keyframes acu-shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}75%{transform:translateX(4px)}}.acu-grid-value,.acu-full-value,.acu-card-value,.acu-editable-title,.acu-grid-label,.acu-full-label,.acu-card-label{user-select:text !important;-webkit-user-select:text !important;cursor:text}.acu-layout-vertical .acu-card-grid{display:flex;flex-wrap:wrap;justify-content:center;align-items:stretch;gap:14px}.acu-layout-vertical .acu-data-card{flex:0 0 var(--acu-card-width,280px);width:var(--acu-card-width,280px);height:auto;overflow-y:visible;overflow-x:visible;display:flex;flex-direction:column}.acu-layout-vertical .acu-data-card:hover{transform:translateY(-4px);box-shadow:0 8px 25px var(--acu-shadow);z-index:5}.acu-layout-horizontal .acu-card-grid{display:inline-flex;flex-wrap:nowrap;gap:14px;height:auto;align-items:flex-start;padding-bottom:10px;min-width:100%}.acu-layout-horizontal .acu-data-card{flex:0 0 var(--acu-card-width,280px);width:var(--acu-card-width,280px);height:-moz-fit-content;height:fit-content;max-height:98%;overflow-y:auto;white-space:normal;touch-action:pan-x pan-y !important}.acu-card-header{padding:10px 15px;background:rgba(0,0,0,0);border-bottom:1px solid rgba(0,0,0,.05);font-weight:bold;color:var(--acu-title-color);font-size:14px;display:flex;justify-content:center;align-items:center;position:relative;flex:0 0 auto}.acu-editable-title{cursor:pointer;border-bottom:1px dashed rgba(0,0,0,0);transition:all .2s;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:15px;font-weight:800;text-align:center;width:100%;padding:2px 5px;border-radius:4px;display:inline-flex;align-items:center;justify-content:center;gap:6px}.acu-editable-title:hover{background:var(--acu-table-hover);color:var(--acu-title-color)}.acu-editable-title.acu-title-locked{background:var(--acu-title-color-bg);border:1px solid var(--acu-title-color)}.acu-title-lock-icon{font-size:10px;opacity:.8;flex-shrink:0}.acu-title-editor{flex:1;min-width:0}.acu-title-editor textarea{width:100%;font-size:15px;font-weight:800;text-align:center;background:hsla(0,0%,100%,.15);border:1px solid var(--acu-title-color,#667eea);border-radius:4px;padding:4px 8px;color:var(--acu-title-color)}.acu-title-editor textarea:focus{outline:none;box-shadow:0 0 0 2px var(--acu-title-color-bg,rgba(102,126,234,0.2))}.acu-card-index{position:absolute;left:10px;top:50%;transform:translateY(-50%);font-size:10px;color:var(--acu-text-sub);font-weight:normal;background:var(--acu-badge-bg);padding:1px 6px;border-radius:8px;opacity:.8}.acu-history-btns{position:absolute;right:8px;top:50%;transform:translateY(-50%);display:flex !important;flex-direction:row !important;flex-wrap:nowrap !important;align-items:center;gap:2px}.acu-undo-trigger,.acu-history-trigger{width:26px;height:26px;min-width:26px;min-height:26px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:50%;color:var(--acu-text-sub);cursor:pointer;font-size:11px;transition:all .2s ease;opacity:.6;padding:0}.acu-undo-trigger:hover,.acu-history-trigger:hover{background:var(--acu-table-hover);color:var(--acu-title-color);opacity:1}.acu-undo-trigger:active,.acu-history-trigger:active{transform:scale(0.9)}@media (max-width:768px){.acu-undo-trigger,.acu-history-trigger{width:32px;height:32px;min-width:32px;min-height:32px;font-size:13px}}.acu-undo-trigger.acu-loading{opacity:.5;cursor:wait;pointer-events:none}.acu-undo-trigger:disabled{opacity:.3;cursor:not-allowed}.acu-row-lock-btn{position:absolute;right:10px;top:50%;transform:translateY(-50%);width:26px;height:26px;display:flex;align-items:center;justify-content:center;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:50%;color:var(--acu-text-sub);cursor:pointer;font-size:12px;transition:all .2s ease}.acu-row-lock-btn:hover{background:var(--acu-title-color-bg);color:var(--acu-title-color);border-color:var(--acu-title-color)}.acu-row-lock-btn.acu-row-locked{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color)}.acu-row-lock-btn.acu-row-locked:hover{background:var(--acu-title-color);filter:brightness(1.1)}.acu-card-body{padding:0;display:flex;flex-direction:column;gap:0;font-size:var(--acu-font-size,13px);flex:1}.acu-card-main-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:12px;flex:1}.acu-grid-item{display:flex;flex-direction:column;gap:2px;padding:5px;border-radius:6px;cursor:pointer;overflow:hidden}.acu-grid-item:hover{background:var(--acu-table-hover)}.acu-grid-label{font-size:11px;color:var(--acu-title-color);text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-grid-value{font-size:var(--acu-font-size,13px);color:var(--acu-text-main);font-weight:500;white-space:pre-wrap;word-break:break-word;line-height:1.35}.acu-card-full-area{display:flex;flex-direction:column;gap:8px;padding:0 12px 10px 12px}.acu-full-item{display:flex;flex-direction:column;gap:3px;padding:6px;border-radius:6px;border-top:1px dashed rgba(0,0,0,.05);cursor:pointer}.acu-full-item:hover{background:var(--acu-table-hover)}.acu-full-label{font-size:11px;color:var(--acu-title-color);font-weight:bold}.acu-full-value{font-size:var(--acu-font-size,13px);color:var(--acu-text-main);line-height:1.4;word-break:break-all;white-space:pre-wrap;max-height:var(--acu-text-max-height,80px);overflow-y:var(--acu-text-overflow,auto);scrollbar-width:none}.acu-data-card.acu-style-list .acu-card-body{padding:6px 12px;display:flex;flex-direction:column;gap:0}.acu-data-card.acu-style-list .acu-card-row{display:block !important;padding:6px 0 !important;border-bottom:1px dashed var(--acu-border);cursor:pointer;overflow:hidden}.acu-data-card.acu-style-list .acu-card-row:last-child{border-bottom:none}.acu-data-card.acu-style-list .acu-card-row:hover{background:var(--acu-table-hover)}.acu-data-card.acu-style-list .acu-card-label{float:left !important;clear:left;width:auto !important;margin-right:8px !important;color:var(--acu-title-color);font-size:.9em;font-weight:bold;line-height:1.5}.acu-data-card.acu-style-list .acu-card-value{display:block !important;width:auto !important;margin:0 !important;text-align:left !important;word-break:break-all !important;white-space:pre-wrap !important;line-height:1.5 !important;color:var(--acu-text-main);max-height:var(--acu-text-max-height,80px);overflow-y:var(--acu-text-overflow,auto);scrollbar-width:none}.acu-data-card.acu-style-list .acu-card-value::-webkit-scrollbar{display:none}.acu-data-card.acu-style-list .acu-highlight-changed{display:inline-block;width:auto;line-height:1.4}.acu-cell-changed .acu-grid-value,.acu-cell-changed .acu-full-value,.acu-cell-changed .acu-card-value{font-weight:600}.acu-cell-changed-manual .acu-grid-value,.acu-cell-changed-manual .acu-full-value,.acu-cell-changed-manual .acu-card-value{color:var(--acu-highlight-manual,#d35400) !important;font-weight:600}.acu-cell-changed-ai .acu-grid-value,.acu-cell-changed-ai .acu-full-value,.acu-cell-changed-ai .acu-card-value{color:var(--acu-highlight-ai,#3498db) !important;font-weight:600}.acu-cell-locked{position:relative;background:rgba(231,76,60,.08) !important;border-left:3px solid #e74c3c !important}.acu-cell-locked::after{content:"ï€£";font-family:"Font Awesome 6 Free","Font Awesome 5 Free",FontAwesome;font-weight:900;position:absolute;top:4px;right:6px;font-size:10px;color:#e74c3c;opacity:.7;pointer-events:none}.acu-cell-locked .acu-grid-value,.acu-cell-locked .acu-full-value,.acu-cell-locked .acu-card-value{color:#c0392b !important}.acu-cell-locked .acu-grid-label,.acu-cell-locked .acu-full-label,.acu-cell-locked .acu-card-label{color:#e74c3c;font-weight:600}.acu-row-locked{background:rgba(231,76,60,.05) !important;border:1px solid rgba(231,76,60,.3) !important}.acu-row-locked .acu-card-header{background:rgba(231,76,60,.1);color:#c0392b}.acu-row-locked .acu-card-header::after{content:"ï€£å·²é”å®š";font-family:"Font Awesome 6 Free","Font Awesome 5 Free",FontAwesome,inherit;font-weight:600;font-size:11px;color:#e74c3c;margin-left:8px;opacity:.8}.acu-pull-overlay{display:flex;align-items:center;justify-content:center;overflow:hidden;width:100%;flex:0 0 auto;height:0;transition:height .1s linear}.acu-pull-top{background:rgba(46,204,113,.15);border-bottom:2px dashed #27ae60;color:#27ae60}.acu-pull-bottom{background:rgba(231,76,60,.15);border-top:2px dashed #c0392b;color:#c0392b}.acu-pull-restore{background:rgba(52,152,219,.15) !important;border-top:2px dashed #2980b9 !important;color:#2980b9 !important}.acu-pull-icon{display:flex;flex-direction:column;align-items:center;gap:5px;opacity:.8}.acu-pull-text{font-size:12px;opacity:.9}.acu-swipe-overlay{position:absolute;top:0;bottom:0;width:0;display:flex;align-items:center;justify-content:center;overflow:hidden;pointer-events:none;z-index:10;font-size:18px;font-weight:bold;transition:width .1s linear;white-space:nowrap}.acu-swipe-right{left:0;background:rgba(46,204,113,.2);border-right:2px dashed #27ae60;color:#27ae60}.acu-swipe-left{right:0;background:rgba(231,76,60,.2);border-left:2px dashed #c0392b;color:#c0392b}.acu-swipe-restore{background:rgba(52,152,219,.2) !important;border-left:2px dashed #2980b9 !important;color:#2980b9 !important}.acu-data-table{display:flex;flex-direction:column;flex:1;min-height:0;height:100%;gap:0}.acu-data-table.acu-table-loading{opacity:.6;pointer-events:none}.acu-table-toolbar{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:var(--acu-table-head,rgba(0,0,0,0.03));border-bottom:1px solid var(--acu-border,rgba(0,0,0,0.06));border-radius:0;gap:12px;z-index:10;flex-shrink:0}.acu-toolbar-left{display:flex;align-items:center;gap:8px;flex-shrink:0;min-width:0}.acu-table-title{font-weight:600;font-size:calc(var(--acu-font-size,13px) + 1px);color:var(--acu-title-color,var(--acu-text-main,#333));white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-table-count{font-size:calc(var(--acu-font-size,13px) - 2px);color:var(--acu-text-muted,#999);white-space:nowrap}.acu-table-badge{font-size:11px;padding:2px 6px;border-radius:10px;white-space:nowrap}.acu-table-badge.acu-badge-changed{background:rgba(102,126,234,.15);color:var(--acu-title-color,#667eea)}.acu-table-badge.acu-badge-deleting{background:rgba(231,76,60,.15);color:var(--acu-danger,#e74c3c)}.acu-toolbar-right{display:flex;align-items:center;gap:8px;flex-shrink:0}.acu-icon-btn.acu-height-handle{cursor:ns-resize}.acu-icon-btn.acu-close-btn:hover{background:rgba(231,76,60,.1);color:var(--acu-danger,#e74c3c)}.acu-search-input.acu-search-inline{width:100px;padding:4px 8px;border:none;border-radius:var(--acu-radius-sm,4px);background:rgba(0,0,0,0);color:var(--acu-text-main,#333);font-size:calc(var(--acu-font-size,13px) - 1px);outline:none;transition:all .2s}.acu-search-input.acu-search-inline:focus{width:140px;background:var(--acu-btn-hover,rgba(0,0,0,0.05))}.acu-search-input.acu-search-inline::placeholder{color:var(--acu-text-muted,#999)}.acu-search-clear{color:var(--acu-text-muted,#999);cursor:pointer;font-size:11px;flex-shrink:0}.acu-search-clear:hover{color:var(--acu-text-main,#333)}.acu-cards-container{flex:1;min-height:0;overflow-y:auto;overflow-x:hidden;overscroll-behavior:contain;padding:12px}.acu-cards-container.acu-view-card{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;align-content:flex-start;align-items:stretch}.acu-cards-container.acu-view-card>.acu-data-card{flex:0 0 var(--acu-card-width,280px);width:var(--acu-card-width,280px)}.acu-cards-container.acu-view-list{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;align-content:flex-start;align-items:stretch}.acu-cards-container.acu-view-list>.acu-data-card{flex:0 0 var(--acu-card-width,280px);width:var(--acu-card-width,280px)}.acu-layout-horizontal .acu-cards-container{flex:1 1 0;height:0;min-height:0;display:flex !important;flex-wrap:nowrap !important;gap:14px;align-items:flex-start;justify-content:flex-start;white-space:nowrap;overflow-x:auto !important;overflow-y:hidden !important;touch-action:pan-x pan-y !important;padding:12px;padding-bottom:8px;overscroll-behavior-x:contain}.acu-layout-horizontal .acu-cards-container.acu-view-card,.acu-layout-horizontal .acu-cards-container.acu-view-list{display:flex !important;flex-wrap:nowrap !important}.acu-layout-horizontal .acu-data-card{flex:0 0 var(--acu-card-width,280px) !important;width:var(--acu-card-width,280px) !important;min-width:var(--acu-card-width,280px);align-self:flex-start;height:-moz-fit-content;height:fit-content;max-height:calc(100% - 4px);overflow-y:auto;white-space:normal;touch-action:pan-x pan-y !important;display:flex !important}.acu-layout-horizontal .acu-data-table{height:100%;min-height:200px;display:flex;flex-direction:column;overflow:hidden}.acu-layout-horizontal .acu-table-toolbar{flex-shrink:0;position:relative;z-index:10}.acu-layout-horizontal .acu-pagination-container{flex-shrink:0;position:relative;z-index:10}.acu-layout-horizontal .acu-panel-content{overflow:hidden !important;min-height:150px}.acu-empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 24px;color:var(--acu-text-muted,#999);grid-column:1/-1}.acu-empty-state i{font-size:48px;margin-bottom:16px;opacity:.5}.acu-empty-state p{margin:0;font-size:var(--acu-font-size,13px)}.acu-pagination{display:flex;justify-content:center;align-items:center;gap:4px;padding:12px;flex-wrap:wrap}.acu-btn-page{min-width:32px;padding:4px 8px;font-size:calc(var(--acu-font-size,13px) - 1px)}.acu-btn-page.active{font-weight:600}.acu-page-ellipsis{padding:4px 8px;color:var(--acu-text-muted,#999)}.acu-modal-btn{padding:10px 24px;border:none;border-radius:8px;font-size:14px;font-weight:500;font-family:inherit;cursor:pointer;transition:all .2s ease}.acu-modal-btn.primary{background:var(--acu-title-color);color:#fff}.acu-modal-btn.primary:hover{filter:brightness(1.1);transform:translateY(-1px)}.acu-modal-btn.secondary{background:var(--acu-btn-bg);color:var(--acu-text-main);border:1px solid var(--acu-border)}.acu-modal-btn.secondary:hover{background:var(--acu-btn-hover)}.acu-modal-btn.danger{background:#e74c3c;color:#fff}.acu-modal-btn.danger:hover{background:#c0392b}.acu-modal-btn:disabled{opacity:.5;cursor:not-allowed;transform:none !important}.acu-action-btn{flex:1;height:36px;display:flex;align-items:center;justify-content:center;background:var(--acu-btn-bg);border-radius:8px;color:var(--acu-text-sub);cursor:pointer;border:1px solid rgba(0,0,0,0);transition:all .2s;font-size:16px;font-family:inherit;-webkit-user-select:none;user-select:none}.acu-action-btn:hover{background:var(--acu-btn-hover);color:var(--acu-text-main);transform:translateY(-2px);border-color:var(--acu-border)}.acu-tool-btn{padding:6px 12px;font-size:12px;font-family:inherit;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);cursor:pointer;transition:all .2s ease;white-space:nowrap}.acu-tool-btn:hover{background:var(--acu-btn-hover);border-color:var(--acu-title-color)}.acu-tool-btn.small{padding:4px 10px;font-size:11px}.acu-icon-btn{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--acu-text-sub);cursor:pointer;transition:all .2s}.acu-icon-btn:hover{background:var(--acu-btn-hover);color:var(--acu-title-color)}.acu-icon-btn.active{background:var(--acu-title-color-bg);color:var(--acu-title-color)}#acu-btn-save-global{color:var(--acu-title-color)}#acu-btn-save-global:hover{background:var(--acu-btn-active-bg);color:var(--acu-btn-active-text)}#acu-btn-save-specific{color:#9b59b6;display:none}.acu-dialog-btn{background:none;border:none;cursor:pointer;font-size:14px;font-weight:bold;display:flex;align-items:center;gap:6px;color:var(--acu-text-sub);transition:color .2s}.acu-page-btn{padding:0;border:1px solid var(--acu-border);background:var(--acu-btn-bg);color:var(--acu-title-color);border-radius:6px;cursor:pointer;font-size:12px;min-width:32px;height:32px;display:flex;align-items:center;justify-content:center;transition:all .2s;-webkit-user-select:none;user-select:none;font-weight:500;flex-shrink:0}.acu-page-btn:not(.disabled):not(.active):hover{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);transform:translateY(-2px);box-shadow:0 2px 5px rgba(0,0,0,.1)}.acu-page-btn.active{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);font-weight:bold;cursor:default}.acu-page-btn.disabled{opacity:.5;cursor:not-allowed;background:var(--acu-text-sub)}.acu-page-arrow{width:36px;font-size:14px}.acu-tab-btn{padding:6px 12px;cursor:pointer;font-size:13px;font-weight:bold;color:var(--acu-text-sub);border-bottom:2px solid rgba(0,0,0,0);transition:all .2s}.acu-tab-btn:hover{color:var(--acu-text-main);background:var(--acu-table-hover);border-radius:4px 4px 0 0}.acu-tab-btn.active{color:var(--acu-title-color);border-bottom-color:var(--acu-title-color)}.acu-action-bar{display:flex;align-items:center;gap:4px;padding:4px}.acu-action-bar .acu-action-btn{flex:none;width:32px;height:32px;padding:0;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);cursor:pointer;border-radius:6px;transition:all .2s ease}.acu-action-bar .acu-action-btn:hover{background:var(--acu-hover-bg,rgba(255,255,255,0.1));color:var(--acu-text-main);transform:none;border-color:rgba(0,0,0,0)}.acu-action-bar .acu-action-btn:active{transform:scale(0.95)}.acu-action-bar .acu-action-btn.acu-btn-active{background:var(--acu-title-color-bg,rgba(52,152,219,0.2));color:var(--acu-title-color,#3498db);border-color:var(--acu-title-color)}.acu-action-bar .acu-action-btn i{font-size:14px}.acu-btn-danger{color:#e74c3c}.acu-btn-danger:hover{background:rgba(231,76,60,.2)}.acu-btn-toggle.active{background:var(--acu-title-color-bg,rgba(52,152,219,0.2)) !important;color:var(--acu-title-color,#3498db) !important;border:1px solid var(--acu-title-color,#3498db) !important;box-shadow:inset 0 0 0 1px rgba(52,152,219,.3)}.has-changes{color:#f39c12;animation:pulse 1.5s infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}.acu-action-btn-wrapper{position:relative;display:flex;align-items:center;flex:1}.acu-action-bar .acu-action-btn-wrapper{flex:none}.has-secondary{position:relative}.secondary-indicator{position:absolute;top:2px;right:2px;width:6px;height:6px;background:var(--acu-primary-color,#3498db);border-radius:50%;pointer-events:none}.acu-popup-btn{position:absolute;top:100%;left:50%;transform:translateX(-50%);margin-top:4px;z-index:100;background:var(--acu-panel-bg,#2a2a2a) !important;border:1px solid var(--acu-primary-color,#3498db) !important;box-shadow:0 4px 12px rgba(0,0,0,.3)}.acu-popup-btn:hover{background:var(--acu-primary-color,#3498db) !important;color:#fff !important}.acu-btn-success{color:#27ae60 !important;background:rgba(39,174,96,.15) !important;border:1px solid rgba(39,174,96,.3) !important}.acu-btn-success:hover{background:rgba(39,174,96,.25) !important;color:#2ecc71 !important}.acu-icon-btn.acu-dual-icon{position:relative}.acu-icon-btn.acu-dual-icon .icon-secondary{position:absolute;bottom:0;right:0;font-size:8px;opacity:.9;background:var(--acu-card-bg);border-radius:50%;padding:2px;line-height:1;z-index:1}.acu-search-input{background:var(--acu-btn-bg);border:1px solid var(--acu-border);color:var(--acu-text-main);padding:2px 2px 3px 22px;border-radius:16px;font-size:12px;width:100px;transition:all .2s}.acu-search-input:focus{width:140px;outline:none;border-color:var(--acu-title-color);background:var(--acu-input-bg)}.acu-search-icon{position:absolute;left:10px;font-size:10px;color:var(--acu-text-sub);pointer-events:none}.acu-inline-editor{width:100%;position:relative;touch-action:manipulation}.acu-edit-textarea{width:100%;min-height:24px;padding:6px 8px;border:2px solid var(--acu-title-color,#667eea);border-radius:var(--acu-radius-sm,4px);background:var(--acu-input-bg,#fff);color:var(--acu-text-main,#333);font-size:var(--acu-font-size,13px);font-family:inherit;line-height:1.5;resize:none;outline:none;box-sizing:border-box;overflow:hidden;user-select:text !important;-webkit-user-select:text !important;touch-action:manipulation}.acu-edit-textarea:focus{box-shadow:0 0 0 3px var(--acu-title-color-bg,rgba(102,126,234,0.2))}.acu-textarea-scrollable{width:100%;min-height:24px;padding:6px 8px;border:2px solid var(--acu-title-color);border-radius:var(--acu-radius-sm);background:var(--acu-input-bg);color:var(--acu-text-main);font-size:var(--acu-font-size);font-family:inherit;line-height:1.5;outline:none;box-sizing:border-box;overflow-y:auto !important;resize:vertical;user-select:text !important;-webkit-user-select:text !important;touch-action:manipulation}.acu-textarea-scrollable:focus{box-shadow:0 0 0 3px var(--acu-title-color-bg)}.acu-editing-lock .acu-inline-editor{touch-action:manipulation}.acu-settings-input{background:var(--acu-input-bg);border:1px solid var(--acu-border);border-radius:6px;padding:8px 12px;color:var(--acu-text-main);font-size:14px;transition:border-color .2s}.acu-settings-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-range-input{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:var(--acu-border);border-radius:3px;outline:none;cursor:pointer}.acu-range-input::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;background:var(--acu-title-color);border-radius:50%;cursor:pointer;-webkit-transition:transform .2s;transition:transform .2s}.acu-range-input::-webkit-slider-thumb:hover{transform:scale(1.2)}.acu-range-input::-webkit-slider-thumb{filter:none !important}.acu-range-input::-moz-range-thumb{width:16px;height:16px;background:var(--acu-title-color);border-radius:50%;border:none;cursor:pointer;filter:none !important}.acu-select{appearance:auto !important;-webkit-appearance:menulist !important;-moz-appearance:menulist !important;padding:8px 12px !important;background:var(--acu-btn-bg) !important;border:1px solid var(--acu-border) !important;border-radius:6px !important;color:var(--acu-text-main) !important;font-size:13px !important;font-family:inherit !important;cursor:pointer !important;text-align:center !important;text-align-last:center !important;width:auto !important;min-width:80px;outline:none !important;box-shadow:none !important;min-height:auto !important;height:auto !important;line-height:normal !important;margin:0 !important;transition:border-color .2s ease}.acu-select:focus{border-color:var(--acu-title-color) !important}.acu-select option{background:var(--acu-bg-panel) !important;color:var(--acu-text-main) !important;text-align:center}input[type=color]{width:32px;height:32px;padding:0;border:2px solid var(--acu-border) !important;border-radius:6px;cursor:pointer;background:rgba(0,0,0,0);flex-shrink:0;transition:all .2s ease}input[type=color]:hover{border-color:var(--acu-title-color);transform:scale(1.05)}input[type=color]::-webkit-color-swatch-wrapper{padding:2px}input[type=color]::-webkit-color-swatch{border-radius:3px;border:none}input[type=color]::-moz-color-swatch{border-radius:3px;border:none}input[type=color].acu-dashed{border-style:dashed !important}.acu-color-swatch{width:32px !important;height:32px !important}.acu-textarea{width:100%;padding:10px 12px;font-size:12px;line-height:1.5;background:var(--acu-table-head);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);resize:vertical;font-family:inherit}.acu-textarea:focus{outline:none;border-color:var(--acu-title-color)}.acu-textarea::placeholder{color:var(--acu-text-sub);opacity:.6}.acu-search-box{display:flex;align-items:center;gap:12px}.acu-search-input-wrapper{position:relative;display:flex;align-items:center;flex:1;max-width:300px;min-width:180px}.acu-search-box .acu-search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--acu-text-sub,#999);font-size:14px;pointer-events:none;transition:color var(--acu-transition-fast,0.15s);z-index:1}.focused .acu-search-box .acu-search-icon{color:var(--acu-title-color,#d35400)}.acu-search-box .acu-search-input{width:100%;height:36px;padding:0 36px;border:1px solid var(--acu-border,#dcd0c0);border-radius:var(--acu-radius-md,12px);background:var(--acu-input-bg,rgba(255,255,255,0.5));color:var(--acu-text-main,#5e4b35);font-size:var(--acu-font-size,13px);outline:none;transition:border-color var(--acu-transition-fast,0.15s),box-shadow var(--acu-transition-fast,0.15s),background var(--acu-transition-fast,0.15s)}.acu-search-box .acu-search-input::placeholder{color:var(--acu-text-sub,#999);opacity:.7}.acu-search-box .acu-search-input:focus{border-color:var(--acu-title-color,#d35400);box-shadow:0 0 0 3px var(--acu-title-color-bg,rgba(211,84,0,0.08));background:var(--acu-card-bg,#fffef9)}.has-value .acu-search-box .acu-search-input{padding-right:40px}.acu-search-clear{position:absolute;right:8px;display:flex;align-items:center;justify-content:center;width:24px;height:24px;border:none;border-radius:50%;background:var(--acu-badge-bg,#efebe4);color:var(--acu-text-sub,#999);cursor:pointer;transition:background var(--acu-transition-fast,0.15s),color var(--acu-transition-fast,0.15s),transform var(--acu-transition-fast,0.15s)}.acu-search-clear i{font-size:12px}.acu-search-clear:hover{background:var(--acu-danger,#e74c3c);color:#fff;transform:scale(1.1)}.acu-search-clear:active{transform:scale(0.95)}.acu-search-result{font-size:.85em;color:var(--acu-text-sub,#999);white-space:nowrap}.acu-search-result strong{color:var(--acu-title-color,#d35400);font-weight:600}.acu-search-result .no-result{color:var(--acu-warning,#f39c12)}.acu-fade-enter-active,.acu-fade-leave-active{transition:opacity .15s ease,transform .15s ease}.acu-fade-enter-from,.acu-fade-leave-to{opacity:0;transform:scale(0.8)}.acu-fade-enter-to,.acu-fade-leave-from{opacity:1;transform:scale(1)}@media (max-width:480px){.acu-search-box{flex-direction:column;align-items:stretch;gap:8px}.acu-search-input-wrapper{max-width:none;min-width:auto}.acu-search-box .acu-search-input{height:40px}.acu-search-result{text-align:center;font-size:.8em}}.acu-switch{position:relative;display:inline-flex;align-items:center;width:44px;height:24px;cursor:pointer;flex-shrink:0}.acu-switch input[type=checkbox]{opacity:0;width:0;height:0;position:absolute;pointer-events:none}.acu-switch .slider,.acu-switch .acu-switch-slider{position:absolute;inset:0;background:var(--acu-btn-bg);border:none;border-radius:12px;transition:background .2s ease}.acu-switch .slider::after,.acu-switch .acu-switch-slider::after{content:"";position:absolute;top:50%;left:2px;transform:translateY(-50%);width:20px;height:20px;background:var(--acu-text-sub);border:none;border-radius:50%;transition:all .2s ease;box-shadow:0 1px 3px rgba(0,0,0,.15)}.acu-switch input[type=checkbox]:checked+.slider,.acu-switch input[type=checkbox]:checked+.acu-switch-slider{background:var(--acu-title-color)}.acu-switch input[type=checkbox]:checked+.slider::after,.acu-switch input[type=checkbox]:checked+.acu-switch-slider::after{left:calc(100% - 22px);background:#fff}.acu-switch:hover .slider,.acu-switch:hover .acu-switch-slider{opacity:.85}.acu-switch:not(:has(input)){background:var(--acu-btn-bg);border:none;border-radius:12px;transition:background .2s ease}.acu-switch:not(:has(input))::after{content:"";position:absolute;top:50%;left:2px;transform:translateY(-50%);width:20px;height:20px;background:var(--acu-text-sub);border:none;border-radius:50%;transition:all .2s ease;box-shadow:0 1px 3px rgba(0,0,0,.15)}.acu-switch:not(:has(input)).active{background:var(--acu-title-color)}.acu-switch:not(:has(input)).active::after{left:calc(100% - 22px);background:#fff}.acu-switch:not(:has(input)):hover{opacity:.9}.acu-badge,.acu-badge-default,.acu-badge-female,.acu-badge-male,.acu-badge-pill,.acu-badge-tag{display:inline-block;padding:2px 8px;border-radius:var(--acu-radius-sm,4px);font-size:calc(var(--acu-font-size,13px) - 1px);background:var(--acu-badge-bg,rgba(0,0,0,0.05));color:var(--acu-text-main,#333);line-height:1.4;word-break:break-word;white-space:pre-wrap}.acu-badge-default,.acu-badge-female,.acu-badge-male{background:rgba(0,0,0,0);padding:0;color:inherit}.acu-badge-pill,.acu-badge-tag{border-radius:999px;padding:2px 10px}.acu-badge-count{display:inline-flex;align-items:center;justify-content:center;min-width:20px;height:20px;padding:0 6px;border-radius:50%;font-size:11px;font-weight:bold;background:var(--acu-title-color);color:#fff;line-height:1}.acu-badge-primary,.acu-badge-percent,.acu-badge-level,.acu-badge-danger,.acu-badge-warning,.acu-badge-success,.acu-badge-number{background:var(--acu-title-color-bg);color:var(--acu-title-color)}.acu-badge-secondary,.acu-badge-info{background:var(--acu-table-head);color:var(--acu-text-sub)}.acu-badge-outline,.acu-badge-tag{background:rgba(0,0,0,0);border:1px solid var(--acu-border);color:var(--acu-text-sub);padding:1px 7px}.acu-badge-outline-primary{background:rgba(0,0,0,0);border:1px solid var(--acu-title-color);color:var(--acu-title-color);padding:1px 7px}.acu-badge-interactive{cursor:pointer;transition:all .15s ease;-webkit-user-select:none;user-select:none}.acu-badge-interactive:hover{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color)}.acu-badge-interactive:active{transform:translateY(1px)}.acu-stamp-delete{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-15deg);width:80px;height:80px;border:4px solid #e74c3c;border-radius:50%;color:#e74c3c;font-size:20px;font-weight:900;display:flex;align-items:center;justify-content:center;z-index:50;pointer-events:none;opacity:.6;box-shadow:inset 0 0 10px rgba(231,76,60,.2);background:hsla(0,0%,100%,.1)}.acu-badge-default,.acu-badge-female,.acu-badge-male{background:rgba(0,0,0,0)}.acu-pagination-container{flex:0 0 auto;flex-shrink:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:6px 8px;background:var(--acu-bg-panel);border-top:1px solid var(--acu-border);z-index:10;box-sizing:border-box}.acu-pagination-container.hidden{display:none !important}.acu-pagination-numbers{display:flex;justify-content:center;align-items:center;gap:4px;flex:1;overflow:hidden}.acu-page-btn{padding:0;border:1px solid var(--acu-border);background:var(--acu-btn-bg);color:var(--acu-title-color);border-radius:5px;cursor:pointer;font-size:11px;min-width:26px;height:26px;display:flex;align-items:center;justify-content:center;transition:all .2s;-webkit-user-select:none;user-select:none;font-weight:500;flex-shrink:0}.acu-page-btn:not(.disabled):not(.active):hover{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);transform:translateY(-1px);box-shadow:0 2px 4px rgba(0,0,0,.1)}.acu-page-btn.active{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);font-weight:bold;cursor:default}.acu-page-btn.disabled{opacity:.5;cursor:not-allowed;background:var(--acu-text-sub)}.acu-page-arrow{width:30px;font-size:12px}.acu-page-dots{color:var(--acu-text-sub);font-size:11px;padding:0 2px;letter-spacing:1px}.acu-pagination-info{color:var(--acu-text-sub);font-size:11px;white-space:nowrap}.acu-pagination{display:flex;align-items:center;justify-content:center;padding:8px 15px;gap:5px;flex-wrap:nowrap;font-size:var(--acu-font-size,13px);background:var(--acu-bg-panel);border-top:1px solid var(--acu-border);box-sizing:border-box;width:100%;flex:0 0 auto}.acu-pagination .acu-pagination-info{display:flex;align-items:center;gap:4px;color:var(--acu-text-sub,#999);white-space:nowrap}.acu-pagination .acu-pagination-info strong{color:var(--acu-text-main,#5e4b35);font-weight:600}.acu-pagination .acu-pagination-info .acu-pagination-total{opacity:.7;font-size:.9em}.acu-pagination-controls{display:flex;align-items:center;gap:4px}.acu-page-list{display:flex;align-items:center;gap:4px}.acu-pagination .acu-btn{display:inline-flex;align-items:center;justify-content:center;border:1px solid var(--acu-border,#dcd0c0);background:var(--acu-btn-bg,#dcd0c0);color:var(--acu-text-main,#5e4b35);cursor:pointer;transition:background var(--acu-transition-fast,0.15s),border-color var(--acu-transition-fast,0.15s),color var(--acu-transition-fast,0.15s),transform var(--acu-transition-fast,0.15s);-webkit-user-select:none;user-select:none;flex-shrink:0}.acu-pagination .acu-btn:hover:not(:disabled){background:var(--acu-title-color,#5e4b35);color:#fff;border-color:var(--acu-title-color,#5e4b35);transform:translateY(-2px);box-shadow:0 2px 5px rgba(0,0,0,.1)}.acu-pagination .acu-btn:active:not(:disabled){transform:scale(0.95)}.acu-pagination .acu-btn:disabled,.acu-pagination .acu-btn.disabled{opacity:.5;cursor:not-allowed;background:var(--acu-text-sub,#999)}.acu-pagination .acu-btn-icon{width:32px;height:32px;padding:0;border-radius:var(--acu-radius-sm,6px)}.acu-pagination .acu-btn-icon i{font-size:14px}.acu-pagination .acu-btn-page{min-width:32px;height:32px;padding:0;border-radius:6px;font-size:12px;font-weight:500;flex-shrink:0}.acu-pagination .acu-btn-page.active{background:var(--acu-title-color,#5e4b35);border-color:var(--acu-title-color,#5e4b35);color:#fff;font-weight:bold;cursor:default}.acu-pagination .acu-btn-page.active:hover{transform:none}.acu-pagination .acu-btn-page i{font-size:14px}.acu-pagination .acu-btn-sm{height:28px;padding:0 12px;font-size:12px;border-radius:var(--acu-radius-sm,6px)}.acu-page-ellipsis{display:flex;align-items:center;justify-content:center;min-width:24px;height:32px;color:var(--acu-text-sub,#999);font-size:12px;padding:0 2px;letter-spacing:1px;flex-shrink:0}.acu-page-ellipsis i{font-size:12px}.acu-pagination-jump{display:flex;align-items:center;gap:8px;color:var(--acu-text-sub,#999);white-space:nowrap}.acu-pagination-jump .acu-input-sm{width:56px;height:28px;padding:0 8px;border:1px solid var(--acu-border,#dcd0c0);border-radius:var(--acu-radius-sm,6px);background:var(--acu-input-bg,rgba(255,255,255,0.5));color:var(--acu-text-main,#5e4b35);font-size:var(--acu-font-size,13px);text-align:center;outline:none;transition:border-color var(--acu-transition-fast,0.15s),box-shadow var(--acu-transition-fast,0.15s);-moz-appearance:textfield}.acu-pagination-jump .acu-input-sm::-webkit-outer-spin-button,.acu-pagination-jump .acu-input-sm::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.acu-pagination-jump .acu-input-sm:focus{border-color:var(--acu-title-color,#d35400);box-shadow:0 0 0 3px var(--acu-title-color-bg,rgba(211,84,0,0.08))}@media (max-width:480px){.acu-pagination{flex-direction:column;gap:12px}.acu-pagination .acu-pagination-info{order:-1}.acu-pagination-jump{font-size:12px}.acu-pagination-jump .acu-input-sm{width:48px;height:26px}.acu-pagination-jump .acu-btn-sm{height:26px;padding:0 10px}}.acu-dash-container{display:grid;grid-template-columns:1fr 2fr;gap:16px;height:100%;padding:5px;overflow-y:auto;font-size:var(--acu-font-size);touch-action:pan-y}@media (max-width:700px){.acu-dash-container{grid-template-columns:1fr}}.acu-dash-card{background:var(--acu-card-bg);border-radius:12px;border:1px solid var(--acu-border);padding:16px;display:flex;flex-direction:column;gap:12px;box-shadow:0 4px 12px var(--acu-shadow);min-height:0;overflow:hidden}.acu-dash-title{font-size:1.2em;font-weight:bold;color:var(--acu-title-color);border-bottom:1px dashed var(--acu-border);padding:0 16px 2px 16px;margin-bottom:0;display:flex;justify-content:space-between;align-items:center;transition:background .2s;gap:8px;-webkit-user-select:none;user-select:none}.acu-dash-title *{font-size:inherit}.acu-dash-title.acu-dash-title-clickable{cursor:pointer}.acu-dash-title.acu-dash-title-clickable:hover{background:var(--acu-table-hover);border-radius:6px 6px 0 0}.acu-dash-collapse-icon{font-size:.7em;color:var(--acu-text-sub);transition:transform .2s;flex-shrink:0;display:flex;align-items:center;justify-content:center;height:28px}.acu-dash-title-text{display:flex;align-items:center;gap:8px;cursor:pointer;padding:2px 6px;margin:-2px -6px;border-radius:4px;transition:color .2s,background .2s}.acu-dash-title-text i{font-size:.9em}.acu-dash-title-clickable .acu-dash-title-text:hover{color:var(--acu-highlight,var(--acu-title-color));background:rgba(var(--acu-highlight-rgb,144,205,244),0.15)}.acu-dash-actions{display:flex;gap:2px}.acu-dash-npc-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:8px;padding:0 16px}.acu-dash-npc-item{background:var(--acu-table-head);padding:10px;border-radius:8px;cursor:default;border:1px solid rgba(0,0,0,0);transition:all .2s;font-weight:500;color:var(--acu-text-main);font-size:1em;display:flex;align-items:center;justify-content:center;gap:8px}.acu-dash-npc-item:hover{border-color:var(--acu-highlight);color:var(--acu-highlight);background:var(--acu-btn-bg)}.acu-dash-npc-text{flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center}.acu-dash-list-item{padding:6px 16px;border-bottom:1px solid var(--acu-border);color:var(--acu-text-sub);font-size:1em;display:flex;align-items:center;gap:6px;cursor:default;flex-wrap:nowrap}.acu-dash-list-item.acu-multi-tags{flex-wrap:wrap}.acu-dash-list-item:hover{color:var(--acu-text-main);padding-left:20px}.acu-dash-list-item i{font-size:.8em;color:var(--acu-title-color)}.acu-dash-row-collapse-btn{width:22px !important;height:22px !important;min-width:22px !important;display:flex;align-items:center;justify-content:center;border-radius:50%;background:var(--acu-table-head) !important;border:1px solid var(--acu-border) !important;color:var(--acu-text-sub) !important;font-size:10px !important;padding:0 !important;cursor:pointer;transition:all .2s}.acu-dash-row-collapse-btn:hover{background:var(--acu-title-color-bg) !important;border-color:var(--acu-title-color) !important;color:var(--acu-title-color) !important}.acu-dash-interactive{cursor:pointer !important;position:relative}.acu-tab-btn{padding:6px 12px;cursor:pointer;font-size:13px;font-weight:bold;color:var(--acu-text-sub);transition:all .2s;background:rgba(0,0,0,0);border:none;border-bottom:2px solid rgba(0,0,0,0)}.acu-tab-btn:hover{color:var(--acu-text-main);background:var(--acu-table-hover);border-radius:4px 4px 0 0}.acu-tab-btn.active{color:var(--acu-highlight);border-bottom-color:var(--acu-highlight)}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.acu-dash-npc-item.acu-highlight-changed,.acu-dash-list-item.acu-highlight-changed{color:var(--acu-highlight) !important;background-color:var(--acu-highlight-bg);font-weight:bold;animation:pulse-highlight 2s infinite}.acu-dash-widget.acu-highlight-ai-table .acu-dash-title-text{color:var(--acu-highlight-ai)}.acu-dash-widget.acu-highlight-ai-table .acu-dash-title-text i{color:var(--acu-highlight-ai)}.acu-dash-widget.acu-highlight-ai-table .acu-dash-count{background:var(--acu-highlight-ai-bg);color:var(--acu-highlight-ai)}.acu-dash-npc-item.acu-highlight-ai,.acu-dash-list-item.acu-highlight-ai{color:var(--acu-highlight-ai) !important;background:var(--acu-highlight-ai-bg) !important;font-weight:600;border-color:var(--acu-highlight-ai) !important}.acu-dash-display-tag{display:inline-flex;align-items:center;padding:2px 8px;font-size:11px;font-weight:500;color:var(--acu-text-sub);background:var(--acu-table-head);border:1px solid var(--acu-border);border-radius:10px;white-space:nowrap;flex-shrink:0}.acu-dash-interactive-tag{display:inline-flex;align-items:center;padding:2px 8px;font-size:11px;font-weight:500;color:var(--acu-title-color);background:var(--acu-title-color-bg);border:1px solid var(--acu-title-color);border-radius:10px;white-space:nowrap;flex-shrink:0;cursor:pointer;transition:all .15s ease}.acu-dash-interactive-tag:hover{background:var(--acu-title-color);color:#fff}.acu-dash-interactive-tag.fixed{border-style:dashed}.acu-dash-category-btn{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;font-size:11px;font-weight:500;color:var(--acu-text-sub);background:var(--acu-table-head);border:1px dashed var(--acu-border);border-radius:10px;white-space:nowrap;flex-shrink:0;cursor:pointer;transition:all .15s ease}.acu-dash-category-btn i{font-size:10px;opacity:.7}.acu-dash-category-btn:hover{background:var(--acu-title-color-bg);border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-dash-category-btn:hover i{opacity:1}.acu-dash-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;color:var(--acu-text-sub);text-align:center}.acu-dash-empty i{font-size:24px;margin-bottom:8px;opacity:.5}.acu-dash-widget{position:relative;background:var(--acu-card-bg);border-radius:12px;border:1px solid var(--acu-border);padding:4px 0;display:flex;flex-direction:column;gap:2px;box-shadow:0 4px 12px var(--acu-shadow);transition:all .2s ease;min-width:0;max-height:250px}.acu-dash-widget.acu-dash-widget-wide{grid-column:span 2}.acu-dash-widget:has(.acu-global-widget){padding:0 !important;gap:0 !important}.acu-dash-widget-editing{border:2px dashed var(--acu-title-color);cursor:grab;background:linear-gradient(var(--acu-card-bg),var(--acu-card-bg)) padding-box,linear-gradient(45deg,var(--acu-title-color),var(--acu-border)) border-box}.acu-dash-widget-editing:active{cursor:grabbing}.acu-widget-remove{position:absolute;top:-10px;left:-10px;width:24px;height:24px;border-radius:50%;background:#e74c3c;color:#fff;border:2px solid var(--acu-card-bg);cursor:pointer;z-index:10;display:flex;align-items:center;justify-content:center;font-size:12px;box-shadow:0 2px 6px rgba(0,0,0,.2);transition:transform .15s ease}.acu-widget-remove:hover{transform:scale(1.1)}.acu-widget-config{position:absolute;top:-10px;right:-10px;width:24px;height:24px;border-radius:50%;background:var(--acu-title-color);color:#fff;border:2px solid var(--acu-card-bg);cursor:pointer;z-index:10;display:flex;align-items:center;justify-content:center;font-size:12px;box-shadow:0 2px 6px rgba(0,0,0,.2);transition:transform .15s ease}.acu-widget-config:hover{transform:scale(1.1)}.acu-widget-resize{position:absolute;bottom:-10px;right:-10px;width:24px;height:24px;border-radius:50%;background:var(--acu-btn-bg);color:var(--acu-text-sub);border:2px solid var(--acu-border);cursor:nwse-resize;z-index:10;display:flex;align-items:center;justify-content:center;font-size:10px;box-shadow:0 2px 6px rgba(0,0,0,.2);transition:all .15s ease}.acu-widget-resize:hover{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color)}.acu-dash-body-scrollable{flex:1;min-height:0;max-height:100%;overflow-y:auto;overflow-x:hidden}.acu-dash-body-scrollable::-webkit-scrollbar{width:4px}.acu-dash-body-scrollable::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-dash-body-scrollable::-webkit-scrollbar-thumb{background:var(--acu-border);border-radius:2px}.acu-dash-body-scrollable::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub)}.acu-dash-count{display:inline-flex;align-items:center;justify-content:center;min-width:18px;height:18px;padding:0 5px;font-size:11px;font-weight:600;color:var(--acu-title-color);background:var(--acu-title-color-bg,rgba(var(--acu-title-color-rgb),0.15));border-radius:9px}.acu-dash-list-text{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-dash-header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--acu-border);background:var(--acu-bg-nav);flex-shrink:0}.acu-dash-header-left{display:flex;align-items:center;gap:8px;flex-shrink:0}.acu-dash-header-title{font-size:1.1em;font-weight:600;color:var(--acu-text-main);display:flex;align-items:center;gap:6px}.acu-dash-header-title i{color:var(--acu-title-color)}.acu-dash-header-spacer{flex:1;min-width:16px}.acu-dash-header-actions{display:flex;gap:6px;align-items:center;flex-shrink:0}.acu-dash-header-actions .acu-icon-btn.acu-btn-primary{background:var(--acu-title-color) !important;color:#fff !important;border-color:var(--acu-title-color) !important}.acu-dash-header-actions .acu-icon-btn.acu-btn-primary:hover{opacity:.9}.acu-dash-grid{flex:1;overflow-y:auto;display:grid;grid-template-columns:repeat(2,1fr);gap:8px;padding:8px;align-content:start}.acu-dash-widget-dragging{opacity:.5}.acu-dash-widget-drop-target{border:2px dashed var(--acu-title-color);background:var(--acu-title-color-bg,rgba(var(--acu-title-color-rgb),0.1))}.acu-dash-container-new{display:flex;flex-direction:column;height:100%;overflow:hidden}.acu-dash-empty-state{grid-column:1/-1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 24px;text-align:center;color:var(--acu-text-sub)}.acu-dash-empty-state i{font-size:48px;margin-bottom:16px;opacity:.5}.acu-dash-empty-state p{margin:0 0 16px;font-size:14px}.acu-dash-add-first-btn{display:inline-flex;align-items:center;gap:8px;padding:10px 20px;background:var(--acu-title-color);color:#fff;border:none;border-radius:8px;font-size:14px;cursor:pointer;transition:opacity .2s}.acu-dash-add-first-btn:hover{opacity:.9}.acu-actions-config-modal{max-width:320px}@media (max-width:400px){.acu-actions-config-modal{max-width:95%}}.acu-dash-row-edit-btn{width:24px;height:24px;min-width:24px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--acu-text-sub);cursor:pointer;transition:all .2s;opacity:0;margin-left:auto;flex-shrink:0}.acu-dash-row-edit-btn i{font-size:11px}.acu-dash-row-edit-btn:hover{background:var(--acu-btn-hover);color:var(--acu-title-color)}.acu-dash-npc-item:hover .acu-dash-row-edit-btn{opacity:1}.acu-dash-list-item:hover .acu-dash-row-edit-btn{opacity:1}.acu-dash-row-collapse-btn{width:20px;height:20px;min-width:20px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--acu-text-sub);cursor:pointer;transition:all .15s ease;margin-left:4px;flex-shrink:0;padding:0}.acu-dash-row-collapse-btn i{font-size:10px}.acu-dash-row-collapse-btn:hover{background:var(--acu-btn-hover);color:var(--acu-title-color)}@media (max-width:768px){.acu-row-edit-modal-container{align-items:flex-start !important;padding-top:8vh;padding-bottom:0}}.acu-row-edit-modal{max-width:500px;width:90%;max-height:80vh;display:flex;flex-direction:column}@media (max-width:768px){.acu-row-edit-modal{max-width:100%;width:100%;max-height:60vh;border-radius:16px 16px 0 0;margin-bottom:auto}}.acu-row-edit-modal .acu-modal-body{flex:1;overflow-y:auto;padding:16px}.acu-row-edit-content .acu-data-card{background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:12px;padding:12px;width:100% !important;max-width:none !important;box-sizing:border-box}.acu-status-board{width:100%;display:flex;flex-direction:column;gap:8px}.acu-status-board-header{display:flex;align-items:center;justify-content:space-between;padding:4px 8px;border-bottom:1px dashed var(--acu-border);flex-wrap:wrap;gap:8px}.acu-status-board-summary{font-size:11px;color:var(--acu-text-sub);white-space:nowrap}.acu-status-table-wrapper{overflow-x:auto}.acu-status-table{width:100%;border-collapse:collapse;font-size:12px}.acu-status-table th,.acu-status-table td{padding:6px 8px;text-align:left;border-bottom:1px solid var(--acu-border);font-family:var(--acu-font-family) !important}.acu-status-table th{font-weight:600;color:var(--acu-text-sub);background:var(--acu-table-head);font-size:11px;white-space:nowrap}.acu-status-table td{color:var(--acu-text-main)}.acu-status-table tbody tr{cursor:pointer;transition:background .15s}.acu-status-table tbody tr:hover{background:var(--acu-table-hover)}.acu-status-table tbody tr:last-child td{border-bottom:none}.acu-status-name{font-weight:500;max-width:100px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-status-freq,.acu-status-unrecorded,.acu-status-last-update{text-align:center !important}.acu-status-col-freq,.acu-status-col-unrecorded,.acu-status-col-last{text-align:center !important}.acu-status-disabled{color:var(--acu-text-sub);opacity:.6}.acu-status-global-hint{font-size:10px;color:var(--acu-text-sub);margin-left:2px}.acu-status-empty,.acu-status-loading{text-align:center;padding:20px !important;color:var(--acu-text-sub)}.acu-status-empty i,.acu-status-loading i{margin-right:6px}.acu-status-table tbody tr.acu-highlight-ai td{color:var(--acu-highlight-ai) !important;font-weight:600}.acu-status-table tbody tr.acu-highlight-ai .acu-status-name{color:var(--acu-highlight-ai) !important;font-weight:700}.acu-status-table tbody tr.acu-row-selected{background:var(--acu-title-color-bg) !important}.acu-status-table tbody tr.acu-row-selected td{color:var(--acu-title-color)}.acu-status-table tbody tr.acu-row-selected .acu-status-name{font-weight:600}.acu-status-board-actions{display:flex;align-items:center;gap:8px;margin-left:auto}.acu-status-toolbar{display:flex;align-items:center;gap:4px;padding-right:8px;border-right:1px solid var(--acu-border);margin-right:4px}.acu-freq-input{width:60px;padding:4px 6px;text-align:center;font-size:13px;font-weight:500;border:1px solid var(--acu-border);border-radius:4px;background:var(--acu-btn-bg);color:var(--acu-text-main);transition:border-color .15s ease}.acu-freq-input:focus{outline:none;border-color:var(--acu-title-color);background:var(--acu-card-bg)}.acu-freq-input::-webkit-inner-spin-button,.acu-freq-input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.acu-freq-input[type=number]{-moz-appearance:textfield}.acu-status-table td.acu-status-name span{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-icon-btn.acu-edit-active{background:var(--acu-title-color-bg);border-color:var(--acu-title-color);color:var(--acu-title-color)}@media (max-width:768px){.acu-status-toolbar{flex-wrap:wrap;gap:2px;padding-right:4px;margin-right:2px}.acu-freq-input{width:50px;padding:3px 4px;font-size:12px}.acu-status-board-actions{gap:4px}}.acu-embedded-options{width:100%;display:flex;flex-direction:column;gap:12px}.acu-embedded-options-list{display:flex;flex-direction:column;gap:12px}.acu-embedded-option-group{display:flex;flex-direction:column;gap:6px}.acu-embedded-option-rows{display:flex;flex-direction:column;gap:4px}.acu-embedded-option-row{display:flex;align-items:center;gap:8px;padding:6px 10px;background:var(--acu-table-head);border-radius:6px;cursor:pointer;transition:all .15s}.acu-embedded-option-row:hover{background:var(--acu-table-hover);color:var(--acu-title-color)}.acu-embedded-option-tags{display:flex;gap:4px;flex-shrink:0}.acu-option-tag{font-size:10px !important;padding:1px 5px !important;background:var(--acu-title-color-bg,rgba(var(--acu-title-color-rgb),0.15)) !important;color:var(--acu-title-color) !important}.acu-embedded-option-text{flex:1;font-size:12px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-dash-add-section{grid-column:1/-1;display:flex;flex-direction:column;gap:0}.acu-dash-add-section .acu-action-btn{width:100%;justify-content:center;border-radius:12px;padding:10px 16px}.acu-dash-add-section .acu-action-btn.active{border-bottom-left-radius:0;border-bottom-right-radius:0;border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-dash-add-list{border-top:none;border-top-left-radius:0;border-top-right-radius:0}.acu-dash-add-list .acu-switch-list-body{max-height:200px}.acu-dash-add-list .acu-switch-list-item.is-selected .item-label i{color:var(--acu-title-color)}.acu-dash-virtual-container{max-height:200px;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.acu-dash-virtual-container::-webkit-scrollbar{width:4px}.acu-dash-virtual-container::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-dash-virtual-container::-webkit-scrollbar-thumb{background:var(--acu-border);border-radius:2px}.acu-dash-virtual-container::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub)}.acu-dash-virtual-container .acu-dash-npc-grid{margin-bottom:8px}.acu-dash-virtual-container .acu-dash-npc-grid:last-child{margin-bottom:0}.acu-selected-tags{display:flex;flex-wrap:wrap;gap:8px;padding:10px;background:var(--acu-table-head);border-radius:8px;min-height:40px}.acu-selected-tag{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;background:var(--acu-title-color-bg);border:1px solid var(--acu-title-color);border-radius:6px;color:var(--acu-title-color);font-size:12px;font-weight:500}.acu-tag-remove{display:flex;align-items:center;justify-content:center;width:16px;height:16px;background:rgba(0,0,0,0);border:none;border-radius:50%;color:var(--acu-title-color);cursor:pointer;transition:all .15s ease;padding:0}.acu-tag-remove:hover{background:rgba(231,76,60,.2);color:#e74c3c}.acu-tag-remove i{font-size:10px}.acu-tab-btn{display:flex;align-items:center;gap:6px;padding:10px 16px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);font-size:13px;cursor:pointer;white-space:nowrap;position:relative;transition:all .2s ease}.acu-tab-btn i{font-size:14px}.acu-tab-btn:hover{color:var(--acu-text-main);background:var(--acu-btn-hover)}.acu-tab-btn.active{color:var(--acu-title-color);font-weight:600}.acu-tab-btn.active::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:60%;height:3px;background:var(--acu-title-color);border-radius:3px 3px 0 0}.acu-options-panel{display:flex;flex-direction:column;height:100%;min-height:0}.acu-options-header{flex:0 0 auto;padding:8px 12px;-webkit-user-select:none;user-select:none}.acu-options-title{font-size:1.2em;font-weight:800;color:var(--acu-title-color,#333);display:flex;align-items:center;gap:8px}.acu-options-title i{color:var(--acu-title-color,#667eea)}.acu-options-count{color:var(--acu-text-sub,#666);font-size:.9em}.acu-options-content{flex:1;overflow-y:auto !important;min-height:0;padding:10px;touch-action:pan-y;-webkit-overflow-scrolling:touch;position:relative;z-index:10}.acu-options-list{display:flex;flex-direction:column;gap:12px;padding-bottom:20px;flex:1;min-height:0}.acu-options-list .acu-dash-card{flex:1;min-height:0;display:flex;flex-direction:column}.acu-empty-state{text-align:center;color:var(--acu-text-sub,#666);padding:30px;font-size:.9em}.acu-option-rows{display:flex;flex-direction:column;gap:6px;overflow-y:auto;min-height:0;flex:1;padding-right:4px}.acu-option-rows::-webkit-scrollbar{width:4px}.acu-option-rows::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-option-rows::-webkit-scrollbar-thumb{background:var(--acu-border);border-radius:2px}.acu-option-rows::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub)}.acu-embedded-option-row{display:flex;flex-direction:column;align-items:flex-start;gap:8px;padding:12px;background:hsla(0,0%,100%,.05);border-radius:8px;border:1px solid var(--acu-border,rgba(255,255,255,0.1));cursor:pointer;transition:background .1s,transform .1s;-webkit-user-select:none;user-select:none;touch-action:pan-y}.acu-embedded-option-row:hover{background:var(--acu-table-hover,rgba(255,255,255,0.1));border-color:var(--acu-title-color,#667eea)}.acu-embedded-option-row:active{transform:translateY(1px)}.acu-embedded-option-tags{display:flex;flex-wrap:wrap;gap:4px;width:100%;flex-shrink:0}.acu-option-tag{background:var(--acu-btn-bg,rgba(255,255,255,0.1));color:var(--acu-title-color,#fff);border:1px solid var(--acu-border);font-weight:bold}.acu-embedded-option-text{width:100%;color:var(--acu-text-main,#333);font-weight:500;font-size:var(--acu-font-size,14px);line-height:1.5;word-break:break-word;white-space:pre-wrap}.acu-tab-config-panel,.acu-button-config-panel{display:flex;flex-direction:column;gap:16px}.acu-btn-text{display:flex;align-items:center;gap:4px;padding:4px 8px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub,#999);cursor:pointer;font-size:12px;border-radius:4px;transition:all .2s}.acu-btn-text:hover{background:var(--acu-btn-hover,#cbbba8);color:var(--acu-text-main,#5e4b35)}.acu-btn-text.acu-btn-clear{font-size:11px}.acu-btn-text.acu-btn-clear:hover{color:#e74c3c;background:rgba(231,76,60,.1)}.acu-config-section{display:flex;flex-direction:column;gap:8px}.acu-config-section h4{margin:0;font-size:13px;font-weight:600;color:var(--acu-text-main,#5e4b35);display:flex;align-items:center;gap:6px}.acu-config-section h4 .acu-btn-reset{margin-left:auto;font-size:11px}.acu-config-hint{display:flex;align-items:center;gap:6px;padding:8px 12px;background:var(--acu-table-head,#efebe4);border:1px solid var(--acu-border,#dcd0c0);border-radius:6px;font-size:12px;color:var(--acu-text-sub,#999)}.acu-config-hint i{color:var(--acu-title-color,#d35400)}.acu-visible-area{background:var(--acu-title-color-bg,rgba(211,84,0,0.08));border-radius:8px;padding:12px;border:1px dashed var(--acu-border,#dcd0c0)}.acu-visible-area h4{display:flex;align-items:center;gap:6px;font-weight:600}.acu-visible-area h4 i{color:var(--acu-title-color,#d35400)}.acu-hidden-area{background:var(--acu-table-head,#efebe4);border-radius:8px;padding:12px}.acu-hidden-area h4{display:flex;align-items:center;gap:6px;font-weight:600}.acu-hidden-area h4 i{color:var(--acu-text-sub,#999)}.acu-tab-visible-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:6px;max-height:160px;overflow-y:auto;padding:4px}@media (max-width:480px){.acu-tab-visible-grid{grid-template-columns:repeat(2,1fr)}}.acu-tab-config-btn{position:relative;cursor:grab;touch-action:none}.acu-tab-config-btn:hover{border-color:#e74c3c !important;background:rgba(231,76,60,.1) !important}.acu-tab-config-btn.dragging{opacity:.5;cursor:grabbing;border:2px dashed var(--acu-title-color,#d35400) !important}.acu-tab-config-btn .tab-type-badge-mini{position:absolute;top:-4px;right:-4px;font-size:8px;padding:1px 4px;border-radius:3px;background:var(--acu-title-color,#d35400);color:#fff;line-height:1.2}.acu-tab-hidden-list{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;max-height:150px;overflow-y:auto;padding:4px}@media (max-width:480px){.acu-tab-hidden-list{grid-template-columns:repeat(2,1fr)}}.acu-tab-hidden-item{display:flex;align-items:center;gap:6px;padding:8px 10px;border:1px solid var(--acu-border,#dcd0c0);border-radius:6px;background:var(--acu-card-bg,#fffef9);color:var(--acu-text-sub,#999);cursor:pointer;transition:all .2s;font-size:12px}.acu-tab-hidden-item:hover{background:var(--acu-title-color-bg,rgba(211,84,0,0.08));border-color:var(--acu-title-color,#d35400);color:var(--acu-title-color,#d35400)}.acu-tab-hidden-item:hover .add-icon{color:var(--acu-title-color,#d35400)}.acu-tab-hidden-item.is-special{border-left:2px solid var(--acu-text-sub,#999)}.acu-tab-hidden-item .tab-icon{width:14px;text-align:center}.acu-tab-hidden-item .tab-name{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-tab-hidden-item .tab-type-badge{font-size:9px;padding:1px 4px;border-radius:2px;background:rgba(0,0,0,.05)}.acu-tab-hidden-item .add-icon{font-size:10px;color:var(--acu-text-sub,#999)}.acu-empty-hint{display:flex;align-items:center;justify-content:center;gap:8px;padding:16px;color:var(--acu-text-sub,#999);font-size:12px;font-style:italic}.acu-empty-hint i{font-size:14px}.acu-btn-visible-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(48px,1fr));gap:8px;max-height:180px;overflow-y:auto;padding:4px}@media (max-width:480px){.acu-btn-visible-grid{grid-template-columns:repeat(auto-fill,48px);justify-content:flex-start}}.acu-btn-config-item{position:relative;display:flex;align-items:center;justify-content:center;width:48px;height:48px;border:1px solid var(--acu-border,#dcd0c0);border-radius:8px;background:var(--acu-card-bg,#fffef9);cursor:grab;touch-action:none;transition:all .2s}.acu-btn-config-item .btn-icon{font-size:16px;color:var(--acu-text-main,#5e4b35)}.acu-btn-config-item:hover{background:rgba(231,76,60,.1);border-color:#e74c3c}.acu-btn-config-item:hover .btn-icon{color:#e74c3c}.acu-btn-config-item.is-required{cursor:default;border-color:var(--acu-title-color,#d35400)}.acu-btn-config-item.is-required:hover{background:var(--acu-card-bg,#fffef9);border-color:var(--acu-title-color,#d35400)}.acu-btn-config-item.is-required:hover .btn-icon{color:var(--acu-text-main,#5e4b35)}.acu-btn-config-item .required-dot{position:absolute;top:4px;right:4px;width:6px;height:6px;border-radius:50%;background:var(--acu-title-color,#d35400)}.acu-btn-config-item .attachment-indicator{position:absolute;bottom:-4px;right:-4px;display:flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:50%;background:var(--acu-title-color,#d35400);color:#fff;font-size:8px;cursor:pointer;border:2px solid var(--acu-bg-panel,#e6e2d3);transition:all .2s}.acu-btn-config-item .attachment-indicator:hover{background:#e74c3c;transform:scale(1.1)}.acu-btn-config-item .attachment-add-btn{position:absolute;bottom:-4px;right:-4px;display:flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:4px;border:1px dashed var(--acu-text-sub,#999);background:var(--acu-bg-panel,#e6e2d3);color:var(--acu-text-sub,#999);font-size:8px;cursor:pointer;padding:0;transition:all .2s}.acu-btn-config-item .attachment-add-btn:hover{border-color:var(--acu-title-color,#d35400);color:var(--acu-title-color,#d35400);background:var(--acu-title-color-bg,rgba(211,84,0,0.08))}.acu-btn-hidden-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(40px,1fr));gap:6px;max-height:100px;overflow-y:auto;padding:4px}@media (max-width:480px){.acu-btn-hidden-grid{grid-template-columns:repeat(auto-fill,40px);justify-content:flex-start}}.acu-btn-hidden-item{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border:1px solid var(--acu-border,#dcd0c0);border-radius:6px;background:var(--acu-card-bg,#fffef9);color:var(--acu-text-sub,#999);cursor:pointer;transition:all .2s;font-size:14px;padding:0}.acu-btn-hidden-item:hover{background:var(--acu-title-color-bg,rgba(211,84,0,0.08));border-color:var(--acu-title-color,#d35400);color:var(--acu-title-color,#d35400)}.acu-config-hint-fixed{position:sticky;bottom:0;margin-top:auto;background:var(--acu-bg-panel,#e6e2d3);border-top:1px solid var(--acu-border,#dcd0c0);border-left:none;border-right:none;border-bottom:none;border-radius:0;margin-left:-16px;margin-right:-16px;padding:10px 16px;margin-bottom:-16px}.acu-attachment-picker-overlay{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw !important;height:100vh !important;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:2147483647;padding:20px;box-sizing:border-box}.acu-attachment-picker{width:90%;max-width:300px;max-height:calc(100vh - 100px);background:var(--acu-bg-panel,#e6e2d3);border:1px solid var(--acu-border,#dcd0c0);border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.3);overflow:hidden}.acu-attachment-picker .picker-header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--acu-table-head,#efebe4);border-bottom:1px solid var(--acu-border,#dcd0c0)}.acu-attachment-picker .picker-header h4{margin:0;font-size:14px;font-weight:600;color:var(--acu-title-color,#d35400)}.acu-attachment-picker .picker-header .btn-close{display:flex;align-items:center;justify-content:center;width:28px;height:28px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub,#999);cursor:pointer;border-radius:4px;transition:all .2s}.acu-attachment-picker .picker-header .btn-close:hover{background:var(--acu-btn-hover,#cbbba8);color:var(--acu-text-main,#5e4b35)}.acu-attachment-picker .picker-content{padding:16px}.acu-attachment-picker .picker-hint{margin:0 0 12px;font-size:12px;color:var(--acu-text-sub,#999)}.acu-attachment-picker .picker-options{display:grid;grid-template-columns:repeat(auto-fill,minmax(48px,1fr));gap:8px;max-height:200px;overflow-y:auto}.acu-attachment-picker .picker-option{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;padding:10px 6px;border:1px solid var(--acu-border,#dcd0c0);border-radius:8px;background:var(--acu-card-bg,#fffef9);color:var(--acu-text-main,#5e4b35);cursor:pointer;transition:all .2s;font-size:10px;text-align:center}.acu-attachment-picker .picker-option:hover{background:var(--acu-title-color-bg,rgba(211,84,0,0.08));border-color:var(--acu-title-color,#d35400);color:var(--acu-title-color,#d35400)}.acu-attachment-picker .picker-option i{font-size:18px;color:var(--acu-text-sub,#999)}.acu-attachment-picker .picker-option:hover i{color:var(--acu-title-color,#d35400)}.acu-attachment-picker .picker-option span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:100%}@media (max-width:768px){.acu-attachment-picker-overlay{padding:16px}.acu-attachment-picker{width:100%;max-width:320px}.acu-attachment-picker .picker-options{max-height:250px}}.acu-mode-control{display:flex !important;flex-direction:column !important;align-items:flex-end !important;gap:8px !important;width:100%}.acu-mode-control .acu-select{width:auto !important;min-width:120px}.acu-mode-control .acu-range-wrapper{display:flex;align-items:center;gap:8px;width:100%;justify-content:flex-end;margin-top:4px}.acu-mode-control .acu-inline-range{width:120px !important;flex-shrink:0}.acu-mode-control .acu-range-value{min-width:24px;text-align:right;font-variant-numeric:tabular-nums;color:var(--acu-title-color,#d35400);font-weight:bold}.acu-update-layout{display:flex;gap:0}@media (max-width:768px){.acu-update-layout{flex-direction:column}}.acu-update-left{flex:1;min-width:0;max-height:calc(80vh - 120px);overflow-y:auto;padding-right:16px;scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-update-left::-webkit-scrollbar{width:4px !important;height:4px !important}.acu-update-left::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important}.acu-update-left::-webkit-scrollbar-thumb{background:var(--acu-border) !important;border-radius:2px !important}.acu-update-left::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub) !important}.acu-update-left::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}@media (max-width:768px){.acu-update-left{max-height:none;padding-right:0}}.acu-update-right{width:260px;flex-shrink:0;border-left:1px solid var(--acu-border);padding-left:20px;display:flex;flex-direction:column}@media (max-width:768px){.acu-update-right{display:none}}.acu-table-selector{background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:12px;overflow:hidden}.acu-table-selector-header{display:flex;flex-wrap:wrap;gap:6px;padding:10px 12px;border-bottom:1px solid var(--acu-border);background:var(--acu-table-head);justify-content:flex-end}.acu-table-selector-list{max-height:280px;overflow-y:auto;padding:8px;scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-table-selector-list::-webkit-scrollbar{width:6px !important;height:6px !important}.acu-table-selector-list::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important}.acu-table-selector-list::-webkit-scrollbar-thumb{background:var(--acu-border) !important;border-radius:3px !important}.acu-table-selector-list::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub) !important}.acu-table-selector-list::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}.acu-table-selector-item{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:8px;cursor:pointer;transition:background .15s;-webkit-user-select:none;user-select:none}.acu-table-selector-item:hover{background:var(--acu-table-hover)}.acu-table-selector-item .acu-switch.small{transform:scale(0.65);transform-origin:center;margin:0 -4px;flex-shrink:0}.acu-table-selector-item input[type=checkbox]:not(.acu-switch input){appearance:checkbox !important;-webkit-appearance:checkbox !important;-moz-appearance:checkbox !important;width:16px !important;height:16px !important;min-width:16px !important;min-height:16px !important;margin:0 !important;padding:0 !important;cursor:pointer !important;accent-color:var(--acu-title-color) !important;background:none !important;background-color:rgba(0,0,0,0) !important;background-image:none !important;border:revert !important;outline:none !important;box-shadow:none !important;vertical-align:middle !important;flex-shrink:0 !important;position:relative !important}.acu-table-selector-item input[type=checkbox]:not(.acu-switch input)::before,.acu-table-selector-item input[type=checkbox]:not(.acu-switch input)::after{content:none !important;display:none !important}.acu-table-selector-item .table-name{flex:1;font-size:13px;color:var(--acu-text-main);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-table-selector-item.is-summary-outline .table-name::after{content:"â˜…";color:var(--acu-title-color);margin-left:4px;font-size:10px}.acu-table-selector-item.is-selected{background:var(--acu-title-color-bg)}.acu-table-selector-footer{padding:8px 12px;border-top:1px solid var(--acu-border);font-size:12px;color:var(--acu-text-sub);text-align:center}.acu-table-selector-empty{padding:20px;text-align:center;color:var(--acu-text-sub);font-size:13px}.acu-table-selector-empty i{display:block;font-size:24px;margin-bottom:8px;opacity:.5}.acu-quick-select-btn{padding:4px 10px;font-size:11px;border-radius:6px;border:1px solid var(--acu-border);background:var(--acu-btn-bg);color:var(--acu-text-main);cursor:pointer;transition:all .15s;white-space:nowrap}.acu-quick-select-btn:hover{background:var(--acu-btn-hover)}.acu-quick-select-btn.active{background:var(--acu-title-color-bg);border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-quick-select-btn i{margin-right:4px;font-size:10px}.acu-table-selector-mobile{margin-top:12px}.acu-table-selector-mobile .acu-table-selector{margin-top:8px}.acu-collapsible{cursor:pointer;display:flex;align-items:center;justify-content:space-between}.acu-collapsible .acu-collapse-indicator{font-size:12px;color:var(--acu-text-sub);transition:transform .2s}.acu-collapsible.is-expanded .acu-collapse-indicator{transform:rotate(180deg)}@media (max-width:768px){.acu-hide-mobile{display:none !important}}.acu-show-mobile-only{display:none}@media (max-width:768px){.acu-show-mobile-only{display:block}}@media (min-width:769px){.acu-manual-update-modal{max-width:800px}.acu-manual-update-modal .acu-modal-body{overflow:visible;max-height:none;padding:20px}}.acu-switch-list{background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:12px;overflow:hidden}.acu-switch-list-header{display:flex;flex-wrap:wrap;gap:6px;padding:10px 12px;border-bottom:1px solid var(--acu-border);background:var(--acu-table-head);justify-content:flex-end}.acu-switch-list-body{max-height:280px;overflow-y:auto;padding:8px;scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-switch-list-body::-webkit-scrollbar{width:6px !important;height:6px !important}.acu-switch-list-body::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important}.acu-switch-list-body::-webkit-scrollbar-thumb{background:var(--acu-border) !important;border-radius:3px !important}.acu-switch-list-body::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub) !important}.acu-switch-list-body::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}.acu-switch-list-item{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:8px;cursor:pointer;transition:background .15s;-webkit-user-select:none;user-select:none}.acu-switch-list-item:hover{background:var(--acu-table-hover)}.acu-switch-list-item.is-selected{background:var(--acu-title-color-bg)}.acu-switch-list-item .item-label{flex:1;font-size:13px;color:var(--acu-text-main);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-switch-list-item .item-badge{color:var(--acu-title-color);margin-left:4px;font-size:10px}.acu-switch-list-item .acu-switch.small{transform:scale(0.65);transform-origin:center;margin:0 -4px;flex-shrink:0}.acu-switch-list-empty{padding:20px;text-align:center;color:var(--acu-text-sub);font-size:13px}.acu-switch-list-empty i{display:block;font-size:24px;margin-bottom:8px;opacity:.5}.acu-switch-list-footer{padding:8px 12px;border-top:1px solid var(--acu-border);font-size:12px;color:var(--acu-text-sub);text-align:center}.acu-switch-list-footer .empty-hint{color:var(--acu-title-color)}.acu-graph-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;min-height:300px;color:var(--acu-text-sub);font-size:14px}.acu-graph-loading i{font-size:24px;color:var(--acu-title-color)}.acu-relationship-graph{position:relative;width:100%;flex:1 1 auto;min-height:400px;background:var(--acu-bg-panel);border-radius:12px;overflow:hidden;display:flex;flex-direction:column}.acu-graph-background{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0;pointer-events:none;background-color:rgba(0,0,0,0);background-repeat:no-repeat}.acu-panel-content:has(.acu-relationship-graph){display:flex;flex-direction:column;flex:1;min-height:450px;overflow:hidden}.acu-data-table:has(.acu-relationship-graph){min-height:450px;height:auto !important;overflow:hidden}.acu-graph-container{width:100%;position:absolute;top:40px;bottom:48px;left:0;right:0;overflow:hidden;z-index:1;background:rgba(0,0,0,0)}.acu-graph-search-input{position:absolute;bottom:56px;left:50%;transform:translateX(-50%);width:200px;z-index:10}.acu-graph-search-input .acu-search-input-wrapper{background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1)}.acu-slide-up-enter-active,.acu-slide-up-leave-active{transition:all .2s ease}.acu-slide-up-enter-from,.acu-slide-up-leave-to{opacity:0;transform:translateX(-50%) translateY(10px)}.acu-graph-toolbar{position:absolute;bottom:0;left:0;right:0;display:flex;align-items:center;justify-content:center;gap:4px;background:var(--acu-bg-panel);padding:8px 12px;border-top:1px solid var(--acu-border);z-index:10}.acu-graph-legend{position:absolute;top:0;left:0;right:0;display:flex;flex-wrap:wrap;justify-content:center;gap:8px;background:var(--acu-bg-panel);padding:8px 12px;font-size:11px;border-bottom:1px solid var(--acu-border);z-index:10}.acu-toolbar-divider{width:1px;height:20px;background:var(--acu-border);margin:0 4px}.acu-graph-btn{display:flex;align-items:center;justify-content:center;width:32px;height:32px;border:none;border-radius:6px;background:rgba(0,0,0,0);color:var(--acu-text-main);cursor:pointer;transition:all .15s ease;font-size:14px}.acu-graph-btn:hover{background:var(--acu-table-hover)}.acu-graph-btn:active{transform:scale(0.95)}.acu-graph-btn.active{background:var(--acu-title-color-bg);color:var(--acu-title-color)}.acu-graph-btn.saved{background:var(--acu-success,#27ae60);color:#fff;animation:pulse-success .3s ease}@keyframes pulse-success{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}.acu-legend-item{display:flex;align-items:center;gap:4px;white-space:nowrap}.acu-legend-item .dot{width:10px;height:10px;border-radius:50%;flex-shrink:0}.acu-legend-item .dot.dashed{width:18px;height:2px;border-radius:0;border:none;background:rgba(0,0,0,0) !important;position:relative}.acu-legend-item .dot.dashed::before{content:"";position:absolute;top:0;left:0;right:0;height:2px;border-top:2px dashed currentColor;color:inherit}.acu-legend-item .label{color:var(--acu-text-sub)}.acu-graph-empty{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:12px;color:var(--acu-text-sub);text-align:center}.acu-graph-empty i{font-size:48px;opacity:.3}.acu-graph-empty p{margin:0;font-size:14px}.acu-graph-empty .hint{font-size:12px;opacity:.7}.acu-node-fullname{margin:0 0 6px 0;font-size:13px;color:var(--acu-text-main)}.acu-node-hint{margin:0 0 12px 0;font-size:11px;color:var(--acu-text-sub)}.acu-node-preview{margin:0 0 12px 0;padding:8px 12px;font-size:14px;font-weight:600;color:var(--acu-text-main);background:var(--acu-table-head);border-radius:6px;text-align:center}.acu-char-selector{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px}.acu-char-btn{width:40px;height:40px;border:2px solid var(--acu-border);border-radius:8px;background:var(--acu-card-bg);color:var(--acu-text-main);font-size:18px;cursor:pointer;transition:all .15s ease}.acu-char-btn:hover{border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-char-btn.active{border-color:var(--acu-title-color);background:var(--acu-title-color);color:#fff}.acu-node-config-actions{display:flex;gap:8px;justify-content:flex-end}.acu-action-btn{padding:8px 16px;border:none;border-radius:6px;font-size:13px;cursor:pointer;transition:all .15s ease}.acu-action-btn.primary{background:var(--acu-title-color);color:#fff}.acu-action-btn.primary:hover{filter:brightness(1.1)}.acu-action-btn.secondary{background:var(--acu-table-head);color:var(--acu-text-main)}.acu-action-btn.secondary:hover{background:var(--acu-table-hover)}@media (max-width:768px){.acu-relationship-graph{min-height:calc(100vh - var(--acu-win-bottom,100px) - 120px);max-height:calc(100vh - var(--acu-win-bottom,100px) - 80px)}.acu-data-display:has(.acu-relationship-graph){flex:1 1 auto;min-height:calc(100vh - var(--acu-win-bottom,100px) - 80px)}.acu-panel-content:has(.acu-relationship-graph){flex:1;min-height:0;height:100%;overflow:hidden !important}.acu-graph-toolbar{padding:6px 8px;gap:2px;flex-wrap:wrap;position:absolute;bottom:0;left:0;right:0}.acu-graph-btn{width:28px;height:28px;font-size:12px}.acu-graph-legend{padding:6px 10px;font-size:10px;gap:6px;position:absolute;top:0;left:0;right:0}.acu-graph-container{top:36px;bottom:44px}.acu-legend-item .dot{width:8px;height:8px}}.acu-graph-avatar-wrapper{display:flex;flex-direction:column;align-items:center;gap:4px;pointer-events:none}.acu-graph-avatar{border:2px solid var(--acu-text-main,#333);box-shadow:0 2px 8px rgba(0,0,0,.15);overflow:hidden;background-color:var(--acu-card-bg,#fff)}.acu-graph-avatar-name{font-weight:bold;color:var(--acu-text-main,#333);text-shadow:-1px -1px 0 var(--acu-card-bg,#fff),1px -1px 0 var(--acu-card-bg,#fff),-1px 1px 0 var(--acu-card-bg,#fff),1px 1px 0 var(--acu-card-bg,#fff);white-space:nowrap;max-width:80px;overflow:hidden;text-overflow:ellipsis}.acu-graph-btn[title=åŠ¿åŠ›åˆ†ç»„å¸ƒå±€].active{background:var(--acu-title-color-bg);color:var(--acu-title-color)}.acu-interaction-list{display:flex;flex-direction:column;gap:8px;padding:8px}.acu-interaction-item{background:var(--acu-table-head);border-radius:8px;padding:10px;display:flex;flex-direction:column;gap:8px;border:1px solid rgba(0,0,0,0);transition:all .2s}.acu-interaction-item:hover{background:var(--acu-btn-bg);border-color:var(--acu-border)}.acu-interaction-item.acu-highlight-ai{background:var(--acu-highlight-ai-bg);border-color:var(--acu-highlight-ai)}.acu-interaction-header{display:flex;justify-content:space-between;align-items:center;width:100%}.acu-interaction-target{font-weight:bold;color:var(--acu-text-main);font-size:1em}.acu-interaction-actions{display:flex;flex-direction:row;gap:8px;align-items:center}.acu-interaction-meta{display:flex;align-items:center;gap:8px;font-size:.9em;flex-wrap:wrap}.acu-badge{padding:2px 6px;border-radius:4px;font-size:.8em;font-weight:500;white-space:normal;word-break:break-word}.acu-badge.acu-badge-primary{background:var(--acu-title-color-bg);color:var(--acu-title-color);border:1px solid var(--acu-title-color)}.acu-badge.acu-badge-secondary{background:var(--acu-table-head);color:var(--acu-text-sub);border:1px solid var(--acu-border)}.acu-interaction-text{font-size:.95em;color:var(--acu-text-main);background:rgba(0,0,0,.05);padding:6px 8px;border-radius:6px;line-height:1.4;white-space:pre-wrap}.acu-btn-success{color:#2ecc71 !important;border-color:#2ecc71 !important}.acu-btn-success:hover{background:rgba(46,204,113,.1) !important}.acu-dimension-manager{display:flex;flex-direction:column;gap:12px}.dimension-container{transition:all .2s ease;border:1px solid var(--acu-border);background:var(--acu-bg-panel);border-radius:8px;overflow:hidden}.dimension-container.is-collapsed{background:var(--acu-card-bg)}.dimension-container.is-collapsed .dimension-header{border-bottom:none}.dimension-header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;cursor:pointer;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border);transition:background .2s}.dimension-header:hover{background:var(--acu-table-hover)}.dimension-header .header-left{display:flex;align-items:center;gap:8px;flex:1}.dimension-header .header-right{display:flex;align-items:center;gap:8px}.dimension-header .collapse-icon{font-size:12px;color:var(--acu-text-sub);transition:transform .2s;width:16px;text-align:center}.dimension-header .collapse-icon.is-expanded{transform:rotate(90deg)}.dimension-name-input{background:rgba(0,0,0,0);border:1px solid rgba(0,0,0,0);color:var(--acu-text-main);font-weight:600;font-size:14px;padding:4px 8px;border-radius:4px;width:100%;max-width:200px;transition:all .2s}.dimension-name-input:hover{border-color:var(--acu-border);background:var(--acu-input-bg)}.dimension-name-input:focus{outline:none;border-color:var(--acu-title-color);background:var(--acu-input-bg)}.dimension-content{padding:12px;background:var(--acu-bg-panel)}.tier-list{display:flex;flex-direction:column;gap:12px;margin-bottom:12px}.tier-item{display:flex;flex-direction:column;gap:8px;padding-bottom:12px;border-bottom:1px dashed var(--acu-border)}.tier-item:last-child{border-bottom:none;padding-bottom:0}.tier-row{display:flex;align-items:center;gap:8px}.tier-row.basic-info{justify-content:space-between}.tier-row.weight-control{background:var(--acu-table-head);padding:6px 10px;border-radius:6px}.tier-row.weight-control .label{font-size:12px;color:var(--acu-text-sub);white-space:nowrap}.tier-row.weight-control .acu-range-input{flex:1;height:4px}.tier-row.weight-control .acu-badge{min-width:24px;text-align:center}.tier-row.prompt-editor .acu-textarea-scrollable{min-height:48px;font-size:12px;padding:6px;border-color:var(--acu-border);background:var(--acu-input-bg)}.tier-row.prompt-editor .acu-textarea-scrollable:focus{border-color:var(--acu-title-color);min-height:80px}.tier-name-wrapper{display:flex;align-items:center;gap:8px;flex:1}.tier-name-input{background:rgba(0,0,0,0);border:none;border-bottom:1px solid var(--acu-border);color:var(--acu-text-main);font-size:13px;padding:2px 4px;width:100%;max-width:150px;border-radius:0;transition:border-color .2s}.tier-name-input:focus{outline:none;border-bottom-color:var(--acu-title-color)}.acu-color-picker-mini{width:20px !important;height:20px !important;border-radius:4px !important;border:1px solid var(--acu-border) !important;padding:0 !important;appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);cursor:pointer}.acu-color-picker-mini::-webkit-color-swatch-wrapper{padding:0}.acu-color-picker-mini::-webkit-color-swatch{border-radius:3px;border:none}.acu-btn-dashed{display:flex;align-items:center;justify-content:center;gap:6px;width:100%;padding:8px;background:rgba(0,0,0,0);border:1px dashed var(--acu-border);border-radius:6px;color:var(--acu-text-sub);font-size:12px;cursor:pointer;transition:all .2s}.acu-btn-dashed:hover{border-color:var(--acu-title-color);color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-btn-dashed.add-dimension-btn{margin-top:8px;padding:12px;font-size:13px;border-style:solid;background:var(--acu-card-bg)}.acu-btn-dashed.add-dimension-btn:hover{background:var(--acu-btn-hover);border-color:var(--acu-border);color:var(--acu-text-main)}.acu-input-minimal{font-family:inherit}.acu-dimension-toolbar{display:flex;align-items:center;gap:2px;padding:4px 8px;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border)}.acu-dimension-toolbar .toolbar-label{font-size:11px;color:var(--acu-text-sub);white-space:nowrap}.acu-dimension-toolbar .toolbar-spacer{flex:1}.acu-dimension-toolbar .toolbar-divider{width:1px;height:16px;background:var(--acu-border);margin:0 2px}.acu-dimension-toolbar .toolbar-badge{display:inline-flex;align-items:center;justify-content:center;min-width:16px;height:16px;padding:0 4px;background:var(--acu-title-color);color:#fff;border-radius:8px;font-size:10px;font-weight:600}.acu-dimension-toolbar .acu-icon-btn{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--acu-text-sub);font-size:12px;cursor:pointer;transition:all .15s}.acu-dimension-toolbar .acu-icon-btn:hover{background:var(--acu-btn-hover);color:var(--acu-text-main)}.acu-dimension-toolbar .acu-icon-btn.active{background:var(--acu-title-color);color:#fff}.acu-dimension-toolbar .acu-icon-btn.migrate-in{color:var(--acu-title-color)}.acu-dimension-toolbar .acu-icon-btn.migrate-in:hover{background:var(--acu-title-color-bg)}.dimension-container.is-selected{border-color:var(--acu-title-color);box-shadow:0 0 0 2px var(--acu-title-color-bg)}.dimension-container.is-selected .dimension-header{background:var(--acu-title-color-bg)}.acu-preset-option.migrate-disabled{opacity:.6;cursor:not-allowed}.acu-preset-option.migrate-target .acu-preset-delete-btn{display:none}.acu-migrate-hint{font-size:10px;color:var(--acu-text-sub);padding:2px 6px;background:var(--acu-table-head);border-radius:3px}.acu-preset-header{position:sticky;top:0;margin:0 0 16px;padding:12px 16px;z-index:10;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border)}.acu-preset-header .acu-settings-row{margin-bottom:0}.acu-preset-header .hint{white-space:nowrap}.acu-preset-control{display:flex;align-items:center;gap:8px;margin-left:auto;justify-content:flex-end}.acu-preset-dropdown{position:relative;flex:1;min-width:120px;max-width:200px}.acu-preset-dropdown.open .acu-preset-dropdown-btn i{transform:rotate(180deg)}.acu-preset-dropdown-btn{display:flex;align-items:center;justify-content:space-between;width:100%;padding:8px 12px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);font-size:13px;cursor:pointer;transition:all .2s ease}.acu-preset-dropdown-btn:hover{border-color:var(--acu-text-sub)}.acu-preset-dropdown-btn .acu-preset-selected-name{flex:1;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-preset-dropdown-btn i{font-size:10px;color:var(--acu-text-sub);transition:transform .2s ease;margin-left:8px}.acu-preset-dropdown-menu{position:absolute;top:100%;left:0;right:0;margin-top:4px;max-height:200px;overflow-y:auto;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,.15);z-index:100}.acu-preset-option{display:flex;align-items:center;padding:10px 12px;cursor:pointer;transition:background .15s ease}.acu-preset-option:hover{background:var(--acu-btn-hover)}.acu-preset-option.active{background:var(--acu-title-color-bg);color:var(--acu-title-color)}.acu-preset-option:first-child{border-radius:7px 7px 0 0}.acu-preset-option:last-child{border-radius:0 0 7px 7px}.acu-preset-option .acu-preset-option-name{flex:1;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-preset-option .acu-preset-delete-btn{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--acu-text-sub);cursor:pointer;opacity:0;transition:all .15s ease}.acu-preset-option .acu-preset-delete-btn:hover{background:rgba(231,76,60,.1);color:#e74c3c}.acu-preset-option .acu-preset-delete-btn i{font-size:10px}.acu-preset-option:hover .acu-preset-delete-btn{opacity:1}.acu-preset-actions{display:flex;gap:8px}.acu-global-widget{width:100%;height:auto;min-height:100%;display:block;color:var(--acu-text-main);position:relative}.acu-global-header{display:flex;flex-direction:column;gap:8px;width:100%;padding:12px 16px}.acu-global-body{display:flex;flex-wrap:wrap;gap:8px;width:100%;padding:0 16px 12px 16px}.acu-global-footer{width:100%;padding:0 16px 12px 16px}.acu-global-time-group{display:flex;align-items:center;gap:12px;flex-wrap:wrap}.acu-global-widget .acu-global-time-primary{display:flex;align-items:center;gap:8px;font-size:1.4em;font-weight:600;color:var(--acu-title-color)}.acu-global-widget .acu-global-time-primary *{font-size:inherit}.acu-global-widget .acu-global-time-primary i{opacity:.8}.acu-global-time-secondary{display:flex;gap:8px}.acu-global-widget .acu-global-location{display:flex;align-items:center;gap:10px;font-size:1.5em;font-weight:600;line-height:1.4;color:var(--acu-text-main)}.acu-global-widget .acu-global-location *{font-size:inherit}.acu-global-widget .acu-global-location i{color:var(--acu-title-color);font-size:.9em;flex-shrink:0;opacity:.8}.acu-global-widget .acu-global-location .location-path{display:flex;flex-wrap:wrap;align-items:center;gap:6px}.acu-global-widget .acu-global-location .location-part{font-weight:500}.acu-global-widget .acu-global-location .location-part:last-child{color:var(--acu-title-color);font-weight:600}.acu-global-widget .acu-global-location .location-sep{color:var(--acu-text-sub);font-size:.8em;opacity:.6}.acu-global-item{display:flex;align-items:center;background:rgba(0,0,0,.03);border-radius:var(--acu-radius-md);padding:6px 10px;font-size:.95em;transition:all .2s ease;border:1px solid rgba(0,0,0,0)}.acu-theme-dark .acu-global-item{background:hsla(0,0%,100%,.05)}.acu-global-item:hover{background:var(--acu-table-hover);border-color:var(--acu-border)}.acu-global-item.layout-inline{width:auto;flex-grow:1;max-width:48%;min-width:120px}.acu-global-item.layout-inline.people-group{max-width:100%}.acu-global-item.layout-block{width:100%;background:rgba(0,0,0,.02)}.acu-global-item.layout-block .item-value{white-space:normal}.acu-global-item .item-icon{flex-shrink:0;width:20px;text-align:center;margin-right:8px;color:var(--acu-text-sub);font-size:.9em}.acu-global-item .item-content{display:flex;flex-direction:column;flex:1;min-width:0}.acu-global-item .item-label{font-size:.75em;color:var(--acu-text-sub);margin-bottom:2px}.acu-global-item .item-value{font-weight:500;color:var(--acu-text-main);line-height:1.3}.acu-global-person-list{display:flex;flex-wrap:wrap;gap:6px;width:100%;padding-top:4px}.acu-global-person-list .person-tag{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;background:var(--acu-badge-bg);border-radius:12px;font-size:.85em;color:var(--acu-text-main);border:1px solid rgba(0,0,0,0);transition:all .2s}.acu-global-person-list .person-tag:hover{border-color:var(--acu-title-color);color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-global-person-list .person-tag:hover i{opacity:1}.acu-badge-outline{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border:1px solid var(--acu-border);border-radius:10px;font-size:.85em;color:var(--acu-text-sub);white-space:nowrap}.acu-badge-outline i{font-size:.9em}.acu-badge-outline.is-highlight{color:var(--acu-title-color);border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.rwp-header{cursor:pointer}.rwp-body{padding:8px;max-height:400px;overflow-y:auto}.rwp-column-group{margin-bottom:8px;border-radius:8px;background:var(--acu-card-bg)}.rwp-column-group:last-child{margin-bottom:0}.rwp-column-group.collapsed .rwp-group-content{display:none}.rwp-group-header{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--acu-table-head);cursor:pointer;transition:background .15s ease;border-radius:8px}.rwp-group-header:hover{background:var(--acu-table-hover)}.rwp-group-header .rwp-header-left{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--acu-text-main)}.rwp-group-header .rwp-header-left i{font-size:10px;color:var(--acu-text-sub);transition:transform .2s ease}.rwp-group-header .rwp-column-name{font-weight:500}.rwp-group-header .rwp-word-count{font-size:11px;color:var(--acu-text-sub)}.rwp-group-header .rwp-header-right{display:flex;align-items:center;gap:8px}.rwp-limit-wrapper{position:relative;display:flex;align-items:center}.rwp-limit-popover{position:absolute;top:calc(100% + 8px);right:0;width:200px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:var(--acu-radius-md);box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:100;padding:12px;cursor:default}.rwp-limit-popover .popover-header{font-size:12px;color:var(--acu-text-sub);margin-bottom:8px}.rwp-limit-popover .popover-body{display:flex;flex-direction:column;gap:8px}.rwp-limit-popover .limit-control{display:flex;align-items:center;gap:8px}.rwp-limit-popover .limit-control input[type=range]{flex:1}.rwp-limit-popover .limit-control .limit-value{font-size:13px;font-weight:500;min-width:32px;text-align:right}.rwp-limit-popover .popover-actions{display:flex;justify-content:flex-end}.rwp-group-content{display:flex;flex-wrap:wrap;gap:6px;padding:10px 12px;background:var(--acu-card-bg);border-top:1px solid var(--acu-border)}.rwp-word-badge{display:inline-flex;align-items:center;padding:4px 10px;font-size:12px;color:var(--acu-text-main);background:var(--acu-btn-bg);border-radius:12px;transition:all .15s ease}.rwp-word-badge:hover{background:var(--acu-btn-hover)}.rwp-word-badge.disabled{opacity:.5;color:var(--acu-text-sub)}.rwp-empty-hint{font-size:12px;color:var(--acu-text-sub);font-style:italic}@media (max-width:768px){.rwp-body{max-height:300px}.rwp-group-header{padding:8px 10px}.rwp-group-content{padding:8px 10px}.rwp-word-badge{padding:3px 8px;font-size:11px}}.acu-modal-container{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw !important;height:100vh !important;z-index:2147483647;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);animation:acu-fadeIn .2s ease;pointer-events:auto !important}.acu-modal{position:relative;width:90%;max-width:500px;max-height:80vh;background:var(--acu-bg-panel);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;animation:acu-slideUp .3s ease}.acu-modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--acu-border);background:var(--acu-table-head)}.acu-modal-header h3{margin:0;font-size:16px;font-weight:600;color:var(--acu-text-main);display:flex;align-items:center;gap:8px}.acu-modal-header h3 i{color:var(--acu-title-color)}.acu-modal-close{width:32px;height:32px;display:flex;align-items:center;justify-content:center;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);font-size:18px;cursor:pointer;border-radius:8px;transition:all .2s ease}.acu-modal-close:hover{background:rgba(231,76,60,.15);color:#e74c3c}.acu-modal-body{flex:1;padding:20px;overflow-y:auto;overflow-x:hidden;scrollbar-width:thin !important;scrollbar-color:var(--acu-border) rgba(0,0,0,0) !important}.acu-modal-body::-webkit-scrollbar{width:6px !important;height:6px !important}.acu-modal-body::-webkit-scrollbar-track{background:rgba(0,0,0,0) !important}.acu-modal-body::-webkit-scrollbar-thumb{background:var(--acu-border) !important;border-radius:3px !important}.acu-modal-body::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub) !important}.acu-modal-body::-webkit-scrollbar-corner{background:rgba(0,0,0,0) !important}.acu-modal-footer{display:flex;align-items:center;justify-content:flex-end;gap:12px;padding:16px 20px;border-top:1px solid var(--acu-border);background:var(--acu-bg-panel)}.acu-close-pill{background-color:var(--acu-text-main,#333) !important;color:var(--acu-bg-panel,#fff) !important;border:none !important;padding:6px 20px;border-radius:20px;font-weight:bold;font-size:13px;cursor:pointer;box-shadow:0 4px 10px var(--acu-title-color-bg,rgba(74,158,255,0.2));transition:transform .2s,filter .2s;display:inline-flex;align-items:center;justify-content:center;margin-left:auto}.acu-close-pill:hover{filter:brightness(0.85);transform:scale(1.05)}.modal-enter-active,.modal-leave-active{transition:opacity .2s ease}.modal-enter-active .acu-modal,.modal-leave-active .acu-modal{transition:transform .3s cubic-bezier(0.4,0,0.2,1)}.modal-enter-from,.modal-leave-to{opacity:0}.modal-enter-from .acu-modal,.modal-leave-to .acu-modal{transform:scale(0.95) translateY(-20px)}.acu-toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);z-index:2147483647;display:flex;align-items:center;gap:10px;padding:14px 24px;border-radius:12px;font-size:14px;font-weight:500;box-shadow:0 8px 32px rgba(0,0,0,.25);backdrop-filter:blur(10px);pointer-events:none;background:var(--acu-bg-panel);color:var(--acu-text-main);border:1px solid var(--acu-border)}.acu-toast i{font-size:18px;flex-shrink:0;color:var(--acu-text-main)}.acu-toast .acu-toast-message{max-width:300px;line-height:1.4}.toast-enter-active,.toast-leave-active{transition:all .35s cubic-bezier(0.4,0,0.2,1)}.toast-enter-from{opacity:0;transform:translateX(-50%) translateY(-20px) scale(0.9)}.toast-leave-to{opacity:0;transform:translateX(-50%) translateY(-10px) scale(0.95)}.acu-graph-settings-modal{max-width:480px}.acu-graph-settings-modal .acu-modal-body{padding:0}.acu-background-config-section{margin-top:12px}.acu-background-preview-container{margin-bottom:12px}.acu-background-preview{position:relative;width:100%;height:150px;border:1px solid var(--acu-border);border-radius:12px;background:var(--acu-table-head);overflow:hidden;cursor:grab;-webkit-user-select:none;user-select:none;transition:border-color .2s ease}.acu-background-preview.dragging{cursor:grabbing;border-color:var(--acu-title-color)}.acu-background-preview.has-image{background:rgba(0,0,0,0)}.acu-background-preview:hover{border-color:var(--acu-title-color)}.acu-preview-image{width:100%;height:100%;background-size:cover;background-position:center;background-repeat:no-repeat;transition:background-position .05s ease}.acu-no-image-hint{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:8px;color:var(--acu-text-sub)}.acu-no-image-hint i{font-size:32px;opacity:.5}.acu-no-image-hint span{font-size:12px;opacity:.7}.acu-background-actions{display:flex;gap:8px;margin-bottom:12px}.acu-background-actions .acu-action-btn{flex:1;height:36px;font-size:13px;gap:6px}.acu-background-actions .acu-action-btn i{font-size:14px}.acu-url-input-row{margin-bottom:12px}.acu-url-input-row .acu-background-url-input{width:100%;padding:10px 12px !important;background:var(--acu-btn-bg) !important;border:1px solid var(--acu-border) !important;border-radius:8px !important;color:var(--acu-text-main) !important;font-size:12px !important;font-family:monospace !important}.acu-url-input-row .acu-background-url-input:focus{border-color:var(--acu-title-color) !important;box-shadow:0 0 0 2px var(--acu-title-color-bg) !important}.acu-url-input-row .acu-background-url-input::placeholder{color:var(--acu-text-sub) !important;opacity:.7 !important}.acu-faction-color-hint{display:flex;align-items:center;gap:16px;padding:8px 16px;margin-bottom:8px;font-size:11px;color:var(--acu-text-sub)}.acu-faction-color-hint .hint-item{display:flex;align-items:center;gap:4px}.acu-faction-color-hint .hint-box{width:14px;height:14px;border-radius:3px}.acu-faction-color-hint .hint-box.dashed{border:2px dashed var(--acu-text-sub);background:rgba(0,0,0,0)}.acu-faction-color-hint .hint-box.solid{background:var(--acu-text-sub);opacity:.3}.acu-faction-color-group{padding:12px 16px;background:var(--acu-table-head);border-radius:12px;border:none}.acu-faction-color-group.acu-faction-color-scrollable{max-height:200px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--acu-border) rgba(0,0,0,0)}.acu-faction-color-group.acu-faction-color-scrollable::-webkit-scrollbar{width:6px}.acu-faction-color-group.acu-faction-color-scrollable::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-faction-color-group.acu-faction-color-scrollable::-webkit-scrollbar-thumb{background:var(--acu-border);border-radius:3px}.acu-faction-color-group.acu-faction-color-scrollable::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub)}.acu-faction-color-row{display:flex;align-items:center;justify-content:space-between;padding:8px 0}.acu-faction-color-row:not(:last-child){border-bottom:1px solid var(--acu-border)}.acu-faction-color-row .acu-settings-label{flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:13px;font-weight:500;color:var(--acu-text-main)}.acu-faction-color-control{display:flex;align-items:center;gap:8px;flex-shrink:0}.acu-faction-color-control input[type=color]{width:28px !important;height:28px !important}.acu-faction-color-control .acu-opacity-slider{width:60px !important;height:14px !important}.acu-faction-color-control .acu-opacity-value{font-size:11px;color:var(--acu-text-sub);width:32px;text-align:right}.acu-legend-items-section{margin-top:12px}.acu-legend-items-header{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;font-size:12px;font-weight:500;color:var(--acu-text-sub)}.acu-legend-items-list{max-height:200px;overflow-y:auto;padding:8px 16px;background:var(--acu-table-head);border-radius:12px;margin:0 16px;scrollbar-width:thin;scrollbar-color:var(--acu-border) rgba(0,0,0,0)}.acu-legend-items-list::-webkit-scrollbar{width:6px}.acu-legend-items-list::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-legend-items-list::-webkit-scrollbar-thumb{background:var(--acu-border);border-radius:3px}.acu-legend-items-list::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub)}.acu-legend-item-row{padding:10px 0;display:flex;align-items:center;justify-content:space-between;gap:8px}.acu-legend-item-row:not(:last-child){border-bottom:1px solid var(--acu-border)}.acu-legend-item-display{display:flex;align-items:center;gap:8px;flex:1;min-width:0}.acu-legend-color-dot{width:14px;height:14px;border-radius:50%;flex-shrink:0;box-shadow:0 1px 3px rgba(0,0,0,.15)}.acu-legend-emoji{font-size:14px;flex-shrink:0}.acu-legend-label{font-size:13px;font-weight:500;color:var(--acu-text-main);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-legend-keywords{display:flex;align-items:center;gap:4px;flex-wrap:wrap;margin-left:auto}.acu-legend-keyword-tag{font-size:10px;padding:2px 6px;background:var(--acu-btn-bg);color:var(--acu-text-sub);border-radius:4px;white-space:nowrap}.acu-legend-keyword-more{font-size:10px;color:var(--acu-text-sub)}.acu-legend-item-actions{display:flex;align-items:center;gap:4px;flex-shrink:0}.acu-legend-action-btn{width:28px;height:28px;display:flex;align-items:center;justify-content:center;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);border-radius:6px;cursor:pointer;transition:all .2s ease}.acu-legend-action-btn:hover{background:var(--acu-btn-bg);color:var(--acu-text-main)}.acu-legend-action-btn.acu-legend-action-btn-danger:hover{background:rgba(231,76,60,.15);color:#e74c3c}.acu-legend-action-btn i{font-size:12px}.acu-legend-item-edit{flex:1;display:flex;flex-direction:column;gap:8px}.acu-legend-edit-row{display:flex;align-items:center;gap:8px}.acu-legend-input{flex:1;min-width:80px;padding:6px 10px !important;font-size:12px !important}.acu-legend-color-input{width:32px !important;height:32px !important;padding:2px !important;flex-shrink:0}.acu-legend-emoji-input{width:48px !important;padding:6px 8px !important;font-size:14px !important;text-align:center;flex-shrink:0}.acu-legend-keywords-input{flex:1;padding:6px 10px !important;font-size:12px !important}.acu-legend-edit-actions{display:flex;align-items:center;gap:6px;justify-content:flex-end}.acu-legend-empty{padding:16px;text-align:center;color:var(--acu-text-sub);font-size:12px}.acu-legend-reset-wrapper{margin-top:12px;padding:0 16px;display:flex;justify-content:center}.acu-action-btn-small{padding:6px 12px !important;font-size:12px !important}.acu-action-btn-small i{font-size:11px !important}.acu-action-btn-primary{background:var(--acu-title-color) !important;color:#fff !important}.acu-action-btn-primary:hover{filter:brightness(1.1)}.acu-faction-settings-modal{max-width:400px}.acu-faction-settings-modal .acu-modal-body{padding:0;padding-bottom:var(--acu-safe-area-bottom,20px)}.acu-faction-settings-modal .acu-action-row{display:flex;justify-content:space-between;gap:12px}.acu-faction-settings-modal .acu-action-row .acu-action-btn{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:10px 16px;border:none;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease}.acu-faction-settings-modal .acu-action-row .acu-action-btn i{font-size:12px}.acu-faction-settings-modal .acu-action-row .acu-action-btn-primary{background:var(--acu-title-color);color:#fff}.acu-faction-settings-modal .acu-action-row .acu-action-btn-primary:hover{filter:brightness(1.1)}.acu-faction-settings-modal .acu-action-row .acu-action-btn-secondary{background:var(--acu-btn-bg);color:var(--acu-text-main)}.acu-faction-settings-modal .acu-action-row .acu-action-btn-secondary:hover{background:var(--acu-btn-hover)}.acu-node-config-modal{max-width:420px}.acu-node-config-modal .acu-modal-body{padding:0;padding-bottom:var(--acu-safe-area-bottom,20px)}.acu-node-config-modal .acu-node-hint{font-size:12px;color:var(--acu-text-sub);margin-bottom:12px}.acu-node-config-modal .acu-char-selector{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}.acu-node-config-modal .acu-char-btn{min-width:36px;height:36px;padding:0 12px;border:2px solid var(--acu-border);border-radius:8px;background:var(--acu-btn-bg);color:var(--acu-text-main);font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.acu-node-config-modal .acu-char-btn:hover{border-color:var(--acu-title-color);background:var(--acu-btn-hover)}.acu-node-config-modal .acu-char-btn.active{border-color:var(--acu-title-color);background:var(--acu-title-color);color:#fff}.acu-node-config-modal .acu-node-preview{font-size:13px;color:var(--acu-text-main);padding:8px 12px;background:var(--acu-card-bg);border-radius:6px;margin-bottom:12px}.acu-node-config-modal .acu-node-config-actions{display:flex;justify-content:flex-end;gap:8px}.acu-node-config-modal .acu-node-config-actions .acu-action-btn{padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease}.acu-node-config-modal .acu-node-config-actions .acu-action-btn.secondary{background:var(--acu-btn-bg);color:var(--acu-text-main)}.acu-node-config-modal .acu-node-config-actions .acu-action-btn.secondary:hover{background:var(--acu-btn-hover)}.acu-node-config-modal .acu-node-config-actions .acu-action-btn.primary{background:var(--acu-title-color);color:#fff}.acu-node-config-modal .acu-node-config-actions .acu-action-btn.primary:hover{filter:brightness(1.1)}.acu-node-config-modal .acu-action-row{display:flex;justify-content:space-between;gap:12px}.acu-node-config-modal .acu-action-row .acu-action-btn{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:10px 16px;border:none;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease}.acu-node-config-modal .acu-action-row .acu-action-btn i{font-size:12px}.acu-node-config-modal .acu-action-row .acu-action-btn-primary{background:var(--acu-title-color);color:#fff}.acu-node-config-modal .acu-action-row .acu-action-btn-primary:hover{filter:brightness(1.1)}.acu-node-config-modal .acu-action-row .acu-action-btn-secondary{background:var(--acu-btn-bg);color:var(--acu-text-main)}.acu-node-config-modal .acu-action-row .acu-action-btn-secondary:hover{background:var(--acu-btn-hover)}.acu-input-floor-modal{max-width:400px}.floor-input-group{display:flex;flex-direction:column;gap:12px}.floor-input{width:100%;padding:12px 16px;font-size:16px;text-align:center;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main)}.floor-input:focus{outline:none;border-color:var(--acu-title-color)}.floor-hint{font-size:12px;color:var(--acu-text-sub);text-align:center}.floor-info{display:flex;align-items:center;gap:8px;padding:12px;background:var(--acu-table-head);border-radius:8px;font-size:13px;color:var(--acu-text-sub)}.floor-info i{color:var(--acu-title-color)}.floor-error{display:flex;align-items:center;gap:8px;padding:10px 12px;background:rgba(231,76,60,.1);border:1px solid rgba(231,76,60,.3);border-radius:8px;font-size:13px;color:#e74c3c}.acu-purge-overlay{display:flex !important;align-items:center !important;justify-content:center !important;padding-top:0 !important}.acu-purge-range-modal{width:85%;max-width:360px;height:auto;margin:0;box-shadow:0 25px 50px rgba(0,0,0,.5);overflow:visible;border-radius:16px;background:var(--acu-bg-panel)}.acu-purge-title{text-align:center;border-bottom:none;padding:25px 20px 0 20px;font-size:18px;font-weight:600;color:var(--acu-text-main)}.acu-purge-content{padding:20px 30px;display:flex;flex-direction:column;align-items:center;gap:15px}.acu-purge-icon{width:50px;height:50px;background:rgba(231,76,60,.15);color:#e74c3c;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;margin-bottom:5px}.acu-purge-hint{font-size:13px;color:var(--acu-text-sub);margin:0;text-align:center;line-height:1.4}.acu-purge-hint-sub{opacity:.7;font-size:12px}.acu-purge-inputs{display:flex;gap:10px;align-items:center;justify-content:center;width:100%}.acu-purge-input{text-align:center;font-size:20px;font-weight:bold;height:50px;width:100px;border-radius:12px;background:var(--acu-input-bg,var(--acu-btn-bg));border:2px solid var(--acu-border);color:var(--acu-text-main);transition:border-color .2s ease}.acu-purge-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-purge-input::placeholder{color:var(--acu-text-sub);opacity:.5;font-weight:normal;font-size:14px}.acu-purge-input::-webkit-outer-spin-button,.acu-purge-input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.acu-purge-input[type=number]{-moz-appearance:textfield}.acu-purge-separator{font-weight:bold;color:var(--acu-text-main);font-size:18px}.acu-purge-btns{padding:0 20px 25px 20px;border-top:none;display:flex;justify-content:space-between;gap:10px}.acu-purge-btn{flex:1;display:flex;justify-content:center;align-items:center;padding:10px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;border:none;transition:all .2s ease}.acu-purge-btn-cancel{background:var(--acu-btn-bg);color:var(--acu-text-main)}.acu-purge-btn-cancel:hover{background:var(--acu-btn-hover)}.acu-purge-btn-confirm{background:#e74c3c;color:#fff}.acu-purge-btn-confirm:hover:not(:disabled){background:#c0392b}.acu-purge-btn-confirm:disabled{opacity:.5;cursor:not-allowed}.acu-purge-btn-advanced{flex:0 0 auto;background:rgba(0,0,0,0);color:var(--acu-text-sub);border:1px solid var(--acu-border);gap:6px}.acu-purge-btn-advanced:hover{background:var(--acu-btn-bg);color:var(--acu-title-color);border-color:var(--acu-title-color)}.acu-purge-btn-advanced i{font-size:12px}.acu-purge-btns-right{display:flex;gap:10px;flex:1}.acu-advanced-purge-modal{max-width:520px;max-height:85vh}.acu-advanced-purge-modal .acu-modal-body{padding:16px;overflow-y:auto;max-height:calc(85vh - 120px)}.acu-purge-range-row{display:flex;align-items:center;justify-content:center;gap:12px;padding:8px 0}.acu-purge-range-row .acu-purge-input{width:100px;height:44px;font-size:18px}.acu-purge-range-row .acu-purge-separator{font-size:20px;color:var(--acu-text-sub)}.acu-purge-range-hint{display:flex;align-items:center;justify-content:center;gap:6px;margin-top:8px;font-size:12px;color:var(--acu-text-sub)}.acu-purge-range-hint i{font-size:11px}.acu-purge-quick-actions{display:flex;justify-content:center;gap:8px;margin-top:8px}.acu-purge-warning{display:flex;align-items:center;gap:10px;margin-top:12px;padding:12px 16px;background:rgba(231,76,60,.1);border:1px solid rgba(231,76,60,.3);border-radius:10px;color:#e74c3c;font-size:13px}.acu-purge-warning i{font-size:16px;flex-shrink:0}.acu-purge-warning span{line-height:1.4}@media (max-width:768px){.acu-advanced-purge-modal{max-width:none;max-height:70vh}.acu-advanced-purge-modal .acu-modal-body{max-height:calc(70vh - 120px)}.acu-purge-range-row .acu-purge-input{width:80px;height:40px;font-size:16px}}.acu-add-table-modal{max-width:520px;max-height:85vh}.acu-add-table-modal .acu-modal-body{padding:16px;overflow-y:auto;max-height:calc(85vh - 120px);display:flex;flex-direction:column;gap:16px}.acu-add-table-tabs{display:flex;gap:8px;border-bottom:1px solid var(--acu-border);padding-bottom:8px;margin-bottom:8px}.acu-add-table-paste{display:flex;flex-direction:column;gap:12px}.acu-add-table-paste .acu-textarea-scrollable{min-height:150px;font-family:monospace;font-size:12px}.acu-add-table-file{display:flex;justify-content:center;padding:20px 0}.acu-add-table-file .acu-file-label{display:flex;flex-direction:column;align-items:center;gap:12px;padding:30px;border:2px dashed var(--acu-border);border-radius:12px;cursor:pointer;transition:all .2s ease;width:100%;max-width:300px;background:var(--acu-bg-panel)}.acu-add-table-file .acu-file-label:hover{border-color:var(--acu-title-color);background:var(--acu-btn-hover)}.acu-add-table-file .acu-file-label i{font-size:32px;color:var(--acu-text-sub)}.acu-add-table-file .acu-file-label span{font-size:14px;color:var(--acu-text-main)}.acu-add-table-error{display:flex;align-items:center;gap:8px;padding:10px 12px;background:rgba(231,76,60,.1);border:1px solid rgba(231,76,60,.3);border-radius:8px;font-size:13px;color:#e74c3c;word-break:break-all}.acu-add-table-error i{flex-shrink:0}.acu-add-table-list{display:flex;flex-direction:column;gap:12px;border-top:1px solid var(--acu-border);padding-top:16px}@media (max-width:768px){.acu-add-table-modal{max-width:none;max-height:70vh}.acu-add-table-modal .acu-modal-body{max-height:calc(70vh - 120px)}}.acu-manual-update-modal{max-width:95%;max-height:80vh}@media (min-width:601px){.acu-manual-update-modal{max-width:800px;max-height:85vh}}.acu-manual-update-modal .acu-modal-body{padding:0;overflow-y:auto;max-height:calc(80vh - 60px)}@media (min-width:601px){.acu-manual-update-modal .acu-modal-body{max-height:calc(85vh - 60px);padding:20px}}.acu-manual-update-modal .acu-settings-group{padding:12px 16px}.acu-manual-update-modal .acu-settings-row{padding:8px 0}.acu-loading-state{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;padding:48px 20px;color:var(--acu-text-sub)}.acu-loading-state i{font-size:24px;color:var(--acu-title-color)}.acu-loading-state span{font-size:14px}.acu-config-input{width:80px;padding:8px 12px;font-size:14px;text-align:center;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);transition:all .2s ease}.acu-config-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-config-input:hover:not(:focus){border-color:var(--acu-text-sub)}.acu-config-input::-webkit-inner-spin-button,.acu-config-input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.acu-config-input{-moz-appearance:textfield}.acu-update-action-group{padding:12px 16px 16px;display:flex;flex-direction:column;align-items:center}.acu-update-btn{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;padding:14px 24px;font-size:15px;font-weight:600;color:var(--acu-text-main);background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:12px;cursor:pointer;transition:all .2s ease}.acu-update-btn i{font-size:18px;color:var(--acu-title-color)}.acu-update-btn:hover:not(:disabled){background:var(--acu-btn-hover);transform:translateY(-1px)}.acu-update-btn:active:not(:disabled){transform:translateY(0)}.acu-update-btn:disabled{opacity:.7;cursor:not-allowed}.acu-update-btn.is-updating{opacity:.7}@media (max-width:768px){.acu-manual-update-modal{max-width:none;max-height:70vh}.acu-manual-update-modal .acu-modal-body{max-height:calc(70vh - 60px)}.acu-manual-update-modal .acu-config-input{width:100px}.acu-update-btn{padding:16px 24px;font-size:16px}}.acu-preset-control{display:flex;align-items:center;gap:6px;margin-left:auto}.acu-config-select{min-width:120px;padding:8px 12px;font-size:13px;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);cursor:pointer;transition:all .2s ease}.acu-config-select:focus{outline:none;border-color:var(--acu-title-color)}.acu-config-select:hover:not(:focus){border-color:var(--acu-text-sub)}.acu-tool-btn.acu-btn-danger:hover{background:rgba(231,76,60,.1);border-color:#e74c3c;color:#e74c3c}.acu-issue-alert{display:flex;align-items:center;gap:10px;margin:0 16px 12px;padding:12px 16px;background:rgba(245,108,108,.1);border:1px solid rgba(245,108,108,.3);border-radius:10px;color:#f56c6c;font-size:13px}.acu-issue-alert i{font-size:16px;flex-shrink:0}.acu-issue-alert span{line-height:1.4}.acu-preset-save-modal{max-width:360px}@media (max-width:768px){.acu-preset-save-modal{width:90vw;max-width:340px;margin:auto;border-radius:16px}}.acu-preset-warning{display:flex;align-items:center;gap:8px;margin-top:12px;padding:10px 14px;background:rgba(243,156,18,.1);border:1px solid rgba(243,156,18,.3);border-radius:8px;color:#f39c12;font-size:12px}.acu-preset-warning i{font-size:14px;flex-shrink:0}.acu-preset-summary{margin-top:12px;padding:12px 14px;background:var(--acu-table-head);border-radius:8px;font-size:12px}.acu-preset-summary .acu-preset-summary-title{font-weight:600;color:var(--acu-text-main);margin-bottom:8px}.acu-preset-summary .acu-preset-summary-list{margin:0;padding-left:16px;color:var(--acu-text-sub);line-height:1.6}.acu-preset-summary .acu-preset-summary-list li{margin:2px 0}.acu-history-modal{min-width:800px;max-width:1200px;max-height:90vh}.acu-history-modal .acu-pc-only{display:block}.acu-history-modal .acu-mobile-only{display:none}.acu-history-modal .acu-modal-body{padding:0;overflow:hidden}.acu-history-layout.acu-pc-layout{display:flex;height:calc(90vh - 60px);overflow:hidden}.acu-history-layout.acu-pc-layout .acu-history-sidebar{flex:1;min-width:320px;max-width:480px;overflow-y:auto;border-right:1px solid var(--acu-border);padding:20px 24px;background:var(--acu-table-head)}.acu-history-layout.acu-pc-layout .acu-history-main{flex:1;min-width:320px;display:flex;flex-direction:column;padding:20px 24px;overflow:hidden}.acu-history-list{display:flex;flex-direction:column;gap:8px}.acu-history-item{border:1px solid var(--acu-border);border-radius:8px;background:var(--acu-card-bg);overflow:hidden}.acu-history-item[open] .acu-history-summary{border-bottom:1px solid var(--acu-border)}.acu-history-summary{padding:10px 12px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:13px;font-weight:600;transition:background .2s;list-style:none}.acu-history-summary::-webkit-details-marker{display:none}.acu-history-summary::before{content:"â–¶";font-size:10px;transition:transform .2s}.acu-history-summary:hover{background:var(--acu-table-hover)}details[open]>.acu-history-summary::before{transform:rotate(90deg)}.acu-history-badge{padding:2px 6px;border-radius:4px;font-size:10px;font-weight:bold}.acu-history-badge.manual{background:var(--acu-highlight-manual-bg,rgba(211,84,0,0.15));color:var(--acu-highlight-manual,#d35400)}.acu-history-badge.ai{background:var(--acu-highlight-ai-bg,rgba(52,152,219,0.15));color:var(--acu-highlight-ai,#3498db)}.acu-history-title{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-history-time{font-size:11px;color:var(--acu-text-sub);font-weight:normal;flex-shrink:0}.acu-history-card-wrapper{padding:8px}.acu-history-card-wrapper .acu-data-card{width:100% !important;flex:none !important}.acu-current-card .acu-data-card,.acu-current-scroll .acu-data-card{width:100% !important;flex:none !important}.acu-current-card-label{display:flex;align-items:center;gap:8px;padding:8px 12px;font-size:13px;font-weight:600;color:var(--acu-text-main);background:var(--acu-table-head);border-radius:8px 8px 0 0;border:1px solid var(--acu-border);border-bottom:none}.acu-current-card-label i{color:var(--acu-title-color)}.acu-current-card-label .acu-changes-count{font-weight:normal;color:var(--acu-title-color)}.acu-current-card{flex:1;overflow-y:auto;border:1px solid var(--acu-border);border-top:none;border-radius:0 0 8px 8px;padding:8px;margin-bottom:12px}.acu-history-actions{display:flex;gap:8px;padding-top:12px;border-top:1px solid var(--acu-border);flex-wrap:wrap}.acu-history-actions .acu-btn-start-edit{flex:1}@media (max-width:768px){.acu-modal-container{align-items:flex-end;justify-content:stretch}.acu-modal{width:100%;max-width:none;max-height:85vh;border-radius:20px 20px 0 0;margin:0}.acu-settings-modal{max-width:none;max-height:85vh}.acu-settings-modal .acu-drag-handle{display:none}.acu-settings-modal .acu-modal-header{padding:10px 16px}.modal-enter-from .acu-modal,.modal-leave-to .acu-modal{transform:translateY(100%)}.acu-modal-header{position:relative;padding-top:24px}.acu-drag-handle{position:absolute;top:0;left:50%;transform:translateX(-50%);width:80px;height:20px;cursor:grab;touch-action:none;z-index:10}.acu-drag-handle::after{content:"";position:absolute;top:8px;left:50%;transform:translateX(-50%);width:36px;height:4px;background:var(--acu-border);border-radius:2px;transition:background .2s}.acu-drag-handle:active::after{background:var(--acu-title-color)}.acu-modal-header.dragging .acu-drag-handle::after{background:var(--acu-title-color)}.acu-modal-body{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch}.acu-modal-container.acu-center-modal{align-items:center !important;justify-content:center !important;padding:20px}.acu-modal-container.acu-center-modal .acu-modal{width:90%;max-width:400px;max-height:80vh;border-radius:16px;margin:0}.acu-modal-container.acu-center-modal .acu-modal-header{padding-top:16px}.acu-modal-container.acu-center-modal .acu-modal-header::before{display:none}}.acu-history-layout.acu-mobile-layout{display:none;flex-direction:column;height:calc(100vh - 60px);overflow:hidden}.acu-history-layout.acu-mobile-layout .acu-history-mobile-list{flex:1;min-height:0;overflow-y:auto;padding:12px}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section{flex:1;display:flex;flex-direction:column;min-height:0;border-bottom:1px solid var(--acu-border)}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section .acu-section-label{padding:8px 12px;font-size:12px;font-weight:600;color:var(--acu-text-sub);background:var(--acu-table-head);display:flex;align-items:center;gap:6px;flex-shrink:0}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section .acu-section-label i{color:var(--acu-title-color)}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section .acu-history-scroll{flex:1;overflow-y:auto;padding:8px}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section{flex:1.5;display:flex;flex-direction:column;min-height:0}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-section-label{padding:8px 12px;font-size:12px;font-weight:600;color:var(--acu-text-sub);background:var(--acu-table-head);display:flex;align-items:center;gap:6px;flex-shrink:0}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-section-label i{color:var(--acu-title-color)}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-section-label .acu-changes-count{color:var(--acu-title-color);font-weight:normal}.acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-current-scroll{flex:1;min-height:0;overflow-y:auto;padding:8px}.acu-history-layout.acu-mobile-layout .acu-mobile-actions{flex-shrink:0;padding:10px 12px;padding-bottom:calc(24px + var(--acu-safe-area-bottom,50px));background:var(--acu-bg-panel);border-top:1px solid var(--acu-border);display:flex;flex-wrap:wrap;gap:8px;box-shadow:0 -4px 12px rgba(0,0,0,.15)}.acu-history-layout.acu-mobile-layout .acu-mobile-actions button{flex:1;min-width:80px;min-height:42px;padding:8px 10px;border-radius:8px;border:1px solid var(--acu-border);background:var(--acu-btn-bg);color:var(--acu-text-main);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:4px;white-space:nowrap}.acu-history-layout.acu-mobile-layout .acu-mobile-actions button:disabled{opacity:.5;cursor:not-allowed}.acu-history-layout.acu-mobile-layout .acu-mobile-actions button.acu-btn-primary{background:var(--acu-title-color);color:#fff;border:none}.acu-history-layout.acu-mobile-layout .acu-mobile-actions button.acu-btn-preview{background:var(--acu-table-head)}.acu-history-layout.acu-mobile-layout .acu-mobile-actions button.acu-btn-done{flex-basis:100%;background:var(--acu-title-color);color:#fff;border:none}.acu-history-layout.acu-mobile-layout .acu-mobile-actions button i{font-size:12px}.acu-history-layout.acu-mobile-layout .acu-preview-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.85);z-index:2147483641;display:flex;align-items:center;justify-content:center;padding:20px;pointer-events:none}.acu-history-layout.acu-mobile-layout .acu-preview-overlay :deep(.acu-data-card){width:100%;max-height:80vh;overflow-y:auto;background:var(--acu-bg-panel);border-radius:12px;pointer-events:auto}@media (max-width:768px){.acu-history-modal{min-width:unset;max-width:none;width:100%;max-height:100vh;height:100vh;border-radius:0}.acu-history-modal .acu-pc-only{display:none !important}.acu-history-modal .acu-mobile-only{display:block !important}.acu-history-modal .acu-modal-header{border-radius:0}.acu-history-modal .acu-modal-body{flex:1;overflow:hidden}.acu-history-modal .acu-history-layout.acu-pc-layout{display:none !important}.acu-history-modal .acu-history-layout.acu-mobile-layout{display:flex !important;flex-direction:column !important;height:calc(100vh - 60px) !important}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode{display:flex !important;flex-direction:column !important}.acu-history-modal .acu-history-layout.acu-mobile-layout .acu-history-mobile-list{flex:1;overflow-y:auto;padding:12px;padding-bottom:calc(120px + env(safe-area-inset-bottom,20px))}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode{display:flex !important;flex-direction:column !important}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section{flex:1;display:flex !important;flex-direction:column !important;min-height:0;border-bottom:1px solid var(--acu-border)}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section .acu-section-label{padding:8px 12px;font-size:12px;font-weight:600;color:var(--acu-text-sub);background:var(--acu-table-head);display:flex;align-items:center;gap:6px;flex-shrink:0}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section .acu-section-label i{color:var(--acu-title-color)}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-history-section .acu-history-scroll{flex:1;overflow-y:auto;padding:8px}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section{flex:1.5;display:flex !important;flex-direction:column !important;min-height:0}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-section-label{padding:8px 12px;font-size:12px;font-weight:600;color:var(--acu-text-sub);background:var(--acu-table-head);display:flex;align-items:center;gap:6px;flex-shrink:0}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-section-label i{color:var(--acu-title-color)}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-section-label .acu-changes-count{color:var(--acu-title-color);font-weight:normal}.acu-history-modal .acu-history-layout.acu-mobile-layout.acu-mobile-edit-mode .acu-mobile-current-section .acu-current-scroll{flex:1;min-height:0;overflow-y:auto;padding:8px}}.acu-ball-preview-fixed{position:sticky;top:-20px;margin:-20px -20px 16px;padding:28px 36px 12px 36px;z-index:10;display:flex;justify-content:center;align-items:center;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border)}.acu-reset-btn{position:absolute;top:24px;right:24px}.acu-settings-title-row{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}.acu-settings-title-row .acu-settings-title{margin-bottom:0}.acu-preview-buttons{display:flex;gap:6px;flex-shrink:0}.acu-ball-preview{position:relative;display:flex;justify-content:center;align-items:center;width:var(--ball-size,48px);height:var(--ball-size,48px);border-radius:50%;background:var(--ball-bg-color,rgba(0,0,0,0.5));border:2px solid var(--ball-border-color-rgba,rgba(255,255,255,0.3));box-shadow:0 4px 16px rgba(0,0,0,.3);transition:transform .2s ease}.acu-ball-preview i{font-size:calc(var(--ball-size,48px)*.4);color:#fff}.acu-ball-preview img{width:70%;height:70%;border-radius:50%;object-fit:cover}.acu-anim-grid{display:flex;gap:8px;width:100%}.acu-anim-option{flex:1;display:flex;align-items:center;justify-content:center;gap:8px;padding:10px 12px;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:10px;cursor:pointer;transition:all .2s ease}.acu-anim-option:hover{background:var(--acu-btn-hover);border-color:var(--acu-text-sub)}.acu-anim-option.active{border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-anim-option .acu-anim-icon{font-size:18px;line-height:1}.acu-anim-option .acu-anim-name{font-size:12px;color:var(--acu-text-main)}.acu-color-picker-inline{display:flex;align-items:center;gap:8px}.acu-color-input{width:auto;min-width:75px;max-width:90px;padding:6px 10px;font-size:12px;font-family:monospace;text-transform:uppercase;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main)}.acu-color-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-icon-type-row{display:flex;gap:8px;width:100%}.acu-type-btn{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:10px 8px;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:10px;cursor:pointer;transition:all .2s ease}.acu-type-btn input[type=radio]{display:none}.acu-type-btn:hover{background:var(--acu-btn-hover);border-color:var(--acu-text-sub)}.acu-type-btn.active{border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-type-btn i{font-size:16px;color:var(--acu-text-main)}.acu-type-btn .emoji-icon{font-size:16px;line-height:1}.acu-type-btn>span:last-child{font-size:12px;color:var(--acu-text-main);white-space:nowrap}.acu-image-preview-row{display:flex;align-items:center;gap:12px;margin-top:10px}.acu-preview-thumb{width:48px;height:48px;border-radius:50%;object-fit:cover;border:2px solid var(--acu-border)}.acu-preview-thumb-wrapper{width:48px;height:48px;border-radius:50%;border:2px solid var(--acu-border);background-size:cover;background-position:center;cursor:pointer;position:relative;overflow:hidden;transition:all .2s ease}.acu-preview-thumb-wrapper:hover{border-color:var(--acu-title-color)}.acu-preview-thumb-wrapper:hover .acu-edit-hint{opacity:1}.acu-preview-thumb-wrapper .acu-edit-hint{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.5);color:#fff;font-size:14px;opacity:0;transition:opacity .2s ease}.acu-image-actions{display:flex;gap:8px}.acu-adjust-btn{display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--acu-title-color-bg);border:1px solid var(--acu-title-color);border-radius:6px;color:var(--acu-title-color);font-size:12px;cursor:pointer;transition:all .2s ease}.acu-adjust-btn:hover{background:var(--acu-title-color);color:#fff}.acu-adjust-btn i{font-size:10px}.acu-ball-appearance-panel{padding:0}.acu-preview-buttons{display:flex;gap:8px;margin-top:8px}.acu-anim-icon{font-size:20px;line-height:1}.acu-anim-name{font-size:11px;color:var(--acu-text-sub);margin-top:4px}.acu-theme-section{margin-bottom:24px}.acu-theme-section:last-child{margin-bottom:0}.acu-theme-section-title{display:flex;align-items:center;gap:8px;font-size:14px;font-weight:600;color:var(--acu-text-main);margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(--acu-border)}.acu-theme-section-title i{font-size:14px;color:var(--acu-title-color)}.acu-highlight-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:10px}.acu-var-group{margin-bottom:16px}.acu-var-group:last-child{margin-bottom:0}.acu-var-group-header{display:flex;align-items:center;gap:8px;padding:10px 12px;background:var(--acu-table-head);border:1px solid var(--acu-border);border-radius:8px;cursor:pointer;transition:all .2s ease;-webkit-user-select:none;user-select:none}.acu-var-group-header:hover{background:var(--acu-btn-hover)}.acu-var-group-header .acu-var-group-icon{font-size:12px;color:var(--acu-text-sub);transition:transform .2s ease}.acu-var-group-header.expanded .acu-var-group-icon{transform:rotate(90deg)}.acu-css-editor{width:100%;min-height:150px;max-height:300px;padding:12px;font-family:"Consolas","Monaco",monospace;font-size:12px;line-height:1.5;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);resize:vertical}.acu-css-editor:focus{outline:none;border-color:var(--acu-title-color)}.acu-css-editor::placeholder{color:var(--acu-text-sub);opacity:.6}.acu-css-hint{margin-top:8px;padding:10px 12px;background:var(--acu-title-color-bg);border-radius:6px;font-size:11px;color:var(--acu-text-sub);line-height:1.5}.acu-css-hint p{margin:0 0 6px 0;font-weight:500;color:var(--acu-text-main)}.acu-css-hint code{display:inline-block;background:var(--acu-btn-bg);border:1px solid var(--acu-border);padding:3px 8px;border-radius:4px;font-size:11px;font-family:"Consolas","Monaco",monospace;color:var(--acu-title-color);margin:2px 4px 2px 0}.acu-theme-actions{display:flex;gap:10px;margin-top:16px;padding-top:16px;border-top:1px solid var(--acu-border)}.acu-theme-btn{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:10px 12px;font-size:12px;border-radius:8px;cursor:pointer;transition:all .2s ease}.acu-theme-btn i{font-size:11px}.acu-theme-btn.btn-primary{background:var(--acu-title-color);border:1px solid var(--acu-title-color);color:#fff}.acu-theme-btn.btn-primary:hover{filter:brightness(1.1)}.acu-theme-btn.btn-secondary{background:rgba(0,0,0,0);border:1px solid var(--acu-border);color:var(--acu-text-main)}.acu-theme-btn.btn-secondary:hover{background:var(--acu-btn-hover);border-color:var(--acu-text-sub)}.acu-theme-btn.btn-danger{background:rgba(0,0,0,0);border:1px solid var(--acu-border);color:var(--acu-text-sub)}.acu-theme-btn.btn-danger:hover{background:rgba(231,76,60,.1);border-color:#e74c3c;color:#e74c3c}.acu-var-groups-container{border:1px solid var(--acu-border);border-radius:8px;overflow:hidden}.acu-var-group{margin-bottom:0;border-bottom:1px solid var(--acu-border)}.acu-var-group:last-child,.acu-var-group.last{border-bottom:none}.acu-var-group.first .acu-var-group-header{border-radius:7px 7px 0 0}.acu-var-group.last .acu-var-group-header{border-radius:0 0 7px 7px}.acu-var-group .acu-var-group-header{border-radius:0;border:none;background:var(--acu-btn-bg)}.acu-var-group .acu-var-group-header:hover{background:var(--acu-btn-hover)}.acu-var-group-body{padding:8px 12px;background:var(--acu-table-head)}.acu-var-row{display:flex;align-items:center;gap:10px;padding:10px 0}.acu-var-row:not(:last-child){border-bottom:1px solid var(--acu-border)}.acu-var-row .acu-var-label{flex:1;font-size:13px;font-weight:600;color:var(--acu-text-main);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-var-row .acu-var-control{display:flex;align-items:center;gap:6px}.acu-var-row-tall{flex-direction:column;align-items:stretch;padding:10px 12px;gap:8px}.acu-var-line-primary{display:flex;align-items:center;justify-content:space-between;gap:10px}.acu-var-line-primary .acu-var-label{font-size:13px;font-weight:600;color:var(--acu-text-main);flex-shrink:0}.acu-var-line-secondary{display:flex;align-items:center;justify-content:space-between;gap:10px}.acu-var-name{font-size:10px;font-family:"Consolas","Monaco",monospace;color:var(--acu-text-sub);background:var(--acu-table-head);padding:2px 6px;border-radius:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:-moz-fit-content;max-width:fit-content}.acu-var-color-row{display:flex;align-items:center;gap:6px;flex:1;justify-content:flex-end;min-width:0}.acu-var-color-row .acu-color-input{width:90px;padding:4px 8px;background:var(--acu-input-bg);border:1px solid var(--acu-border);border-radius:4px;color:var(--acu-text-main);font-size:12px;text-align:center;font-family:"Consolas",monospace}.acu-var-color-row .acu-color-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-var-opacity-row{display:flex;align-items:center;gap:8px}.acu-var-opacity-row .acu-range-input{-webkit-appearance:none;appearance:none;width:80px;height:6px;background:var(--acu-border);border-radius:3px;outline:none;cursor:pointer}.acu-var-opacity-row .acu-range-input::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;background:var(--acu-title-color);border-radius:50%;cursor:pointer;-webkit-transition:transform .2s;transition:transform .2s;filter:none !important}.acu-var-opacity-row .acu-range-input::-webkit-slider-thumb:hover{transform:scale(1.2)}.acu-var-opacity-row .acu-range-input::-moz-range-thumb{width:16px;height:16px;background:var(--acu-title-color);border-radius:50%;border:none;cursor:pointer;filter:none !important}.acu-var-opacity-row .acu-range-input::-moz-range-track{height:6px;background:var(--acu-border);border-radius:3px}.acu-opacity-value{min-width:28px;font-size:11px;color:var(--acu-text-sub);text-align:right}.acu-var-count{font-size:11px;color:var(--acu-text-sub);padding:2px 8px;background:var(--acu-btn-bg);border-radius:10px;margin-left:auto;margin-right:8px}.acu-var-reset{width:26px;height:26px;display:flex;align-items:center;justify-content:center;background:var(--acu-table-head);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-sub);cursor:pointer;transition:all .15s ease}.acu-var-reset:hover{background:var(--acu-title-color-bg);border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-var-reset i{font-size:10px}.acu-preset-save{display:flex;gap:10px;margin-top:12px}.acu-input{flex:1;padding:10px 12px;font-size:13px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);transition:border-color .2s ease}.acu-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-input::placeholder{color:var(--acu-text-sub);opacity:.7}.acu-btn{display:flex;align-items:center;justify-content:center;gap:6px;padding:10px 16px;font-size:13px;border-radius:8px;cursor:pointer;transition:all .2s ease;white-space:nowrap}.acu-btn i{font-size:12px}.acu-btn.acu-btn-primary{background:var(--acu-title-color);border:1px solid var(--acu-title-color);color:#fff}.acu-btn.acu-btn-primary:hover{filter:brightness(1.1)}.acu-btn.acu-btn-primary:disabled{opacity:.5;cursor:not-allowed}.acu-css-actions{display:flex;gap:8px;margin-bottom:10px}.acu-btn-danger:hover{background:rgba(231,76,60,.1) !important;border-color:#e74c3c !important;color:#e74c3c !important}@media (max-width:768px){.acu-highlight-grid{grid-template-columns:repeat(2,1fr)}.acu-var-row{flex-wrap:wrap}.acu-var-row .acu-var-label{width:100%;flex:none;margin-bottom:6px}.acu-var-row .acu-var-control{flex:1}.acu-var-row-tall{flex-direction:column;align-items:stretch;gap:8px}.acu-var-color-row,.acu-var-opacity-row{justify-content:flex-end}.acu-opacity-slider{flex:1;min-width:60px}.acu-preset-save{flex-direction:column}.acu-preset-save .acu-btn{width:100%}}.acu-color-input{flex:1;padding:8px 12px;font-size:13px;font-family:monospace;text-transform:uppercase;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main)}.acu-color-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-icon-option{display:flex;flex-direction:column;align-items:center;gap:6px;padding:14px 8px;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:10px;cursor:pointer;transition:all .2s ease}.acu-icon-option input[type=radio]{display:none}.acu-icon-option:hover{background:var(--acu-btn-hover);border-color:var(--acu-text-sub)}.acu-icon-option.active{border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-icon-option i{font-size:22px;color:var(--acu-text-main)}.acu-icon-option .emoji-icon{font-size:22px;line-height:1}.acu-icon-option>span:last-child{font-size:11px;color:var(--acu-text-sub)}.acu-icon-input-area{margin-top:12px}.acu-icon-input input,.acu-emoji-input input{width:100%;padding:10px 14px;font-size:14px;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);transition:border-color .2s ease}.acu-icon-input input:focus,.acu-emoji-input input:focus{outline:none;border-color:var(--acu-title-color)}.acu-icon-input input::placeholder,.acu-emoji-input input::placeholder{color:var(--acu-text-sub);opacity:.6}.acu-emoji-input input{font-size:18px;text-align:center}.acu-input-hint{display:block;margin-top:6px;font-size:11px;color:var(--acu-text-sub);opacity:.7}.acu-image-preview{position:relative;display:inline-flex;align-items:center;justify-content:center;width:60px;height:60px;border-radius:50%;border:2px solid var(--acu-border);overflow:hidden;background:var(--acu-table-head)}.acu-image-preview img{width:100%;height:100%;object-fit:cover}@media (max-width:768px){.acu-anim-grid{grid-template-columns:repeat(2,1fr);gap:6px}.acu-anim-option,.acu-icon-option{padding:10px 6px}.acu-anim-option i,.acu-icon-option i{font-size:16px}.acu-anim-option span,.acu-icon-option span{font-size:10px}.acu-preview-buttons{flex-wrap:wrap;justify-content:center}}.acu-font-control{display:flex;align-items:center;gap:6px}.acu-font-control select{text-align:center;text-align-last:center}.acu-font-dialog-overlay{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw !important;height:100vh !important;z-index:2147483647;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);padding:20px;box-sizing:border-box}@media (max-width:768px){.acu-font-dialog-overlay{padding:16px}.acu-font-dialog-overlay .acu-mini-dialog{width:100%;max-width:340px;max-height:calc(100vh - 100px);overflow-y:auto}}.acu-add-font-btn{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-sub);cursor:pointer;transition:all .2s ease;flex-shrink:0}.acu-add-font-btn:hover{background:var(--acu-title-color-bg);border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-add-font-btn i{font-size:12px}.acu-add-font-dialog{max-width:380px}.acu-font-form{display:flex;flex-direction:column;gap:14px}.acu-form-row{display:flex;flex-direction:column;gap:6px}.acu-form-row label{font-size:13px;font-weight:500;color:var(--acu-text-main)}.acu-form-row label .optional{font-weight:normal;font-size:11px;color:var(--acu-text-sub);opacity:.7}.acu-form-row input{width:100%;padding:10px 12px;font-size:13px;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);transition:border-color .2s ease}.acu-form-row input:focus{outline:none;border-color:var(--acu-title-color)}.acu-form-row input::placeholder{color:var(--acu-text-sub);opacity:.6}.acu-tag-toolbar{display:flex;align-items:center;gap:8px;padding:8px;margin-bottom:8px;background:var(--acu-input-bg);border-radius:6px}.acu-displayed-tag{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;background:var(--acu-title-color-bg);border:1px solid var(--acu-title-color);border-radius:4px;font-size:12px}.acu-wildcard-shortcuts{display:flex;align-items:center;gap:8px;margin-bottom:12px;flex-wrap:wrap}.acu-wildcard-shortcuts .hint{font-size:11px;color:var(--acu-text-sub)}.acu-wildcard-btn{padding:4px 8px;background:var(--acu-badge-bg);border:1px solid var(--acu-border);border-radius:4px;font-family:monospace;font-size:11px;cursor:pointer;transition:all .2s}.acu-wildcard-btn:hover{background:var(--acu-btn-hover)}.acu-mini-dialog{background:var(--acu-bg-panel);border-radius:12px;padding:16px;min-width:280px;max-width:400px;box-shadow:0 8px 32px rgba(0,0,0,.3)}.acu-mini-dialog-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--acu-border)}.acu-mini-dialog-header span{font-size:15px;font-weight:600;color:var(--acu-text-main)}.acu-mini-dialog-body{margin-bottom:16px}.acu-mini-dialog-footer{display:flex;align-items:center;justify-content:flex-end;gap:10px;padding-top:12px;border-top:1px solid var(--acu-border)}.acu-input-hint{display:block;margin-top:4px;font-size:10px;color:var(--acu-text-sub);opacity:.8}.acu-cell-menu{position:fixed;z-index:2147483647;min-width:160px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,.25);padding:6px;animation:acu-scaleIn .15s ease;transform-origin:top left}.acu-menu-item{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;font-size:13px;color:var(--acu-text-main);cursor:pointer;transition:all .15s ease;white-space:nowrap}.acu-menu-item i{width:16px;text-align:center;font-size:14px;color:var(--acu-text-sub);transition:color .15s ease}.acu-menu-item:hover{background:var(--acu-btn-hover)}.acu-menu-item:hover i{color:var(--acu-title-color)}.acu-menu-item:active{transform:scale(0.98)}.acu-menu-item.danger{color:#e74c3c}.acu-menu-item.danger i{color:#e74c3c}.acu-menu-item.danger:hover{background:rgba(231,76,60,.15)}.acu-menu-item.success{color:#27ae60}.acu-menu-item.success i{color:#27ae60}.acu-menu-item.success:hover{background:rgba(46,204,113,.15)}.acu-menu-item.disabled{opacity:.5;cursor:not-allowed;pointer-events:none}.acu-menu-divider{height:1px;background:var(--acu-border);margin:6px 8px}.acu-cell-menu.compact{padding:4px}.acu-cell-menu.compact .acu-menu-item{padding:8px 12px;font-size:12px}.acu-cell-menu.compact .acu-menu-item i{font-size:12px}.acu-context-menu{position:fixed;z-index:var(--acu-z-menu,2147483648);min-width:160px;max-width:220px;background:var(--acu-menu-bg,#fff);border:1px solid var(--acu-border,#dcd0c0);border-radius:var(--acu-radius-md,12px);box-shadow:0 4px 16px rgba(0,0,0,.15),0 0 1px rgba(0,0,0,.1);padding:6px 0;outline:none;overflow:hidden;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);pointer-events:auto !important}.acu-context-menu .acu-menu-item{display:flex;align-items:center;gap:12px;padding:10px 16px;cursor:pointer;color:var(--acu-menu-text,#333);font-size:var(--acu-font-size,13px);transition:background var(--acu-transition-fast,0.15s),color var(--acu-transition-fast,0.15s);-webkit-user-select:none;user-select:none}.acu-context-menu .acu-menu-item i{width:16px;text-align:center;color:var(--acu-text-sub,#999);font-size:14px;transition:color var(--acu-transition-fast,0.15s)}.acu-context-menu .acu-menu-item span{flex:1}.acu-context-menu .acu-menu-item:hover{background:var(--acu-table-hover,#f0ebe0)}.acu-context-menu .acu-menu-item:active{background:var(--acu-btn-hover,#cbbba8)}.acu-context-menu .acu-menu-item.acu-menu-danger{color:var(--acu-danger,#e74c3c)}.acu-context-menu .acu-menu-item.acu-menu-danger i{color:var(--acu-danger,#e74c3c)}.acu-context-menu .acu-menu-item.acu-menu-danger:hover{background:rgba(231,76,60,.1)}.acu-context-menu .acu-menu-item.acu-menu-warning{color:var(--acu-warning,#f39c12)}.acu-context-menu .acu-menu-item.acu-menu-warning i{color:var(--acu-warning,#f39c12)}.acu-context-menu .acu-menu-item.acu-menu-warning:hover{background:rgba(243,156,18,.1)}.acu-context-menu .acu-menu-divider{height:1px;background:var(--acu-border,#dcd0c0);margin:6px 12px;opacity:.6}.acu-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:2147483640;background:rgba(0,0,0,.4);animation:acu-fadeIn .15s ease}.acu-overlay.transparent{background:rgba(0,0,0,0)}.acu-overlay.blur{backdrop-filter:blur(4px)}.acu-hidden-buttons-popup{position:absolute;bottom:calc(100% + 8px);left:0;right:0;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:8px;padding:8px;box-shadow:0 -4px 16px rgba(0,0,0,.3);z-index:100;pointer-events:auto}.acu-hidden-buttons-popup .popup-buttons-grid{display:flex;flex-wrap:wrap;gap:6px;justify-content:center}.acu-hidden-buttons-popup .popup-button{display:flex;align-items:center;justify-content:center;width:36px;height:36px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);cursor:pointer;transition:all .2s ease}.acu-hidden-buttons-popup .popup-button:hover{background:var(--acu-btn-hover);border-color:var(--acu-title-color)}.acu-hidden-buttons-popup .popup-button.btn-danger{color:#e74c3c}.acu-tabs-popup{position:absolute;bottom:calc(100% + 8px);left:0;right:0;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:12px;padding:12px;box-shadow:0 -8px 24px rgba(0,0,0,.35);z-index:100;pointer-events:auto;max-height:60vh;overflow-y:auto}.acu-tabs-popup .popup-tabs-grid{display:grid;grid-template-columns:var(--acu-nav-cols,repeat(auto-fill,minmax(90px,1fr)));gap:6px}.acu-tabs-popup .popup-tabs-grid .acu-nav-btn{display:flex;align-items:center;justify-content:center;gap:6px;padding:8px 12px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);font-size:12px;cursor:pointer;transition:all .2s ease;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-tabs-popup .popup-tabs-grid .acu-nav-btn i{font-size:14px;flex-shrink:0}.acu-tabs-popup .popup-tabs-grid .acu-nav-btn span{overflow:hidden;text-overflow:ellipsis}.acu-tabs-popup .popup-tabs-grid .acu-nav-btn:hover{background:var(--acu-btn-hover);border-color:var(--acu-title-color)}.acu-tabs-popup .popup-tabs-grid .acu-nav-btn.active{background:var(--acu-title-color-bg);border-color:var(--acu-title-color);color:var(--acu-title-color);font-weight:500}.acu-tabs-popup .popup-tabs-grid .acu-nav-btn.has-issues{border-color:#e74c3c;box-shadow:0 0 0 2px rgba(231,76,60,.2)}.acu-tabs-popup .popup-tabs-grid .acu-nav-btn.has-ai-changes{border-color:var(--acu-highlight-ai-color,#3498db);box-shadow:0 0 0 2px rgba(52,152,219,.2)}.acu-hidden-buttons-popup{position:absolute;bottom:calc(100% + 8px);left:0;right:0;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:8px;padding:8px;box-shadow:0 -4px 16px rgba(0,0,0,.3);z-index:100;pointer-events:auto}.acu-hidden-buttons-popup .popup-buttons-grid{display:flex;flex-wrap:wrap;gap:6px;justify-content:center}.acu-hidden-buttons-popup .popup-button{display:flex;align-items:center;justify-content:center;width:36px;height:36px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);cursor:pointer;transition:all .2s}.acu-hidden-buttons-popup .popup-button:hover{background:var(--acu-btn-hover);border-color:var(--acu-title-color);color:var(--acu-title-color);transform:translateY(-2px)}.acu-hidden-buttons-popup .popup-button:active{transform:scale(0.95)}.acu-hidden-buttons-popup .popup-button i{font-size:14px}.acu-hidden-buttons-popup .popup-button.btn-danger{color:#e74c3c}.acu-hidden-buttons-popup .popup-button.btn-danger:hover{border-color:#e74c3c;background:rgba(231,76,60,.1)}.acu-hidden-buttons-popup .popup-button.btn-toggle.active{background:var(--acu-title-color-bg,rgba(52,152,219,0.2));color:var(--acu-title-color,#3498db);border-color:var(--acu-title-color,#3498db)}.acu-more-btn.active{color:var(--acu-title-color);background:var(--acu-btn-hover)}.acu-more-btn.active i{transform:rotate(180deg)}.acu-more-btn i{transition:transform .2s ease}.acu-avatar-manager-dialog{width:90%;max-width:800px;max-height:85vh;display:flex;flex-direction:column}.acu-avatar-manager-dialog .acu-modal-body{flex:1;overflow-y:auto;padding:0;padding-bottom:var(--acu-safe-area-bottom,20px)}.acu-avatar-tab-bar{display:flex;gap:0;padding:0 12px;background:var(--acu-bg-panel);border-bottom:1px solid var(--acu-border)}.acu-avatar-tab-btn{display:flex;align-items:center;gap:6px;padding:12px 16px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);font-size:13px;font-weight:500;cursor:pointer;position:relative;transition:all .2s ease}.acu-avatar-tab-btn i{font-size:14px}.acu-avatar-tab-btn:hover{color:var(--acu-text-main);background:var(--acu-btn-hover)}.acu-avatar-tab-btn.active{color:var(--acu-title-color);font-weight:600}.acu-avatar-tab-btn.active::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:60%;height:3px;background:var(--acu-title-color);border-radius:3px 3px 0 0}.acu-avatar-search-bar{display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--acu-bg-panel);border-bottom:1px solid var(--acu-border)}.acu-avatar-search-bar>i{color:var(--acu-text-sub);font-size:14px}.acu-avatar-search-input{flex:1;padding:8px 12px;font-size:13px;background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main)}.acu-avatar-search-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-avatar-search-input::placeholder{color:var(--acu-text-sub);opacity:.6}.acu-search-clear{background:none;border:none;padding:4px 8px;color:var(--acu-text-sub);cursor:pointer;font-size:12px}.acu-search-clear:hover{color:var(--acu-title-color)}.acu-avatar-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;gap:12px;color:var(--acu-text-sub)}.acu-avatar-loading i{font-size:24px}.acu-avatar-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;gap:12px;color:var(--acu-text-sub)}.acu-avatar-empty i{font-size:32px;opacity:.5}.acu-avatar-empty p{margin:0}.acu-avatar-items{padding:8px}.acu-avatar-item{display:flex;align-items:flex-start;gap:12px;padding:12px;margin-bottom:8px;background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:12px;position:relative;transition:all .2s ease}.acu-avatar-item:last-child{margin-bottom:0}.acu-avatar-item:hover{background:var(--acu-table-hover)}.acu-avatar-item.selected{border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-avatar-checkbox{display:flex;align-items:center;justify-content:center;width:24px;height:48px;cursor:pointer;color:var(--acu-text-sub)}.acu-avatar-checkbox:hover{color:var(--acu-title-color)}.acu-avatar-checkbox i{font-size:18px}.acu-avatar-column{display:flex;flex-direction:column;align-items:center;gap:4px;flex-shrink:0}.acu-avatar-preview{width:48px;height:48px;min-width:48px;border-radius:50%;background:var(--acu-btn-bg);border:2px solid var(--acu-border);display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;overflow:hidden;background-size:cover;background-position:center;background-repeat:no-repeat;transition:all .2s ease}.acu-avatar-preview:hover{border-color:var(--acu-title-color);transform:scale(1.05)}.acu-avatar-preview.has-image{border-color:var(--acu-title-color)}.acu-avatar-initial{font-size:18px;font-weight:bold;color:var(--acu-text-sub)}.acu-avatar-camera-hint{position:absolute;bottom:2px;right:2px;font-size:10px;color:var(--acu-text-sub);opacity:0;transition:opacity .2s}.acu-avatar-preview:hover .acu-avatar-camera-hint{opacity:.8}.acu-avatar-source{font-size:9px;padding:1px 4px;border-radius:3px;font-weight:500;white-space:nowrap}.acu-avatar-source.acu-source-local{background:var(--acu-title-color-bg);color:var(--acu-title-color)}.acu-avatar-source.acu-source-url{background:var(--acu-btn-bg);color:var(--acu-text-sub)}.acu-avatar-source.acu-source-auto{background:var(--acu-title-color-bg);color:var(--acu-title-color)}.acu-avatar-info{flex:1;min-width:0;display:flex;flex-direction:column;gap:8px}.acu-avatar-name-row{display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}.acu-avatar-name-left{display:flex;align-items:center;gap:4px;flex:1;min-width:0}.acu-avatar-name{font-size:14px;font-weight:600;color:var(--acu-text-main);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-avatar-label-preview{font-size:12px;color:var(--acu-text-sub);flex-shrink:0}.acu-avatar-name-right{display:flex;align-items:center;gap:6px;flex-shrink:0}.acu-avatar-name-btn{padding:4px 10px;font-size:12px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);cursor:pointer;transition:all .15s}.acu-avatar-name-btn:hover{background:var(--acu-btn-hover);border-color:var(--acu-title-color)}.acu-import-dropdown{position:relative}.acu-avatar-import-btn{padding:4px 10px;font-size:12px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);cursor:pointer;display:flex;align-items:center;gap:4px;transition:all .15s}.acu-avatar-import-btn:hover{background:var(--acu-btn-hover);border-color:var(--acu-title-color)}.acu-avatar-import-btn i{font-size:10px}.acu-dropdown-menu{position:absolute;top:100%;right:0;margin-top:4px;background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:10;min-width:120px;overflow:hidden}.acu-dropdown-item{padding:10px 14px;font-size:13px;color:var(--acu-text-main);cursor:pointer;display:flex;align-items:center;gap:8px;transition:background .15s}.acu-dropdown-item:hover{background:var(--acu-table-hover)}.acu-dropdown-item.disabled{opacity:.5;cursor:not-allowed}.acu-dropdown-item.disabled:hover{background:rgba(0,0,0,0)}.acu-dropdown-item i{width:16px;text-align:center;color:var(--acu-text-sub)}.acu-avatar-url-row{display:flex;align-items:center;gap:8px}.acu-url-label{font-size:12px;color:var(--acu-text-sub);white-space:nowrap;min-width:35px}.acu-avatar-url-input{flex:1;padding:6px 10px;font-size:12px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);min-width:0}.acu-avatar-url-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-avatar-url-input::placeholder{color:var(--acu-text-sub);opacity:.6}.acu-avatar-alias-row{display:flex;align-items:center;gap:8px}.acu-alias-label{font-size:12px;color:var(--acu-text-sub);white-space:nowrap;min-width:35px}.acu-avatar-alias-input{flex:1;padding:6px 10px;font-size:12px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);min-width:0}.acu-avatar-alias-input:focus{outline:none;border-color:var(--acu-title-color)}.acu-avatar-alias-input::placeholder{color:var(--acu-text-sub);opacity:.6}.acu-avatar-footer{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-top:1px solid var(--acu-border);background:var(--acu-bg-panel);gap:12px}.acu-footer-left,.acu-footer-right{display:flex;gap:8px}.acu-crop-dialog{width:90%;max-width:400px}.acu-crop-body{display:flex;flex-direction:column;gap:20px;padding:20px !important}.acu-crop-preview-wrapper{display:flex;justify-content:center}.acu-crop-preview{width:120px;height:120px;border-radius:50%;background:var(--acu-btn-bg);border:3px solid var(--acu-border);background-size:cover;background-position:center;background-repeat:no-repeat;display:flex;align-items:center;justify-content:center;position:relative;-webkit-user-select:none;user-select:none;touch-action:none}.acu-crop-preview.is-dragging{border-color:var(--acu-title-color)}.acu-crop-preview:hover:not(.is-dragging){border-color:var(--acu-title-color)}.acu-crop-placeholder{display:flex;flex-direction:column;align-items:center;gap:8px;color:var(--acu-text-sub)}.acu-crop-placeholder i{font-size:32px;opacity:.5}.acu-crop-placeholder span{font-size:12px}.acu-crop-controls{display:flex;flex-direction:column;gap:16px}.acu-crop-control-row{display:flex;align-items:center;gap:12px}.acu-crop-label{width:70px;font-size:13px;color:var(--acu-text-main);display:flex;align-items:center;gap:6px}.acu-crop-label i{width:16px;text-align:center;color:var(--acu-text-sub)}.acu-crop-slider{flex:1;height:6px;-webkit-appearance:none;background:var(--acu-border);border-radius:3px;outline:none}.acu-crop-slider::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--acu-title-color);cursor:pointer;border:2px solid var(--acu-card-bg);box-shadow:0 2px 4px rgba(0,0,0,.2)}.acu-crop-slider::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--acu-title-color);cursor:pointer;border:2px solid var(--acu-card-bg);box-shadow:0 2px 4px rgba(0,0,0,.2)}.acu-crop-value{width:45px;text-align:right;font-size:12px !important;color:var(--acu-text-sub) !important;font-family:monospace !important;background:rgba(0,0,0,0) !important;border:none !important;padding:0 !important;margin:0 !important}.acu-crop-invert-section{padding:12px 0;border-top:1px solid var(--acu-border)}.acu-crop-invert-section .acu-settings-row{padding:0;border:none}.acu-crop-upload-section{display:flex;justify-content:center;padding-top:8px;border-top:1px solid var(--acu-border)}.acu-modal-footer{display:flex;justify-content:flex-end;gap:8px;padding:12px 16px;border-top:1px solid var(--acu-border)}@media (max-width:768px){.acu-avatar-manager-overlay.acu-modal-container{align-items:center;justify-content:center;padding:16px}.acu-avatar-manager-dialog{width:95%;max-height:70vh;margin:0}.acu-avatar-item{flex-wrap:wrap}.acu-avatar-name-row{flex-wrap:wrap}.acu-avatar-url-row{flex-wrap:wrap}.acu-crop-modal-overlay.acu-modal-container{align-items:center;justify-content:center;padding:16px}.acu-crop-dialog{width:95%;max-height:80vh;margin:0;display:flex;flex-direction:column}.acu-crop-body{flex:1;overflow-y:auto;padding:10px !important;gap:10px}.acu-crop-preview{width:90px;height:90px}.acu-crop-controls{gap:10px}.acu-crop-control-row{gap:8px}.acu-crop-label{width:55px;font-size:12px}.acu-crop-upload-section{padding-top:8px}}@media (max-width:768px){.acu-modal-container:has(.acu-actions-config-modal){align-items:flex-start !important;justify-content:center !important;padding-top:10vh;padding-left:16px;padding-right:16px}.acu-actions-config-modal{width:95%;max-width:400px;max-height:55vh;border-radius:16px;margin:0;display:flex;flex-direction:column}.acu-actions-config-modal .acu-modal-body{flex:1;max-height:calc(55vh - 100px);overflow-y:auto}.acu-actions-config-modal .acu-drag-handle{display:none}.acu-actions-config-modal .acu-modal-header{padding-top:16px}}.acu-tag-manager-modal{width:90vw;max-width:1400px;height:85vh;max-height:900px;display:flex;flex-direction:column}@media (max-width:768px){.acu-tag-manager-modal{width:100vw;height:100vh;max-width:none;max-height:none;border-radius:0}}.acu-tag-manager-modal .acu-modal-body{flex:1;display:flex;flex-direction:column;min-height:0;padding:0}.acu-tag-manager-body{display:flex;flex-direction:column;flex:1;min-height:0}.acu-displayed-area{display:flex;flex-wrap:wrap;align-items:center;gap:8px;padding:12px 16px;border-bottom:1px solid var(--acu-border);min-height:50px;background:var(--acu-table-head)}.acu-displayed-area .acu-displayed-label{font-weight:500;color:var(--acu-text-sub);font-size:13px;margin-right:4px}.acu-displayed-area .acu-displayed-tag{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:16px;background:var(--acu-badge-bg);font-size:12px;cursor:pointer;transition:all .2s}.acu-displayed-area .acu-displayed-tag:hover{background:var(--acu-btn-hover)}.acu-displayed-area .acu-displayed-tag:hover .acu-remove-icon{opacity:1}.acu-displayed-area .acu-displayed-tag .acu-tag-icon{font-size:14px}.acu-displayed-area .acu-displayed-tag .acu-remove-icon{font-size:10px;opacity:.5;transition:opacity .2s}.acu-displayed-area .acu-empty-hint{color:var(--acu-text-sub);font-size:12px;font-style:italic}.acu-tag-search{display:flex;align-items:center;gap:8px;padding:8px 16px;border-bottom:1px solid var(--acu-border);background:var(--acu-card-bg)}.acu-tag-search i{color:var(--acu-text-sub)}.acu-tag-search input{flex:1;border:none;background:rgba(0,0,0,0);outline:none;font-size:13px;color:var(--acu-text-main)}.acu-tag-search input::placeholder{color:var(--acu-text-sub)}.acu-tag-search .acu-clear-search{padding:4px;border:none;background:rgba(0,0,0,0);cursor:pointer;color:var(--acu-text-sub);transition:color .2s}.acu-tag-search .acu-clear-search:hover{color:var(--acu-text-main)}.acu-tag-toolbar{display:flex;align-items:center;gap:6px;padding:8px 16px;border-bottom:1px solid var(--acu-border);flex-wrap:wrap;background:var(--acu-bg-panel)}.acu-tag-toolbar .acu-mode-btn{display:inline-flex;align-items:center;gap:4px;padding:6px 12px;border-radius:6px;border:1px solid var(--acu-border);background:var(--acu-btn-bg);cursor:pointer;font-size:12px;color:var(--acu-text-main);transition:all .2s}.acu-tag-toolbar .acu-mode-btn:hover:not(:disabled){background:var(--acu-btn-hover)}.acu-tag-toolbar .acu-mode-btn:disabled{opacity:.5;cursor:not-allowed}.acu-tag-toolbar .acu-mode-btn.active{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color)}.acu-tag-toolbar .acu-mode-btn i{font-size:12px}@media (max-width:768px){.acu-tag-toolbar .acu-mode-btn .btn-label{display:none}}.acu-tag-manager{display:flex;flex:1;min-height:0;gap:0}.acu-tag-tree{width:240px;min-width:200px;overflow-y:auto;border-right:1px solid var(--acu-border);background:var(--acu-card-bg)}@media (max-width:768px){.acu-tag-tree{width:140px;min-width:120px}}.acu-tag-tree .acu-root-icon-editor{display:flex;align-items:center;gap:4px;padding:4px 8px;background:var(--acu-card-bg);border-bottom:1px solid var(--acu-border)}.acu-tag-tree .acu-root-icon-editor .acu-icon-input{width:40px;text-align:center;font-size:16px;padding:4px;border:1px solid var(--acu-border);border-radius:4px;background:var(--acu-bg-panel);color:var(--acu-text-main)}.acu-tag-tree .acu-root-icon-editor .acu-btn-small{padding:4px 8px;border:none;border-radius:4px;background:var(--acu-btn-bg);color:var(--acu-text-main);cursor:pointer}.acu-tag-tree .acu-root-icon-editor .acu-btn-small:hover{background:var(--acu-btn-hover)}.acu-tag-tree .acu-root-item{font-weight:500}.acu-tag-tree .acu-root-item .acu-edit-icon-btn{opacity:0;padding:2px 6px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);cursor:pointer;transition:opacity .2s}.acu-tag-tree .acu-root-item .acu-edit-icon-btn:hover{color:var(--acu-title-color)}.acu-tag-tree .acu-root-item:hover .acu-edit-icon-btn{opacity:1}.acu-tag-tree .acu-tag-tree-item{display:flex;align-items:center;gap:6px;padding:10px 12px;cursor:pointer;transition:background .2s;border-left:3px solid rgba(0,0,0,0)}.acu-tag-tree .acu-tag-tree-item:hover{background:var(--acu-table-hover)}.acu-tag-tree .acu-tag-tree-item.active{background:var(--acu-title-color-bg);border-left-color:var(--acu-title-color)}.acu-tag-tree .acu-tag-tree-item.selected{outline:2px solid var(--acu-title-color);outline-offset:-2px}.acu-tag-tree .acu-tag-tree-item.sticky{position:sticky;top:0;z-index:1;background:var(--acu-bg-panel);border-bottom:1px solid var(--acu-border)}.acu-tag-tree .acu-tag-tree-item .acu-tree-toggle{width:16px;text-align:center;font-size:10px;color:var(--acu-text-sub);cursor:pointer;transition:transform .2s}.acu-tag-tree .acu-tag-tree-item .acu-tree-toggle-placeholder{width:0px}.acu-tag-tree .acu-tag-tree-item .acu-tree-icon{font-size:14px}.acu-tag-tree .acu-tag-tree-item .acu-tree-label{flex:1;font-size:13px;color:var(--acu-text-main);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-tag-tree .acu-tag-tree-item .acu-tree-count{font-size:11px;color:var(--acu-text-sub)}.acu-tag-tree .acu-tag-tree-item .acu-add-btn,.acu-tag-tree .acu-tag-tree-item .acu-select-btn,.acu-tag-tree .acu-tag-tree-item .acu-migrate-btn,.acu-tag-tree .acu-tag-tree-item .acu-delete-btn{padding:4px 2px;border-radius:4px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);cursor:pointer;opacity:.7;transition:all .2s;font-size:11px}.acu-tag-tree .acu-tag-tree-item .acu-add-btn:hover,.acu-tag-tree .acu-tag-tree-item .acu-select-btn:hover,.acu-tag-tree .acu-tag-tree-item .acu-migrate-btn:hover,.acu-tag-tree .acu-tag-tree-item .acu-delete-btn:hover{opacity:1;background:var(--acu-btn-hover)}.acu-tag-tree .acu-tag-tree-item .acu-add-btn.active,.acu-tag-tree .acu-tag-tree-item .acu-select-btn.active,.acu-tag-tree .acu-tag-tree-item .acu-migrate-btn.active,.acu-tag-tree .acu-tag-tree-item .acu-delete-btn.active{color:var(--acu-title-color);opacity:1}.acu-tag-tree .acu-tag-tree-item .acu-add-btn:hover{color:var(--acu-success,#28a745)}.acu-tag-tree .acu-tag-tree-item .acu-select-btn.active{color:var(--acu-title-color)}.acu-tag-tree .acu-tag-tree-item .acu-migrate-btn:hover{color:var(--acu-warning,#ffc107)}.acu-tag-tree .acu-tag-tree-item .acu-delete-btn:hover{color:var(--acu-danger,#dc3545)}.acu-tag-tree .acu-tag-tree-item:hover .acu-add-btn,.acu-tag-tree .acu-tag-tree-item:hover .acu-select-btn,.acu-tag-tree .acu-tag-tree-item:hover .acu-migrate-btn,.acu-tag-tree .acu-tag-tree-item:hover .acu-delete-btn,.acu-tag-tree .acu-tag-tree-item.migrate-target .acu-migrate-btn{opacity:1}.acu-tag-tree .acu-tree-divider{height:1px;margin:8px 12px;background:var(--acu-border)}.acu-tag-tree .acu-tree-empty{display:flex;flex-direction:column;align-items:center;gap:8px;padding:24px;color:var(--acu-text-sub);font-size:12px}.acu-tag-tree .acu-tree-empty i{font-size:24px;opacity:.5}.acu-tag-grid{flex:1;display:flex;flex-wrap:wrap;align-content:flex-start;gap:8px;padding:16px;overflow-y:auto;background:var(--acu-bg-panel)}.acu-tag-grid .acu-tag-badge{display:inline-flex;align-items:center;gap:6px;padding:8px 14px;border-radius:20px;background:var(--acu-badge-bg);font-size:13px;cursor:pointer;transition:all .2s;border:2px solid rgba(0,0,0,0)}.acu-tag-grid .acu-tag-badge:hover{transform:scale(1.05);background:var(--acu-btn-hover)}.acu-tag-grid .acu-tag-badge.selected{border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-tag-grid .acu-tag-badge.added .added-icon{color:#27ae60}.acu-tag-grid .acu-tag-badge.mode-add .add-icon{color:var(--acu-text-sub);font-size:10px;transition:color .2s}.acu-tag-grid .acu-tag-badge.mode-add:hover .add-icon{color:var(--acu-title-color)}.acu-tag-grid .acu-tag-badge.mode-add.added{background-color:var(--acu-table-head);opacity:.8;cursor:default}.acu-tag-grid .acu-tag-badge.mode-add.added:hover{transform:none;background-color:var(--acu-table-head)}.acu-tag-grid .acu-tag-badge.mode-migrate,.acu-tag-grid .acu-tag-badge.mode-delete:hover{background:rgba(231,76,60,.1);border-color:#e74c3c}.acu-tag-grid .acu-tag-badge .acu-badge-icon{font-size:12px;display:flex;align-items:center}.acu-tag-grid .acu-tag-badge .acu-badge-label{color:var(--acu-text-main)}.acu-tag-grid .acu-tag-badge .acu-badge-delete{color:#e74c3c;font-size:11px}.acu-tag-grid .acu-tag-badge .acu-badge-action{font-size:11px;color:var(--acu-text-sub);transition:color .2s}.acu-tag-grid .acu-tag-badge .acu-badge-action.added{color:#27ae60}.acu-tag-grid .acu-tag-badge.mode-add:hover .acu-badge-action:not(.added){color:#27ae60}.acu-tag-grid .acu-grid-empty,.acu-tag-grid .acu-grid-create-hint{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;width:100%;padding:48px;color:var(--acu-text-sub)}.acu-tag-grid .acu-grid-empty i,.acu-tag-grid .acu-grid-create-hint i{font-size:36px;opacity:.5}.acu-tag-grid .acu-grid-empty span,.acu-tag-grid .acu-grid-create-hint span{font-size:14px}.acu-tag-grid .acu-grid-create-hint{cursor:pointer;border:2px dashed var(--acu-border);border-radius:12px;transition:all .2s}.acu-tag-grid .acu-grid-create-hint:hover{border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-tag-edit-modal{max-width:480px;width:90vw}@media (max-width:768px){.acu-tag-edit-modal{width:100vw;max-width:none;height:auto;max-height:90vh;margin:auto 0 0;border-radius:16px 16px 0 0}}.acu-tag-edit-modal .acu-header-actions{display:flex;align-items:center;gap:8px}.acu-tag-edit-modal .acu-modal-body{padding:0}.acu-tag-edit-modal .acu-modal-body input[type=text]{min-width:0;flex:1;width:100%}.acu-tag-edit-modal .acu-category-control{display:flex;gap:6px}@media (max-width:400px){.acu-tag-edit-modal .acu-category-control{flex-wrap:wrap;justify-content:flex-end;width:100%}.acu-tag-edit-modal .acu-category-control .acu-custom-select{flex:1;min-width:140px}}.acu-tag-edit-modal .acu-category-control select{flex:1;min-width:0}.acu-tag-edit-modal .acu-category-control .acu-add-btn{flex-shrink:0;padding:8px 10px;border:1px solid var(--acu-border);border-radius:6px;background:var(--acu-btn-bg);color:var(--acu-text-main);cursor:pointer;transition:all .2s}.acu-tag-edit-modal .acu-category-control .acu-add-btn:hover{background:var(--acu-btn-hover);color:var(--acu-title-color)}@media (max-width:400px){.acu-tag-edit-modal .acu-settings-row{flex-wrap:wrap}.acu-tag-edit-modal .acu-settings-row .acu-settings-label{width:100%;margin-bottom:4px}.acu-tag-edit-modal .acu-settings-row .acu-settings-control{width:100%;justify-content:flex-start}.acu-tag-edit-modal .acu-settings-row .acu-settings-control input{width:100%}.acu-tag-edit-modal .acu-settings-row.acu-category-row .acu-settings-control{justify-content:flex-end}}.acu-tag-edit-modal .acu-new-category-row{flex-direction:column !important;align-items:stretch !important;justify-content:flex-start !important;gap:8px !important;background:var(--acu-table-head);margin:-10px -16px;padding:10px 16px}.acu-tag-edit-modal .acu-new-category-row .acu-settings-label{flex:none !important;width:100% !important;flex-direction:row !important;align-items:center !important;gap:8px !important}.acu-tag-edit-modal .acu-new-category-row .acu-settings-label .hint{white-space:nowrap !important;display:inline !important}.acu-tag-edit-modal .acu-new-category-row .acu-settings-control{width:100% !important;margin-left:0}.acu-tag-edit-modal .acu-new-category-control{display:flex;gap:6px;flex-wrap:nowrap}.acu-tag-edit-modal .acu-new-category-control input[type=text]{flex:1;min-width:80px}.acu-tag-edit-modal .acu-new-category-control .acu-icon-input{width:50px !important;flex:none !important;text-align:center}.acu-tag-edit-modal .acu-textarea{width:100% !important;padding:10px 12px !important;border:1px solid var(--acu-border) !important;border-radius:6px !important;background:var(--acu-btn-bg) !important;color:var(--acu-text-main) !important;font-size:13px !important;font-family:inherit !important;resize:vertical !important;min-height:80px !important;outline:none !important;box-sizing:border-box !important;transition:border-color .2s}.acu-tag-edit-modal .acu-textarea:focus{border-color:var(--acu-title-color) !important;box-shadow:0 0 0 2px var(--acu-title-color-bg) !important}.acu-tag-edit-modal .acu-textarea::placeholder{color:var(--acu-text-sub) !important;opacity:.7 !important}.acu-tag-edit-modal .acu-wildcard-shortcuts{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:8px 0}.acu-tag-edit-modal .acu-wildcard-shortcuts .hint{color:var(--acu-text-sub);font-size:12px}.acu-tag-edit-modal .acu-wildcard-shortcuts .acu-wildcard-btn{padding:4px 10px;border-radius:4px;background:rgba(0,0,0,0) !important;border:none !important;cursor:pointer;font-family:monospace;font-size:12px;color:var(--acu-text-sub) !important;transition:all .2s;opacity:.6}.acu-tag-edit-modal .acu-wildcard-shortcuts .acu-wildcard-btn:hover{opacity:1;color:var(--acu-title-color) !important}.acu-tag-edit-modal .acu-wildcard-shortcuts .acu-wildcard-btn code{font-family:inherit;background:rgba(0,0,0,0) !important;color:inherit !important;padding:0 !important;border:none !important}.acu-tag-edit-modal .acu-wildcard-help{background:var(--acu-table-head);border-radius:8px;overflow:hidden;margin-top:8px}.acu-tag-edit-modal .acu-wildcard-help .acu-help-header{display:flex;align-items:center;gap:8px;padding:10px 12px;cursor:pointer;transition:background .2s}.acu-tag-edit-modal .acu-wildcard-help .acu-help-header:hover{background:var(--acu-table-hover)}.acu-tag-edit-modal .acu-wildcard-help .acu-help-header i:first-child{color:#f39c12}.acu-tag-edit-modal .acu-wildcard-help .acu-help-header i:last-child{margin-left:auto;font-size:10px;color:var(--acu-text-sub)}.acu-tag-edit-modal .acu-wildcard-help ul{margin:0;padding:0 12px 12px 36px;font-size:12px;color:var(--acu-text-sub)}.acu-tag-edit-modal .acu-wildcard-help ul li{margin:6px 0}.acu-tag-edit-modal .acu-wildcard-help ul code{background:var(--acu-card-bg) !important;padding:2px 6px !important;border-radius:3px !important;font-family:monospace !important;font-size:11px !important;color:var(--acu-text-main) !important;border:none !important}.acu-import-modal{max-width:500px;width:90vw}.acu-import-upload .acu-upload-area{display:flex;flex-direction:column;align-items:center;gap:12px;padding:48px 24px;border:2px dashed var(--acu-border);border-radius:12px;cursor:pointer;transition:all .2s}.acu-import-upload .acu-upload-area:hover{border-color:var(--acu-title-color);background:var(--acu-title-color-bg)}.acu-import-upload .acu-upload-area i{font-size:48px;color:var(--acu-text-sub)}.acu-import-upload .acu-upload-area p{margin:0;font-size:14px;color:var(--acu-text-main)}.acu-import-upload .acu-upload-area .hint{font-size:12px;color:var(--acu-text-sub)}.acu-import-preview{display:flex;flex-direction:column;gap:16px;padding:16px}.acu-import-stats{display:flex;justify-content:center;gap:24px}.acu-import-stats .acu-stat-item{display:flex;flex-direction:column;align-items:center;gap:4px}.acu-import-stats .acu-stat-item i{font-size:24px;color:var(--acu-title-color)}.acu-import-stats .acu-stat-item .acu-stat-value{font-size:24px;font-weight:bold;color:var(--acu-text-main)}.acu-import-stats .acu-stat-item .acu-stat-label{font-size:12px;color:var(--acu-text-sub)}.acu-import-stats .acu-stat-item.acu-stat-conflict i{color:#f39c12}.acu-conflict-options{background:var(--acu-table-head);border-radius:8px;padding:12px}.acu-conflict-options .acu-radio-option{display:flex;align-items:flex-start;gap:8px;padding:8px;cursor:pointer;border-radius:6px;transition:background .2s}.acu-conflict-options .acu-radio-option:hover{background:var(--acu-table-hover)}.acu-conflict-options .acu-radio-option input{margin-top:2px}.acu-conflict-options .acu-radio-option span{display:block;font-size:13px}.acu-conflict-options .acu-radio-option span.hint{font-size:11px;color:var(--acu-text-sub);margin-top:2px}.acu-import-list .acu-preview-scroll{max-height:200px;overflow-y:auto}.acu-import-list .acu-preview-section{margin-bottom:12px}.acu-import-list .acu-preview-section .acu-preview-header{font-size:12px;font-weight:500;color:var(--acu-text-sub);margin-bottom:8px}.acu-import-list .acu-preview-section .acu-preview-items{display:flex;flex-wrap:wrap;gap:6px}.acu-import-list .acu-preview-section .acu-preview-items .acu-preview-item{padding:4px 10px;border-radius:12px;background:var(--acu-badge-bg);font-size:12px}.acu-import-list .acu-preview-section .acu-preview-items .acu-preview-item.conflict{background:rgba(243,156,18,.2);color:#f39c12}.acu-import-list .acu-preview-section .acu-preview-items .acu-preview-more{font-size:12px;color:var(--acu-text-sub);padding:4px}.acu-import-actions{display:flex;justify-content:flex-end;gap:12px}.acu-import-error{display:flex;align-items:center;gap:8px;padding:12px;border-radius:8px;background:rgba(231,76,60,.1);color:#e74c3c;font-size:13px}.acu-category-select-modal{max-width:600px;width:90vw;max-height:70vh;display:flex;flex-direction:column}.acu-category-select-modal.has-subcategories{max-width:800px}@media (max-width:768px){.acu-category-select-modal{width:100vw;max-width:none;max-height:80vh;margin:auto 0 0;border-radius:16px 16px 0 0}}.acu-category-select-modal .acu-modal-body{flex:1;min-height:0;padding:0}.acu-category-select-dual{display:flex;height:100%;min-height:300px}@media (max-width:768px){.acu-category-select-dual{flex-direction:column}}.acu-category-tree{width:180px;min-width:150px;border-right:1px solid var(--acu-border);overflow-y:auto;background:var(--acu-card-bg)}@media (max-width:768px){.acu-category-tree{width:100%;min-width:auto;border-right:none;border-bottom:1px solid var(--acu-border);max-height:120px;display:flex;flex-wrap:wrap;padding:8px;gap:6px}}.acu-category-tree .acu-tree-item{display:flex;align-items:center;gap:8px;padding:10px 12px;cursor:pointer;transition:background .2s;border-left:3px solid rgba(0,0,0,0)}@media (max-width:768px){.acu-category-tree .acu-tree-item{padding:6px 10px;border-left:none;border-radius:16px;background:var(--acu-badge-bg)}}.acu-category-tree .acu-tree-item:hover{background:var(--acu-table-hover)}.acu-category-tree .acu-tree-item.active{background:var(--acu-title-color-bg);border-left-color:var(--acu-title-color)}@media (max-width:768px){.acu-category-tree .acu-tree-item.active{border-left:none;background:var(--acu-title-color);color:#fff}.acu-category-tree .acu-tree-item.active .acu-tree-count{color:hsla(0,0%,100%,.8)}}.acu-category-tree .acu-tree-item .acu-tree-icon{font-size:14px}.acu-category-tree .acu-tree-item .acu-tree-icon i{color:var(--acu-text-sub)}.acu-category-tree .acu-tree-item .acu-tree-label{flex:1;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-category-tree .acu-tree-item .acu-tree-count{font-size:11px;color:var(--acu-text-sub)}.acu-category-tags-grid{flex:1;display:flex;flex-wrap:wrap;align-content:flex-start;gap:8px;padding:16px;overflow-y:auto;background:var(--acu-bg-panel)}@media (max-width:768px){.acu-category-tags-grid{min-height:200px}}.acu-category-tags-only{padding:16px;overflow-y:auto;max-height:400px}.acu-category-tags-only .acu-tags-scroll{display:flex;flex-wrap:wrap;gap:8px}.acu-tag-btn{padding:10px 16px;border:none;border-radius:20px;background:var(--acu-badge-bg);cursor:pointer;font-size:13px;color:var(--acu-text-main);transition:all .2s}.acu-tag-btn:hover{background:var(--acu-btn-hover);transform:scale(1.05)}.acu-tag-btn:active{transform:scale(0.98)}.acu-tags-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;width:100%;padding:32px;color:var(--acu-text-sub)}.acu-tags-empty i{font-size:32px;opacity:.5}.acu-tags-empty span{font-size:13px}.acu-pre-edit-modal{max-width:500px;width:90vw}@media (max-width:768px){.acu-pre-edit-modal{width:100vw;max-width:none;margin:auto 0 0;border-radius:16px 16px 0 0}}.acu-pre-edit-content{display:flex;flex-direction:column;gap:16px;padding:16px}.acu-pre-edit-content .acu-pre-edit-label{font-size:13px;font-weight:500;color:var(--acu-text-main)}.acu-pre-edit-content .acu-pre-edit-textarea{width:100%;min-height:120px;padding:12px;border:1px solid var(--acu-border);border-radius:8px;background:var(--acu-input-bg);color:var(--acu-text-main);font-size:14px;font-family:inherit;line-height:1.5;resize:vertical;outline:none;transition:border-color .2s}.acu-pre-edit-content .acu-pre-edit-textarea:focus{border-color:var(--acu-title-color)}.acu-pre-edit-content .acu-pre-edit-textarea::placeholder{color:var(--acu-text-sub)}.acu-pre-edit-content .acu-pre-edit-hint{display:flex;align-items:center;gap:8px;padding:10px 12px;background:var(--acu-table-head);border-radius:8px;font-size:12px;color:var(--acu-text-sub)}.acu-pre-edit-content .acu-pre-edit-hint i{color:#f39c12}.acu-companion-selector{display:flex;flex-direction:column;gap:8px;padding:12px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:8px}.acu-companion-selector .acu-companion-header{font-size:12px;font-weight:500;color:var(--acu-text-sub);display:flex;align-items:center;gap:6px}.acu-companion-selector .acu-avatar-list{display:flex;gap:8px;flex-wrap:wrap;max-height:200px;overflow-y:auto;padding-right:4px}@media (max-width:768px){.acu-companion-selector .acu-avatar-list{flex-wrap:nowrap;overflow-x:auto;overflow-y:hidden;max-height:none;padding-bottom:8px}}.acu-companion-selector .acu-avatar-list .acu-avatar-item{display:flex;flex-direction:column;align-items:center;gap:4px;width:60px;cursor:pointer;transition:transform .2s}.acu-companion-selector .acu-avatar-list .acu-avatar-item:hover{transform:scale(1.05)}.acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper{width:48px;height:48px;border-radius:50%;overflow:hidden;border:2px solid rgba(0,0,0,0);transition:border-color .2s;background:var(--acu-table-head);display:flex;align-items:center;justify-content:center}.acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper img{width:100%;height:100%;object-fit:cover}.acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper.no-img{background:var(--acu-badge-bg)}.acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper .acu-avatar-text-icon{font-size:20px;font-weight:bold;color:var(--acu-text-sub);text-transform:uppercase}.acu-companion-selector .acu-avatar-list .acu-avatar-item:hover .acu-avatar-img-wrapper{border-color:var(--acu-title-color)}.acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-name{font-size:11px;color:var(--acu-text-main);text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%}.acu-companion-selector .acu-avatar-list .acu-avatar-empty{width:100%;text-align:center;padding:20px;color:var(--acu-text-sub);font-size:12px}.acu-custom-select{position:relative;min-width:120px;max-width:100%;height:32px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:6px;display:flex;align-items:center;padding:0 10px;cursor:pointer;transition:all .2s;min-width:0}.acu-custom-select:hover{border-color:var(--acu-text-sub)}.acu-custom-select.active{border-color:var(--acu-title-color)}.acu-custom-select.active .arrow{transform:rotate(180deg)}.acu-custom-select .selected-value{flex:1;display:flex;align-items:center;gap:8px;overflow:hidden}.acu-custom-select .selected-value i,.acu-custom-select .selected-value span:not(.text):not(.placeholder){font-size:14px;width:16px;text-align:center;flex-shrink:0}.acu-custom-select .selected-value .text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:13px;color:var(--acu-text-main)}.acu-custom-select .selected-value .placeholder{color:var(--acu-text-sub);font-size:13px}.acu-custom-select .arrow{font-size:12px;color:var(--acu-text-sub);margin-left:8px;transition:transform .2s}.acu-custom-select .acu-custom-dropdown-menu{position:absolute;top:100%;left:0;min-width:100%;width:max-content;max-height:200px;overflow-y:auto;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:6px;margin-top:4px;z-index:100;box-shadow:0 4px 12px rgba(0,0,0,.15)}.acu-custom-select .acu-custom-dropdown-menu .dropdown-item{display:flex;align-items:center;gap:8px;padding:8px 10px;cursor:pointer;transition:background .2s}.acu-custom-select .acu-custom-dropdown-menu .dropdown-item:hover{background:var(--acu-table-hover)}.acu-custom-select .acu-custom-dropdown-menu .dropdown-item.selected{background:var(--acu-title-color-bg);color:var(--acu-title-color)}.acu-custom-select .acu-custom-dropdown-menu .dropdown-item.selected .text{color:var(--acu-title-color);font-weight:500}.acu-custom-select .acu-custom-dropdown-menu .dropdown-item i,.acu-custom-select .acu-custom-dropdown-menu .dropdown-item span:not(.text){font-size:14px;width:16px;text-align:center;flex-shrink:0}.acu-custom-select .acu-custom-dropdown-menu .dropdown-item .text{font-size:13px;color:var(--acu-text-main);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.card-back{width:100%;height:100%;border-radius:12px;overflow:hidden;box-shadow:0 25px 50px -12px rgba(0,0,0,.5);border:6px solid #4a3222;position:relative}.card-back__image{width:100%;height:100%;object-fit:cover}.card-back__overlay{position:absolute;inset:0;border:2px solid rgba(139,94,60,.5);border-radius:8px;pointer-events:none}.card-front{width:100%;height:100%;background-color:#f9f2e6;border-radius:12px;overflow:hidden;box-shadow:0 25px 50px -12px rgba(0,0,0,.5);display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:24px;border:6px solid #4a3728;position:relative}.card-front__texture{position:absolute;inset:0;background-image:url("https://grainy-gradients.vercel.app/noise.svg");opacity:.2;pointer-events:none;mix-blend-mode:multiply;z-index:0}.card-front__border-outer{position:absolute;inset:12px;border:1px solid #c6a664;border-radius:8px;pointer-events:none;z-index:10}.card-front__border-inner{position:absolute;inset:16px;border:1px solid rgba(139,94,60,.3);border-radius:6px;pointer-events:none;z-index:10}.card-front__content{position:relative;z-index:20;display:flex;flex-direction:column;align-items:center;height:100%;width:100%}.card-front__top-icon{margin-top:32px;margin-bottom:16px;color:#8b5e3c;animation:divination-pulse 2s ease-in-out infinite}.card-front__luck-name{font-family:"ZCOOL XiaoWei","Cinzel",serif;font-size:24px;color:#4a3728;font-weight:bold;text-align:center;letter-spacing:.2em;text-transform:uppercase;border-bottom:2px solid #c6a664;padding-bottom:8px;margin-bottom:8px;width:85%}@media (min-width:768px){.card-front__luck-name{font-size:28px}}.card-front__dimensions{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-bottom:8px;width:85%}.card-front__dimension-item{font-family:"Noto Serif SC","Cormorant Garamond",serif;font-size:13px;color:#4a3728;background-color:rgba(198,166,100,.15);padding:4px 12px;border-radius:12px;border:1px solid rgba(198,166,100,.3)}@media (min-width:768px){.card-front__dimension-item{font-size:14px}}.card-front__keywords{display:flex;flex-direction:column;gap:12px;width:100%;padding:0 16px;flex-grow:1;justify-content:center;padding-top:0;overflow-y:auto}.card-front__keywords::-webkit-scrollbar{display:none}.card-front__keywords{scrollbar-width:none;-ms-overflow-style:none}.card-front__keyword{display:flex;align-items:center;justify-content:center}.card-front__keyword-text{font-family:"ZCOOL XiaoWei","Cinzel",serif;color:#8b5e3c;font-size:18px;letter-spacing:.1em;text-transform:uppercase;font-weight:bold;white-space:normal;text-align:center;line-height:1.4}.card-front__corner{position:absolute;width:48px;height:48px;color:#c6a664;z-index:10}.card-front__corner--tl{top:12px;left:12px}.card-front__corner--tr{top:12px;right:12px;transform:scaleX(-1)}.card-front__corner--bl{bottom:12px;left:12px;transform:scaleY(-1)}.card-front__corner--br{bottom:12px;right:12px;transform:scale(-1)}.mystic-card-back{width:100%;height:100%;border-radius:12px;overflow:hidden;box-shadow:0 25px 50px -12px rgba(0,0,0,.5);position:relative}.mystic-card-back__image{width:100%;height:100%;object-fit:cover}.mystic-card-back__sheen{position:absolute;inset:0;background:linear-gradient(to top right,rgba(0,0,0,0.2),transparent,rgba(255,255,255,0.1));pointer-events:none}.mystic-card-front{width:100%;height:100%;background-color:#0b1026;border-radius:12px;overflow:hidden;box-shadow:0 0 30px rgba(199,210,254,.3);position:relative}.mystic-card-front__texture{position:absolute;inset:0;background:radial-gradient(circle at center,#1e293b 0%,#0f172a 40%,#020617 100%)}.mystic-card-front__border-outer{position:absolute;inset:12px;border:1px solid rgba(245,158,11,.3);border-radius:8px;pointer-events:none;z-index:10}.mystic-card-front__border-inner{position:absolute;inset:16px;border:2px solid rgba(252,211,77,.6);border-radius:8px;box-shadow:0 0 15px rgba(251,191,36,.2);pointer-events:none;z-index:10}.mystic-card-front__corner{position:absolute;width:64px;height:64px;border-style:solid;border-width:0;border-color:rgba(199,210,254,.8);z-index:10}.mystic-card-front__corner--tl{top:16px;left:16px;border-top-width:2px;border-left-width:2px;border-top-left-radius:16px}.mystic-card-front__corner--tr{top:16px;right:16px;border-top-width:2px;border-right-width:2px;border-top-right-radius:16px}.mystic-card-front__corner--bl{bottom:16px;left:16px;border-bottom-width:2px;border-left-width:2px;border-bottom-left-radius:16px}.mystic-card-front__corner--br{bottom:16px;right:16px;border-bottom-width:2px;border-right-width:2px;border-bottom-right-radius:16px}.mystic-card-front__glow{position:absolute;top:32px;left:50%;transform:translateX(-50%);width:128px;height:128px;opacity:.2;background:radial-gradient(circle,rgba(251,191,36,0.4) 0%,transparent 70%);filter:blur(40px);pointer-events:none;z-index:5}.mystic-card-front__content{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:36px 24px;text-align:center;z-index:20;font-family:"Noto Serif SC","Cormorant Garamond",serif}.mystic-card-front__top-icon{color:rgba(252,211,77,.8);margin-bottom:8px;filter:drop-shadow(0 0 5px rgba(251,191,36,0.8))}.mystic-card-front__top-icon svg{opacity:.8}.mystic-card-front__loading{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;height:100%}.mystic-card-front__spinner{width:32px;height:32px;border:2px solid #f59e0b;border-top-color:rgba(0,0,0,0);border-radius:50%;animation:mystic-spin 1s linear infinite}.mystic-card-front__loading-text{color:#c7d2fe;font-size:14px;letter-spacing:.2em;animation:mystic-pulse 2s ease-in-out infinite}.mystic-card-front__title{position:relative}.mystic-card-front__luck-name{font-family:"Cinzel","ZCOOL XiaoWei",serif;font-size:32px;font-weight:bold;letter-spacing:.2em;background:linear-gradient(to bottom,#fef3c7,#f59e0b);-webkit-background-clip:text;-webkit-text-fill-color:rgba(0,0,0,0);background-clip:text;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.3));margin:0}@media (max-width:768px){.mystic-card-front__luck-name{font-size:28px}}.mystic-card-front__divider{width:64px;height:1px;background:linear-gradient(to right,transparent,#818cf8,transparent);margin:8px auto 0}.mystic-card-front__dimensions{display:flex;flex-direction:column;gap:8px;margin:12px 0}.mystic-card-front__dimension-tag{color:#c7d2fe;font-size:14px;letter-spacing:.2em;text-transform:uppercase;border:1px solid rgba(99,102,241,.3);padding:4px 12px;border-radius:9999px;background:rgba(30,27,75,.3);backdrop-filter:blur(4px)}.mystic-card-front__message-box{position:relative;padding:24px 16px;background:radial-gradient(circle at center,rgba(255,255,255,0.03) 0%,transparent 70%);flex-grow:1;display:flex;flex-direction:column;width:110%;margin:8px -5%;overflow:hidden}.mystic-card-front__message-box::before,.mystic-card-front__message-box::after{content:"";position:absolute;left:20%;right:20%;height:1px;background:linear-gradient(90deg,transparent,rgba(245,158,11,0.3),transparent)}.mystic-card-front__message-box::before{top:0}.mystic-card-front__message-box::after{bottom:0}.mystic-card-front__word-list{display:flex;flex-direction:column;gap:12px;align-items:center;width:100%;height:100%;overflow-y:auto;padding:0 8px}.mystic-card-front__word-list::before,.mystic-card-front__word-list::after{content:"";flex-shrink:0;margin:auto}.mystic-card-front__word-list::-webkit-scrollbar{width:4px}.mystic-card-front__word-list::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.mystic-card-front__word-list::-webkit-scrollbar-thumb{background:rgba(245,158,11,.2);border-radius:4px}.mystic-card-front__word-list::-webkit-scrollbar-thumb:hover{background:rgba(245,158,11,.4)}.mystic-card-front__word-list{scrollbar-width:thin;scrollbar-color:rgba(245,158,11,.2) rgba(0,0,0,0)}.mystic-card-front__word-item{font-family:"Cinzel","ZCOOL XiaoWei",serif;font-size:16px;color:#fef3c7;text-shadow:0 0 10px rgba(253,224,71,.2);letter-spacing:.05em;line-height:1.4;position:relative;white-space:normal;text-align:center}.mystic-card-front__word-item:only-child{font-size:20px;color:#fcd34d;text-shadow:0 0 15px rgba(245,158,11,.3)}.mystic-card-front__bottom-icon{color:rgba(252,211,77,.5);margin-top:16px;transform:rotate(180deg)}@keyframes mystic-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@keyframes mystic-pulse{0%,100%{opacity:1}50%{opacity:.5}}@keyframes mystic-float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}@keyframes mystic-glow{0%,100%{box-shadow:0 0 20px rgba(199,210,254,.3)}50%{box-shadow:0 0 40px rgba(199,210,254,.5)}}.divination-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;height:100dvh;z-index:200000;display:flex;flex-direction:column;align-items:center;justify-content:center;background:radial-gradient(circle at center,#2a1b15 0%,#1a0f0e 40%,#050505 100%);overflow:hidden;font-family:"Noto Serif SC","Cormorant Garamond",serif;color:#f9f2e6}.divination-overlay::before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-image:url("https://www.transparenttextures.com/patterns/stardust.png");opacity:.3;pointer-events:none;z-index:0}.divination-grain{position:absolute;inset:0;background-image:url("https://grainy-gradients.vercel.app/noise.svg");opacity:.15;mix-blend-mode:overlay;pointer-events:none;z-index:1}.divination-starfield{position:absolute;inset:0;pointer-events:none;z-index:0}.divination-star{position:absolute;border-radius:50%;background-color:#f5e6d3;opacity:.6;animation:divination-twinkle var(--duration,3s) ease-in-out infinite;animation-delay:var(--delay,0s)}@keyframes divination-twinkle{0%,100%{opacity:.2;transform:scale(0.8)}50%{opacity:.8;transform:scale(1.2)}}.divination-nebula{position:absolute;border-radius:50%;pointer-events:none;z-index:0}.divination-nebula--purple{top:-10%;left:-10%;width:60%;height:60%;background:#3d2b4a;filter:blur(100px);opacity:.3;mix-blend-mode:screen;animation:divination-nebula-pulse 15s ease-in-out infinite}.divination-nebula--golden{bottom:-10%;right:-10%;width:70%;height:70%;background:#4a3728;filter:blur(120px);opacity:.2;mix-blend-mode:screen;animation:divination-nebula-drift 20s ease-in-out infinite}@keyframes divination-nebula-pulse{0%,100%{transform:scale(1);opacity:.2}50%{transform:scale(1.2);opacity:.4}}@keyframes divination-nebula-drift{0%,100%{transform:translateX(0) scale(1);opacity:.1}50%{transform:translateX(50px) scale(1.1);opacity:.3}}.divination-central-glow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:80vw;height:80vw;max-width:800px;max-height:800px;background:radial-gradient(circle,rgba(198,166,100,0.1) 0%,transparent 70%);filter:blur(48px);pointer-events:none;z-index:0}.divination-geometry{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);pointer-events:none;z-index:0}.divination-geometry--outer{width:140vmin;height:140vmin;opacity:.15;animation:divination-spin-slow 60s linear infinite}.divination-geometry--inner{width:90vmin;height:90vmin;opacity:.1;animation:divination-spin-reverse 80s linear infinite}.divination-geometry svg{width:100%;height:100%}@keyframes divination-spin-slow{from{transform:translate(-50%,-50%) rotate(0deg)}to{transform:translate(-50%,-50%) rotate(360deg)}}@keyframes divination-spin-reverse{from{transform:translate(-50%,-50%) rotate(0deg)}to{transform:translate(-50%,-50%) rotate(-360deg)}}.divination-frame{position:absolute;top:8px;left:8px;right:8px;bottom:8px;width:auto;height:auto;pointer-events:none;z-index:50;border:1px solid rgba(212,175,55,.2);border-radius:12px;box-sizing:border-box}@media (min-width:768px){.divination-frame{top:16px;left:16px;right:16px;bottom:16px}}.divination-frame__corner{position:absolute;width:128px;height:128px;border-color:rgba(212,175,55,.6);border-style:solid;border-width:0}.divination-frame__corner--tl{top:0;left:0;border-top-width:2px;border-left-width:2px;border-top-left-radius:24px}.divination-frame__corner--tr{top:0;right:0;border-top-width:2px;border-right-width:2px;border-top-right-radius:24px}.divination-frame__corner--bl{bottom:0;left:0;border-bottom-width:2px;border-left-width:2px;border-bottom-left-radius:24px}.divination-frame__corner--br{bottom:0;right:0;border-bottom-width:2px;border-right-width:2px;border-bottom-right-radius:24px}.divination-frame__top-line{position:absolute;top:0;left:50%;transform:translateX(-50%);width:160px;height:1px;background:linear-gradient(to right,transparent,#d4af37,transparent);opacity:.8}.divination-frame__bottom-line{position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:160px;height:1px;background:linear-gradient(to right,transparent,#d4af37,transparent);opacity:.8}.divination-content{position:relative;z-index:20;width:100%;display:flex;flex-direction:column;align-items:center;max-width:1280px;margin:0 auto;height:100%;justify-content:space-between;padding:16px 24px;gap:8px;box-sizing:border-box}@media (max-width:768px){.divination-content{padding:12px 16px;gap:4px}}.divination-header{text-align:center;animation:divination-fade-in-down 1s ease-out;flex-shrink:1;min-height:0}@media (max-width:768px){.divination-header{transform:scale(0.6);transform-origin:top center;margin-bottom:-16px}}.divination-header__title{display:inline-flex;flex-direction:column;align-items:center}.divination-header__sparkle--static{position:relative;display:block;color:#d4af37;opacity:.8;animation:divination-twinkle 4s ease-in-out infinite;filter:drop-shadow(0 0 10px rgba(212,175,55,0.5))}.divination-header__divider{height:2px;width:120px;background:linear-gradient(to right,transparent,#d4af37,transparent);margin-top:8px;opacity:.5}@media (max-width:768px){.divination-header__divider{margin-top:4px}}@keyframes divination-fade-in-down{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.divination-stage{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;position:relative;flex:1;min-height:0;padding:8px 0;overflow:hidden}.tarot-card{position:relative;cursor:pointer;perspective:1000px;width:auto;height:100%;max-height:100%;max-width:min(90vw,400px)}@media (max-width:768px){.tarot-card{height:auto;width:min(85vw,300px);max-height:calc(100dvh - 180px)}}@media (min-width:768px){.tarot-card{max-width:min(50vw,450px);max-height:75vh}}.tarot-card__inner{position:relative;width:100%;height:100%;transform-style:preserve-3d;transition:transform .8s ease-in-out}.tarot-card--flipped .tarot-card__inner{transform:rotateY(180deg)}.tarot-card__face{position:absolute;inset:0;width:100%;height:100%;backface-visibility:hidden;border-radius:12px;overflow:hidden}.tarot-card__back{z-index:2}.tarot-card__front{transform:rotateY(180deg);z-index:1}.tarot-card:not(.tarot-card--flipped) .tarot-card__back{animation:divination-float 4s ease-in-out infinite}@keyframes divination-float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}.divination-hint{text-align:center;pointer-events:none;animation:divination-fade-in .8s ease-out}.divination-hint__text{font-family:"ZCOOL XiaoWei","Cinzel",serif;color:#f5e6d3;font-size:18px;letter-spacing:.2em;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.5));animation:divination-bounce 2s ease-in-out infinite}@media (max-width:768px){.divination-hint__text{font-size:14px}}@keyframes divination-fade-in{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes divination-bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}.divination-btn{padding:12px 32px;font-family:"ZCOOL XiaoWei","Cinzel",serif;font-size:14px;letter-spacing:.2em;text-transform:uppercase;border:1px solid;border-radius:0;cursor:pointer;transition:all .3s ease;backdrop-filter:blur(4px);position:relative;overflow:hidden}.divination-btn::before{content:"";position:absolute;inset:0;transform:skewX(-10deg);z-index:-1}.divination-btn--primary{color:#d4af37;border-color:#d4af37;background:rgba(26,15,14,.6)}.divination-btn--primary::before{background:rgba(0,0,0,0)}.divination-btn--primary:hover{color:#f9f2e6;background:rgba(212,175,55,.2)}.divination-btn--secondary{color:rgba(212,175,55,.7);border-color:rgba(212,175,55,.4);background:rgba(0,0,0,0)}.divination-btn--secondary:hover{color:#d4af37;border-color:#d4af37}.divination-btn--retry{font-family:"ZCOOL XiaoWei","Cinzel",serif;color:#f5e6d3;font-size:18px;letter-spacing:.2em;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.5));animation:divination-bounce 2s ease-in-out infinite;border:1px solid hsla(0,0%,100%,.8);border-radius:24px;background:rgba(0,0,0,.3);padding:10px 32px}.divination-btn--retry::before{display:none}.divination-btn--retry:hover{background:hsla(0,0%,100%,.1);border-color:#fff}.divination-footer{height:auto;min-height:32px;display:flex;align-items:center;justify-content:center;flex-shrink:1;padding-bottom:4px}@media (max-width:768px){.divination-footer{min-height:24px;padding-bottom:0}}.divination-close{position:absolute;top:24px;right:24px;z-index:100;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:rgba(212,175,55,.6);border:1px solid rgba(212,175,55,.3);border-radius:50%;background:rgba(15,10,8,.5);backdrop-filter:blur(4px);cursor:pointer;transition:all .3s ease}.divination-close:hover{color:#d4af37;border-color:#d4af37;background:rgba(212,175,55,.1)}.divination-overlay-enter-active{animation:divination-overlay-in .5s ease-out}.divination-overlay-leave-active{animation:divination-overlay-out .3s ease-in forwards}@keyframes divination-overlay-in{from{opacity:0}to{opacity:1}}@keyframes divination-overlay-out{from{opacity:1}to{opacity:0}}.acu-prompt-editor-modal{max-width:600px}@media (max-width:768px){.acu-prompt-editor-modal{max-width:90vw}}.acu-prompt-editor-modal .acu-textarea-scrollable{background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:var(--acu-radius-md);padding:12px;font-size:14px;transition:border-color .2s}.acu-prompt-editor-modal .acu-textarea-scrollable:focus{border-color:var(--acu-title-color);box-shadow:none}.acu-prompt-editor-modal .acu-textarea-scrollable::placeholder{color:var(--acu-text-sub);opacity:.7}:root{--acu-neutral-50:#fafafa;--acu-neutral-100:#f5f5f5;--acu-neutral-200:#eeeeee;--acu-neutral-300:#e0e0e0;--acu-neutral-400:#bdbdbd;--acu-neutral-500:#9e9e9e;--acu-neutral-600:#757575;--acu-neutral-700:#616161;--acu-neutral-800:#424242;--acu-neutral-900:#212121;--acu-success:#27ae60;--acu-warning:#f39c12;--acu-danger:#e74c3c;--acu-info:#3498db;--acu-z-ball:2147483646;--acu-z-overlay:2147483647;--acu-z-menu:2147483648;--acu-radius-sm:6px;--acu-radius-md:12px;--acu-radius-lg:16px;--acu-shadow-sm:0 2px 8px rgba(0,0,0,0.1);--acu-shadow-md:0 4px 16px rgba(0,0,0,0.15);--acu-shadow-lg:0 15px 50px rgba(0,0,0,0.3);--acu-transition-fast:0.15s;--acu-transition-normal:0.3s;--acu-transition-slow:0.5s}.acu-wrapper,.acu-theme-retro{--acu-bg-nav:#e6e2d3;--acu-bg-panel:#e6e2d3;--acu-card-bg:#fffef9;--acu-table-head:#efebe4;--acu-table-hover:#f0ebe0;--acu-badge-bg:#efebe4;--acu-input-bg:rgba(255,255,255,0.5);--acu-menu-bg:#fff;--acu-overlay-bg:rgba(94,75,53,0.4);--acu-text-main:#5e4b35;--acu-text-sub:#999;--acu-menu-text:#333;--acu-border:#dcd0c0;--acu-btn-bg:#dcd0c0;--acu-btn-hover:#cbbba8;--acu-btn-active-bg:#8d7b6f;--acu-btn-active-text:#fdfaf5;--acu-shadow:rgba(0,0,0,0.1);--acu-card-width:280px;--acu-font-size:13px;--acu-highlight:#d35400;--acu-title-color-bg:rgba(211,84,0,0.08);--acu-title-color:#d35400;--acu-accent:#d35400;--acu-nav-cols:repeat(auto-fill,minmax(90px,1fr));--acu-text-max-height:80px;--acu-text-overflow:auto;--acu-win-width:400px;--acu-win-left:100px;--acu-win-bottom:100px}.acu-theme-dark{--acu-bg-nav:rgba(43,43,43,0.95);--acu-bg-panel:rgba(37,37,37,0.95);--acu-border:#444;--acu-text-main:#eee;--acu-text-sub:#aaa;--acu-btn-bg:rgba(58,58,58,0.5);--acu-btn-hover:#4a4a4a;--acu-btn-active-bg:#6a5acd;--acu-btn-active-text:#fff;--acu-table-head:rgba(51,51,51,0.8);--acu-table-hover:rgba(58,58,58,0.5);--acu-shadow:rgba(0,0,0,0.6);--acu-card-bg:rgba(45,48,53,0.8);--acu-badge-bg:#3a3f4b;--acu-menu-bg:#333;--acu-menu-text:#eee;--acu-input-bg:rgba(0,0,0,0.3);--acu-overlay-bg:rgba(0,0,0,0.75)}.acu-theme-modern{--acu-bg-nav:#ffffff;--acu-bg-panel:#f8f9fa;--acu-border:#e0e0e0;--acu-text-main:#333;--acu-text-sub:#888;--acu-btn-bg:#f1f3f5;--acu-btn-hover:#e9ecef;--acu-btn-active-bg:#007bff;--acu-btn-active-text:#fff;--acu-table-head:#f8f9fa;--acu-table-hover:#f1f3f5;--acu-shadow:rgba(0,0,0,0.08);--acu-card-bg:#ffffff;--acu-badge-bg:#f1f3f5;--acu-menu-bg:#fff;--acu-menu-text:#333;--acu-input-bg:#ffffff;--acu-overlay-bg:rgba(0,0,0,0.3)}.acu-theme-forest{--acu-bg-nav:#e8f5e9;--acu-bg-panel:#e8f5e9;--acu-border:#c8e6c9;--acu-text-main:#2e7d32;--acu-text-sub:#81c784;--acu-btn-bg:#c8e6c9;--acu-btn-hover:#a5d6a7;--acu-btn-active-bg:#43a047;--acu-btn-active-text:#fff;--acu-table-head:#dcedc8;--acu-table-hover:#f1f8e9;--acu-shadow:rgba(0,0,0,0.1);--acu-card-bg:#ffffff;--acu-badge-bg:#dcedc8;--acu-menu-bg:#fff;--acu-menu-text:#2e7d32;--acu-input-bg:rgba(255,255,255,0.7);--acu-overlay-bg:rgba(46,125,50,0.2)}.acu-theme-ocean{--acu-bg-nav:#e3f2fd;--acu-bg-panel:#e3f2fd;--acu-border:#bbdefb;--acu-text-main:#1565c0;--acu-text-sub:#64b5f6;--acu-btn-bg:#bbdefb;--acu-btn-hover:#90caf9;--acu-btn-active-bg:#1976d2;--acu-btn-active-text:#fff;--acu-table-head:#bbdefb;--acu-table-hover:#e1f5fe;--acu-shadow:rgba(0,0,0,0.15);--acu-card-bg:#ffffff;--acu-badge-bg:#e3f2fd;--acu-menu-bg:#fff;--acu-menu-text:#1565c0;--acu-input-bg:rgba(255,255,255,0.7);--acu-overlay-bg:rgba(21,101,192,0.2)}.acu-theme-cyber{--acu-bg-nav:#000000;--acu-bg-panel:#0a0a0a;--acu-border:#333;--acu-text-main:#00ffcc;--acu-text-sub:#ff00ff;--acu-btn-bg:#1a1a1a;--acu-btn-hover:#333;--acu-btn-active-bg:#ff00ff;--acu-btn-active-text:#fff;--acu-table-head:#111;--acu-table-hover:#1a1a1a;--acu-shadow:0 0 10px rgba(0,255,204,0.3);--acu-card-bg:#050505;--acu-badge-bg:#222;--acu-menu-bg:#111;--acu-menu-text:#00ffcc;--acu-input-bg:#111;--acu-overlay-bg:rgba(0,0,0,0.85)}.acu-theme-purple{--acu-bg-nav:#ede7f6;--acu-bg-panel:#ede7f6;--acu-border:#d1c4e9;--acu-text-main:#4a148c;--acu-text-sub:#7b1fa2;--acu-btn-bg:#d1c4e9;--acu-btn-hover:#b39ddb;--acu-btn-active-bg:#7b1fa2;--acu-btn-active-text:#fff;--acu-table-head:#f5f0fa;--acu-table-hover:#f3e5f5;--acu-shadow:rgba(74,20,140,0.1);--acu-card-bg:#faf8fc;--acu-badge-bg:#f5f0fa;--acu-menu-bg:#faf8fc;--acu-menu-text:#4a148c;--acu-input-bg:rgba(255,255,255,0.8);--acu-overlay-bg:rgba(74,20,140,0.3)}.acu-icon-select-modal{width:500px;max-width:90vw;height:600px;max-height:80vh;display:flex;flex-direction:column}.acu-icon-select-modal .acu-modal-body{flex:1;display:flex;flex-direction:column;overflow:hidden;padding:0}.acu-icon-select-modal .acu-icon-tabs{display:flex;border-bottom:1px solid var(--acu-border);background:var(--acu-bg-panel);padding:0 16px;flex-shrink:0}.acu-icon-select-modal .acu-icon-tabs .acu-icon-tab{padding:12px 16px;cursor:pointer;color:var(--acu-text-sub);font-size:14px;font-weight:500;border-bottom:2px solid rgba(0,0,0,0);transition:all .2s}.acu-icon-select-modal .acu-icon-tabs .acu-icon-tab:hover{color:var(--acu-text-main)}.acu-icon-select-modal .acu-icon-tabs .acu-icon-tab.active{color:var(--acu-title-color);border-bottom-color:var(--acu-title-color)}.acu-icon-select-modal .acu-icon-search-bar{padding:12px 16px;border-bottom:1px solid var(--acu-border);background:var(--acu-bg-panel);flex-shrink:0}.acu-icon-select-modal .acu-icon-search-bar .acu-search-input-wrapper{position:relative}.acu-icon-select-modal .acu-icon-search-bar .acu-search-input-wrapper i{position:absolute;left:10px;top:50%;transform:translateY(-50%);color:var(--acu-text-sub)}.acu-icon-select-modal .acu-icon-search-bar .acu-search-input-wrapper input{width:100%;padding:8px 12px 8px 32px;border:1px solid var(--acu-border);border-radius:var(--acu-radius-md);background:var(--acu-card-bg);color:var(--acu-text-main);font-size:13px}.acu-icon-select-modal .acu-icon-search-bar .acu-search-input-wrapper input:focus{border-color:var(--acu-title-color);outline:none}.acu-icon-select-modal .acu-icon-grid-container{flex:1;overflow-y:auto;padding:16px;background:var(--acu-card-bg)}.acu-icon-select-modal .acu-icon-grid-container .acu-icon-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(40px,1fr));gap:8px}.acu-icon-select-modal .acu-icon-grid-container .acu-icon-item{aspect-ratio:1;display:flex;align-items:center;justify-content:center;border-radius:var(--acu-radius-sm);cursor:pointer;font-size:20px;color:var(--acu-text-main);transition:all .2s;border:1px solid rgba(0,0,0,0)}.acu-icon-select-modal .acu-icon-grid-container .acu-icon-item:hover{background:var(--acu-table-hover);border-color:var(--acu-border)}.acu-icon-select-modal .acu-icon-grid-container .acu-icon-item.selected{background:var(--acu-title-color-bg);border-color:var(--acu-title-color);color:var(--acu-title-color)}.acu-icon-select-modal .acu-icon-grid-container .acu-no-icons{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--acu-text-sub);gap:8px}.acu-icon-select-modal .acu-icon-grid-container .acu-no-icons i{font-size:24px;opacity:.5}.acu-icon-select-modal .acu-icon-manual-input{padding:12px 16px;border-top:1px solid var(--acu-border);background:var(--acu-bg-panel);flex-shrink:0;display:flex;align-items:center;gap:12px}.acu-icon-select-modal .acu-icon-manual-input .acu-manual-label{font-size:13px;color:var(--acu-text-sub);white-space:nowrap}.acu-icon-select-modal .acu-icon-manual-input .acu-manual-field{flex:1;display:flex;align-items:center;gap:8px;background:var(--acu-card-bg);border:1px solid var(--acu-border);border-radius:var(--acu-radius-md);padding:6px 10px}.acu-icon-select-modal .acu-icon-manual-input .acu-manual-field .acu-preview-icon{width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-size:16px;color:var(--acu-text-main)}.acu-icon-select-modal .acu-icon-manual-input .acu-manual-field input{flex:1;border:none;background:rgba(0,0,0,0);color:var(--acu-text-main);font-size:13px;min-width:0}.acu-icon-select-modal .acu-icon-manual-input .acu-manual-field input:focus{outline:none}.acu-pre-edit-modal{max-width:600px}.acu-pre-edit-modal .acu-modal-header .acu-header-actions{display:flex;gap:8px;margin-left:auto}.acu-pre-edit-modal .acu-pre-edit-content{display:flex;flex-direction:column;gap:12px}.acu-pre-edit-modal .acu-pre-edit-info-row{display:flex;align-items:center;justify-content:space-between;gap:12px}.acu-pre-edit-modal .acu-pre-edit-info-row .acu-pre-edit-label{font-size:14px;color:var(--acu-text-sub);font-weight:500}.acu-pre-edit-modal .acu-pre-edit-textarea{width:100%;min-height:120px;padding:12px;border:1px solid var(--acu-border);border-radius:8px;background:var(--acu-input-bg);color:var(--acu-text-main);font-size:14px;line-height:1.5;resize:vertical;outline:none;transition:border-color .2s}.acu-pre-edit-modal .acu-pre-edit-textarea:focus{border-color:var(--acu-title-color)}.acu-pre-edit-modal .acu-companion-selector{border:1px solid var(--acu-border);border-radius:8px;background:var(--acu-card-bg);overflow:hidden}.acu-pre-edit-modal .acu-companion-selector .acu-companion-header{padding:8px 12px;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border);font-size:12px;color:var(--acu-text-sub);display:flex;align-items:center;gap:6px}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list{display:flex;flex-wrap:wrap;gap:8px;padding:12px;max-height:200px;overflow-y:auto;justify-content:center}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item{display:flex;flex-direction:column;align-items:center;gap:4px;width:60px;cursor:pointer;transition:transform .2s}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item:hover{transform:translateY(-2px)}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item:hover .acu-avatar-name{color:var(--acu-title-color)}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper{width:48px;height:48px;border-radius:50%;overflow:hidden;border:2px solid rgba(0,0,0,0);background:var(--acu-bg-panel);display:flex;align-items:center;justify-content:center}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper img{width:100%;height:100%;object-fit:cover}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper.no-img{background:var(--acu-table-head);border:1px solid var(--acu-border)}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-img-wrapper.no-img .acu-avatar-text-icon{font-size:20px;font-weight:bold;color:var(--acu-text-sub)}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-item .acu-avatar-name{font-size:11px;color:var(--acu-text-main);text-align:center;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-pre-edit-modal .acu-companion-selector .acu-avatar-list .acu-avatar-empty{width:100%;text-align:center;padding:20px;color:var(--acu-text-sub);font-size:12px}.acu-pre-edit-modal .acu-pre-edit-hint{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--acu-text-sub)}.acu-pre-edit-modal .acu-pre-edit-hint i{color:var(--acu-warning,#f39c12)}',e.head.appendChild(r),n.value=r,console.info('[ACU Styles] Base styles injected')})(),s(),(()=>{const e=a(),t=`${b}-dynamic-${o.value}`;e.getElementById(t)?.remove();const n=e.createElement('style');n.id=t,n.setAttribute('data-source','acu-visualizer'),e.head.appendChild(n),r.value=n,console.info('[ACU Styles] Dynamic styles element created')})(),(()=>{const e=a(),t=`${x}-${o.value}`;e.getElementById(t)?.remove();const n=e.createElement('style');n.id=t,n.setAttribute('data-source','acu-visualizer-theme'),e.head.appendChild(n),i.value=n,console.info('[ACU Styles] Theme custom styles element created')})(),t.loadFromStorage(),u(),d(),c.value=!0,console.info('[ACU Styles] Style system initialized'))};return(0,m.watch)(()=>e.config,e=>{c.value&&(u(),p(e.theme),y(e.layout))},{deep:!0}),(0,m.watch)(()=>e.config.fontFamily,e=>{c.value&&w(e)}),(0,m.watch)([()=>t.currentThemeVars,()=>t.currentHighlight,()=>t.customCSS,()=>t.backgroundConfig],()=>{c.value&&d()},{deep:!0}),(0,m.onMounted)(()=>{C()}),(0,m.onUnmounted)(()=>{k()}),{isInitialized:c,init:C,cleanup:k,updateDynamicVariables:u,updateThemeCustomStyles:d,applyTheme:p,applyLayout:y,applyFont:w,applyAllStyles:()=>{u(),d(),p(),y(),w()},baseStyleEl:n,dynamicStyleEl:r,fontStyleEl:l,themeCustomStyleEl:i}}var w=d(3024),k=d(7002);function C(){const e='shujuku_v80_allSettings_v2';if(localStorage.getItem(e))return e;const t='shujuku_v70_allSettings_v2';if(localStorage.getItem(t))return t;return Object.keys(localStorage||{}).find(e=>/^shujuku_.*_allSettings_v2$/.test(e))||e}function N(){try{const e=C(),t=localStorage.getItem(e);return t?JSON.parse(t):{}}catch(e){return console.warn('[ACU] è¯»å– localStorage è®¾ç½®å¤±è´¥:',e),{}}}function V(e){try{const t=C(),a=N();localStorage.setItem(t,JSON.stringify({...a,...e}))}catch(e){console.warn('[ACU] å†™å…¥ localStorage è®¾ç½®å¤±è´¥:',e)}}function E(){const e=(0,m.ref)({}),t=(0,m.ref)(!1),a=(0,m.ref)(!1);async function o(t){try{const a=(0,v.M1)().getDB(),o={...e.value,...t};return a&&'function'==typeof a.updateSettings?(await a.updateSettings(o),e.value=o,console.info('[ACU] é€šè¿‡ API ä¿å­˜è®¾ç½®æˆåŠŸ'),!0):(V(o),e.value=o,console.info('[ACU] é€šè¿‡ localStorage ä¿å­˜è®¾ç½®'),!0)}catch(a){console.error('[ACU] ä¿å­˜è®¾ç½®å¤±è´¥:',a);try{return V({...e.value,...t}),e.value={...e.value,...t},!0}catch{return!1}}}async function n(){try{const e=(0,v.M1)().getDB();if(!e)return console.warn('[ACU] æ•°æ®åº“ API ä¸å¯ç”¨'),!1;if('function'==typeof e.manualUpdate)return await e.manualUpdate(),console.info('[ACU] æ‰‹åŠ¨æ›´æ–°æ‰§è¡ŒæˆåŠŸ (manualUpdate)'),!0;if('function'==typeof e.triggerUpdate){const t=await e.triggerUpdate();return console.info('[ACU] æ‰‹åŠ¨æ›´æ–°æ‰§è¡ŒæˆåŠŸ (triggerUpdate):',t),!!t}return console.warn('[ACU] æ²¡æœ‰å¯ç”¨çš„æ›´æ–°æ–¹æ³•'),!1}catch(e){return console.error('[ACU] æ‰‹åŠ¨æ›´æ–°å¤±è´¥:',e),!1}}return{settings:e,isLoading:t,isInitialized:a,loadSettings:async function(){t.value=!0;try{const t=(0,v.M1)().getDB();if(t&&'function'==typeof t.getSettings){const a=await t.getSettings();if(a&&'object'==typeof a)return e.value=a,console.info('[ACU] ä» API è¯»å–è®¾ç½®æˆåŠŸ'),a}const a=N();return e.value=a,console.info('[ACU] ä» localStorage è¯»å–è®¾ç½®'),a}catch(t){console.error('[ACU] è¯»å–è®¾ç½®å¤±è´¥:',t);const a=N();return e.value=a,a}finally{t.value=!1,a.value=!0}},saveSettings:o,updateSetting:async function(e,t){await o({[e]:t})},executeManualUpdate:n,getTableList:function(){try{const e=(0,v.M1)().getDB();if(!e)return console.warn('[ACU] æ•°æ®åº“ API ä¸å¯ç”¨'),[];if('function'==typeof e.getTableList){const t=e.getTableList();return console.info('[ACU] è·å–è¡¨æ ¼åˆ—è¡¨æˆåŠŸ:',t?.length||0),t||[]}if('function'==typeof e.exportTableAsJson){const t=e.exportTableAsJson();if(t&&'object'==typeof t){const e=[];return Object.keys(t).forEach(a=>{if(!a.startsWith('sheet_'))return;const o=t[a],n=o?.name||a,r=n.includes('æ€»ç»“')||n.includes('å¤§çº²')||n.toLowerCase().includes('summary')||n.toLowerCase().includes('outline');e.push({key:a,name:n,isSummaryOrOutline:r})}),console.info('[ACU] ä» exportTableAsJson è§£æè¡¨æ ¼åˆ—è¡¨:',e.length),e}}return console.warn('[ACU] æ— æ³•è·å–è¡¨æ ¼åˆ—è¡¨'),[]}catch(e){return console.error('[ACU] è·å–è¡¨æ ¼åˆ—è¡¨å¤±è´¥:',e),[]}},executeWithPreset:async function(e,t=[],a=!1){try{const r=(0,v.M1)().getDB();if(!r)return{success:!1,message:'æ•°æ®åº“ API ä¸å¯ç”¨'};if('function'==typeof r.executeWithPreset){const o=await r.executeWithPreset({settings:{autoUpdateThreshold:e.autoUpdateThreshold,updateBatchSize:e.updateBatchSize,skipUpdateFloors:e.skipUpdateFloors,autoUpdateFrequency:e.autoUpdateFrequency},targetTableNames:t.length>0?t:null,silent:a});return console.info('[ACU] executeWithPreset ç»“æœ:',o),o}console.info('[ACU] å›é€€åˆ°æ—§æ–¹å¼: saveSettings + executeManualUpdate'),await o(e);const l=await n();return{success:l,message:l?'æ›´æ–°æˆåŠŸ':'æ›´æ–°å¤±è´¥'}}catch(e){return console.error('[ACU] é¢„è®¾æ‰§è¡Œå¤±è´¥:',e),{success:!1,message:String(e)}}},findDatabaseSettingsKey:C}}var B=d(9842),S=d(162),T=d(4015);const D=z,A=D.z.object({autoUpdateThreshold:D.z.number().min(1).max(500).default(3),updateBatchSize:D.z.number().min(1).max(50).default(3),skipUpdateFloors:D.z.number().min(0).max(20).default(0),autoUpdateFrequency:D.z.number().min(1).max(100).default(1)}),I=D.z.object({enabled:D.z.boolean().default(!1),onEmptyCell:D.z.boolean().default(!0),onIndexGap:D.z.boolean().default(!0),targetTables:D.z.array(D.z.string()).default(['æ€»ç»“è¡¨','å¤§çº²è¡¨']),updateTargetTables:D.z.array(D.z.string()).default([]),emptyCheckColumns:D.z.array(D.z.string()).default([])}),M=D.z.object({id:D.z.string(),name:D.z.string().min(1).max(50),createdAt:D.z.number(),settings:A,autoTrigger:I.optional().transform(e=>I.parse(e??{}))}),U=D.z.object({presets:D.z.array(M).default([]),activePresetId:D.z.string().nullable().default(null),autoFixPresetId:D.z.string().nullable().default(null),globalAutoTriggerEnabled:D.z.boolean().default(!1),globalAutoExecuteEnabled:D.z.boolean().default(!1)}),L='acu-visualizer',P='updatePresets',F={autoUpdateThreshold:3,updateBatchSize:3,skipUpdateFloors:0,autoUpdateFrequency:1},j={enabled:!1,onEmptyCell:!0,onIndexGap:!0,targetTables:['æ€»ç»“è¡¨','å¤§çº²è¡¨'],updateTargetTables:[]};function O(){try{if('function'==typeof getVariables)return getVariables({type:'script',script_id:L})||{}}catch(e){console.warn('[ACU Presets] getVariables ä¸å¯ç”¨ï¼Œä½¿ç”¨ localStorage å›é€€')}try{const e=localStorage.getItem(`acu_${P}`);return e?JSON.parse(e):{}}catch{return{}}}function R(){const e=(0,m.ref)({presets:[],activePresetId:null,autoFixPresetId:null,globalAutoTriggerEnabled:!1,globalAutoExecuteEnabled:!1}),t=(0,m.ref)(!1),a=(0,m.computed)(()=>e.value.presets),o=(0,m.computed)(()=>{const t=e.value.activePresetId;return t&&e.value.presets.find(e=>e.id===t)||null}),n=(0,m.computed)(()=>{const t=e.value.autoFixPresetId;return t&&e.value.presets.find(e=>e.id===t)||null}),r=(0,m.computed)(()=>e.value.presets.length>0);function l(){try{const a=O()[P];if(a){const t=U.safeParse(a);t.success?(e.value=t.data,console.info('[ACU Presets] åŠ è½½é¢„è®¾æˆåŠŸï¼Œæ•°é‡:',t.data.presets.length)):(console.warn('[ACU Presets] é¢„è®¾æ•°æ®æ ¼å¼æ— æ•ˆï¼Œä½¿ç”¨é»˜è®¤å€¼'),e.value=U.parse({}))}else e.value=U.parse({});t.value=!0}catch(a){console.error('[ACU Presets] åŠ è½½é¢„è®¾å¤±è´¥:',a),e.value=U.parse({}),t.value=!0}}function i(){try{const t=O();t[P]=(0,T.klona)(e.value),function(e){try{if('function'==typeof replaceVariables)return void replaceVariables((0,T.klona)(e),{type:'script',script_id:L})}catch(e){console.warn('[ACU Presets] replaceVariables ä¸å¯ç”¨ï¼Œä½¿ç”¨ localStorage å›é€€')}try{localStorage.setItem(`acu_${P}`,JSON.stringify(e))}catch(e){console.error('[ACU Presets] ä¿å­˜åˆ° localStorage å¤±è´¥:',e)}}(t),console.info('[ACU Presets] ä¿å­˜é¢„è®¾æˆåŠŸ')}catch(e){console.error('[ACU Presets] ä¿å­˜é¢„è®¾å¤±è´¥:',e)}}function c(t){const a=t.trim();return e.value.presets.find(e=>e.name.trim()===a)||null}function s(t,a={},o={}){const n={id:`preset_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:t,createdAt:Date.now(),settings:A.parse({...F,...a}),autoTrigger:I.parse({...j,...o})};return e.value.presets.push(n),i(),console.info('[ACU Presets] åˆ›å»ºé¢„è®¾:',n.name),n}function u(t,a){const o=e.value.presets.findIndex(e=>e.id===t);if(-1===o)return console.warn('[ACU Presets] é¢„è®¾ä¸å­˜åœ¨:',t),!1;const n=e.value.presets[o];return void 0!==a.name&&(n.name=a.name),void 0!==a.settings&&(n.settings=A.parse({...n.settings,...a.settings})),void 0!==a.autoTrigger&&(n.autoTrigger=I.parse({...n.autoTrigger,...a.autoTrigger})),i(),console.info('[ACU Presets] æ›´æ–°é¢„è®¾:',n.name),!0}const d=(0,m.computed)(()=>e.value.globalAutoTriggerEnabled),p=(0,m.computed)(()=>e.value.globalAutoExecuteEnabled);return t.value||l(),{storage:e,presets:a,activePreset:o,autoFixPreset:n,hasPresets:r,isLoaded:t,globalAutoTriggerEnabled:d,globalAutoExecuteEnabled:p,loadPresets:l,savePresets:i,createPreset:s,createOrUpdatePreset:function(e,t={},a={}){const o=c(e);return o?(u(o.id,{settings:A.parse({...F,...t}),autoTrigger:I.parse({...j,...a})}),console.info('[ACU Presets] æ›´æ–°é¢„è®¾:',e),{preset:o,isNew:!1}):{preset:s(e,t,a),isNew:!0}},findPresetByName:c,updatePreset:u,deletePreset:function(t){const a=e.value.presets.findIndex(e=>e.id===t);if(-1===a)return console.warn('[ACU Presets] é¢„è®¾ä¸å­˜åœ¨:',t),!1;const o=e.value.presets[a];return e.value.presets.splice(a,1),e.value.activePresetId===t&&(e.value.activePresetId=null),e.value.autoFixPresetId===t&&(e.value.autoFixPresetId=null),i(),console.info('[ACU Presets] åˆ é™¤é¢„è®¾:',o.name),!0},setActivePreset:function(t){e.value.activePresetId=t,i()},setAutoFixPreset:function(t){e.value.autoFixPresetId=t,i()},duplicatePreset:function(t,a){const o=e.value.presets.find(e=>e.id===t);return o?s(a||`${o.name} (å‰¯æœ¬)`,(0,T.klona)(o.settings),(0,T.klona)(o.autoTrigger)):(console.warn('[ACU Presets] æºé¢„è®¾ä¸å­˜åœ¨:',t),null)},createFromCurrent:function(e,t){return s(e,t)},getPresetSettings:function(t){const a=e.value.presets.find(e=>e.id===t);return a?(0,T.klona)(a.settings):null},setGlobalAutoTrigger:function(t){e.value.globalAutoTriggerEnabled=t,t||(e.value.globalAutoExecuteEnabled=!1),i(),console.info('[ACU Presets] å…¨å±€é—®é¢˜æ£€æµ‹æç¤º:',t)},setGlobalAutoExecute:function(t){e.value.globalAutoExecuteEnabled=t,i(),console.info('[ACU Presets] å…¨å±€è‡ªåŠ¨æ‰§è¡Œä¿®å¤:',t)},UpdateSettingsSchema:A,AutoTriggerConfigSchema:I,UpdatePresetSchema:M}}let H=null,W=null,G=!1;function Y(){const e=(0,w.D)(),t=(0,k.j_)(),a=R(),o=E();let n=0;let r=!1;function l(e,t){if(!e&&!t)return!1;if(!e||!t)return!0;if(e.length!==t.length)return!0;for(let a=0;a<e.length;a++){const o=String(e[a]??'').trim(),n=String(t[a]??'').trim();if(('null'===o||'undefined'===o?'':o)!==('null'===n||'undefined'===n?'':n))return!0}return!1}async function i(e,t){const a=function(){try{const e=window.SillyTavern||window.parent?.SillyTavern||window.top?.SillyTavern;if(e?.getCurrentChatId){const t=e.getCurrentChatId();if(t)return t}if(e?.chat_metadata?.chat_id)return String(e.chat_metadata.chat_id)}catch(e){console.warn('[ACU] è·å– chatId å¤±è´¥:',e)}return'default'}();if(!a)return void console.warn('[ACU] æ— æ³•è·å– chatIdï¼Œè·³è¿‡ AI å˜æ›´å†å²ä¿å­˜');let o=0;for(const n in t){if(!n.startsWith('sheet_'))continue;const r=t[n],i=e[n];if(!r?.content||!Array.isArray(r.content))continue;const c=r.name||n.replace('sheet_',''),s=r.content[0]||[];for(let e=1;e<r.content.length;e++){const t=e-1,n=r.content[e],u=i?.content?.[e];if(l(u,n)&&u&&Array.isArray(u)){const e={index:t,key:`${c}-row-${t}`,cells:u.map((e,t)=>({colIndex:t,key:String(s[t]||`col_${t}`),value:String(e??'')}))};try{await(0,B.O)(a,c,e,'ai'),o++}catch(e){console.warn('[ACU] ä¿å­˜ AI å˜æ›´å†å²å¤±è´¥:',e)}}}}o>0&&console.info(`[ACU] å·²ä¿å­˜ ${o} è¡Œ AI å˜æ›´å†å²è®°å½•`)}function c(){const{getDB:o}=(0,v.M1)(),n=o();n?(G=!1,n.registerTableUpdateCallback&&(H=async()=>{if(G)return;if(t.isEditingOrder||e.isSaving)return;const o=e.snapshot,n=(0,v.tu)();if(n){o&&await i(o,n),e.setStagedData(n);const r=Object.keys(n).filter(e=>e.startsWith('sheet_'));t.syncNewTablesToVisibleTabs(r),e.generateDiffMap(n),t.triggerAiNotify(),a.globalAutoTriggerEnabled.value?(e.checkIntegrity(n),u()):e.clearIntegrityIssues()}},n.registerTableUpdateCallback(H),console.info('[ACU] å·²æ³¨å†Œè¡¨æ ¼æ›´æ–°å›è°ƒ')),n.registerTableFillStartCallback&&(W=()=>{if(G)return;if(e.saveLastState(),t.setAiGenerating(!0),e.diffMap&&e.diffMap.size>0)return void console.info('[ACU] ç´¯ç§¯é«˜äº®ï¼šä¿ç•™æ—§å¿«ç…§');const a=(0,v.tu)();a&&Object.keys(a).length>0&&(e.saveSnapshot(a),console.info('[ACU] å¿«ç…§å·²æ›´æ–°'))},n.registerTableFillStartCallback(W),console.info('[ACU] å·²æ³¨å†Œè¡¨æ ¼å¡«å……å›è°ƒ (é«˜äº®é€»è¾‘)'))):console.warn('[ACU] æ•°æ®åº“ API æœªå°±ç»ªï¼Œè·³è¿‡å›è°ƒæ³¨å†Œ')}function s(){G=!0;const{getDB:e}=(0,v.M1)(),t=e();if(t)try{t.registerTableUpdateCallback&&H&&('function'==typeof t.unregisterTableUpdateCallback&&t.unregisterTableUpdateCallback(H),H=null,console.info('[ACU] å·²æ³¨é”€è¡¨æ ¼æ›´æ–°å›è°ƒ')),t.registerTableFillStartCallback&&W&&('function'==typeof t.unregisterTableFillStartCallback&&t.unregisterTableFillStartCallback(W),W=null,console.info('[ACU] å·²æ³¨é”€è¡¨æ ¼å¡«å……å›è°ƒ'))}catch(e){console.warn('[ACU] æ³¨é”€å›è°ƒæ—¶å‡ºé”™:',e)}}async function u(){if(!a.globalAutoTriggerEnabled.value)return;if(!e.hasIntegrityIssues)return;const t=Date.now();if(t-n<3e4)return;if(r)return;const l=a.autoFixPreset.value;if(l&&l.autoTrigger.enabled){let a=!1;const i=e.problematicTables;if(i&&i.length>0&&(a=!0),a){n=t;const a=e.getIntegritySummary();r=!0,S.toast.info(`ğŸ”§ æ£€æµ‹åˆ°é—®é¢˜ï¼š${a}ï¼Œæ­£åœ¨è‡ªåŠ¨ä¿®å¤...`),console.info('[ACU] è‡ªåŠ¨è§¦å‘ä¿®å¤:',a);try{const e=l.autoTrigger.updateTargetTables||[],t=await o.executeWithPreset({autoUpdateThreshold:l.settings.autoUpdateThreshold,autoUpdateFrequency:l.settings.autoUpdateFrequency,updateBatchSize:l.settings.updateBatchSize,skipUpdateFloors:l.settings.skipUpdateFloors},e);t.success?S.toast.success('âœ… è‡ªåŠ¨ä¿®å¤å·²å®Œæˆ'):S.toast.warning('âš ï¸ è‡ªåŠ¨ä¿®å¤å¤±è´¥ï¼š'+(t.message||'è¯·æ‰‹åŠ¨æ›´æ–°'))}catch(e){console.error('[ACU] è‡ªåŠ¨ä¿®å¤å¤±è´¥:',e),S.toast.error('âŒ è‡ªåŠ¨ä¿®å¤å‡ºé”™')}finally{r=!1}}}}return(0,m.onMounted)(()=>{c()}),(0,m.onUnmounted)(()=>{s()}),{registerCallbacks:c,unregisterCallbacks:s,checkAndNotifyIssues:u}}var X=d(953);function q(e){const t=Object.keys(e),a=t.find(e=>e.match(/^shujuku_v\d+_allSettings_v2$/)&&parseInt(e.match(/v(\d+)/)?.[1]||'0')>=100);if(a)return a;const o=t.find(e=>e.match(/^shujuku_v\d+_allSettings_v2$/));return o||null}function K(e){const t=e.match(/shujuku_v?(\d+)/i);return t?parseInt(t[1],10):0}function J(){const e=window.parent||window;try{const t=e.SillyTavern?.getContext?.(),a=t?.extensionSettings?.__userscripts;if(a){const e=function(e,t){const a=e.filter(e=>t.test(e));return 0===a.length?null:(a.sort((e,t)=>K(t)-K(e)),a[0])}(Object.keys(a),/shujuku_v\d+__userscript_settings_v1/i);if(e&&a[e]){const t=a[e],o='string'==typeof t?JSON.parse(t):t,n=`${e.replace(/__userscript_settings_v1$/i,'')}_globalMeta_v1`;if(o[n]){const e=o[n],t='string'==typeof e?JSON.parse(e):e,a=String(t.activeIsolationCode||'');return a&&console.info(`[ACU] ä½¿ç”¨éš”ç¦»æ ‡ç­¾: "${a}" (from extensionSettings)`),a}}}let o=window.localStorage,n=q(o);if(!n&&window.parent)try{o=window.parent.localStorage,n=q(o)}catch{}if(n){const e=o.getItem(n);if(e){const t=JSON.parse(e);if(t.dataIsolationEnabled&&t.dataIsolationCode)return console.info(`[ACU] ä½¿ç”¨éš”ç¦»æ ‡ç­¾: "${t.dataIsolationCode}" (from localStorage: ${n})`),t.dataIsolationCode}}}catch(e){console.warn('[ACU] è¯»å–éš”ç¦»é…ç½®å¤±è´¥:',e)}return''}const Q='TavernDB_ACU_InternalSheetGuide',Z='orderNo';const ee=['acu_table_order','acu_reverse_tables','acu_table_heights','acu_active_tab','acu_ui_collapse','acu_pin','acu_table_styles','acu_win_config'];function te(){const e=(0,w.D)(),t=(0,f.JH)();async function a(t,a,o=-1){const r=(0,T.klona)(t);if(a&&e.pendingDeletes.size>0)for(const t in r){if('mate'===t)continue;const a=r[t];if(!a||!a.name||!a.content)continue;const o=[a.content[0]];for(let t=1;t<a.content.length;t++){const n=t-1;e.pendingDeletes.has(`${a.name}-row-${n}`)||o.push(a.content[t])}a.content=o}try{let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern);const t=J();if(e&&e.chat&&e.chat.length>0){let a=null,l=-1;if(o>=0&&o<e.chat.length)l=o,a=e.chat[l];else{for(let t=e.chat.length-1;t>=0;t--)if(!e.chat[t].is_user&&e.chat[t].TavernDB_ACU_IsolatedData){l=t,a=e.chat[t];break}if(!a)for(let t=e.chat.length-1;t>=0;t--)if(!e.chat[t].is_user){l=t,a=e.chat[t];break}}if(a){let o=t;if(a.TavernDB_ACU_IsolatedData){const e=Object.keys(a.TavernDB_ACU_IsolatedData);e.length>0&&(o=e[0])}else a.TavernDB_ACU_IsolatedData={};a.TavernDB_ACU_IsolatedData[o]||(a.TavernDB_ACU_IsolatedData[o]={independentData:{},modifiedKeys:[],updateGroupKeys:[]});const i=a.TavernDB_ACU_IsolatedData[o];i.independentData||(i.independentData={});const c=Object.keys(r).filter(e=>e.startsWith('sheet_'));c.forEach(e=>{i.independentData[e]=(0,T.klona)(r[e])});const s=i.modifiedKeys||[];if(i.modifiedKeys=[...new Set([...s,...c])],c.length>0){const t=function(e){const t={mate:{type:'chatSheets',version:1}};return Object.keys(e).forEach(a=>{if(!a.startsWith('sheet_'))return;const o=e[a];if(!o||'object'!=typeof o)return;const n=o.content,r=Array.isArray(n)&&Array.isArray(n[0])?n[0]:[null];t[a]={uid:o.uid||a,name:o.name||a,sourceData:o.sourceData||{note:'',initNode:'',insertNode:'',updateNode:'',deleteNode:''},content:[r],updateConfig:o.updateConfig||{uiSentinel:-1,contextDepth:-1,updateFrequency:-1,batchSize:-1,skipFloors:-1},exportConfig:o.exportConfig||{enabled:!1,splitByRow:!1,entryName:o.name||a,entryType:'constant',keywords:'',preventRecursion:!0,injectionTemplate:''},[Z]:o[Z]??void 0}}),t}(r);Object.keys(t).some(e=>e.startsWith('sheet_'))&&function(e,t,a){if(!e?.chat||0===e.chat.length)return console.info('[ACU] æ— æ³•æ›´æ–°æŒ‡å¯¼è¡¨ï¼šèŠå¤©è®°å½•ä¸ºç©º'),!1;const o=e.chat[0];if(!o)return console.info('[ACU] æ— æ³•æ›´æ–°æŒ‡å¯¼è¡¨ï¼šchat[0] ä¸å­˜åœ¨'),!1;try{let e=null;const n=o[Q];if(n)if('string'==typeof n)try{e=JSON.parse(n)}catch{e=null}else'object'==typeof n&&(e=n);return e&&'object'==typeof e||(e={version:1,tags:{}}),e.tags&&'object'==typeof e.tags||(e.tags={}),e.version=1,e.tags[t]={data:a,updatedAt:Date.now(),reason:'vue_visualizer_save'},o[Q]=e,console.info(`[ACU] å·²æ›´æ–° chat[0] æŒ‡å¯¼è¡¨ (tag=${t||'æ— æ ‡ç­¾'}, tables=${Object.keys(a).filter(e=>e.startsWith('sheet_')).length})`),!0}catch(e){return console.warn('[ACU] æ›´æ–°æŒ‡å¯¼è¡¨å¤±è´¥:',e),!1}}(e,o,t)}if(e.saveChat)return await e.saveChat(),await n(),{...r,_savedToFloor:l}}}}catch(e){throw console.error('[ACU] Core save error:',e),e}return await n(),r}function o(e,t,a){if(!e||!e.chat)return-1;for(let o=e.chat.length-1;o>=0;o--){const n=e.chat[o];if(!n.is_user){if(n.TavernDB_ACU_IsolatedData&&'object'==typeof n.TavernDB_ACU_IsolatedData){const e=n.TavernDB_ACU_IsolatedData[a];if(e&&e.independentData&&e.independentData[t])return o;if(!a&&n.TavernDB_ACU_IsolatedData['']&&n.TavernDB_ACU_IsolatedData[''].independentData&&n.TavernDB_ACU_IsolatedData[''].independentData[t])return o}if(n.TavernDB_ACU_IndependentData&&n.TavernDB_ACU_IndependentData[t]){if(a&&n.TavernDB_ACU_Identity&&n.TavernDB_ACU_Identity!==a)continue;return o}}}return-1}async function n(){const e=(0,v.M1)().getDB();if(e&&e.syncWorldbookEntries)try{await e.syncWorldbookEntries({createIfNeeded:!0})}catch(e){console.warn('[ACU] Worldbook sync failed after save:',e)}else console.warn('[ACU] syncWorldbookEntries API not found, skipping sync.')}let r=null;function l(a=5e3){r&&(r(),r=null),r=(0,X.Th)(()=>e.tables,async()=>{if(e.hasChanges&&t.config.autoSave)try{console.info('[ACU] è‡ªåŠ¨ä¿å­˜è§¦å‘...'),await e.saveToDatabase(),console.info('[ACU] è‡ªåŠ¨ä¿å­˜å®Œæˆ')}catch(e){console.error('[ACU] è‡ªåŠ¨ä¿å­˜å¤±è´¥:',e)}},{debounce:a,deep:!0}),console.info(`[ACU] è‡ªåŠ¨ä¿å­˜å·²å¯ç”¨ï¼Œé˜²æŠ–å»¶è¿Ÿ: ${a}ms`)}function i(){console.info('[ACU] æ£€æŸ¥æ—§ç‰ˆæœ¬æ•°æ®...');let e=!1;ee.forEach(t=>{try{const a=localStorage.getItem(t);if(a){console.info(`[ACU] å‘ç°æ—§ç‰ˆæœ¬æ•°æ®: ${t}`),e=!0;try{const e=JSON.parse(a),t=Array.isArray(e)?'array':typeof e;console.info(`[ACU]   - æ•°æ®ç±»å‹: ${t}`)}catch{console.info('[ACU]   - æ•°æ®ç±»å‹: string')}}}catch(e){console.warn(`[ACU] è¯»å– ${t} å¤±è´¥:`,e)}});try{localStorage.getItem('acu_v5_isolation_settings')&&(console.info('[ACU] å‘ç° V5 éš”ç¦»è®¾ç½®æ•°æ®'),e=!0)}catch{}e||console.info('[ACU] æœªå‘ç°æ—§ç‰ˆæœ¬æ•°æ®')}return{saveToDatabase:async function(t=null,r=!1,l=!1,i=-1){if(e.isSaving)return console.warn('[ACU] Save already in progress'),!1;let c=e.getStagedData();if(c||(c=t||(0,v.tu)()),!c)return console.warn('[ACU] æ— æ•°æ®å¯ä¿å­˜'),!1;const{$}=(0,v.M1)(),s=$?.('#acu-btn-save-global, #acu-parent-container #acu-btn-save-global');let u='';try{e.isSaving=!0,!r&&s?.length&&(u=s.html(),s.html('<i class="fa-solid fa-spinner fa-spin"></i>').prop('disabled',!0));let t=null;if(i>=0)console.info('[ACU] æ‰§è¡Œå…¨é‡ä¿å­˜ (å¦å­˜ä¸ºæ¨¡å¼)...'),t=await a(c,l,i);else{console.info('[ACU] æ‰§è¡Œå¢é‡ä¿å­˜ (é»˜è®¤æ¨¡å¼)...');const a=e.getModifiedTableIds();if(0===a.length)return console.info('[ACU] æ— å˜æ›´ï¼Œè·³è¿‡ä¿å­˜'),!0;t=await async function(t,a,r){if(0===r.length)return null;console.info('[ACU] å¼€å§‹å¢é‡ä¿å­˜ï¼Œæ¶‰åŠè¡¨æ ¼:',r);const l=(0,T.klona)(t);if(a&&e.pendingDeletes.size>0)for(const t of r){if('mate'===t)continue;const a=l[t];if(!a||!a.name||!a.content)continue;const o=[a.content[0]];let n=!1;for(let t=1;t<a.content.length;t++){const r=t-1;e.pendingDeletes.has(`${a.name}-row-${r}`)?n=!0:o.push(a.content[t])}n&&(a.content=o)}try{let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern);const t=J(),a=new Map,i=new Set;for(const n of r){const r=o(e,n,t);-1!==r?(a.has(r)||a.set(r,new Set),a.get(r).add(n)):i.add(n)}if(i.size>0){let t=-1;for(let a=e.chat.length-1;a>=0;a--)if(!e.chat[a].is_user&&e.chat[a].TavernDB_ACU_IsolatedData){t=a;break}if(-1===t)for(let a=e.chat.length-1;a>=0;a--)if(!e.chat[a].is_user){t=a;break}-1!==t?(a.has(t)||a.set(t,new Set),i.forEach(e=>a.get(t).add(e)),console.info(`[ACU] æ–°å¢è¡¨æ ¼ ${Array.from(i).join(', ')} å°†å­˜å…¥æ¥¼å±‚ ${t}`)):console.warn('[ACU] æ— æ³•æ‰¾åˆ°ä»»ä½• AI æ¥¼å±‚æ¥å­˜æ”¾æ–°è¡¨æ ¼')}let c=!1;for(const[o,n]of a.entries()){const a=e.chat[o];if(!a)continue;let r=a.TavernDB_ACU_IsolatedData;if('string'==typeof r)try{r=JSON.parse(r)}catch{r={}}r&&'object'==typeof r||(r={});const i=t||'';r[i]||(r[i]={independentData:{},modifiedKeys:[],updateGroupKeys:[]});const s=r[i];s.independentData||(s.independentData={});const u=Array.from(n);u.forEach(e=>{l[e]&&(s.independentData[e]=(0,T.klona)(l[e]))});const d=s.modifiedKeys||[];s.modifiedKeys=[...new Set([...d,...u])],a.TavernDB_ACU_IsolatedData=r,t&&(a.TavernDB_ACU_Identity=t),a.TavernDB_ACU_IndependentData=s.independentData,a.TavernDB_ACU_ModifiedKeys=s.modifiedKeys,a.TavernDB_ACU_UpdateGroupKeys=s.updateGroupKeys,c=!0,console.info(`[ACU] å·²æ›´æ–°æ¥¼å±‚ ${o}ï¼Œæ¶‰åŠè¡¨æ ¼: ${u.join(', ')}`)}if(c&&e.saveChat)return await e.saveChat(),await n(),l}catch(e){throw console.error('[ACU] Incremental save error:',e),e}return await n(),l}(c,l,a)}if(!r){const a=t?._savedToFloor;void 0!==a?S.toast.success(`å·²æ›´æ–°è‡³ç¬¬ ${a} å±‚ (è¦†ç›–æ—§æ•°æ®)`):t&&S.toast.success('ä¿å­˜æˆåŠŸ');$(window.parent?.document||document).find('.acu-highlight-changed').removeClass('acu-highlight-changed'),s?.removeClass('acu-save-alert'),e.clearChanges(l),e.stagedData=null,t&&e.saveSnapshot(t)}return await n(),!0}catch(e){return console.error('[ACU] Save failed:',e),r||S.toast.error('ä¿å­˜å¤±è´¥: '+e.message),!1}finally{setTimeout(()=>{e.isSaving=!1,!r&&s?.length&&s.html(u||'<i class="fa-solid fa-save"></i>').prop('disabled',!1)},100)}},syncWorldbook:n,saveSnapshot:function(t){e.saveSnapshot(t)},loadSnapshot:function(){return e.loadSnapshot()},clearSnapshot:function(){e.clearSnapshot()},purgeFloorRange:async function(t,a){if(e.isSaving)return;let o=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);if(!o&&window.top&&window.top.SillyTavern&&(o=window.top.SillyTavern),!o||!o.chat)return void S.toast.error('æ— æ³•è¿æ¥åˆ° SillyTavern æ ¸å¿ƒæ•°æ®');const r=o.chat.length-1;if(t=Math.max(0,t),a=Math.min(r,a),isNaN(t)||isNaN(a)||t>a)S.toast.warning('æ— æ•ˆçš„æ¥¼å±‚èŒƒå›´');else{e.isSaving=!0;try{console.log(`[ACU-Purge] å¼€å§‹å¼ºåŠ›æ¸…æ´—æ¥¼å±‚èŒƒå›´: ${t} - ${a}`);let r=0;const l=['TavernDB_ACU_Data','TavernDB_ACU_SummaryData','TavernDB_ACU_IndependentData','TavernDB_ACU_Identity','TavernDB_ACU_IsolatedData','TavernDB_ACU_ModifiedKeys','TavernDB_ACU_UpdateGroupKeys'];for(let e=t;e<=a;e++){const t=o.chat[e];if(!t)continue;let a=!1;for(const e of l)Object.prototype.hasOwnProperty.call(t,e)&&(delete t[e],a=!0);a&&r++}if(r>0){o.saveChat&&await o.saveChat(),await n();const t=(0,v.tu)();t?e.saveSnapshot(t):e.clearSnapshot(),e.clearChanges(!0),S.toast.success(`å·²å¼ºåŠ›æ¸…é™¤ ${r} ä¸ªæ¥¼å±‚çš„æ•°æ®`)}else S.toast.info('æŒ‡å®šèŒƒå›´å†…æ²¡æœ‰å¯æ¸…é™¤çš„æ•°æ®')}catch(e){console.error('[ACU] Purge Error:',e),S.toast.error('æ¸…é™¤å¤±è´¥: '+e.message)}finally{e.isSaving=!1}}},purgeTableDataByRange:async function(t,a,o){const r=Array.isArray(t)?[...new Set(t.filter(e=>'string'==typeof e&&e.startsWith('sheet_')))]:[];if(0===r.length)return{changed:!1,changedCount:0};let l=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);if(!l&&window.top&&window.top.SillyTavern&&(l=window.top.SillyTavern),!l?.chat||0===l.chat.length)return S.toast.error('æ— æ³•è¿æ¥åˆ° SillyTavern æ ¸å¿ƒæ•°æ®'),{changed:!1,changedCount:0};const i=l.chat.length-1;if(a=Math.max(0,a),o=Math.min(i,o),isNaN(a)||isNaN(o)||a>o)return S.toast.warning('æ— æ•ˆçš„æ¥¼å±‚èŒƒå›´'),{changed:!1,changedCount:0};if(e.isSaving)return S.toast.warning('ä¿å­˜æ“ä½œè¿›è¡Œä¸­ï¼Œè¯·ç¨åå†è¯•'),{changed:!1,changedCount:0};e.isSaving=!0;const c=(e,t)=>{if(!Array.isArray(e)||0===e.length)return{arr:e,changed:!1};const a=e.filter(e=>e!==t);return{arr:a,changed:a.length!==e.length}};try{console.info(`[ACU-AdvancedPurge] å¼€å§‹æ¸…é™¤è¡¨æ ¼ [${r.join(', ')}] åœ¨æ¥¼å±‚ ${a}-${o} çš„æ•°æ®`);let t=!1,i=0;for(let e=a;e<=o;e++){const a=l.chat[e];if(!a||a.is_user)continue;let o=!1;a.TavernDB_ACU_IsolatedData&&'object'==typeof a.TavernDB_ACU_IsolatedData&&(Object.keys(a.TavernDB_ACU_IsolatedData).forEach(e=>{const t=a.TavernDB_ACU_IsolatedData[e];t&&'object'==typeof t&&(t.independentData&&'object'==typeof t.independentData&&r.forEach(e=>{t.independentData[e]&&(delete t.independentData[e],o=!0)}),Array.isArray(t.modifiedKeys)&&r.forEach(e=>{const a=c(t.modifiedKeys,e);a.changed&&(t.modifiedKeys=a.arr,o=!0)}),Array.isArray(t.updateGroupKeys)&&r.forEach(e=>{const a=c(t.updateGroupKeys,e);a.changed&&(t.updateGroupKeys=a.arr,o=!0)}),!t.independentData||0!==Object.keys(t.independentData).length||t.modifiedKeys&&0!==t.modifiedKeys.length||t.updateGroupKeys&&0!==t.updateGroupKeys.length||(delete a.TavernDB_ACU_IsolatedData[e],o=!0))}),0===Object.keys(a.TavernDB_ACU_IsolatedData).length&&(delete a.TavernDB_ACU_IsolatedData,o=!0)),a.TavernDB_ACU_IndependentData&&'object'==typeof a.TavernDB_ACU_IndependentData&&r.forEach(e=>{a.TavernDB_ACU_IndependentData[e]&&(delete a.TavernDB_ACU_IndependentData[e],o=!0)}),Array.isArray(a.TavernDB_ACU_ModifiedKeys)&&r.forEach(e=>{const t=c(a.TavernDB_ACU_ModifiedKeys,e);t.changed&&(a.TavernDB_ACU_ModifiedKeys=t.arr,o=!0)}),Array.isArray(a.TavernDB_ACU_UpdateGroupKeys)&&r.forEach(e=>{const t=c(a.TavernDB_ACU_UpdateGroupKeys,e);t.changed&&(a.TavernDB_ACU_UpdateGroupKeys=t.arr,o=!0)}),a.TavernDB_ACU_Data&&'object'==typeof a.TavernDB_ACU_Data&&r.forEach(e=>{a.TavernDB_ACU_Data[e]&&(delete a.TavernDB_ACU_Data[e],o=!0)}),a.TavernDB_ACU_SummaryData&&'object'==typeof a.TavernDB_ACU_SummaryData&&r.forEach(e=>{a.TavernDB_ACU_SummaryData[e]&&(delete a.TavernDB_ACU_SummaryData[e],o=!0)}),o&&(t=!0,i++)}if(t){l.saveChat&&await l.saveChat(),await n();const t=(0,v.tu)();t?e.saveSnapshot(t):e.clearSnapshot(),e.clearChanges(!0),console.info(`[ACU-AdvancedPurge] æ¸…é™¤å®Œæˆï¼Œå½±å“ ${i} ä¸ªæ¥¼å±‚`)}return{changed:t,changedCount:i}}catch(e){throw console.error('[ACU-AdvancedPurge] æ¸…é™¤å¤±è´¥:',e),e}finally{e.isSaving=!1}},setupAutoSave:l,stopAutoSave:function(){r&&(r(),r=null,console.info('[ACU] è‡ªåŠ¨ä¿å­˜å·²åœæ­¢'))},migrateLegacyData:i,initDataPersistence:async function(){console.info('[ACU] åˆå§‹åŒ–æ•°æ®æŒä¹…åŒ–...'),i(),await e.loadFromDatabase(),t.config.autoSave&&l(t.config.autoSaveDelay||5e3),console.info('[ACU] æ•°æ®æŒä¹…åŒ–åˆå§‹åŒ–å®Œæˆ')},getTableData:v.tu,dataStore:e}}void 0===window.__acu_hidden_prompt&&(window.__acu_hidden_prompt='');const ae=[];let oe=!1;function ne(e){window.__acu_hidden_prompt=e,console.info('[ACU] éšè—æç¤ºè¯å·²è®¾ç½®:',e.substring(0,50))}function re(){return window.__acu_hidden_prompt||''}function le(){ie();const e=window.parent.document,t=e.getElementById('send_textarea'),a=e.getElementById('send_but');if(!t||!a)return console.warn('[ACU] æœªæ‰¾åˆ°è¾“å…¥æ¡†æˆ–å‘é€æŒ‰é’®ï¼Œ1ç§’åé‡è¯•'),void setTimeout(le,1e3);const o=e=>{(async e=>{if(oe)return;const o=re();if(o.trim()){e.preventDefault(),e.stopImmediatePropagation(),oe=!0;try{const e=t.value.trim(),n=`${o}`,r=e?`${n}\n${e}`:n;console.info('[ACU] æ‹¼æ¥æ¶ˆæ¯:',r.substring(0,80));const l=window.parent;if(!l.TavernHelper||!l.TavernHelper.triggerSlash)throw console.error('[ACU] TavernHelper.triggerSlash ä¸å¯ç”¨'),new Error('TavernHelper API unavailable');await l.TavernHelper.triggerSlash(`/send as=user ${r}`),console.info('[ACU] âœ“ ç”¨æˆ·æ¶ˆæ¯å·²åˆ›å»º'),t.value='',t.dispatchEvent(new Event('input',{bubbles:!0})),await new Promise(e=>setTimeout(e,50)),a.click(),console.info('[ACU] âœ“ å·²è§¦å‘ç”Ÿæˆ')}catch(e){console.error('[ACU] å‘é€å¤±è´¥:',e),S.toast.error('éšè—æç¤ºè¯å‘é€å¤±è´¥')}finally{setTimeout(()=>{oe=!1},100)}}})(e)};a.addEventListener('click',o,{capture:!0}),ae.push(()=>a.removeEventListener('click',o,{capture:!0}));const n=e=>{if('Enter'===e.key&&!e.shiftKey){if(!re().trim())return;e.preventDefault(),e.stopImmediatePropagation(),a.click()}};t.addEventListener('keydown',n,{capture:!0}),ae.push(()=>t.removeEventListener('keydown',n,{capture:!0})),console.info('[ACU] å‘é€æ‹¦æˆªå·²è®¾ç½®')}function ie(){ae.forEach(e=>e()),ae.length=0}function ce(e,t='\n'){const a=window.parent.document.getElementById('send_textarea'),o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(a){const n=a.value||'',r=n?n+t+e:e;a.value=r,a.dispatchEvent(new Event('input',{bubbles:!0})),o||(a.focus(),a.setSelectionRange(r.length,r.length)),console.info('[ACU] æç¤ºè¯å·²è¿½åŠ åˆ°è¾“å…¥æ¡†')}else console.warn('[ACU] æœªæ‰¾åˆ°è¾“å…¥æ¡† #send_textarea')}function se(){return{setHiddenPrompt:ne,getHiddenPrompt:re,setupSendIntercept:le,cleanupSendIntercept:ie,appendPromptToInput:ce}}function ue(){const{saveToDatabase:e,getTableData:t,saveSnapshot:a,loadSnapshot:o}=te(),n=(0,w.D)();return{insertRow:async(a,o)=>{let r=n.getStagedData();if(r||(r=t()),!r)return console.warn('[ACU insertRow] æ— æ³•è·å–æ•°æ®'),void S.toast.error('æ— æ³•è·å–æ•°æ®');const l=r[a];if(!l?.content)return console.warn('[ACU insertRow] æœªæ‰¾åˆ°è¡¨æ ¼:',a,'å¯ç”¨è¡¨æ ¼:',Object.keys(r)),void S.toast.error('æœªæ‰¾åˆ°ç›®æ ‡è¡¨æ ¼');const i=l.content,c=i[0]?i[0].length:2,s=new Array(c).fill('');c>0&&(s[0]=String(i.length)),i.splice(o+2,0,s),S.toast.info('æ­£åœ¨æ’å…¥æ–°è¡Œ...'),n.setStagedData(r);const u=l.name||a.replace('sheet_',''),d=o+1,p=n.getRowKey(u,d);n.manualDiffMap.add(p),console.info(`[ACU insertRow] å·²æ·»åŠ å˜æ›´æ ‡è®°: ${p}`),n.saveLastState();await e(r,!1,!0)&&S.toast.success('æ–°è¡Œå·²æ’å…¥')},copyContent:e=>{const t=window.parent||window;if(t.TavernHelper&&t.TavernHelper.triggerSlash)try{const a=e.replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\n/g,'\\n');return t.TavernHelper.triggerSlash(`/clipboard-set "${a}"`),void S.toast.success('å·²å¤åˆ¶')}catch(e){console.warn('é…’é¦†å¤åˆ¶æ¥å£å¤±è´¥',e)}const a=document.createElement('textarea');a.value=e,a.style.position='fixed',a.style.left='-9999px',document.body.appendChild(a),a.select();try{document.execCommand('copy'),S.toast.success('å·²å¤åˆ¶')}catch(t){prompt('è¯·æ‰‹åŠ¨å¤åˆ¶:',e)}document.body.removeChild(a)},toggleDelete:(e,t,a)=>{if(!a||!a.length){const{$}=(0,v.M1)();if($){const o=$(window.parent.document).find(`.acu-editable-title[data-tname="${e}"][data-row="${t}"]`);o.length&&(a=o.closest('.acu-data-card'))}}if(!a||!a.find)return void console.warn('[ACU] toggleDelete failed: card element not found',{tableName:e,rowIdx:t});const o=`${e}-row-${t}`;n.isPendingDelete(o)?(n.toggleDelete(o),a.find('.acu-badge-pending').remove(),S.toast.success('å·²å–æ¶ˆåˆ é™¤')):(n.toggleDelete(o),0===a.find('.acu-badge-pending').length&&a.append('<div class="acu-badge-pending">å¾…åˆ é™¤</div>'),S.toast.warning('æ•´è¡Œå·²æ ‡è®°ä¸ºåˆ é™¤'))},setInput:e=>{ce(e,' ')},editCell:(e,r,l)=>{const{tableKey:i,rowIdx:c,colIdx:s,$cell:u}=e,{$}=(0,v.M1)(),d=l||document;let p=n.getStagedData();if(p||(p=t()),p||(p=o()),p){const e=p[i];e?.content&&e.content[c+1]&&(e.content[c+1][s]=r,n.setStagedData(p),a(p))}u.attr('data-val',encodeURIComponent(r)),u.data('val',encodeURIComponent(r));let m=u;u.hasClass('acu-grid-item')?m=u.find('.acu-grid-value'):u.hasClass('acu-full-item')&&(m=u.find('.acu-full-value'));const f=(0,v.n2)(r);f&&!u.hasClass('acu-editable-title')?m.html(`<span class="acu-badge ${f}">${r}</span>`):m.text(r),m.addClass('acu-highlight-changed'),u.hasClass('acu-editable-title')&&u.addClass('acu-highlight-changed'),n.updateCell(i,c,s,r);$(d).find('#acu-btn-save-global').addClass('acu-save-alert'),S.toast.info('ä¿®æ”¹å·²æš‚å­˜')}}}var de=d(3981);const pe=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;function me(){if('undefined'!=typeof window){if(window.innerWidth<=768)return!0;if(window.innerWidth>1024)return!1}return pe.test(navigator.userAgent)}function fe(){const e=(0,m.ref)(me());if('undefined'!=typeof window){const t=()=>{e.value=me()};window.addEventListener('resize',t),(0,m.onUnmounted)(()=>{window.removeEventListener('resize',t)})}return{isMobile:e,isTouchDevice:(0,m.computed)(()=>'ontouchstart'in window||navigator.maxTouchPoints>0)}}function ge(e,t={}){const{initialX:a=100,initialY:o=100,edgePadding:n=10,elementWidth:r=50,onPositionChange:l,useParentWindow:i=!1}=t,c=()=>i&&window.parent&&window.parent!==window?window.parent:window,s=()=>{const e=c();return{width:e.innerWidth,height:e.innerHeight}},u=(0,m.ref)(!1);let d=0,p=0;const f=(0,m.computed)(()=>{if(i)try{return c().document}catch{return document}return document}),{x:g,y:v,isDragging:b}=(0,de.PMY)(e,{initialValue:{x:a,y:o},draggingElement:f,onStart(e,t){u.value=!1,d=t.clientX,p=t.clientY},onMove(e,t){const a=t.clientX,o=t.clientY,n=Math.abs(a-d),r=Math.abs(o-p);(n>5||r>5)&&(u.value=!0)},onEnd(){if(u.value){const{width:e,height:t}=s();g.value<n&&(g.value=n),g.value>e-r-n&&(g.value=e-r-n),v.value<n&&(v.value=n),v.value>t-r-n&&(v.value=t-r-n),l?.(g.value,v.value)}}}),h=(0,m.computed)(()=>({left:`${g.value}px`,top:`${v.value}px`,cursor:b.value?'grabbing':'grab'}));return{x:g,y:v,isDragging:b,wasDragging:u,style:h,reset:()=>{g.value=a,v.value=o,l?.(g.value,v.value)}}}d(8);const ve={clearTableOnSwipe:!0};function be(){const e=window.parent||window,t=e.SillyTavern||e.top?.SillyTavern;return t&&'function'==typeof t.getContext?t.getContext():null}function he(){const e=(0,w.D)(),t=(0,f.JH)(),a=(0,m.ref)(!1),o=(0,m.ref)({...ve}),n=[];async function r(t){try{return await e.purgeFloorRange(t,t),console.info(`[ACU Swipe] å·²æ¸…é™¤ç¬¬ ${t} æ¥¼çš„è¡¨æ ¼æ•°æ®`),!0}catch(e){return console.error('[ACU Swipe] æ¸…é™¤æ¥¼å±‚æ•°æ®å¤±è´¥:',e),!1}}function l(e){if(e.is_user)return!1;return(e.swipe_id??0)>=(e.swipes?.length??1)-1}function i(e){const t=e.TavernDB_ACU_IsolatedData;return!(!t||'object'!=typeof t)&&Object.keys(t).length>0}async function c(){if(console.info('[ACU Swipe] handleSwipeClearOnly å¼€å§‹æ‰§è¡Œ'),a.value)return void console.info('[ACU Swipe] æ­£åœ¨å¤„ç†ä¸­ï¼Œè·³è¿‡');const e=be();if(!e?.chat?.length)return void console.warn('[ACU Swipe] SillyTavern context.chat ä¸å¯ç”¨');const t=e.chat.length-1,o=e.chat[t];if(console.info('[ACU Swipe] æ£€æŸ¥æœ€åä¸€æ¥¼:',{index:t,is_user:o.is_user,swipe_id:o.swipe_id,swipes_length:o.swipes?.length}),!l(o))return void console.info('[ACU Swipe] æŸ¥çœ‹å†å² swipeï¼Œè·³è¿‡æ¸…é™¤');const n=i(o);if(console.info('[ACU Swipe] æœ€åä¸€æ¥¼æ˜¯å¦æœ‰ ACU æ•°æ®:',n),n){a.value=!0;try{console.info('[ACU Swipe] å¼€å§‹æ¸…é™¤ç¬¬',t,'æ¥¼çš„è¡¨æ ¼æ•°æ®');await r(t)&&S.toast.info('Swipe: å·²æ¸…é™¤æœ€åä¸€æ¥¼è¡¨æ ¼æ•°æ®')}finally{a.value=!1}}else console.info('[ACU Swipe] æœ€åä¸€æ¥¼æ—  ACU æ•°æ®ï¼Œè·³è¿‡æ¸…é™¤')}async function s(e){const a=t.config.clearTableOnSwipe??o.value.clearTableOnSwipe;console.info('[ACU Swipe] handleSwipe è°ƒç”¨',{clearEnabled:a}),a?(console.info('[ACU Swipe] æ‰§è¡Œæ¸…é™¤è¡¨æ ¼'),await c()):console.info('[ACU Swipe] åŠŸèƒ½æœªå¯ç”¨ï¼Œè·³è¿‡')}function u(){n.forEach(e=>e()),n.length=0,console.info('[ACU Swipe] Swipe å¢å¼ºåŠŸèƒ½å·²æ¸…ç†')}return(0,m.onUnmounted)(()=>{u()}),{isProcessing:a,config:o,updateConfig:function(e){o.value={...o.value,...e},console.info('[ACU Swipe] é…ç½®å·²æ›´æ–°:',o.value)},getConfig:function(){return{...o.value}},clearFloorData:r,handleSwipe:s,handleSwipeClearOnly:c,willTriggerNewGeneration:l,init:function(){!function(){const{$}=(0,v.M1)();if(!$)return void console.warn('[ACU Swipe] jQuery ä¸å¯ç”¨ï¼Œæ— æ³•åˆå§‹åŒ–æ¡Œé¢ç«¯ç›‘å¬');const e=window.parent.document,a=async e=>{const a=e.target.closest('.swipe_right');if(!a)return;if(e.__acu_processed)return;if(!(t.config.clearTableOnSwipe??o.value.clearTableOnSwipe))return;console.info('[ACU Swipe] æ‹¦æˆª swipe_right ç‚¹å‡»ï¼Œå‡†å¤‡æ¸…ç†æ•°æ®'),e.preventDefault(),e.stopImmediatePropagation();try{await s()}catch(e){console.error('[ACU Swipe] æ¸…ç†è¿‡ç¨‹å‡ºé”™ï¼Œä»ç»§ç»­è§¦å‘ Swipe',e)}console.info('[ACU Swipe] æ•°æ®æ¸…ç†å®Œæˆï¼Œé‡æ–°è§¦å‘ Swipe');const n=new MouseEvent('click',{bubbles:!0,cancelable:!0,view:window.parent});n.__acu_processed=!0,a.dispatchEvent(n)};e.addEventListener('click',a,{capture:!0}),n.push(()=>{e.removeEventListener('click',a,{capture:!0}),console.info('[ACU Swipe] æ¡Œé¢ç«¯ç›‘å¬å·²æ¸…ç†')}),console.info('[ACU Swipe] æ¡Œé¢ç«¯ç›‘å¬å·²åˆå§‹åŒ– (æ•è·æ¨¡å¼)')}(),function(){let e=0;const{stop:a}=eventMakeFirst(tavern_events.MESSAGE_SWIPED,errorCatched(async a=>{if(!(t.config.clearTableOnSwipe??o.value.clearTableOnSwipe))return;const n=Date.now();if(n-e<500)return void console.info('[ACU Swipe] åˆšå¤„ç†è¿‡ï¼Œè·³è¿‡é‡å¤è§¦å‘');e=n,console.info('[ACU Swipe] MESSAGE_SWIPED äº‹ä»¶è§¦å‘ï¼Œmessage_id:',a);const r=be();if(!r?.chat?.length)return;const s=r.chat.length-1,u=r.chat[s];l(u)?i(u)?(console.info('[ACU Swipe] é€šè¿‡äº‹ä»¶ç›‘å¬æ‰§è¡Œæ¸…ç†...'),await c()):console.info('[ACU Swipe] æœ€åä¸€æ¥¼æ—  ACU æ•°æ®ï¼Œè·³è¿‡æ¸…é™¤'):console.info('[ACU Swipe] æŸ¥çœ‹å†å² swipeï¼Œè·³è¿‡æ¸…é™¤')}));n.push(()=>{a(),console.info('[ACU Swipe] é…’é¦†äº‹ä»¶ç›‘å¬å·²æ¸…ç†')}),console.info('[ACU Swipe] é…’é¦†äº‹ä»¶ç›‘å¬å·²åˆå§‹åŒ– (MESSAGE_SWIPED)')}(),console.info('[ACU Swipe] Swipe å¢å¼ºåŠŸèƒ½å·²åˆå§‹åŒ–')},cleanup:u}}var xe=d(2158),ye=d(1037);function we(e){const t=e.match(/shujuku_v?(\d+)/i);return t?parseInt(t[1],10):0}function ke(e,t){const a=e.filter(e=>t.test(e));return 0===a.length?null:(a.sort((e,t)=>we(t)-we(e)),a[0])}let Ce=null;function Ne(e){const t=e.toLowerCase();return e.includes('æ€»ç»“')||e.includes('å¤§çº²')||t.includes('summary')||t.includes('outline')}function Ve(e,t,a,o){const n=a.dataIsolationEnabled?a.dataIsolationCode:'';for(let r=t.length-1;r>=0;r--){const l=t[r];if(l.is_user)continue;let i=!1;const c=l.TavernDB_ACU_IsolatedData;if(c&&c[n]){const t=c[n],a=t.updateGroupKeys||[],o=t.modifiedKeys||[],r=t.independentData||{};a.length>0&&o.length>0?i=a.includes(e):(o.includes(e)||r[e])&&(i=!0)}if(!i){const t=l.TavernDB_ACU_Identity;let n=!1;if(n=a.dataIsolationEnabled?t===a.dataIsolationCode:!t,n){const t=l.TavernDB_ACU_ModifiedKeys||[],a=l.TavernDB_ACU_UpdateGroupKeys||[];a.length>0&&t.length>0?i=a.includes(e):(t.includes(e)||l.TavernDB_ACU_IndependentData&&l.TavernDB_ACU_IndependentData[e]||o&&l.TavernDB_ACU_SummaryData&&l.TavernDB_ACU_SummaryData[e]||!o&&l.TavernDB_ACU_Data&&l.TavernDB_ACU_Data[e])&&(i=!0)}}if(i){return{aiFloor:t.slice(0,r+1).filter(e=>!e.is_user).length,chatIndex:r,hasHistory:!0}}}return{aiFloor:0,chatIndex:-1,hasHistory:!1}}const Ee=(0,m.ref)([]),Be=(0,m.ref)(!1),Se=(0,m.ref)(null),Te=(0,m.ref)(0),De=(0,m.ref)(0);function Ae(){return{statusList:(0,m.computed)(()=>Ee.value),isLoading:(0,m.computed)(()=>Be.value),lastRefreshTime:(0,m.computed)(()=>Se.value),currentTotalAiFloors:(0,m.computed)(()=>Te.value),currentTotalFloors:(0,m.computed)(()=>De.value),refresh:async function(){if(Be.value)return console.info('[ACU] è¡¨æ ¼æ›´æ–°çŠ¶æ€åˆ·æ–°è¿›è¡Œä¸­ï¼Œè·³è¿‡é‡å¤è¯·æ±‚'),Ee.value;Be.value=!0;const e=Date.now();try{const e=(0,v.M1)().getDB(),t=e?.exportTableAsJson?.();if(!t)return console.warn('[ACU] æ— æ³•è·å–è¡¨æ ¼æ•°æ®'),Ee.value=[],[];const a=function(){const e=window.parent||window;try{const t=e.SillyTavern?.getContext?.(),a=t?.extensionSettings?.__userscripts;if(a){const e=ke(Object.keys(a),/shujuku_v\d+__userscript_settings_v1/i);if(e&&a[e]){const t=a[e],o='string'==typeof t?JSON.parse(t):t,n=e.replace(/__userscript_settings_v1$/i,''),r=`${n}_globalMeta_v1`;let l='';if(o[r]){const e=o[r],t='string'==typeof e?JSON.parse(e):e;l=String(t.activeIsolationCode||'')}const i=`${n}_profile_v1__${encodeURIComponent(l)||'__default__'}__settings`;let c={};if(o[i]){const e=o[i];c='string'==typeof e?JSON.parse(e):e}return Ce={versionPrefix:n,isolationCode:l,userscripts:o},{dataIsolationEnabled:''!==l,dataIsolationCode:l,autoUpdateFrequency:Number(c.autoUpdateFrequency)||2,skipUpdateFloors:Number(c.skipUpdateFloors)||0}}}const o=e.localStorage;if(o){const e=ke(Object.keys(o),/shujuku.*settings/i);if(e){const t=JSON.parse(o.getItem(e)||'{}');return{dataIsolationEnabled:!!t.dataIsolationEnabled,dataIsolationCode:String(t.dataIsolationCode||''),autoUpdateFrequency:Number(t.autoUpdateFrequency)||2,skipUpdateFloors:Number(t.skipUpdateFloors)||0}}}}catch(e){console.warn('[ACU] è¯»å–å…¨å±€è®¾ç½®å¤±è´¥:',e)}return Ce=null,{dataIsolationEnabled:!1,dataIsolationCode:'',autoUpdateFrequency:2,skipUpdateFloors:0}}();let o=null;o='function'==typeof e?.getTableTemplate?e.getTableTemplate():function(){if(!Ce)return null;try{const{versionPrefix:e,isolationCode:t,userscripts:a}=Ce,o=`${e}_profile_v1__${encodeURIComponent(t)||'__default__'}__template`;if(a[o]){const e=a[o];return'string'==typeof e?JSON.parse(e):e}}catch(e){console.warn('[ACU] è¯»å–æ¨¡æ¿é…ç½®å¤±è´¥:',e)}return null}();const n=window.parent||window,r=n.SillyTavern?.getContext?.()?.chat||[],l=r.length,i=r.filter(e=>!e.is_user).length;De.value=l,Te.value=i;const c=[],s=Object.keys(t).filter(e=>e.startsWith('sheet_')).sort((e,a)=>(o?.[e]?.orderNo??t[e]?._acu_orderNo??1/0)-(o?.[a]?.orderNo??t[a]?._acu_orderNo??1/0));for(const e of s){const n=t[e],s=o?.[e],u=s?.name||n?.name;if(!u)continue;const d=(s?.updateConfig||{}).updateFrequency??-1,p=-1===d?a.autoUpdateFrequency:d,m=Ne(u),{aiFloor:f,chatIndex:g,hasHistory:v}=Ve(e,r,a,m),b=v?i-f:i;c.push({sheetKey:e,name:u,updateFrequency:d,effectiveFrequency:p,lastUpdatedAiFloor:f,lastUpdatedChatIndex:g,unrecordedFloors:b,totalAiFloors:i,totalFloors:l,hasHistory:v,isSummaryOrOutline:m,orderNo:s?.orderNo??n?._acu_orderNo??999})}return Ee.value=c,Se.value=new Date,console.info(`[ACU] è¡¨æ ¼æ›´æ–°çŠ¶æ€åˆ·æ–°å®Œæˆï¼Œå…± ${c.length} ä¸ªè¡¨æ ¼ï¼Œå…¨å±€é¢‘ç‡: ${a.autoUpdateFrequency}`),c}catch(e){return console.error('[ACU] è·å–è¡¨æ ¼æ›´æ–°çŠ¶æ€å¤±è´¥:',e),Ee.value=[],[]}finally{const t=Date.now()-e;t<500&&await new Promise(e=>setTimeout(e,500-t)),Be.value=!1}},formatLastUpdate:function(e){return e.hasHistory?`${e.lastUpdatedAiFloor}/${e.lastUpdatedChatIndex}`:'æœªåˆå§‹'},getUnrecordedClass:function(e){if(!e.hasHistory)return'';if(0===e.effectiveFrequency)return'';const t=e.unrecordedFloors/e.effectiveFrequency;return t>=2?'danger':t>=1?'warning':'success'}}}d(4279);var ze=d(1699);const Ie={HEADER:'<user>è¡ŒåŠ¨é¡ºåˆ©åº¦ï¼š',LUCK:'{{luck}}',WORDS:'åœ¨æ¥ä¸‹æ¥çš„æå†™ä¸­ï¼Œè¯·è‡ªç„¶åœ°èå…¥ä»¥ä¸‹è¦ç´ ï¼š[ {{words}} ]',DIMENSIONS:'{{dimensions}}'},_e=`${Ie.HEADER}\n${Ie.LUCK}\n${Ie.WORDS}\n${Ie.DIMENSIONS}`;function Me(e){const{luck:t,words:a,dimensions:o}=e,n=[Ie.HEADER];if(t.prompt&&n.push(t.prompt),a&&a.length>0){const e=Ie.WORDS.replace('{{words}}',a.join('ã€'));n.push(e)}if(o&&o.length>0){const e=o.filter(e=>e.prompt&&e.prompt.trim()).map(e=>e.prompt).join('\n');e&&n.push(e)}return n.join('\n')}let Ue=null,$e=null;function Le(){const e=(0,m.ref)({isFullscreen:!1,fullscreenDocument:null,fullscreenElement:null,isMigrated:!1}),t=[];let a=null;function o(){return(window.parent?.document||document).querySelector('.acu-wrapper')}function n(t,a){const n=o();if(n){if(Ue||(Ue=n.parentElement),a!==(window.parent?.document||document)){console.info('[ACU Fullscreen] Fullscreen in iframe, injecting styles...'),$e&&($e(),$e=null);const e=function(e='head'){const t=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone()).appendTo(e);return{destroy:()=>t.remove()}}(a.head);$e=e.destroy}t.appendChild(n),n.style.position='fixed',n.style.zIndex='2147483647',e.value.isMigrated=!0,console.info('[ACU Fullscreen] ACU migrated to fullscreen element')}else console.warn('[ACU Fullscreen] ACU wrapper not found')}function r(){const t=o();t&&Ue&&(Ue.appendChild(t),$e&&($e(),$e=null),t.style.position='',t.style.zIndex='',e.value.isMigrated=!1,Ue=null,console.info('[ACU Fullscreen] ACU restored from fullscreen'))}function l(){const{doc:t,element:a}=function(){const e=window.parent?.document||document,t=e.fullscreenElement;if(t)return{doc:e,element:t};const a=e.querySelectorAll('.mes_streaming iframe');for(const e of a){const t=e;try{const e=t.contentDocument;if(e?.fullscreenElement)return{doc:e,element:e.fullscreenElement}}catch(e){console.warn('[ACU Fullscreen] Cannot access iframe:',e)}}return{doc:e,element:null}}();a?(e.value.isFullscreen=!0,e.value.fullscreenDocument=t,e.value.fullscreenElement=a,n(a,t)):(e.value.isFullscreen=!1,e.value.fullscreenDocument=null,e.value.fullscreenElement=null,r())}function i(e){const a=()=>l();e.addEventListener('fullscreenchange',a),t.push({doc:e,handler:a})}function c(){const e=(window.parent?.document||document).querySelectorAll('.mes_streaming iframe');for(const a of e){const e=a;try{const a=e.contentDocument;if(a){t.some(e=>e.doc===a)||(i(a),console.info('[ACU Fullscreen] Added listener to iframe:',e.id||'anonymous')),e.contentWindow.getACUMountPoint=()=>a.body,e.contentWindow.isFullscreen=()=>!!a.fullscreenElement}}catch(e){}}}function s(){const e=window.parent?.document||document;i(e),c(),a=new MutationObserver(e=>{for(const t of e)if('childList'===t.type){Array.from(t.addedNodes).some(e=>e instanceof Element&&(e.matches('.mes_streaming')||e.querySelector('.mes_streaming')))&&setTimeout(c,500)}});const t=e.querySelector('#chat');t&&a.observe(t,{childList:!0,subtree:!0}),console.info('[ACU Fullscreen] Initialized')}function u(){for(const{doc:e,handler:a}of t)try{e.removeEventListener('fullscreenchange',a)}catch(e){}t.length=0,a&&(a.disconnect(),a=null),$e&&($e(),$e=null),e.value.isMigrated&&r(),console.info('[ACU Fullscreen] Cleaned up')}return(0,m.onMounted)(()=>{s()}),(0,m.onUnmounted)(()=>{u()}),{state:e,init:s,cleanup:u,checkFullscreen:l}}var Pe=d(6758);const Fe=['title'],je={class:'ball-emoji'},Oe={key:1,class:'acu-issue-badge'},Re=(0,m.defineComponent)({__name:'FloatingBall',setup(e,{expose:t}){const a=(0,Pe.j_)(),o=(0,Pe.D$)(),n=(0,Pe.MP)(),r=(0,m.computed)(()=>o.hasIntegrityIssues),l=(0,m.computed)(()=>r.value?o.getIntegritySummary():''),i=(0,m.computed)(()=>n.appearance),c=(0,m.computed)(()=>{const e=i.value;return'image'===e.type&&e.content?{backgroundImage:`url('${e.content}')`,backgroundPosition:`${e.imageOffsetX??50}% ${e.imageOffsetY??50}%`,backgroundSize:`${e.imageScale??150}%`,backgroundRepeat:'no-repeat'}:{}}),s=(0,m.ref)(!1),u=(0,m.computed)(()=>a.isAiGenerating);let d=null;function p(e=3e3){d&&clearTimeout(d),s.value=!0,d=setTimeout(()=>{s.value=!1,d=null},e)}const f=(0,m.computed)(()=>{const e=u.value||s.value;return{docked:x.value,'has-issues':r.value,'ai-notify':e,'anim-ripple':e&&'ripple'===i.value.notifyAnimation,'anim-arc':e&&'arc'===i.value.notifyAnimation}}),g=(0,m.computed)(()=>{const e=i.value;return{'--ball-size':`${e.size}px`,'--ball-border-color':e.borderColor,'--ball-border-color-rgba':(0,v.j5)(e.borderColor,e.borderOpacity),'--ball-bg-color':(0,v.j5)(e.bgColor,e.bgOpacity),...N.value}});function b(){const e=window.parent&&window.parent!==window?window.parent:window;return{width:e.innerWidth,height:e.innerHeight}}const h=(0,m.ref)(),x=(0,m.ref)(!1);let y=null;const w=function(){const{height:e}=b();return{x:20,y:e-150}}(),{x:k,y:C,style:N,isDragging:V,wasDragging:E}=ge(h,{initialX:w.x,initialY:w.y,edgePadding:10,elementWidth:(0,m.computed)(()=>i.value.size).value,useParentWindow:!0,onPositionChange:(e,t)=>{console.info('[ACU FloatingBall] ä½ç½®å·²ä¿å­˜:',e,t)}});function B(e){return console.log('[ACU FloatingBall] handleClick, wasDragging:',E.value,'isDragging:',V.value),E.value?(E.value=!1,e.stopPropagation(),void console.log('[ACU FloatingBall] å¿½ç•¥æ‹–æ‹½åçš„ç‚¹å‡»')):(s.value&&(s.value=!1,d&&(clearTimeout(d),d=null)),x.value?(x.value=!1,void e.stopPropagation()):void(y?(clearTimeout(y),y=null,x.value=!0,console.info('[ACU FloatingBall] åŒå‡» - è¿›å…¥åœé æ¨¡å¼')):y=setTimeout(()=>{y=null,a.openPanel(),console.info('[ACU FloatingBall] å•å‡» - æ‰“å¼€é¢æ¿')},250)))}return function(e,t,a){const o=window.parent&&window.parent!==window?window.parent:window;(0,de.MLh)(o,e,t,a)}('resize',()=>{const{width:e,height:t}=b(),a=i.value.size,o=10;let n=!1;k.value>e-a-o&&(k.value=e-a-o,n=!0),C.value>t-a-o&&(C.value=t-a-o,n=!0),k.value<o&&(k.value=o,n=!0),C.value<o&&(C.value=o,n=!0),n&&console.info('[ACU FloatingBall] çª—å£å¤§å°å˜åŒ–ï¼Œä½ç½®å·²è°ƒæ•´')}),(0,m.onMounted)(()=>{n.loadFromGlobalVariables()}),(0,m.watch)(()=>a.aiNotifySignal,()=>{console.info('[ACU FloatingBall] æ”¶åˆ° AI é€šçŸ¥ä¿¡å·ï¼Œè§¦å‘åŠ¨ç”»'),p()}),(0,m.onUnmounted)(()=>{y&&clearTimeout(y),d&&clearTimeout(d)}),t({resetPosition:()=>{const e=(window.parent?.innerHeight??window.innerHeight)-150;k.value=20,C.value=e},setDocked:e=>{x.value=e},triggerAiNotify:p,getAppearance:()=>i.value}),(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{ref_key:'ballRef',ref:h,class:(0,m.normalizeClass)(['acu-floating-ball-vue',f.value]),style:(0,m.normalizeStyle)(g.value),title:r.value?l.value:'ç‚¹å‡»æ‰“å¼€é¢æ¿',onClick:B},[(0,m.createCommentVNode)(' å›¾æ ‡å†…å®¹ - æ ¹æ®ç±»å‹åŠ¨æ€æ¸²æŸ“ '),x.value?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createCommentVNode)(' FontAwesome å›¾æ ‡ '),'icon'===i.value.type?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(['fa-solid',i.value.content])},null,2)):'emoji'===i.value.type?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' Emoji '),(0,m.createElementVNode)('span',je,(0,m.toDisplayString)(i.value.content),1)],2112)):'image'===i.value.type&&i.value.content?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' å›¾ç‰‡ - ä½¿ç”¨ div + background-image æ”¯æŒè£å‰ªå‚æ•° '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['ball-image',{'ball-image-invert':i.value.imageInvert}]),style:(0,m.normalizeStyle)(c.value)},null,6)],2112)):(0,m.createCommentVNode)('v-if',!0)],64)),(0,m.createCommentVNode)(' é—®é¢˜å¾½ç«  '),r.value&&!x.value?((0,m.openBlock)(),(0,m.createElementBlock)('span',Oe,'!')):(0,m.createCommentVNode)('v-if',!0)],14,Fe))}}),He={class:'popup-buttons-grid'},We=['title','onClick'],Ge=(0,m.defineComponent)({__name:'HiddenButtonsPopup',props:{visible:{type:Boolean},buttons:{},isPinned:{type:Boolean,default:!1}},emits:['close','button-click'],setup(e,{emit:t}){const a=e,o=t,n=e=>{const t=[];return'purge'===e&&t.push('btn-danger'),'pin'===e&&(t.push('btn-toggle'),a.isPinned&&t.push('active')),t};return(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'hidden-popup'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-hidden-buttons-popup',onClick:a[0]||(a[0]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('div',He,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.buttons,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e.id,class:(0,m.normalizeClass)(['popup-button',n(e.id)]),title:e.label,onClick:(0,m.withModifiers)(t=>{return a=e.id,o('button-click',a),void o('close');var a},['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fa-solid',e.icon])},null,2)],10,We))),128))])])):(0,m.createCommentVNode)('v-if',!0)]),_:1}))}});d(8186);var Ye=d(9946);const Xe=(0,Ye.A)(Ge,[['__scopeId','data-v-5d2fcd0e']]),qe={class:'acu-panel-content'},Ke={class:'acu-nav-actions-area'},Je=['title','onClick','onMousedown','onTouchstartPassive'],Qe={key:0,class:'secondary-indicator'},Ze=['title','onClick'],et={key:0,class:'acu-action-btn-wrapper'},tt='acu_win_config',at=(0,m.defineComponent)({__name:'MainPanel',props:{title:{default:'ACU å¯è§†åŒ–è¡¨æ ¼'},theme:{default:'retro'},layout:{default:'vertical'},isCollapsed:{type:Boolean,default:!1},isPinned:{type:Boolean,default:!1},isContentHidden:{type:Boolean,default:!1},lockPanel:{type:Boolean,default:!1},hasChanges:{type:Boolean,default:!1},panelType:{default:'normal'}},emits:['refresh','save','save-as','undo','manual-update','purge','settings','open-native','toggle-pin','toggle','close','hide-content','height-change','width-change','collapse-tab'],setup(e,{expose:t,emit:a}){const o=e,n=a,r=(0,Pe.j_)(),l=((0,xe.t)(),(0,Pe.JH)()),i=['save','refresh','settings','pin','toggle'],c=(0,m.computed)(()=>{let e=l.config.buttonOrder||Pe.mu.map(e=>e.id);const t=l.config.visibleButtons?.length>0?[...l.config.visibleButtons]:[...i];if(l.config.collapseTabBar&&!1!==l.config.showCollapseTabButton){if(t.includes('collapseTab')||t.push('collapseTab'),!e.includes('collapseTab')){const t=e.indexOf('settings');e=t>=0?[...e.slice(0,t),'collapseTab',...e.slice(t)]:[...e,'collapseTab']}}else{const e=t.indexOf('collapseTab');e>-1&&t.splice(e,1)}return console.info('[ACU MainPanel] è®¡ç®—å¯è§æŒ‰é’®:',{order:e,visibleIds:t,collapseTabBar:l.config.collapseTabBar,showCollapseTabButton:l.config.showCollapseTabButton}),e.map(e=>Pe.mu.find(t=>t.id===e)).filter(e=>!!e&&t.includes(e.id))}),s=(0,m.computed)(()=>l.hiddenButtons),u=(0,m.computed)(()=>l.hasHiddenButtons),d=(0,m.ref)(!1),p=()=>{d.value=!d.value},f=e=>{d.value=!1,B(e)},g=(0,m.ref)(!1),v=e=>{const t=[];return'purge'===e&&t.push('acu-btn-danger'),'pin'===e&&(t.push('acu-btn-toggle'),o.isPinned&&t.push('active')),'save'===e&&o.hasChanges&&t.push('has-changes'),'refresh'===e&&g.value&&t.push('refreshing'),t},b=e=>{const t={};return'purge'===e&&(t.color='#e74c3c'),'pin'===e&&o.isPinned&&(t.color='var(--acu-title-color)',t.borderColor='var(--acu-title-color)',t.background='var(--acu-btn-hover)'),t};let h=null;const x=(0,m.ref)(!1),y=(0,m.ref)(null),w=e=>l.getSecondaryButtonId(e),k=e=>{const t=Pe.mu.find(t=>t.id===e);return t?.icon||'fa-circle'},C=e=>{const t=Pe.mu.find(t=>t.id===e);return t?.label||e},N=e=>{const t=C(e),a=w(e);if(a){return`${t} (é•¿æŒ‰: ${C(a)})`}return t},V=e=>{const t=w(e);console.log('[ACU MainPanel] startLongPress:',e,'secondaryId:',t,'groups:',l.buttonGroups),t?(x.value=!1,h=setTimeout(()=>{x.value=!0,console.log('[ACU MainPanel] Long press triggered for:',e,'directExec:',l.longPressDirectExec),l.longPressDirectExec?(console.log('[ACU MainPanel] Direct exec:',t),B(t)):(console.log('[ACU MainPanel] Popup button:',t),y.value=e,setTimeout(()=>{y.value===e&&(y.value=null)},3e3))},600)):console.log('[ACU MainPanel] No secondary button for:',e)},E=()=>{h&&(clearTimeout(h),h=null)},B=e=>{switch(e){case'save':n('save');break;case'saveAs':n('save-as');break;case'undo':n('undo');break;case'refresh':n('refresh');break;case'manualUpdate':n('manual-update');break;case'purge':n('purge');break;case'pin':n('toggle-pin');break;case'toggle':n('toggle');break;case'director':r.directorDialog=!0;break;case'settings':n('settings');break;case'openNative':n('open-native');break;case'collapseTab':n('collapse-tab');break;default:console.warn(`[MainPanel] æœªçŸ¥çš„åŠ¨ä½œ ID: ${e}`)}},S=(0,m.ref)(),T=(0,m.ref)(),D=(0,m.ref)(),A=(0,m.ref)(),I={width:400,left:'50%',bottom:'50%',isCentered:!0};let M=null,U=!1;try{const e=localStorage.getItem(tt);M=e?JSON.parse(e):null}catch(e){M=null}M?!M.isCentered&&'number'==typeof M.bottom&&M.bottom<100&&(U=!0,console.warn('[ACU MainPanel] æ£€æµ‹åˆ°æ— æ•ˆä½ç½®é…ç½® (bottom='+M.bottom+')ï¼Œé‡ç½®ä¸ºå±…ä¸­')):(U=!0,console.info('[ACU MainPanel] é¦–æ¬¡åŠ è½½ï¼Œè®¾ç½®é»˜è®¤å±…ä¸­é…ç½®')),U&&(localStorage.setItem(tt,JSON.stringify(I)),localStorage.removeItem('acu_active_tab'),console.info('[ACU MainPanel] å±…ä¸­æ¨¡å¼ï¼šæ¸…é™¤ activeTabï¼Œåªæ˜¾ç¤ºå¯¼èˆªæ '));const L=(0,de.rXt)(tt,I);function P(){return function(){const e='ontouchstart'in window||navigator.maxTouchPoints>0,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),a=window.innerWidth<768;return e&&(t||a)}()?l.config.mobileSafeAreaBottom??50:0}function F(){const e=L.value,{width:t,height:a}={width:window.parent?.innerWidth??window.innerWidth,height:window.parent?.innerHeight??window.innerHeight};if(console.info('[ACU MainPanel] éªŒè¯é¢æ¿ä½ç½®:',JSON.stringify(e),'parentHeight:',a),!e||void 0===e.left||void 0===e.bottom)return console.warn('[ACU MainPanel] é…ç½®ä¸å®Œæ•´ï¼Œé‡ç½®ä¸ºå±…ä¸­æ¨¡å¼'),void(L.value={width:e?.width||400,left:'50%',bottom:'50%',isCentered:!0});if(e.isCentered)return void('50%'===e.left&&'50%'===e.bottom||(console.warn('[ACU MainPanel] å±…ä¸­æ¨¡å¼ä¸‹ä½ç½®å¼‚å¸¸ï¼Œä¿®æ­£ä¸º 50%'),L.value={...e,left:'50%',bottom:'50%'}));let o=!1,n=!1,r=e.left;const l=e.bottom,i=P(),c=Math.max(i,50);if('number'==typeof e.bottom?e.bottom<c?(console.warn(`[ACU MainPanel] åº•éƒ¨ä½ç½®å¼‚å¸¸ (${e.bottom}px < ${c}px)ï¼Œé‡ç½®ä¸ºå±…ä¸­æ¨¡å¼`),n=!0):e.bottom>a-50&&(console.warn(`[ACU MainPanel] é¡¶éƒ¨ä½ç½®å¼‚å¸¸ (${e.bottom}px > ${a-50}px)ï¼Œé‡ç½®ä¸ºå±…ä¸­æ¨¡å¼`),n=!0):'50%'!==e.bottom&&(console.warn('[ACU MainPanel] éå±…ä¸­æ¨¡å¼ä¸‹ bottom æ ¼å¼æ— æ•ˆï¼Œé‡ç½®ä¸ºå±…ä¸­æ¨¡å¼'),n=!0),'number'==typeof e.left){const a=t-50;e.left<-200?(r=-200,o=!0):e.left>a&&(r=Math.max(0,a),o=!0)}else'50%'!==e.left&&(console.warn('[ACU MainPanel] éå±…ä¸­æ¨¡å¼ä¸‹ left æ ¼å¼æ— æ•ˆï¼Œé‡ç½®ä¸ºå±…ä¸­æ¨¡å¼'),n=!0);if(n)return L.value={width:e.width||400,left:'50%',bottom:'50%',isCentered:!0},void console.info('[ACU MainPanel] é¢æ¿å·²é‡ç½®ä¸ºå±…ä¸­æ¨¡å¼');o&&(console.info('[ACU MainPanel] é¢æ¿ä½ç½®è¶Šç•Œï¼Œå·²è‡ªåŠ¨ä¿®æ­£'),L.value={...e,left:r,bottom:l})}function j(e){if(o.lockPanel)return;if(e.target.closest('.acu-resize-handle, .acu-slider, input'))return;if(0!==e.button)return;const t=D.value;if(!t||!S.value)return;const a=e.clientX,n=e.clientY,r=S.value.getBoundingClientRect(),l=r.left,i=window.parent?.innerHeight??window.innerHeight,c=i-r.bottom;let s=!1,u=!1;const d=e=>{const t=e.originalEvent,o=t.clientX-a,r=t.clientY-n;if(!s&&(Math.abs(o)>5||Math.abs(r)>5)&&(s=!0,u=!0,L.value.isCentered=!1),s){e.preventDefault();let t=l+o,a=c-r;const n=window.parent?.innerWidth??window.innerWidth,s=P(),u=n-50,d=i-50;t<-200&&(t=-200),t>u&&(t=u),a<s&&(a=s),a>d&&(a=d),L.value.left=t,L.value.bottom=a}},p=()=>{if($('body').off('pointermove',d),$('body').off('pointerup',p),u){const e=a=>{a.stopPropagation(),a.preventDefault(),t.removeEventListener('click',e,!0)};t.addEventListener('click',e,!0),console.info('[ACU MainPanel] é¢æ¿ä½ç½®å·²æ›´æ–°')}};$('body').on('pointermove',d),$('body').on('pointerup',p)}(0,m.watchEffect)(()=>{if(!S.value)return;let e=L.value;e||(e={width:400,left:'50%',bottom:'50%',isCentered:!0});const t=S.value;if(e.width&&t.style.setProperty('--acu-win-width',`${e.width}px`),void 0!==e.left){const a='number'==typeof e.left?`${e.left}px`:e.left;t.style.setProperty('--acu-win-left',a)}if(void 0!==e.bottom){const a='number'==typeof e.bottom?`${e.bottom}px`:e.bottom;t.style.setProperty('--acu-win-bottom',a)}e.isCentered?(t.style.setProperty('--acu-win-left','50%'),t.style.removeProperty('--acu-win-bottom'),t.style.transform='translate(-50%, -50%)'):t.style.transform='none'});const O=(0,m.ref)(),R=(0,m.ref)(!1),H=(0,m.ref)(0),W=(0,m.computed)(()=>o.panelType),G=(0,m.computed)(()=>l.config.showPagination);(0,m.onMounted)(()=>{F();const e=D.value;e&&(e.addEventListener('pointerdown',j),console.info('[ACU MainPanel] å¯¼èˆªæ æ‹–æ‹½äº‹ä»¶å·²ç»‘å®š'));const t=A.value;t&&(t.addEventListener('pointerdown',q),console.info('[ACU MainPanel] å®½åº¦è°ƒèŠ‚äº‹ä»¶å·²ç»‘å®š'))}),(0,m.onUnmounted)(()=>{const e=D.value;e&&e.removeEventListener('pointerdown',j);const t=A.value;t&&t.removeEventListener('pointerdown',q)}),(0,de.MLh)(window.parent??window,'resize',()=>{F()});const{height:Y,recalculate:X}=function(e,t,a,o={}){const{minHeight:n=200,maxHeightRatio:r=.8,headerHeight:l=42,paginationHeight:i=56,contentPadding:c=25,onHeightChange:s}=o,u=(0,m.ref)(n),d=()=>window.parent&&window.parent!==window?window.parent.innerHeight:window.innerHeight,p=()=>d()*r,f=()=>'string'==typeof t?t:t.value,g=()=>'boolean'==typeof a?a:a.value;(0,de.wYm)(e,e=>{const t=e[0];if(!t)return;if('dashboard'===f()){const e=p();return console.info('[ACU useSmartHeight] ä»ªè¡¨ç›˜é«˜åº¦è®¡ç®—:',{maxH:e,parentHeight:d(),ratio:r}),u.value=e,void s?.(e)}const a=t.contentRect.height,o=g()?i:0,m=l+a+c+o,v=p(),b=Math.max(n,Math.min(m,v));u.value=b,s?.(b)}),'string'!=typeof t&&(0,m.watch)(t,e=>{if('dashboard'===e){const e=p();console.info('[ACU useSmartHeight] åˆ‡æ¢åˆ°ä»ªè¡¨ç›˜ï¼Œè®¾ç½®é«˜åº¦:',e),u.value=e,s?.(e)}}),'boolean'!=typeof a&&(0,m.watch)(a,()=>{if(e.value){const t=e.value.scrollHeight;if('dashboard'!==f()){const e=g()?i:0,a=l+t+c+e,o=p(),r=Math.max(n,Math.min(a,o));u.value=r,s?.(r)}}});const v=(0,m.computed)(()=>({height:`${u.value}px`,maxHeight:`${p()}px`}));return{height:u,heightStyle:v,maxHeight:(0,m.computed)(()=>p()),reset:()=>{u.value=n,s?.(n)},maximize:()=>{const e=p();u.value=e,s?.(e)},recalculate:()=>{if(e.value)if('dashboard'===f()){const e=p();u.value=e,s?.(e)}else{const t=e.value.scrollHeight,a=g()?i:0,o=l+t+c+a,r=p(),d=Math.max(n,Math.min(o,r));u.value=d,s?.(d)}}}}(O,W,G,{minHeight:200,maxHeightRatio:.8,headerHeight:42,paginationHeight:56,contentPadding:25,onHeightChange:e=>{!R.value&&T.value&&(H.value=e,n('height-change',e))}});function q(e){if(0!==e.button)return;e.preventDefault(),e.stopPropagation();if(!A.value||!S.value)return;const t=e.clientX,a=S.value.getBoundingClientRect().width,o=e=>{const o=e.originalEvent.clientX-t;let r=a+o;const l=(window.parent?.innerWidth??window.innerWidth)-10;r<300&&(r=300),r>l&&(r=l),L.value.width=r,n('width-change',r)},r=()=>{$('body').off('pointermove',o),$('body').off('pointerup',r),console.info('[ACU MainPanel] å®½åº¦å·²æ›´æ–°:',L.value.width)};$('body').on('pointermove',o),$('body').on('pointerup',r)}return t({getPanelElement:()=>S.value,getDataAreaElement:()=>T.value,getCurrentHeight:()=>H.value,resetPosition:()=>{L.value={width:400,left:'50%',bottom:'50%',isCentered:!0}},exitCenteredMode:()=>{if(!L.value.isCentered)return;const e=window.parent?.innerWidth??window.innerWidth;L.value={...L.value,isCentered:!1,bottom:'number'==typeof L.value.bottom&&L.value.bottom>=50?L.value.bottom:100,left:'number'==typeof L.value.left?L.value.left:e/2-200},console.info('[ACU MainPanel] é€€å‡ºå±…ä¸­æ¨¡å¼ï¼Œåˆ‡æ¢åˆ°åº•éƒ¨å®šä½')},resetHeight:()=>{T.value&&(R.value=!1,T.value.style.height='',T.value.style.minHeight='',T.value.style.maxHeight='',setTimeout(()=>{requestAnimationFrame(()=>{if(!T.value)return;const e=window.parent?.innerHeight??window.innerHeight,t=D.value,a=e-(t?t.offsetHeight:0)-20,o=T.value.querySelector('.acu-relationship-graph');if(o){const e=a;return T.value.style.height=`${e}px`,H.value=e,console.info(`[ACU] å…³ç³»å›¾é«˜åº¦é‡ç½®: å¼ºåˆ¶æœ€å¤§é«˜åº¦ ${e}`),void n('height-change',e)}const r='horizontal'===l.config.layout;let i;if(r){const e=T.value.querySelector('.acu-cards-container');if(e){const t=e.querySelectorAll('.acu-data-card');let a=0;t.forEach(e=>{const t=e.scrollHeight;t>a&&(a=t)});const o=T.value.querySelector('.acu-table-toolbar'),n=T.value.querySelector('.acu-pagination-container'),r=o?o.offsetHeight:0,l=n?n.offsetHeight:0,c=window.getComputedStyle(e),s=parseFloat(c.paddingTop)+parseFloat(c.paddingBottom);i=a+r+l+s,console.info(`[ACU] æ¨ªå‘å¸ƒå±€é«˜åº¦è®¡ç®—: maxCard=${a}, toolbar=${r}, pagination=${l}, padding=${s}`)}else i=T.value.scrollHeight}else{const e=T.value.querySelector('.acu-panel-content');if(e){const t=e.firstElementChild;i=t?t.offsetHeight+20:e.scrollHeight}else i=T.value.scrollHeight}const c=Math.min(a,Math.max(200,i)),s=r&&T.value.querySelector('.acu-cards-container');if(o||s)T.value.style.height=`${c}px`,H.value=c,console.info(`[ACU] é«˜åº¦å·²é‡ç½®(Fixed): natural=${i}, max=${a}, final=${c}, horizontal=${r}`),n('height-change',c);else{T.value.style.height='';const e=T.value.offsetHeight;H.value=e,console.info(`[ACU] é«˜åº¦å·²é‡ç½®(Auto): actual=${e}, horizontal=${r}`),n('height-change',e)}})},50))},recalculateHeight:X}),(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{ref_key:'panelRef',ref:S,class:(0,m.normalizeClass)(['acu-wrapper',[`acu-theme-${e.theme}`,`acu-layout-${e.layout}`,{collapsed:e.isCollapsed,pinned:e.isPinned,'acu-centered-mode':(0,m.unref)(L).isCentered}]])},[(0,m.createCommentVNode)(' 1. æ•°æ®æ˜¾ç¤ºåŒºï¼ˆæ”¾åœ¨æœ€å‰é¢ï¼‰ '),(0,m.createElementVNode)('div',{ref_key:'dataAreaRef',ref:T,class:(0,m.normalizeClass)(['acu-data-display',{visible:!e.isContentHidden,'acu-layout-horizontal':'horizontal'===e.layout,'acu-layout-vertical':'vertical'===e.layout}])},[(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',qe,[(0,m.renderSlot)(t.$slots,'default')])],2),(0,m.createCommentVNode)(' 2. å®½åº¦è°ƒèŠ‚æŠŠæ‰‹ '),(0,m.createCommentVNode)(' æ³¨æ„ï¼šäº‹ä»¶ç»‘å®šåœ¨ onMounted ä¸­æ‰‹åŠ¨è¿›è¡Œï¼Œé¿å…è·¨ iframe ç”Ÿäº§æ„å»ºäº‹ä»¶ç»‘å®šå¤±æ•ˆ '),e.lockPanel?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,ref_key:'resizeHandleRef',ref:A,class:'acu-resize-handle'},null,512)),(0,m.createCommentVNode)(' 3. å¯¼èˆªå®¹å™¨ï¼ˆæ”¾åœ¨æœ€åï¼Œæ˜¾ç¤ºåœ¨åº•éƒ¨ï¼‰ '),(0,m.createCommentVNode)(' æ³¨æ„ï¼šæ‹–æ‹½äº‹ä»¶ç»‘å®šåœ¨ onMounted ä¸­æ‰‹åŠ¨è¿›è¡Œ '),(0,m.createElementVNode)('div',{ref_key:'navContainerRef',ref:D,class:(0,m.normalizeClass)(['acu-nav-container',{'acu-locked':e.lockPanel}])},[(0,m.createCommentVNode)(' Tab åŒºåŸŸ (ç”± slot æä¾›ï¼ŒTabBar è‡ªå¸¦ .acu-nav-tabs-area) '),(0,m.renderSlot)(t.$slots,'tabs'),(0,m.createCommentVNode)(' åˆ†éš”çº¿ '),a[2]||(a[2]=(0,m.createElementVNode)('div',{class:'acu-nav-separator'},null,-1)),(0,m.createCommentVNode)(' åŠ¨ä½œæŒ‰é’®åŒºï¼ˆæ¨ªæ’ï¼‰ '),(0,m.createElementVNode)('div',Ke,[(0,m.createCommentVNode)(' å¸¸è§„æŒ‰é’®ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(c.value,e=>{return(0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-action-btn-wrapper'},[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-action-btn',v(e.id)]),title:N(e.id),style:(0,m.normalizeStyle)(b(e.id)),onClick:(0,m.withModifiers)(t=>{return a=e.id,void(x.value?x.value=!1:('refresh'===a&&(g.value=!0,setTimeout(()=>{g.value=!1},1e3)),B(a)));var a},['stop']),onMousedown:(0,m.withModifiers)(t=>V(e.id),['stop']),onMouseup:(0,m.withModifiers)(E,['stop']),onMouseleave:E,onTouchstartPassive:(0,m.withModifiers)(t=>V(e.id),['stop']),onTouchend:(0,m.withModifiers)(E,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fa-solid',e.icon])},null,2),(0,m.createCommentVNode)(' é™„å±æŒ‰é’®æŒ‡ç¤ºç‚¹ '),(t=e.id,null!==w(t)?((0,m.openBlock)(),(0,m.createElementBlock)('span',Qe)):(0,m.createCommentVNode)('v-if',!0))],46,Je),(0,m.createCommentVNode)(' é•¿æŒ‰å¼¹å‡ºçš„é™„å±æŒ‰é’® '),(0,m.createVNode)(m.Transition,{name:'popup'},{default:(0,m.withCtx)(()=>[y.value===e.id&&w(e.id)?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-action-btn acu-popup-btn',title:C(w(e.id)),onClick:(0,m.withModifiers)(t=>(e=>{const t=w(e);t&&B(t),y.value=null})(e.id),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fa-solid',k(w(e.id))])},null,2)],8,Ze)):(0,m.createCommentVNode)('v-if',!0)]),_:2},1024)]);var t}),128)),(0,m.createCommentVNode)(' æ›´å¤šæŒ‰é’®ï¼ˆä»…å½“æœ‰éšè—æŒ‰é’®æ—¶æ˜¾ç¤ºï¼‰ '),u.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',et,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-action-btn acu-more-btn',{active:d.value}]),title:'æ›´å¤šæŒ‰é’®',onClick:(0,m.withModifiers)(p,['stop'])},[...a[1]||(a[1]=[(0,m.createElementVNode)('i',{class:'fa-solid fa-chevron-up'},null,-1)])],2)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' éšè—æŒ‰é’®æµ®çª—ï¼ˆæ”¾åœ¨ actions-area å†…ï¼Œè´´ç€ action æŒ‰é’®æ˜¾ç¤ºï¼‰ '),(0,m.createVNode)(Xe,{visible:d.value,buttons:s.value,'is-pinned':e.isPinned,onClose:a[0]||(a[0]=e=>d.value=!1),onButtonClick:f},null,8,['visible','buttons','is-pinned']),(0,m.createCommentVNode)(' Tabæµ®çª—ï¼ˆæ”¾åœ¨ actions-area å†…ï¼Œè´´ç€ action æŒ‰é’®æ˜¾ç¤ºï¼‰ '),(0,m.renderSlot)(t.$slots,'tabs-popup')])],2)],2))}}),ot={class:'acu-tab-bar'},nt=['title','draggable','onClick','onDragstart','onDragover','onDrop'],rt=(0,m.defineComponent)({__name:'TabBar',props:{tabs:{},activeTab:{},showDashboard:{type:Boolean,default:!0},hasOptionsTabs:{type:Boolean,default:!1},hasRelationshipGraph:{type:Boolean,default:!1},isEditingOrder:{type:Boolean,default:!1},gridColumns:{default:'repeat(auto-fill, minmax(90px, 1fr))'}},emits:['tab-change','order-change','exit-editing'],setup(e,{expose:t,emit:a}){const o=e,n=a,r=(0,k.j_)(),l=(0,w.D)(),i=(0,m.ref)([]);function c(e){return e===k.H6||e===k.$9||e===k.SC}const s=(0,m.computed)(()=>{const e=r.visibleTabs;if(!e||0===e.length){const e=[];return o.showDashboard&&e.push({id:k.H6,name:'ä»ªè¡¨ç›˜',icon:'fas fa-home'}),e.push(...i.value),o.hasRelationshipGraph&&e.push({id:k.SC,name:'å…³ç³»å›¾',icon:'fas fa-project-diagram'}),o.hasOptionsTabs&&e.push({id:k.$9,name:'é€‰é¡¹',icon:'fas fa-sliders-h'}),e}return e.map(e=>function(e){return e===k.H6?{id:k.H6,name:'ä»ªè¡¨ç›˜',icon:'fas fa-home'}:e===k.SC?{id:k.SC,name:'å…³ç³»å›¾',icon:'fas fa-project-diagram'}:e===k.$9?{id:k.$9,name:'é€‰é¡¹',icon:'fas fa-sliders-h'}:i.value.find(t=>t.id===e)}(e)).filter(e=>!!e&&(!(e.id===k.H6&&!o.showDashboard)&&(!(e.id===k.SC&&!o.hasRelationshipGraph)&&!(e.id===k.$9&&!o.hasOptionsTabs))))});function u(e){return l.hasTableIssues(e)}function d(e){if(u(e.name)){return`âš ï¸ å‘ç° ${l.getTableIssues(e.name).length} ä¸ªé—®é¢˜`}return e.name}let p=null,f=null;(0,m.watch)(()=>o.tabs,e=>{i.value=[...e]},{immediate:!0,deep:!0});const g=()=>{n('exit-editing')},v=e=>{e.target.classList.remove('dragging'),p=null,f=null};return t({getCurrentOrder:()=>i.value.map(e=>e.id),getVisibleTabs:()=>s.value.map(e=>e.id)}),(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',ot,[(0,m.createCommentVNode)(' æ’åºæç¤º '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-order-controls',{visible:e.isEditingOrder}])},[(0,m.createElementVNode)('span',null,[a[1]||(a[1]=(0,m.createElementVNode)('i',{class:'fas fa-info-circle'},null,-1)),a[2]||(a[2]=(0,m.createTextVNode)(' æ‹–æ‹½è°ƒæ•´é¡ºåºï¼Œå®Œæˆåç‚¹å‡» ',-1)),(0,m.createElementVNode)('button',{class:'acu-order-done-btn',onClick:g},[...a[0]||(a[0]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1),(0,m.createTextVNode)(' å®Œæˆ',-1)])])])],2),(0,m.createCommentVNode)(' Tab ç½‘æ ¼åŒºåŸŸ '),(0,m.createElementVNode)('div',{class:'acu-nav-tabs-area',style:(0,m.normalizeStyle)({'--acu-nav-cols':e.gridColumns})},[(0,m.createCommentVNode)(' ç»Ÿä¸€ Tab åˆ—è¡¨ï¼ˆåŒ…å«ä»ªè¡¨ç›˜ã€æ™®é€šè¡¨æ ¼ã€é€‰é¡¹é¢æ¿ï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(s.value,t=>{return(0,m.openBlock)(),(0,m.createElementBlock)('button',{key:t.id,class:(0,m.normalizeClass)(['acu-nav-btn',{active:e.activeTab===t.id,'drag-handle':e.isEditingOrder,'has-issues':!c(t.id)&&u(t.name),'has-ai-changes':!c(t.id)&&!u(t.name)&&(a=t.name,l.hasTableAiChanges(a))}]),title:d(t),draggable:e.isEditingOrder,onClick:(0,m.withModifiers)(e=>{return a=t.id,void(o.isEditingOrder||n('tab-change',a));var a},['stop']),onDragstart:e=>((e,t)=>{o.isEditingOrder?(p=t,e.dataTransfer&&(e.dataTransfer.effectAllowed='move',e.dataTransfer.setData('text/plain',t.id)),e.target.classList.add('dragging')):e.preventDefault()})(e,t),onDragover:(0,m.withModifiers)(e=>((e,t)=>{o.isEditingOrder&&p&&(e.preventDefault(),f=t)})(e,t),['prevent']),onDrop:e=>((e,t)=>{if(!o.isEditingOrder||!p)return;e.preventDefault();const a=i.value.findIndex(e=>e.id===p.id),r=i.value.findIndex(e=>e.id===t.id);if(-1!==a&&-1!==r&&a!==r){const[e]=i.value.splice(a,1);i.value.splice(r,0,e),n('order-change',i.value.map(e=>e.id))}p=null,f=null})(e,t),onDragend:v},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(t.icon||(0,m.unref)(k.Sj)(t.name))},null,2),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(t.name),1)],42,nt);var a}),128))],4)]))}}),lt=(0,m.defineComponent)({__name:'Badge',props:{value:{},type:{default:'default'}},setup(e){const t=e,a=(0,m.computed)(()=>{if('default'!==t.type)return t.type;const e=String(t.value);return/Lv\.?\s*\d+/i.test(e)?'level':/\d+(\.\d+)?%/.test(e)?'percent':'ç”·'===e?'male':'å¥³'===e?'female':/^[+-]?\d+(\.\d+)?$/.test(e.trim())?'number':'default'}),o=(0,m.computed)(()=>{const e=a.value;return['primary','secondary','outline','outline-primary'].includes(e),`acu-badge-${e}`}),n=(0,m.computed)(()=>{const e=t.value;return null==e||''===e?'-':String(e)});return(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{class:(0,m.normalizeClass)(['acu-badge',o.value])},(0,m.toDisplayString)(n.value),3))}}),it=(0,m.defineComponent)({__name:'InlineEditor',props:{value:{},minHeight:{default:24}},emits:['save','cancel'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(),r=(0,m.ref)(String(a.value)),l=(0,m.ref)(!1),i=(0,m.ref)(!1),c=()=>{const e=window.getSelection();i.value=null!==e&&e.toString().length>0},s=()=>{const e=n.value;if(!e)return;const t=e.offsetHeight,o=e.style.visibility;e.style.visibility='hidden',e.style.height='0px';const r=e.scrollHeight,l=Math.max(r,a.minHeight);e.style.visibility=o,e.style.height=l===t&&t>0?`${t}px`:`${l}px`};(0,m.watch)(r,()=>{(0,m.nextTick)(s)});const u=()=>{if(l.value)return;l.value=!0;const e=String(a.value);r.value!==e?o('save',r.value):o('cancel')},d=e=>{'Escape'===e.key?(e.preventDefault(),e.stopPropagation(),l.value=!0,o('cancel')):'Enter'!==e.key||e.shiftKey||(e.preventDefault(),e.stopPropagation(),u())},p=e=>{e.stopPropagation()},f=e=>{c(),i.value,e.stopPropagation()};return(0,m.onMounted)(()=>{(0,m.nextTick)(()=>{const e=n.value;if(!e)return;const t=e.scrollHeight,o=Math.max(t,a.minHeight);e.style.height=`${o}px`,e.focus();const r=e.value.length;e.setSelectionRange(r,r)}),document.addEventListener('selectionchange',c)}),(0,m.onBeforeUnmount)(()=>{document.removeEventListener('selectionchange',c)}),(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:'acu-inline-editor',onClick:t[5]||(t[5]=(0,m.withModifiers)(()=>{},['stop'])),onMousedown:t[6]||(t[6]=(0,m.withModifiers)(()=>{},['stop'])),onPointerdown:t[7]||(t[7]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.withDirectives)((0,m.createElementVNode)('textarea',{ref_key:'textareaRef',ref:n,'onUpdate:modelValue':t[0]||(t[0]=e=>r.value=e),class:'acu-edit-textarea',onBlur:u,onKeydown:d,onClick:t[1]||(t[1]=(0,m.withModifiers)(()=>{},['stop'])),onMousedown:t[2]||(t[2]=(0,m.withModifiers)(()=>{},['stop'])),onPointerdown:t[3]||(t[3]=(0,m.withModifiers)(()=>{},['stop'])),onTouchstart:p,onTouchmove:f,onTouchend:t[4]||(t[4]=(0,m.withModifiers)(()=>{},['stop']))},null,544),[[m.vModelText,r.value]])],32))}}),ct={key:0,class:'acu-card-header'},st={key:0,class:'acu-card-index'},ut={key:0,class:'fas fa-lock acu-title-lock-icon'},dt={key:4,class:'acu-history-btns'},pt=['disabled'],mt={class:'acu-card-main-grid'},ft=['onClick'],gt={class:'acu-grid-label'},vt={class:'acu-grid-value'},bt={key:0,class:'fas fa-lock acu-lock-icon'},ht={key:0,class:'acu-card-full-area'},xt=['onClick'],yt={class:'acu-full-label'},wt={class:'acu-full-value'},kt={key:1},Ct={key:0,class:'fas fa-lock acu-lock-icon'},Nt={class:'acu-card-body'},Vt=['onClick'],Et={class:'acu-card-label'},Bt={class:'acu-card-value'},St={key:0,class:'fas fa-lock acu-lock-icon'},Tt={class:'acu-pull-icon'},Dt={class:'acu-pull-text'},At={key:3,class:'acu-stamp-delete'},zt=(0,m.defineComponent)({__name:'DataCard',props:{data:{},tableId:{},tableName:{},isChanged:{type:Boolean,default:!1},layout:{default:'vertical'},viewMode:{default:'card'},showIndex:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},titleColIndex:{default:1},showHistoryButton:{type:Boolean,default:!0},customHighlights:{default:void 0},allowEdit:{type:Boolean,default:!0}},emits:['cellClick','insertRow','toggleDelete','contextMenu','showHistory'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(),r=(0,m.ref)(null),l=(0,m.ref)(!1),i=(0,w.D)(),c=(0,k.j_)(),s=(0,xe.t)(),u=(0,B.m)(),d=(0,m.ref)(),p=(0,m.ref)(),f=(0,m.ref)(),g=(0,m.ref)(),{isMobile:v}=fe(),b=(0,m.ref)(!1),h=(0,m.ref)(null),x=(0,m.computed)(()=>`${a.tableName}-row-${a.data.index}`),y=(0,m.computed)(()=>i.pendingDeletes.has(x.value)),C=(0,m.computed)(()=>a.titleColIndex>=0&&a.data.cells.length>a.titleColIndex?a.data.cells[a.titleColIndex]:null),N=(0,m.computed)(()=>{let e=a.data.cells.filter((_,e)=>e>0);return a.showHeader&&C.value&&a.titleColIndex>0&&(e=e.filter((_,e)=>e+1!==a.titleColIndex)),e}),V=e=>{const t=String(e.value),a=e.key.toLowerCase();return t.length>50||a.includes('æè¿°')||a.includes('è¯´æ˜')||a.includes('å¤‡æ³¨')||a.includes('å†…å®¹')||a.includes('detail')||a.includes('description')},E=(0,m.computed)(()=>N.value.filter(e=>!V(e))),T=(0,m.computed)(()=>N.value.filter(e=>V(e))),D=(0,m.computed)(()=>{const e=a.data.cells.map(e=>e.key),t=a.data.cells.map(e=>String(e.value??''));return s.getRowKey(a.tableName,t,e,a.data.index)}),A=(0,m.computed)(()=>{if(!c.isLockEditMode)return!1;const e=D.value;return!!e&&s.isRowLockedPending(a.tableName,e)}),I=(0,m.computed)(()=>{if(!c.isLockEditMode||!C.value)return!1;const e=D.value;return!!e&&s.isCellLockedPending(a.tableName,e,C.value.key)});function M(e){if(a.customHighlights?.has(e))return{'acu-cell-changed':!0,'acu-cell-changed-manual':!0};const t=`${a.tableName}-${a.data.index}-${e}`,o=i.getCellChangeType(t);return{'acu-cell-changed':null!==o,'acu-cell-changed-manual':'manual'===o,'acu-cell-changed-ai':'ai'===o}}const U=(0,m.computed)(()=>{const e=i.getRowChangeType(a.tableName,a.data.index,a.data.cells.length);return'manual'===e?'acu-highlight-changed acu-highlight-manual':'ai'===e?'acu-highlight-changed acu-highlight-ai':''}),{isSelecting:L,shouldBlockInteraction:P,wasSelecting:F}=function(){const{text:e}=(0,de.fOm)(),t=(0,m.computed)(()=>e.value.length>0),a=(0,m.ref)(!1),o=(0,m.ref)(null);return(0,m.watch)(t,e=>{!e&&a.value?o.value=setTimeout(()=>{a.value=!1},100):e&&(a.value=!0,o.value&&(clearTimeout(o.value),o.value=null))}),{selectedText:e,isSelecting:t,wasSelecting:(0,m.computed)(()=>a.value),shouldBlockInteraction:()=>t.value||a.value,clearSelection:()=>{const e=window.getSelection();e&&e.removeAllRanges()}}}(),{isSwiping:j,gestureType:O,atStart:R,atEnd:H,checkScrollEdge:W,lengthX:G,lengthY:Y}=function(e,t){const{layout:a,onInsertRow:o,onToggleDelete:n,horizontalThreshold:r=50,verticalThreshold:l=40,edgeThreshold:i=5,longPressDelay:c=400,longPressCancelThreshold:s=5}=t,u='horizontal'===a?r:l,{text:d}=(0,de.fOm)(),p=(0,m.computed)(()=>d.value.length>0),f=(0,m.ref)(!1),g=(0,m.ref)(!1),v=(0,m.ref)(!1),b=(0,m.ref)(null),h=(0,m.ref)(!1),x=(0,m.ref)(0),y=(0,m.ref)(0),w=(0,m.ref)(0),k=(0,m.ref)(0),C=(0,m.ref)(null),N=(0,m.ref)(!1),V=(0,m.ref)(0),E=(0,m.ref)(0),B=(0,m.ref)(!1),S=(0,m.ref)(0),T=(0,m.ref)(null),D=(0,m.ref)(!1),A=(0,m.ref)(null),I=(0,m.ref)(!1),M=t=>{const o=t?.currentTarget,n=o||e.value;n&&('horizontal'===a?(g.value=n.scrollTop<=i,v.value=n.scrollTop+n.clientHeight>=n.scrollHeight-i):(g.value=n.scrollLeft<=i,v.value=n.scrollLeft+n.clientWidth>=n.scrollWidth-i),f.value=g.value||v.value)},U=()=>{const e=window.getSelection();return!!e&&e.toString().length>0},L=(0,m.computed)(()=>p.value||U()),P=t=>{const o=e.value;if(!o)return;D.value=!1,I.value=!1,b.value=null,C.value=null,N.value=!1,A.value&&(clearTimeout(A.value),A.value=null),U()&&(D.value=!0);const n=t.touches[0];if(x.value=n.clientX,y.value=n.clientY,w.value=0,k.value=0,h.value=!0,'horizontal'===a){const e=o.closest('.acu-data-display');T.value=e,S.value=e?.scrollLeft??0}M(),V.value=o.scrollHeight,E.value=o.clientHeight,B.value=o.scrollHeight<=o.clientHeight+2,A.value=setTimeout(()=>{I.value=!0,D.value=!0},c)},F=t=>{const o=e.value;if(!o||!h.value)return;const n=t.touches[0],r=n.clientX-x.value,l=n.clientY-y.value;w.value=r,k.value=l,(Math.abs(r)>s||Math.abs(l)>s)&&A.value&&(clearTimeout(A.value),A.value=null);const i=U();if(D.value||I.value||i)D.value=!0;else if(M(),!C.value&&(Math.abs(r)>10||Math.abs(l)>10)&&(C.value=Math.abs(r)>Math.abs(l)?'horizontal':'vertical',console.info('[ACU Card] æ–¹å‘é”å®šä¸º:',C.value)),'horizontal'===a){const e=o.scrollTop;if(B.value){if(!C.value&&(Math.abs(r)>10||Math.abs(l)>10)&&(C.value=Math.abs(r)>Math.abs(l)?'horizontal':'vertical',console.info('[ACU Card] çŸ­å¡ç‰‡æ–¹å‘é”å®šä¸º:',C.value)),'horizontal'===C.value)return N.value||(b.value=null),void(T.value&&(T.value.scrollLeft=S.value-r));if('vertical'===C.value||null===C.value&&Math.abs(l)>5){t.cancelable&&t.preventDefault(),t.stopPropagation();const e=l>0?'insert':'delete';.6*Math.abs(l)>30?(b.value=e,N.value=!0):N.value||(b.value=null)}return}if('horizontal'===C.value)return N.value||(b.value=null),void(T.value&&(T.value.scrollLeft=S.value-r));if('vertical'===C.value){const a=o.scrollHeight,n=o.clientHeight,r=l>0&&e<=0;if(r||l<0&&e+n>=a-2){t.cancelable&&t.preventDefault(),t.stopPropagation();const e=r?'insert':'delete';.6*Math.abs(l)>30?(b.value=e,N.value=!0):N.value||(b.value=null)}else N.value||(b.value=null)}}else if('vertical'===a&&Math.abs(r)>Math.abs(l)&&Math.abs(r)>10){t.cancelable&&t.preventDefault(),t.stopPropagation();const e=.7*Math.abs(r);b.value=r>0&&e>28?'delete':r<0&&e>28?'insert':null}},j=t=>{const r=e.value;if(!r)return;A.value&&(clearTimeout(A.value),A.value=null);const l=w.value,i=k.value;if('horizontal'===a&&'horizontal'===C.value)return console.info('[ACU Card TouchEnd] æ–¹å‘é”å®šä¸ºæ¨ªå‘ï¼Œè·³è¿‡çºµå‘æ‰‹åŠ¿'),h.value=!1,b.value=null,void(N.value=!1);if(console.info('[ACU Card TouchEnd] å¼€å§‹å¤„ç†',{layout:a,deltaX:l.toFixed(1),deltaY:i.toFixed(1),threshold:u,isSelectionMode:I.value,hasNativeSelection:U(),shouldBlockClick:D.value,gestureType:b.value}),I.value||U())return console.info('[ACU Card TouchEnd] é€‰è¯æ¨¡å¼ï¼Œè·³è¿‡æ‰‹åŠ¿'),D.value=!0,h.value=!1,void(b.value=null);if(D.value)return console.info('[ACU Card TouchEnd] shouldBlockClick é”å®šï¼Œè·³è¿‡æ‰‹åŠ¿'),h.value=!1,void(b.value=null);if('horizontal'===a){const e=r.scrollTop,t=r.scrollHeight,a=r.clientHeight,l=B.value,c=i>0&&(e<=0||l),s=i<0&&(e+a>=t-2||l);console.info('[ACU Card TouchEnd] æ¨ªå‘å¸ƒå±€åˆ¤å®š',{scrollTop:e,scrollHeight:t,clientHeight:a,isShortCard:l,isPullDown:c,isPullUp:s,deltaY:i.toFixed(1),threshold:u,åº”è§¦å‘æ–°å¢:c&&i>u,åº”è§¦å‘åˆ é™¤:s&&Math.abs(i)>u}),c&&i>u?(console.info('[ACU Card] ä¸‹æ‹‰è§¦å‘æ–°å¢è¡Œ (deltaY:',i,')'),o()):s&&Math.abs(i)>u?(console.info('[ACU Card] ä¸Šåˆ’è§¦å‘åˆ é™¤åˆ‡æ¢ (deltaY:',i,')'),n()):console.info('[ACU Card TouchEnd] æ¨ªå‘å¸ƒå±€æœªè§¦å‘ä»»ä½•æ“ä½œ')}else'vertical'===a&&(console.info('[ACU Card TouchEnd] çºµå‘å¸ƒå±€åˆ¤å®š',{deltaX:l.toFixed(1),threshold:u,'åº”è§¦å‘åˆ é™¤(å³æ»‘)':l>u,'åº”è§¦å‘æ–°å¢(å·¦æ»‘)':l<-u}),l>u?(console.info('[ACU Card] å³æ»‘è§¦å‘åˆ é™¤åˆ‡æ¢ (deltaX:',l,')'),n()):l<-u?(console.info('[ACU Card] å·¦æ»‘è§¦å‘æ–°å¢è¡Œ (deltaX:',l,')'),o()):console.info('[ACU Card TouchEnd] çºµå‘å¸ƒå±€æœªè§¦å‘ä»»ä½•æ“ä½œ'));setTimeout(()=>{b.value=null,N.value=!1},300),h.value=!1};return(0,m.watch)(e,(e,t)=>{t&&(t.removeEventListener('touchstart',P),t.removeEventListener('touchmove',F),t.removeEventListener('touchend',j)),e&&(e.addEventListener('touchstart',P,{passive:!0}),e.addEventListener('touchmove',F,{passive:!1}),e.addEventListener('touchend',j,{passive:!0}),M())},{immediate:!0}),(0,m.onUnmounted)(()=>{const t=e.value;t&&(t.removeEventListener('touchstart',P),t.removeEventListener('touchmove',F),t.removeEventListener('touchend',j)),A.value&&(clearTimeout(A.value),A.value=null)}),{isSelecting:L,scrolledToEdge:f,atStart:g,atEnd:v,isSwiping:h,gestureType:b,checkScrollEdge:M,lengthX:w,lengthY:k,shouldBlockClick:D,isSelectionMode:I}}(n,{layout:a.layout,horizontalThreshold:50,verticalThreshold:40,edgeThreshold:10,onInsertRow:()=>{console.info('[ACU DataCard] æ‰‹åŠ¿è§¦å‘æ–°å¢è¡Œ'),o('insertRow')},onToggleDelete:()=>{console.info('[ACU DataCard] æ‰‹åŠ¿è§¦å‘åˆ‡æ¢åˆ é™¤',{isDeleting:y.value}),o('toggleDelete')}}),X=(0,m.computed)(()=>{if('horizontal'!==a.layout)return 0;const e=Math.abs(Y?.value||0);return Math.min(.6*e,120)}),q=(0,m.computed)(()=>Math.min(X.value/80,1)),K=(0,m.computed)(()=>{if('vertical'!==a.layout)return 0;const e=Math.abs(G?.value||0);return Math.min(.7*e,120)}),J=(0,m.computed)(()=>Math.min(K.value/60,1));(0,m.watchEffect)(()=>{d.value&&(d.value.style.height=`${X.value}px`,d.value.style.opacity=String(q.value)),p.value&&(p.value.style.height=`${X.value}px`,p.value.style.opacity=String(q.value))}),(0,m.watchEffect)(()=>{f.value&&(f.value.style.width=`${K.value}px`,f.value.style.opacity=String(J.value)),g.value&&(g.value.style.width=`${K.value}px`,g.value.style.opacity=String(J.value))}),(0,m.watch)([R,H],([e,t])=>{v.value&&(e||t)&&(h.value&&clearTimeout(h.value),b.value=!0,h.value=setTimeout(()=>{b.value=!1},2e3))});const Q=e=>{W(e)};function Z(e){if(!c.isLockEditMode)return{};const t=a.data.cells[e];if(!t)return{};const o=D.value;if(!o)return{};const n=s.isCellLockedPending(a.tableName,o,t.key),r=s.isRowLockedPending(a.tableName,o);return{'acu-cell-locked':n||r,'acu-cell-row-locked':r}}const ee=()=>{const e=D.value;if(!e)return void console.warn('[ACU] æ— æ³•ç”Ÿæˆè¡Œé”®ï¼Œè·³è¿‡æ•´è¡Œé”å®š');const t=a.data.cells.map(e=>e.key),o=a.data.cells.map(e=>String(e.value??'')),n=s.toggleRowLock(a.tableName,e,t,o);console.info(`[ACU] æ•´è¡Œé”å®šçŠ¶æ€åˆ‡æ¢: ${e} -> ${n?'é”å®š':'è§£é”'}`)},te=e=>{if(P()||F.value)console.info('[ACU] æ£€æµ‹åˆ°é€‰è¯æ“ä½œæˆ–åˆšç»“æŸé€‰è¯ï¼Œé˜»æ­¢ç‚¹å‡»äº‹ä»¶');else if(j.value)console.info('[ACU] æ»‘åŠ¨ä¸­ï¼Œé˜»æ­¢ç‚¹å‡»äº‹ä»¶');else if(y.value)console.info('[ACU] å¾…åˆ é™¤è¡Œä¸èƒ½ç¼–è¾‘');else if(a.allowEdit){if(c.isLockEditMode){const t=a.data.cells[e];if(!t)return;const o=D.value;if(!o)return void console.warn('[ACU] æ— æ³•ç”Ÿæˆè¡Œé”®ï¼Œè·³è¿‡é”å®šæ“ä½œ');const n=String(t.value??''),r=s.toggleCellLock(a.tableName,o,t.key,n);return void console.info(`[ACU] å•å…ƒæ ¼é”å®šçŠ¶æ€åˆ‡æ¢: ${t.key} -> ${r?'é”å®š':'è§£é”'}`)}r.value=e,o('cellClick',a.data.index,e)}else o('cellClick',a.data.index,e)},ae=()=>{if(!(a.titleColIndex<0)&&C.value)if(y.value)console.info('[ACU] å¾…åˆ é™¤è¡Œä¸èƒ½æ“ä½œæ ‡é¢˜');else if(a.allowEdit){if(c.isLockEditMode){const e=D.value;if(!e)return void console.warn('[ACU] æ— æ³•ç”Ÿæˆè¡Œé”®ï¼Œè·³è¿‡æ ‡é¢˜é”å®šæ“ä½œ');const t=String(C.value.value??''),o=s.toggleCellLock(a.tableName,e,C.value.key,t);return void console.info(`[ACU] æ ‡é¢˜é”å®šçŠ¶æ€åˆ‡æ¢: ${C.value.key} -> ${o?'é”å®š':'è§£é”'}`)}console.info('[ACU DataCard] æ ‡é¢˜ç‚¹å‡»ï¼Œè§¦å‘ç¼–è¾‘ colIndex:',a.titleColIndex),r.value=a.titleColIndex,o('cellClick',a.data.index,a.titleColIndex)}else o('cellClick',a.data.index,a.titleColIndex)},oe=(e,t)=>{i.updateCell(a.tableName,a.data.index,e,t);const o=a.data.cells[e],n=D.value;o&&n&&s.isCellLocked(a.tableName,n,o.key)&&(s.updateLockedValue(a.tableName,n,o.key,t),console.info('[ACU] åŒæ­¥æ›´æ–°é”å®šå€¼:',o.key,'->',t)),r.value=null},ne=async()=>{if(!l.value){l.value=!0;try{const e=await u.getSnapshots(a.tableName,a.data.index);if(0===e.length)return void S.toast.warning('è¯¥è¡Œæ²¡æœ‰å†å²è®°å½•');const t=e[0];let o=0;for(const[e,n]of Object.entries(t.cells)){const t=Number(e),r=a.data.cells[t]?.value;r!==n&&(i.updateCell(a.tableName,a.data.index,t,n,{skipHistory:!0}),o++)}o>0?S.toast.success(`å·²æ’¤å› ${o} ä¸ªå•å…ƒæ ¼åˆ°ä¸Šä¸€ç‰ˆæœ¬`):S.toast.info('å½“å‰æ•°æ®ä¸å†å²ç‰ˆæœ¬ç›¸åŒ')}catch(e){console.error('[ACU] æ’¤å›å¤±è´¥:',e),S.toast.error('æ’¤å›å¤±è´¥')}finally{l.value=!1}}},re=e=>{/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?console.info('[ACU] ç§»åŠ¨ç«¯ä¸è§¦å‘å³é”®èœå•'):o('contextMenu',e,a.data.index)};return(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{ref_key:'cardRef',ref:n,class:(0,m.normalizeClass)(['acu-data-card',[U.value,{'acu-editing-lock':null!==r.value,'acu-style-list':'list'===e.viewMode,'acu-style-card':'card'===e.viewMode,'acu-swiping':(0,m.unref)(j)}]]),onContextmenu:(0,m.withModifiers)(re,['prevent']),onScroll:Q},[(0,m.createCommentVNode)(' æ¨ªå‘å¸ƒå±€ï¼šé¡¶éƒ¨ä¸‹æ‹‰æ–°å¢æç¤ºï¼ˆå¿…é¡»åœ¨æœ€å‰é¢ï¼Œä¸åŸç‰ˆ prepend ä¸€è‡´ï¼‰ '),(0,m.createCommentVNode)(' æ³¨æ„ï¼šä½¿ç”¨ v-show æ›¿ä»£ v-if ä¿æŒ DOM å­˜åœ¨ï¼Œé…åˆ watchEffect ç›´æ¥æ“ä½œæ ·å¼ '),(0,m.withDirectives)((0,m.createElementVNode)('div',{ref_key:'pullTopRef',ref:d,class:'acu-pull-overlay acu-pull-top'},[...a[6]||(a[6]=[(0,m.createElementVNode)('div',{class:'acu-pull-icon'},[(0,m.createElementVNode)('i',{class:'fa-solid fa-plus'}),(0,m.createElementVNode)('span',{class:'acu-pull-text'},'æ–°å¢ä¸€è¡Œ')],-1)])],512),[[m.vShow,'horizontal'===e.layout&&(0,m.unref)(v)&&'insert'===(0,m.unref)(O)]]),(0,m.createCommentVNode)(' å¡ç‰‡å¤´éƒ¨ï¼ˆå¯é€‰æ˜¾ç¤ºç´¢å¼•å’Œæ ‡é¢˜ï¼‰ '),e.showHeader?((0,m.openBlock)(),(0,m.createElementBlock)('div',ct,[e.showIndex?((0,m.openBlock)(),(0,m.createElementBlock)('span',st,'#'+(0,m.toDisplayString)(e.data.index+1),1)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' æ ‡é¢˜ç¼–è¾‘æ¨¡å¼ '),C.value&&r.value===e.titleColIndex&&!(0,m.unref)(c).isLockEditMode?((0,m.openBlock)(),(0,m.createBlock)(it,{key:1,class:'acu-title-editor',value:C.value.value,onSave:a[0]||(a[0]=t=>oe(e.titleColIndex,t)),onCancel:a[1]||(a[1]=e=>r.value=null)},null,8,['value'])):C.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' æ ‡é¢˜æ˜¾ç¤ºæ¨¡å¼ '),(0,m.createElementVNode)('span',{class:(0,m.normalizeClass)(['acu-editable-title',{'acu-title-locked':I.value}]),onClick:ae},[(0,m.createTextVNode)((0,m.toDisplayString)(C.value.value||'æœªå‘½å')+' ',1),I.value?((0,m.openBlock)(),(0,m.createElementBlock)('i',ut)):(0,m.createCommentVNode)('v-if',!0)],2)],2112)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è¡Œé”å®šæŒ‰é’®ï¼ˆä»…é”å®šç¼–è¾‘æ¨¡å¼æ˜¾ç¤ºï¼‰ '),(0,m.unref)(c).isLockEditMode?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:3,class:(0,m.normalizeClass)(['acu-row-lock-btn',{'acu-row-locked':A.value}]),title:'é”å®š/è§£é”æ•´è¡Œ',onClick:(0,m.withModifiers)(ee,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(A.value?'fas fa-lock':'fas fa-lock-open')},null,2)],2)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å†å²è®°å½•æŒ‰é’®ç»„ '),e.showHistoryButton&&!(0,m.unref)(c).isLockEditMode?((0,m.openBlock)(),(0,m.createElementBlock)('div',dt,[(0,m.createCommentVNode)(' æ’¤å›æŒ‰é’® '),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-undo-trigger',{'acu-loading':l.value}]),disabled:l.value,title:'æ’¤å›åˆ°ä¸Šä¸€ç‰ˆæœ¬',onClick:(0,m.withModifiers)(ne,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(l.value?'fas fa-spinner fa-spin':'fas fa-undo')},null,2)],10,pt),(0,m.createCommentVNode)(' æŸ¥çœ‹å†å²æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-history-trigger',title:'æŸ¥çœ‹å†å²è®°å½•',onClick:a[2]||(a[2]=(0,m.withModifiers)(e=>o('showHistory'),['stop']))},[...a[7]||(a[7]=[(0,m.createElementVNode)('i',{class:'fas fa-search'},null,-1)])])])):(0,m.createCommentVNode)('v-if',!0)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å¡ç‰‡å†…å®¹åŒº - Card å¸ƒå±€ '),'card'===e.viewMode?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' Card å•å…ƒæ ¼åŒºåŸŸ '),(0,m.createElementVNode)('div',mt,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(E.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.colIndex,class:(0,m.normalizeClass)(['acu-grid-item',[M(e.colIndex),Z(e.colIndex)]]),onClick:t=>te(e.colIndex)},[(0,m.createElementVNode)('label',gt,(0,m.toDisplayString)(e.key),1),(0,m.createElementVNode)('div',vt,[r.value!==e.colIndex||(0,m.unref)(c).isLockEditMode?((0,m.openBlock)(),(0,m.createBlock)(lt,{key:1,value:e.value},null,8,['value'])):((0,m.openBlock)(),(0,m.createBlock)(it,{key:0,value:e.value,onSave:t=>oe(e.colIndex,t),onCancel:a[3]||(a[3]=e=>r.value=null)},null,8,['value','onSave']))]),(0,m.createCommentVNode)(' é”å®šå›¾æ ‡ï¼ˆä»…é”å®šç¼–è¾‘æ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ '),(0,m.unref)(c).isLockEditMode&&Z(e.colIndex)['acu-cell-locked']?((0,m.openBlock)(),(0,m.createElementBlock)('i',bt)):(0,m.createCommentVNode)('v-if',!0)],10,ft))),128))]),(0,m.createCommentVNode)(' Full-Width å•å…ƒæ ¼åŒºåŸŸï¼ˆé•¿æ–‡æœ¬ï¼‰ '),T.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',ht,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(T.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.colIndex,class:(0,m.normalizeClass)(['acu-full-item',[M(e.colIndex),Z(e.colIndex)]]),onClick:t=>te(e.colIndex)},[(0,m.createElementVNode)('label',yt,(0,m.toDisplayString)(e.key),1),(0,m.createElementVNode)('div',wt,[r.value!==e.colIndex||(0,m.unref)(c).isLockEditMode?((0,m.openBlock)(),(0,m.createElementBlock)('span',kt,(0,m.toDisplayString)(e.value||'-'),1)):((0,m.openBlock)(),(0,m.createBlock)(it,{key:0,value:e.value,'max-height':300,onSave:t=>oe(e.colIndex,t),onCancel:a[4]||(a[4]=e=>r.value=null)},null,8,['value','onSave']))]),(0,m.createCommentVNode)(' é”å®šå›¾æ ‡ï¼ˆä»…é”å®šç¼–è¾‘æ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ '),(0,m.unref)(c).isLockEditMode&&Z(e.colIndex)['acu-cell-locked']?((0,m.openBlock)(),(0,m.createElementBlock)('i',Ct)):(0,m.createCommentVNode)('v-if',!0)],10,xt))),128))])):(0,m.createCommentVNode)('v-if',!0)],64)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' å¡ç‰‡å†…å®¹åŒº - List å¸ƒå±€ '),(0,m.createElementVNode)('div',Nt,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(N.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.colIndex,class:(0,m.normalizeClass)(['acu-card-row',[M(e.colIndex),Z(e.colIndex)]]),onClick:t=>te(e.colIndex)},[(0,m.createElementVNode)('label',Et,(0,m.toDisplayString)(e.key)+':',1),(0,m.createElementVNode)('div',Bt,[r.value!==e.colIndex||(0,m.unref)(c).isLockEditMode?((0,m.openBlock)(),(0,m.createBlock)(lt,{key:1,value:e.value},null,8,['value'])):((0,m.openBlock)(),(0,m.createBlock)(it,{key:0,value:e.value,onSave:t=>oe(e.colIndex,t),onCancel:a[5]||(a[5]=e=>r.value=null)},null,8,['value','onSave']))]),(0,m.createCommentVNode)(' é”å®šå›¾æ ‡ï¼ˆä»…é”å®šç¼–è¾‘æ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ '),(0,m.unref)(c).isLockEditMode&&Z(e.colIndex)['acu-cell-locked']?((0,m.openBlock)(),(0,m.createElementBlock)('i',St)):(0,m.createCommentVNode)('v-if',!0)],10,Vt))),128))])],64)),(0,m.createCommentVNode)(' æ¨ªå‘å¸ƒå±€ï¼šåº•éƒ¨ä¸Šåˆ’åˆ é™¤æç¤ºï¼ˆåœ¨å†…å®¹åŒºåŸŸä¹‹åï¼Œä¸åŸç‰ˆ append ä¸€è‡´ï¼‰ '),(0,m.createCommentVNode)(' æ³¨æ„ï¼šä½¿ç”¨ v-show æ›¿ä»£ v-if ä¿æŒ DOM å­˜åœ¨ï¼Œé…åˆ watchEffect ç›´æ¥æ“ä½œæ ·å¼ '),(0,m.withDirectives)((0,m.createElementVNode)('div',{ref_key:'pullBottomRef',ref:p,class:(0,m.normalizeClass)(['acu-pull-overlay acu-pull-bottom',{'acu-pull-restore':y.value}])},[(0,m.createElementVNode)('div',Tt,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(y.value?'fa-solid fa-undo':'fa-solid fa-trash')},null,2),(0,m.createElementVNode)('span',Dt,(0,m.toDisplayString)(y.value?'æ’¤é”€åˆ é™¤':'åˆ é™¤æœ¬è¡Œ'),1)])],2),[[m.vShow,'horizontal'===e.layout&&(0,m.unref)(v)&&'delete'===(0,m.unref)(O)]]),(0,m.createCommentVNode)(' å¾…åˆ é™¤å°ç«  (åœ†å½¢å°ç« æ ·å¼) '),y.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',At,'å¾…åˆ é™¤')):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' ç«–å‘å¸ƒå±€ï¼šå·¦å³æ»‘åŠ¨åé¦ˆï¼ˆä¸åŸç‰ˆ .acu-swipe-overlay ä¸€è‡´ï¼‰ '),(0,m.createCommentVNode)(' æ³¨æ„ï¼šä½¿ç”¨ v-show æ›¿ä»£ v-if ä¿æŒ DOM å­˜åœ¨ï¼Œé…åˆ watchEffect ç›´æ¥æ“ä½œæ ·å¼ '),'vertical'===e.layout&&(0,m.unref)(v)?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:4},[(0,m.createCommentVNode)(' å·¦ä¾§å³æ»‘åˆ é™¤æç¤º '),(0,m.withDirectives)((0,m.createElementVNode)('div',{ref_key:'swipeLeftRef',ref:f,class:(0,m.normalizeClass)(['acu-swipe-overlay acu-swipe-left',{'acu-swipe-restore':y.value}])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(y.value?'fa-solid fa-undo':'fa-solid fa-trash')},null,2)],2),[[m.vShow,'delete'===(0,m.unref)(O)]]),(0,m.createCommentVNode)(' å³ä¾§å·¦æ»‘æ–°å¢æç¤º '),(0,m.withDirectives)((0,m.createElementVNode)('div',{ref_key:'swipeRightRef',ref:g,class:'acu-swipe-overlay acu-swipe-right'},[...a[8]||(a[8]=[(0,m.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1)])],512),[[m.vShow,'insert'===(0,m.unref)(O)]])],64)):(0,m.createCommentVNode)('v-if',!0)],34))}});var It=d(6444),_t=d(4182),Mt=d(4919);function Ut(){const e=(0,Mt.E)(),t=(0,k.j_)(),{setHiddenPrompt:a,setupSendIntercept:o,appendPromptToInput:n}=se();function r(t){const a=t.dimensions.map(e=>({dimensionName:e.name,tierName:e.value,prompt:e.prompt})),o=e.config,n=o&&'object'==typeof o&&'value'in o?o.value?.customTemplate:o?.customTemplate;if(n&&n.trim()){let e=n;const a=t.luck.prompt||'',o=t.words.join('ã€'),r=new Map;t.dimensions.forEach(e=>{e.prompt&&e.prompt.trim()&&r.set(e.name,e.prompt)});const l=new Set;e=e.replace(/\{\{luck\}\}/gi,a),e=e.replace(/\{\{words\}\}/gi,o);for(const[t,a]of r.entries()){const o=t.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),n=new RegExp(`\\{\\{${o}\\}\\}`,'gi');n.test(e)&&(e=e.replace(n,a),l.add(t))}const i=[];for(const[e,t]of r.entries())l.has(e)||i.push(t);const c=i.join('\n');return e=e.replace(/\{\{dimensions\}\}/gi,c),e}return Me({luck:t.luck,words:t.words,dimensions:a})}async function l(e){const t=window.parent,a=t.getChatMessages||t.TavernHelper?.getChatMessages,o=t.setChatMessages||t.TavernHelper?.setChatMessages,r=t.getLastMessageId||t.TavernHelper?.getLastMessageId;if(!a||!o)return console.error('[ACU] getChatMessages/setChatMessages not found in parent window or TavernHelper'),void S.toast.error('æ— æ³•è·å–é…’é¦†æ¥å£ï¼Œè¯·ç¡®ä¿é…’é¦†åŠ©æ‰‹å·²æ­£ç¡®å®‰è£…');const l=r?.()??999,i=Math.max(0,l-50),c=a(`${i}-${l}`);let s;for(let e=c.length-1;e>=0;e--)if('user'===c[e].role){s=c[e];break}if(console.info('[ACU Divination] æœç´¢ç”¨æˆ·æ¶ˆæ¯èŒƒå›´:',`${i}-${l}`,'æ€»æ¶ˆæ¯:',c.length,'æ¡ï¼Œæœ€åä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ ID:',s?.message_id),!s)return S.toast.warning('æœªæ‰¾åˆ°ç”¨æˆ·æ¶ˆæ¯ï¼Œå·²æ”¹ä¸ºè¿½åŠ åˆ°è¾“å…¥æ¡†'),void n(e);const u=`<å‰§æƒ…å…ƒæŒ‡ä»¤>\n${e.replace(/<å‰§æƒ…å…ƒæŒ‡ä»¤[^>]*>/g,'').replace(/<\/å‰§æƒ…å…ƒæŒ‡ä»¤>/g,'').trim()}\n</å‰§æƒ…å…ƒæŒ‡ä»¤>`,d=/<å‰§æƒ…å…ƒæŒ‡ä»¤[\s\S]*?<\/å‰§æƒ…å…ƒæŒ‡ä»¤>/,p=s.message||'';let m;m=d.test(p)?p.replace(d,u):u+'\n'+p,await o([{message_id:s.message_id,message:m}]),S.toast.success('å·²æ›¿æ¢ç”¨æˆ·æ¶ˆæ¯ä¸­çš„å‰§æƒ…å…ƒæŒ‡ä»¤ï¼Œè¯·ç‚¹å‡»é‡æ–°ç”Ÿæˆ')}return{performDivination:async function(){e.isLoaded||e.loadConfig(),await t.initDivinationSystem(),0===e.categories.length?(console.info('[ACU] é¦–æ¬¡æŠ½ç­¾ï¼Œå°è¯•åŠ è½½è¯åº“...'),await e.loadFromWorldbook(),0===e.categories.length&&(console.info('[ACU] è¯åº“ä¸ºç©ºï¼Œå°è¯•ä» ACU è¡¨æ ¼åŒæ­¥...'),await e.syncFromACU(),await e.loadFromWorldbook())):e.loadFromWorldbook(),0===e.categories.length&&S.toast.warning('æœªæ‰¾åˆ°éšæœºè¯åº“ã€‚è¯·ç¡®ä¿å­˜åœ¨åä¸º "Random" æˆ– "éšæœº" çš„è¡¨æ ¼ã€‚');const n=e.performDivination();if(n){const l=e.config;if('skip'===(l&&'object'==typeof l&&'value'in l?l.value?.flipMode:l?.flipMode)){const e=r(n);a(e),o(),S.toast.success('æç¤ºè¯å·²æ³¨å…¥éšè—ç¼–è¾‘æ¡†')}else t.openDivinationOverlay(n)}else S.toast.error('æŠ½ç­¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®')},confirmDivination:function(e,i='reveal'){const c=r(e);'reroll'===i?l(c):'hide'===i?(a(c),o(),S.toast.success('æç¤ºè¯å·²æ³¨å…¥éšè—ç¼–è¾‘æ¡†')):n(c),t.closeDivinationOverlay()},triggerQuickReroll:async function(){e.isLoaded||e.loadConfig(),await t.initDivinationSystem(),0===e.categories.length?(await e.loadFromWorldbook(),0===e.categories.length&&(await e.syncFromACU(),await e.loadFromWorldbook())):e.loadFromWorldbook();const a=e.performDivination();if(a){const o=e.config;if('skip'===(o.value?.flipMode??o?.flipMode)){const e=r(a);await l(e)}else t.openDivinationOverlay(a,!0)}else S.toast.error('æŠ½ç­¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®')}}}var $t=d(7285);const Lt={class:'acu-embedded-options'},Pt={key:0,class:'acu-empty-hint'},Ft={class:'acu-embedded-options-list'},jt={class:'acu-embedded-option-rows'},Ot=['onClick'],Rt={key:0,class:'acu-embedded-option-tags'},Ht={class:'acu-embedded-option-text'},Wt=(0,m.defineComponent)({__name:'EmbeddedOptionsPanel',props:{tables:{}},setup(e){const t=e,{setInput:a}=ue(),o=(0,m.computed)(()=>t.tables.filter(e=>e.name.includes('é€‰é¡¹')||e.name.toLowerCase().includes('option')));function n(e){return e&&e.rows?e.rows.map(e=>{const t=e.cells;if(0===t.length)return{tags:[],text:''};if(1===t.length)return{tags:[],text:String(t[0].value)};{const e=t.filter(e=>''!==String(e.value).trim());if(0===e.length)return{tags:[],text:''};if(1===e.length)return{tags:[],text:String(e[0].value)};return{tags:e.slice(0,-1).map(e=>String(e.value)),text:String(e[e.length-1].value)}}}):[]}return(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Lt,[(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===o.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Pt,[...t[0]||(t[0]=[(0,m.createElementVNode)('i',{class:'fas fa-inbox'},null,-1),(0,m.createTextVNode)(' æœªæ‰¾åˆ°åç§°åŒ…å«"é€‰é¡¹"çš„è¡¨æ ¼ ',-1)])])):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' é€‰é¡¹è¡¨æ ¼åˆ—è¡¨ '),(0,m.createElementVNode)('div',Ft,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(o.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-embedded-option-group'},[(0,m.createCommentVNode)(' é€‰é¡¹è¡Œåˆ—è¡¨ '),(0,m.createElementVNode)('div',jt,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(n(e),(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t,class:'acu-embedded-option-row',title:'ç‚¹å‡»è¿½åŠ ',onClick:(0,m.withModifiers)(t=>{var o;(o=e.text).trim()&&a(o.trim())},['stop'])},[(0,m.createCommentVNode)(' æ ‡ç­¾åŒºåŸŸ (Tag åœ¨ä¸Š) '),e.tags.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Rt,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.tags,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:t,class:'acu-badge acu-option-tag'},(0,m.toDisplayString)(e),1))),128))])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' é€‰é¡¹æ–‡æœ¬ (å†…å®¹åœ¨ä¸‹) '),(0,m.createElementVNode)('div',Ht,(0,m.toDisplayString)(e.text),1)],8,Ot))),128))])]))),128))])],2112))]))}}),Gt={class:'acu-global-header'},Yt={key:0,class:'acu-global-location'},Xt={class:'location-path'},qt={class:'location-part'},Kt={key:0,class:'location-sep'},Jt={key:1,class:'acu-global-time-group'},Qt={key:0,class:'acu-global-time-primary'},Zt={class:'acu-global-time-secondary'},ea={key:0,class:'acu-badge-outline is-highlight'},ta={key:1,class:'acu-badge-outline',title:'ä¸Šè½®æ—¶é—´'},aa={class:'acu-global-body'},oa={key:0,class:'acu-global-item layout-inline'},na={class:'item-icon'},ra={class:'item-content'},la={class:'item-label'},ia={class:'item-value'},ca={class:'item-icon'},sa={class:'item-content'},ua={class:'item-label'},da={class:'item-value'},pa={key:1,class:'acu-global-item layout-inline people-group'},ma={class:'item-content'},fa={class:'item-label'},ga={class:'acu-global-person-list'},va={key:0,class:'acu-global-footer'},ba={class:'acu-global-item layout-block system-notice'},ha={class:'item-icon'},xa={class:'item-content'},ya={class:'item-label'},wa={class:'item-value'},ka=(0,m.defineComponent)({__name:'GlobalStatusWidget',props:{tableData:{},isEditing:{type:Boolean}},setup(e){const t=e,a=(0,m.computed)(()=>t.tableData&&0!==t.tableData.rows.length?t.tableData.rows[0]:null),o=(0,m.computed)(()=>{const e=a.value;if(!e)return null;const t={locationCols:[],timeCols:{current:null,passed:null,last:null},weatherCol:null,peopleCol:null,attributes:[],footer:null};e.cells.forEach(e=>{const a=e.key.toLowerCase();String(e.value||'')&&(['æ—¶','time','date','clock'].some(e=>a.includes(e))?['æµé€','ç»è¿‡','passed','elapse'].some(e=>a.includes(e))?t.timeCols.passed=e:['ä¸Šè½®','last','prev'].some(e=>a.includes(e))?t.timeCols.last=e:!t.timeCols.current||a.length<t.timeCols.current.key.length?(t.timeCols.current&&t.attributes.push(t.timeCols.current),t.timeCols.current=e):t.attributes.push(e):!['åœº','åœ°','ä½ç½®','loc','place','area','zone'].some(e=>a.includes(e))||a.includes('åœ¨åœº')?['å¤©','æ°”','weather','climate'].some(e=>a.includes(e))?t.weatherCol=e:['äºº','npc','chara','åœ¨åœº','role'].some(e=>a.includes(e))?t.peopleCol=e:t.attributes.push(e):t.locationCols.push(e))});let o=0,n=-1;return t.attributes.forEach((e,t)=>{const a=String(e.value).length;(['ç³»','ç»Ÿ','çŸ¥','sys','info'].some(t=>e.key.toLowerCase().includes(t))||a>30&&a>o)&&(o=a,n=t)}),-1!==n&&(t.footer=t.attributes[n],t.attributes.splice(n,1)),t}),n=(0,m.computed)(()=>{const e=o.value?.locationCols;return e&&0!==e.length?e.sort((e,t)=>e.colIndex-t.colIndex).map(e=>e.value).join(' â€º '):''}),r=(0,m.computed)(()=>{const e=o.value?.locationCols;return e&&0!==e.length?e.sort((e,t)=>e.colIndex-t.colIndex).map(e=>e.value):[]}),l=(0,m.computed)(()=>({current:o.value?.timeCols.current?.value,passed:o.value?.timeCols.passed?.value,last:o.value?.timeCols.last?.value})),i=(0,m.computed)(()=>{const e=o.value?.weatherCol;return e?{label:e.key,value:String(e.value)}:null});function c(e){const t=e.toLowerCase();return t.includes('æ™´')||t.includes('sun')||t.includes('clear')?'fa-sun':t.includes('é˜´')||t.includes('cloud')||t.includes('overcast')?'fa-cloud':t.includes('é›¨')||t.includes('rain')?'fa-cloud-showers-heavy':t.includes('é›ª')||t.includes('snow')?'fa-snowflake':t.includes('é›·')||t.includes('thunder')||t.includes('storm')?'fa-bolt':t.includes('é›¾')||t.includes('fog')||t.includes('mist')?'fa-smog':t.includes('é£')||t.includes('wind')?'fa-wind':t.includes('å°é£')||t.includes('hurricane')?'fa-hurricane':'fa-cloud-sun'}const s=(0,m.computed)(()=>o.value?.peopleCol),u=(0,m.computed)(()=>{const e=s.value;return e&&e.value?String(e.value).split(/[,ï¼Œã€/&]/).map(e=>e.trim()).filter(e=>e):[]}),d=(0,m.computed)(()=>o.value?o.value.attributes.map(e=>({key:e.key,value:String(e.value),isLong:String(e.value).length>15})):[]),p=(0,m.computed)(()=>{const e=o.value?.footer;return e?{key:e.key,value:String(e.value)}:null});function f(e){const t=e.toLowerCase();return['é‡‘','é’±','å¸','money','gold','coin'].some(e=>t.includes(e))?'fa-coins':['ç³»','ç»Ÿ','çŸ¥','sys','info','notice'].some(e=>t.includes(e))?'fa-bell':['æ€','state','status','hp','mp'].some(e=>t.includes(e))?'fa-heart-pulse':['çº§','level','lv','rank'].some(e=>t.includes(e))?'fa-layer-group':'fa-info-circle'}return(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:(0,m.normalizeClass)(['acu-global-widget',{'is-editing':e.isEditing}])},[(0,m.createCommentVNode)(' å¤´éƒ¨åŒºåŸŸ (Location + Time) '),(0,m.createElementVNode)('div',Gt,[(0,m.createCommentVNode)(' Location (H1) '),n.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Yt,[a[0]||(a[0]=(0,m.createElementVNode)('i',{class:'fas fa-map-marker-alt'},null,-1)),(0,m.createElementVNode)('div',Xt,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(r.value,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:t},[(0,m.createElementVNode)('span',qt,(0,m.toDisplayString)(e),1),t<r.value.length-1?((0,m.openBlock)(),(0,m.createElementBlock)('span',Kt,'â€º')):(0,m.createCommentVNode)('v-if',!0)],64))),128))])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' Time Group '),l.value.current||l.value.passed||l.value.last?((0,m.openBlock)(),(0,m.createElementBlock)('div',Jt,[(0,m.createCommentVNode)(' Current Time '),l.value.current?((0,m.openBlock)(),(0,m.createElementBlock)('div',Qt,[a[1]||(a[1]=(0,m.createElementVNode)('i',{class:'fas fa-clock'},null,-1)),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(l.value.current),1)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' Secondary Times '),(0,m.createElementVNode)('div',Zt,[(0,m.createCommentVNode)(' Passed Time Badge '),l.value.passed?((0,m.openBlock)(),(0,m.createElementBlock)('span',ea,[a[2]||(a[2]=(0,m.createElementVNode)('i',{class:'fas fa-hourglass-half'},null,-1)),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(l.value.passed),1)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' Last Time '),l.value.last?((0,m.openBlock)(),(0,m.createElementBlock)('span',ta,[a[3]||(a[3]=(0,m.createElementVNode)('i',{class:'fas fa-history'},null,-1)),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(l.value.last),1)])):(0,m.createCommentVNode)('v-if',!0)])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' å†…å®¹åŒºåŸŸ (Body) '),(0,m.createElementVNode)('div',aa,[(0,m.createCommentVNode)(' å¤©æ°”æ¨¡å— '),i.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',oa,[(0,m.createElementVNode)('div',na,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',c(i.value.value)])},null,2)]),(0,m.createElementVNode)('div',ra,[(0,m.createElementVNode)('div',la,(0,m.toDisplayString)(i.value.label),1),(0,m.createElementVNode)('div',ia,(0,m.toDisplayString)(i.value.value),1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å…¶ä»–å±æ€§ (æµå¼æ’ç‰ˆ) '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(d.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.key,class:(0,m.normalizeClass)(['acu-global-item',e.isLong?'layout-block':'layout-inline'])},[(0,m.createElementVNode)('div',ca,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',f(e.key)])},null,2)]),(0,m.createElementVNode)('div',sa,[(0,m.createElementVNode)('div',ua,(0,m.toDisplayString)(e.key),1),(0,m.createElementVNode)('div',da,(0,m.toDisplayString)(e.value),1)])],2))),128)),(0,m.createCommentVNode)(' äººç‰©åˆ—è¡¨ (Tag Group) '),s.value&&u.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',pa,[a[4]||(a[4]=(0,m.createElementVNode)('div',{class:'item-icon'},[(0,m.createElementVNode)('i',{class:'fas fa-users'})],-1)),(0,m.createElementVNode)('div',ma,[(0,m.createElementVNode)('div',fa,(0,m.toDisplayString)(s.value.key),1),(0,m.createElementVNode)('div',ga,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(u.value,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t,class:'person-tag'},(0,m.toDisplayString)(e),1))),128))])])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' åº•éƒ¨åŒºåŸŸ (Footer: System Notice / Long Text) '),p.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',va,[(0,m.createElementVNode)('div',ba,[(0,m.createElementVNode)('div',ha,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',f(p.value.key)])},null,2)]),(0,m.createElementVNode)('div',xa,[(0,m.createElementVNode)('div',ya,(0,m.toDisplayString)(p.value.key),1),(0,m.createElementVNode)('div',wa,(0,m.toDisplayString)(p.value.value),1)])])])):(0,m.createCommentVNode)('v-if',!0)],2))}}),Ca={class:'acu-switch-list'},Na={class:'acu-switch-list-header'},Va=['onClick'],Ea={class:'item-label'},Ba={key:0,class:'item-badge'},Sa=['checked','onChange'],Ta={key:0,class:'acu-switch-list-empty'},Da={class:'acu-switch-list-footer'},Aa={key:0,class:'empty-hint'},za=(0,m.defineComponent)({__name:'SwitchList',props:{modelValue:{},items:{},maxHeight:{default:'280px'},emptyText:{default:'æš‚æ— æ•°æ®'},footerTemplate:{default:'å·²é€‰æ‹©: {selected}/{total}'},emptyHint:{default:''}},emits:['update:modelValue'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.computed)(()=>0!==a.items.length&&a.modelValue.length===a.items.length),r=(0,m.computed)(()=>a.footerTemplate.replace('{selected}',String(a.modelValue.length)).replace('{total}',String(a.items.length)));function l(e){return a.modelValue.includes(e)}function i(e){const t=[...a.modelValue],n=t.indexOf(e);-1===n?t.push(e):t.splice(n,1),o('update:modelValue',t)}function c(){n.value?o('update:modelValue',[]):o('update:modelValue',a.items.map(e=>e.key))}function s(){o('update:modelValue',[])}return(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Ca,[(0,m.createCommentVNode)(' å¤´éƒ¨æŒ‰é’®åŒº '),(0,m.createElementVNode)('div',Na,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-quick-select-btn',{active:n.value}]),onClick:(0,m.withModifiers)(c,['stop'])},[...a[1]||(a[1]=[(0,m.createElementVNode)('i',{class:'fas fa-check-double'},null,-1),(0,m.createTextVNode)(' å…¨é€‰ ',-1)])],2),(0,m.createElementVNode)('button',{class:'acu-quick-select-btn',onClick:(0,m.withModifiers)(s,['stop'])},[...a[2]||(a[2]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1),(0,m.createTextVNode)(' æ¸…ç©º ',-1)])])]),(0,m.createCommentVNode)(' æ»šåŠ¨åˆ—è¡¨åŒº '),(0,m.createElementVNode)('div',{class:'acu-switch-list-body',style:(0,m.normalizeStyle)({maxHeight:e.maxHeight})},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.items,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.key,class:(0,m.normalizeClass)(['acu-switch-list-item',[e.class,{'is-selected':l(e.key)}]]),onClick:t=>i(e.key)},[(0,m.createElementVNode)('span',Ea,[(0,m.createTextVNode)((0,m.toDisplayString)(e.label)+' ',1),e.badge?((0,m.openBlock)(),(0,m.createElementBlock)('span',Ba,(0,m.toDisplayString)(e.badge),1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createElementVNode)('label',{class:'acu-switch small',onClick:a[0]||(a[0]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('input',{type:'checkbox',checked:l(e.key),onChange:t=>i(e.key)},null,40,Sa),a[3]||(a[3]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])],10,Va))),128)),0===e.items.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ta,[a[4]||(a[4]=(0,m.createElementVNode)('i',{class:'fas fa-inbox'},null,-1)),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(e.emptyText),1)])):(0,m.createCommentVNode)('v-if',!0)],4),(0,m.createCommentVNode)(' åº•éƒ¨ç»Ÿè®¡åŒº '),(0,m.createElementVNode)('div',Da,[(0,m.createTextVNode)((0,m.toDisplayString)(r.value)+' ',1),0===e.modelValue.length&&e.emptyHint?((0,m.openBlock)(),(0,m.createElementBlock)('span',Aa,(0,m.toDisplayString)(e.emptyHint),1)):(0,m.createCommentVNode)('v-if',!0)])]))}}),Ia={class:'acu-modal-header'},_a={class:'acu-modal-body'},Ma={class:'acu-add-table-tabs'},Ua={key:0,class:'acu-add-table-paste'},$a={class:'acu-add-table-file'},La={class:'acu-file-label'},Pa={key:2,class:'acu-add-table-error'},Fa={key:3,class:'acu-add-table-list'},ja={class:'acu-modal-footer'},Oa=['disabled'],Ra=(0,m.defineComponent)({__name:'AddTableDialog',props:{visible:{type:Boolean}},emits:['update:visible','confirm'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)('paste'),r=(0,m.ref)(''),l=(0,m.ref)(''),i=(0,m.ref)(''),c=(0,m.ref)([]),s=(0,m.ref)([]),u=(0,m.ref)(),d=(0,m.computed)(()=>c.value.map(e=>({key:e.key,label:e.template.name})));function p(){if(i.value='',c.value=[],s.value=[],r.value.trim())try{g(JSON.parse(r.value))}catch(e){i.value=`JSON è§£æå¤±è´¥: ${e instanceof Error?e.message:String(e)}`}else i.value='è¯·è¾“å…¥ JSON å†…å®¹'}function f(e){const t=e.target,a=t.files?.[0];if(!a)return;l.value=a.name,i.value='',c.value=[],s.value=[];const o=new FileReader;o.onload=e=>{try{const t=e.target?.result;g(JSON.parse(t))}catch(e){i.value=`æ–‡ä»¶è§£æå¤±è´¥: ${e instanceof Error?e.message:String(e)}`}},o.onerror=()=>{i.value='æ–‡ä»¶è¯»å–å¤±è´¥'},o.readAsText(a)}function g(e){if(!e||'object'!=typeof e)return void(i.value='æ— æ•ˆçš„ JSON æ ¼å¼');const t=[];for(const a of Object.keys(e)){if(!a.startsWith('sheet_'))continue;const o=e[a];o&&'object'==typeof o&&(o.name&&Array.isArray(o.content)?t.push({key:a,template:o}):console.warn(`[ACU] è·³è¿‡æ— æ•ˆè¡¨æ ¼: ${a}`))}0!==t.length?(c.value=t,1===t.length&&(s.value=[t[0].key]),S.toast.success(`è§£ææˆåŠŸï¼Œæ‰¾åˆ° ${t.length} ä¸ªè¡¨æ ¼`)):i.value='æœªæ‰¾åˆ°æœ‰æ•ˆçš„è¡¨æ ¼å®šä¹‰ (éœ€è¦ sheet_xxx æ ¼å¼çš„é”®)'}function v(){o('update:visible',!1)}function b(){if(0===s.value.length)return;const e=c.value.filter(e=>s.value.includes(e.key)).map(e=>e.template);o('confirm',e),v()}return(0,m.watch)(()=>a.visible,e=>{e&&(r.value='',l.value='',i.value='',c.value=[],s.value=[],n.value='paste')}),(0,de.X2F)(u,()=>{v()}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(v,['self'])},[(0,m.createElementVNode)('div',{ref_key:'dialogRef',ref:u,class:'acu-modal acu-add-table-modal'},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Ia,[(0,m.createElementVNode)('button',{class:'acu-modal-back',onClick:(0,m.withModifiers)(v,['stop'])},[...a[4]||(a[4]=[(0,m.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])]),a[5]||(a[5]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'æ·»åŠ è¡¨æ ¼',-1)),a[6]||(a[6]=(0,m.createElementVNode)('span',null,null,-1))]),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',_a,[(0,m.createCommentVNode)(' Tab åˆ‡æ¢ï¼šç²˜è´´ JSON / å¯¼å…¥æ–‡ä»¶ '),(0,m.createElementVNode)('div',Ma,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-tab-btn',{active:'paste'===n.value}]),onClick:a[0]||(a[0]=(0,m.withModifiers)(e=>n.value='paste',['stop']))},[...a[7]||(a[7]=[(0,m.createElementVNode)('i',{class:'fas fa-paste'},null,-1),(0,m.createTextVNode)(' ç²˜è´´ JSON ',-1)])],2),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-tab-btn',{active:'file'===n.value}]),onClick:a[1]||(a[1]=(0,m.withModifiers)(e=>n.value='file',['stop']))},[...a[8]||(a[8]=[(0,m.createElementVNode)('i',{class:'fas fa-file-import'},null,-1),(0,m.createTextVNode)(' å¯¼å…¥æ–‡ä»¶ ',-1)])],2)]),(0,m.createCommentVNode)(' ç²˜è´´æ¨¡å¼ '),'paste'===n.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ua,[(0,m.withDirectives)((0,m.createElementVNode)('textarea',{'onUpdate:modelValue':a[2]||(a[2]=e=>r.value=e),placeholder:'ç²˜è´´è¡¨æ ¼æ¨¡æ¿ JSON...',class:'acu-textarea-scrollable',rows:'8'},null,512),[[m.vModelText,r.value]]),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',onClick:(0,m.withModifiers)(p,['stop'])},[...a[9]||(a[9]=[(0,m.createElementVNode)('i',{class:'fas fa-search'},null,-1),(0,m.createTextVNode)(' è§£æ',-1)])])])):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ–‡ä»¶å¯¼å…¥æ¨¡å¼ '),(0,m.createElementVNode)('div',$a,[(0,m.createElementVNode)('label',La,[(0,m.createElementVNode)('input',{type:'file',accept:'.json',onChange:f,style:{display:'none'}},null,32),a[10]||(a[10]=(0,m.createElementVNode)('i',{class:'fas fa-upload'},null,-1)),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(l.value||'ç‚¹å‡»é€‰æ‹© JSON æ–‡ä»¶'),1)])])],2112)),(0,m.createCommentVNode)(' é”™è¯¯æç¤º '),i.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Pa,[a[11]||(a[11]=(0,m.createElementVNode)('i',{class:'fas fa-exclamation-circle'},null,-1)),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(i.value),1)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è§£æç»“æœï¼šè¡¨æ ¼é€‰æ‹©åˆ—è¡¨ '),c.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Fa,[a[12]||(a[12]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-table'}),(0,m.createTextVNode)(' é€‰æ‹©è¦æ·»åŠ çš„è¡¨æ ¼ ')],-1)),(0,m.createVNode)(za,{modelValue:s.value,'onUpdate:modelValue':a[3]||(a[3]=e=>s.value=e),items:d.value,'empty-text':'æš‚æ— å¯æ·»åŠ çš„è¡¨æ ¼','footer-template':'å·²é€‰æ‹©: {selected}/{total} ä¸ªè¡¨æ ¼'},null,8,['modelValue','items'])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' åº•éƒ¨æŒ‰é’® '),(0,m.createElementVNode)('div',ja,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(v,['stop'])},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',disabled:0===s.value.length,onClick:(0,m.withModifiers)(b,['stop'])},[a[13]||(a[13]=(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)),(0,m.createTextVNode)(' æ·»åŠ  ('+(0,m.toDisplayString)(s.value.length)+') ',1)],8,Oa)])],512)])):(0,m.createCommentVNode)('v-if',!0)}}),Ha={class:'acu-status-board'},Wa={class:'acu-status-board-header'},Ga={class:'acu-status-board-summary'},Ya={class:'acu-status-board-actions'},Xa={key:0,class:'acu-status-toolbar'},qa=['disabled'],Ka=['disabled'],Ja=['disabled'],Qa=['disabled','title'],Za=['disabled'],eo=['title'],to={class:'acu-status-table-wrapper'},ao={class:'acu-status-table'},oo=['onClick'],no=['onClick'],ro={class:'acu-status-freq'},lo=['value','onInput'],io={key:0,class:'acu-status-disabled'},co={key:1},so={key:2,class:'acu-status-global-hint'},uo={class:'acu-status-last-update'},po={key:0},mo={key:1},fo=(0,m.defineComponent)({__name:'TableStatusBoard',emits:['tableClick'],setup(e,{emit:t}){const a=t,o=(0,w.D)(),n=(0,k.j_)(),{statusList:r,isLoading:l,currentTotalAiFloors:i,refresh:c,formatLastUpdate:s,getUnrecordedClass:u}=Ae(),{purgeTableDataByRange:d}=te(),p=(0,m.ref)(!1),f=(0,m.ref)(new Set),g=(0,m.ref)(new Map),b=(0,m.ref)([]),h=(0,m.ref)(!1),x=(0,m.computed)(()=>{if(0===f.value.size)return'disabled';const e=r.value.filter(e=>f.value.has(e.sheetKey)).map(e=>g.value.has(e.sheetKey)?g.value.get(e.sheetKey):e.effectiveFrequency),t=e.every(e=>0===e),a=e.every(e=>0!==e);return t?'enable':a?'disable':'mixed'}),y=(0,m.computed)(()=>g.value.size>0||b.value.length>0);function C(e){const t=o.aiDiffMap;if(!t||0===t.size)return!1;for(const a of t)if(a.startsWith(`${e}-`))return!0;return!1}const N=(0,m.computed)(()=>[...r.value].sort((e,t)=>{const a=C(e.name),o=C(t.name);return a!==o?o?1:-1:e.orderNo-t.orderNo}));function V(){p.value=!1,f.value.clear(),g.value.clear(),b.value=[]}function E(){f.value.size===r.value.length?f.value.clear():r.value.forEach(e=>f.value.add(e.sheetKey))}function B(e){return g.value.has(e.sheetKey)?g.value.get(e.sheetKey):e.updateFrequency}async function T(){await c()}function D(){if(0===f.value.size)return;const e=(0,v.M1)().getDB();if(e?.getTableTemplate)try{const t=e.getTableTemplate();if(!t)return void S.toast.error('æ— æ³•è·å–å½“å‰æ¨¡æ¿');const a={mate:t.mate||{type:'chatSheets',version:1,updateConfigUiSentinel:-1}};f.value.forEach(e=>{t[e]&&(a[e]=t[e])});const o=JSON.stringify(a,null,2),n=new Blob([o],{type:'application/json'}),r=URL.createObjectURL(n),l=document.createElement('a');l.href=r,l.download=`tables_export_${Date.now()}.json`,l.click(),URL.revokeObjectURL(r),S.toast.success(`å·²å¯¼å‡º ${f.value.size} ä¸ªè¡¨æ ¼`)}catch(e){console.error('[ACU] å¯¼å‡ºå¤±è´¥:',e),S.toast.error(`å¯¼å‡ºå¤±è´¥: ${e instanceof Error?e.message:String(e)}`)}else S.toast.error('æ•°æ®åº“ API ä¸å¯ç”¨')}async function A(){if(0===f.value.size)return;if(!confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${f.value.size} ä¸ªè¡¨æ ¼å—ï¼Ÿ\n\næ­¤æ“ä½œå°†ï¼š\n1. ä»æ‰€æœ‰èŠå¤©è®°å½•ä¸­æ¸…é™¤è¿™äº›è¡¨æ ¼çš„æ•°æ®\n2. ä»æ¨¡æ¿ä¸­ç§»é™¤è¿™äº›è¡¨æ ¼çš„å®šä¹‰\n\næ“ä½œä¸å¯æ’¤é”€ï¼`))return;const e=(0,v.M1)().getDB();if(e?.getTableTemplate&&e?.importTemplateFromData)try{S.toast.info('æ­£åœ¨æ¸…é™¤å†å²æ•°æ®...');const t=Array.from(f.value),a=await d(t,0,9999999);a.changed&&S.toast.success(`å·²æ¸…é™¤ ${a.changedCount} å±‚å†å²æ•°æ®`);const o=e.getTableTemplate();if(!o)return void S.toast.error('æ— æ³•è·å–å½“å‰æ¨¡æ¿');f.value.forEach(e=>{delete o[e]});const n=await e.importTemplateFromData(o);n.success?(S.toast.success(`å·²åˆ é™¤ ${f.value.size} ä¸ªè¡¨æ ¼å®šä¹‰`),f.value.clear(),await c()):S.toast.error(`åˆ é™¤å¤±è´¥: ${n.message}`)}catch(e){console.error('[ACU] åˆ é™¤è¡¨æ ¼å¤±è´¥:',e),S.toast.error(`åˆ é™¤å¤±è´¥: ${e instanceof Error?e.message:String(e)}`)}else S.toast.error('æ•°æ®åº“ API ä¸å¯ç”¨')}function I(){n.openAdvancedPurgeDialog({initialStartFloor:void 0,initialEndFloor:void 0},{onConfirm:async()=>{await c(),f.value.clear()}},{selectedTableKeys:Array.from(f.value)})}function M(e){b.value.push(...e),S.toast.success(`å·²æ·»åŠ  ${e.length} ä¸ªè¡¨æ ¼åˆ°å¾…ä¿å­˜åˆ—è¡¨`)}function U(){if(0===f.value.size)return;const e=x.value;if('mixed'===e)return;const t='enable'===e?-1:0;f.value.forEach(e=>{g.value.set(e,t)}),S.toast.success('enable'===e?'å·²è®¾ç½®ä¸ºå¯ç”¨':'å·²è®¾ç½®ä¸ºç¦ç”¨')}function L(e){a('tableClick',e.sheetKey,e.name)}function P(e){var t;p.value?(t=e.sheetKey,f.value.has(t)?f.value.delete(t):f.value.add(t)):L(e)}return(0,m.onMounted)(()=>{c()}),(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Ha,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Wa,[(0,m.createElementVNode)('span',Ga,' å…± '+(0,m.toDisplayString)((0,m.unref)(r).length)+' ä¸ªè¡¨æ ¼ Â· AIæ¥¼å±‚ '+(0,m.toDisplayString)((0,m.unref)(i)),1),(0,m.createElementVNode)('div',Ya,[(0,m.createCommentVNode)(' ç¼–è¾‘æ¨¡å¼å·¥å…·æ  '),p.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Xa,[(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'å…¨é€‰',onClick:(0,m.withModifiers)(E,['stop'])},[...t[4]||(t[4]=[(0,m.createElementVNode)('i',{class:'fas fa-check-double'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',disabled:0===f.value.size,title:'å¯¼å‡º',onClick:(0,m.withModifiers)(D,['stop'])},[...t[5]||(t[5]=[(0,m.createElementVNode)('i',{class:'fas fa-file-export'},null,-1)])],8,qa),(0,m.createElementVNode)('button',{class:'acu-tool-btn',disabled:0===f.value.size,title:'åˆ é™¤',onClick:(0,m.withModifiers)(A,['stop'])},[...t[6]||(t[6]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1)])],8,Ka),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'æ·»åŠ ',onClick:t[0]||(t[0]=(0,m.withModifiers)(e=>h.value=!0,['stop']))},[...t[7]||(t[7]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',disabled:0===f.value.size,title:'æ¸…é™¤',onClick:(0,m.withModifiers)(I,['stop'])},[...t[8]||(t[8]=[(0,m.createElementVNode)('i',{class:'fas fa-eraser'},null,-1)])],8,Ja),(0,m.createElementVNode)('button',{class:'acu-tool-btn',disabled:'mixed'===x.value||0===f.value.size,title:'enable'===x.value?'å¯ç”¨':'ç¦ç”¨',onClick:(0,m.withModifiers)(U,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas','enable'===x.value?'fa-play':'fa-ban'])},null,2)],8,Qa)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' åˆ·æ–°æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-icon-btn',disabled:(0,m.unref)(l),title:'åˆ·æ–°çŠ¶æ€',onClick:(0,m.withModifiers)(T,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas fa-redo',{'acu-animate-spin':(0,m.unref)(l)}])},null,2)],8,Za),(0,m.createCommentVNode)(' ç¼–è¾‘/ä¿å­˜æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:p.value?'ä¿å­˜':'ç¼–è¾‘',onClick:t[1]||(t[1]=(0,m.withModifiers)(e=>p.value?async function(){if(!y.value&&0===g.value.size)return void V();const e=(0,v.M1)().getDB();if(e?.getTableTemplate&&e?.importTemplateFromData)try{const t=e.getTableTemplate();if(!t)return void S.toast.error('æ— æ³•è·å–å½“å‰æ¨¡æ¿');let a=0;for(const[e,o]of g.value)t[e]?.updateConfig&&(t[e].updateConfig.updateFrequency=o,a++);for(const e of b.value)t[`sheet_${e.uid||Date.now()}_${Math.random().toString(36).slice(2,8)}`]=e,a++;const o=await e.importTemplateFromData(t);o.success?(S.toast.success(`ä¿å­˜æˆåŠŸï¼Œå…± ${a} é¡¹å˜æ›´`),V(),await c()):S.toast.error(`ä¿å­˜å¤±è´¥: ${o.message}`)}catch(e){console.error('[ACU] ä¿å­˜å¤±è´¥:',e),S.toast.error(`ä¿å­˜å¤±è´¥: ${e instanceof Error?e.message:String(e)}`)}else S.toast.error('æ•°æ®åº“ API ä¸å¯ç”¨')}():(p.value=!0,void S.toast.info('å¯å¤šé€‰æ“ä½œ')),['stop']))},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',p.value?'fa-check':'fa-edit'])},null,2)],8,eo)])]),(0,m.createCommentVNode)(' æ·»åŠ è¡¨æ ¼å¼¹çª— '),(0,m.createVNode)(Ra,{visible:h.value,'onUpdate:visible':t[2]||(t[2]=e=>h.value=e),onConfirm:M},null,8,['visible']),(0,m.createCommentVNode)(' è¡¨æ ¼ '),(0,m.createElementVNode)('div',to,[(0,m.createElementVNode)('table',ao,[t[11]||(t[11]=(0,m.createElementVNode)('thead',null,[(0,m.createElementVNode)('tr',null,[(0,m.createElementVNode)('th',{class:'acu-status-col-name'},'è¡¨æ ¼åç§°'),(0,m.createElementVNode)('th',{class:'acu-status-col-freq'},'æ›´æ–°é¢‘ç‡'),(0,m.createElementVNode)('th',{class:'acu-status-col-unrecorded'},'æœªè®°å½•æ¥¼å±‚'),(0,m.createElementVNode)('th',{class:'acu-status-col-last'},'ä¸Šæ¬¡æ›´æ–°')])],-1)),(0,m.createElementVNode)('tbody',null,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(N.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('tr',{key:e.sheetKey,class:(0,m.normalizeClass)({'acu-row-selected':p.value&&f.value.has(e.sheetKey),'acu-highlight-ai':C(e.name)&&!p.value}),onClick:(0,m.withModifiers)(t=>P(e),['stop'])},[(0,m.createElementVNode)('td',{class:(0,m.normalizeClass)(['acu-status-name',{'acu-highlight-ai':C(e.name)&&!p.value}])},[(0,m.createElementVNode)('span',{style:(0,m.normalizeStyle)({cursor:p.value?'default':'pointer'}),onClick:(0,m.withModifiers)(t=>p.value?null:L(e),['stop'])},(0,m.toDisplayString)(e.name),13,no)],2),(0,m.createElementVNode)('td',ro,[(0,m.createCommentVNode)(' ç¼–è¾‘æ¨¡å¼ï¼šæ˜¾ç¤ºè¾“å…¥æ¡† '),p.value?((0,m.openBlock)(),(0,m.createElementBlock)('input',{key:0,type:'number',value:B(e),min:'-1',class:'acu-freq-input',onInput:t=>function(e,t){const a=t.target,o=parseInt(a.value,10);isNaN(o)||g.value.set(e,o)}(e.sheetKey,t),onClick:t[3]||(t[3]=(0,m.withModifiers)(()=>{},['stop']))},null,40,lo)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ™®é€šæ¨¡å¼ï¼šæ˜¾ç¤ºæ–‡æœ¬ '),0===e.effectiveFrequency?((0,m.openBlock)(),(0,m.createElementBlock)('span',io,'ç¦ç”¨')):((0,m.openBlock)(),(0,m.createElementBlock)('span',co,(0,m.toDisplayString)(e.effectiveFrequency),1)),-1===e.updateFrequency?((0,m.openBlock)(),(0,m.createElementBlock)('span',so,'(å…¨å±€)')):(0,m.createCommentVNode)('v-if',!0)],64))]),(0,m.createElementVNode)('td',{class:(0,m.normalizeClass)(['acu-status-unrecorded',(0,m.unref)(u)(e)])},(0,m.toDisplayString)(e.hasHistory?e.unrecordedFloors:'â€”'),3),(0,m.createElementVNode)('td',uo,[(0,m.createCommentVNode)(' æ˜¾ç¤ºæ ¼å¼: AIæ¥¼å±‚å·/å®é™…æ¥¼å±‚å· '),(0,m.createTextVNode)(' '+(0,m.toDisplayString)((0,m.unref)(s)(e)),1)])],10,oo))),128)),(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0!==(0,m.unref)(r).length||(0,m.unref)(l)?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('tr',po,[...t[9]||(t[9]=[(0,m.createElementVNode)('td',{colspan:'4',class:'acu-status-empty'},[(0,m.createElementVNode)('i',{class:'fas fa-inbox'}),(0,m.createTextVNode)(' æš‚æ— è¡¨æ ¼æ•°æ® ')],-1)])])),(0,m.createCommentVNode)(' åŠ è½½ä¸­ '),(0,m.unref)(l)&&0===(0,m.unref)(r).length?((0,m.openBlock)(),(0,m.createElementBlock)('tr',mo,[...t[10]||(t[10]=[(0,m.createElementVNode)('td',{colspan:'4',class:'acu-status-loading'},[(0,m.createElementVNode)('i',{class:'fas fa-spinner fa-spin'}),(0,m.createTextVNode)(' åŠ è½½ä¸­... ')],-1)])])):(0,m.createCommentVNode)('v-if',!0)])])])]))}}),go=fo,vo=['draggable'],bo={key:0,class:'acu-dash-count'},ho={class:'acu-dash-actions'},xo=['title'],yo=['title'],wo=['title','onClick'],ko=['onClick'],Co={class:'acu-dash-npc-text'},No=['title','onClick'],Vo=['title','onClick'],Eo=['title','onClick'],Bo={key:1},So={class:'acu-dash-npc-grid'},To=['onClick'],Do={class:'acu-dash-npc-text'},Ao=['title','onClick'],zo=['title','onClick'],Io=['title','onClick'],_o={key:1},Mo=['onClick'],Uo={class:'acu-dash-list-text'},$o=['title','onClick'],Lo=['title','onClick'],Po=['title','onClick'],Fo=['title','onClick'],jo={key:1},Oo={class:'acu-dash-list'},Ro=['onClick'],Ho={class:'acu-dash-list-text'},Wo=['title','onClick'],Go=['title','onClick'],Yo=['title','onClick'],Xo=['title','onClick'],qo={key:1},Ko={class:'acu-dash-empty'},Jo=(0,m.defineComponent)({__name:'DashboardWidget',props:{config:{},tableData:{},isEditing:{type:Boolean},diffMap:{},aiDiffMap:{},searchTerm:{},allTables:{}},emits:['navigate','row-click','row-edit','action','remove','resize','config-actions','drag-start','drag-end','drop'],setup(e,{emit:t}){const a=(0,k.j_)(),o=(0,$t.A)(),{setInput:n}=ue(),{performDivination:r}=Ut();(0,m.onMounted)(async()=>{await o.loadLibrary()});const l=e,i=(0,m.ref)(!1);let c=!1;const s=(0,m.ref)(1/0),u=(0,m.ref)(new Set);(0,m.watch)(()=>l.isEditing,e=>{e?(c=i.value,i.value=!0):i.value=c},{immediate:!0});const d=t,p=((0,m.computed)(()=>l.tableData?.rows.length??0),(0,m.computed)(()=>U.value.length)),f=(0,m.computed)(()=>l.tableData?.name?l.tableData.name:l.config.title),g=(0,m.computed)(()=>{if(l.config.icon&&'fa-table'!==l.config.icon)return l.config.icon;const e=l.tableData?.name||l.config.title;if(e){return(0,k.Sj)(e).replace('fas ','')}return'fa-table'}),v=(0,m.computed)(()=>l.tableData?l.tableData.headers.find(e=>e.includes('å±‚çº§'))??null:null),b=(0,m.computed)(()=>!!v.value);function h(e){const t=ee(e);if(!v.value)return t;const a=e.cells.find(e=>e.key===v.value),o=a?.value?String(a.value).trim():'';if(!o)return t;return(o.split('/').pop()??'')===t?o:o+'/'+t}function x(e){const t=h(e);return t?(t.match(/\//g)||[]).length+1:1}function y(e){if(!l.tableData||!b.value)return!1;const t=h(e);return l.tableData.rows.some(a=>{if(a.key===e.key)return!1;return h(a).startsWith(t+'/')})}function w(e){const t=function(e){const t=h(e),a=t.lastIndexOf('/');return a>0?t.substring(0,a):''}(e);if(!t)return!1;const a=t.split('/');let o='';for(const e of a)if(o=o?o+'/'+e:e,u.value.has(o))return!0;return!1}function C(e){const t=h(e);u.value.has(t)?u.value.delete(t):u.value.add(t),u.value=new Set(u.value)}function N(e){const t=h(e);return!u.value.has(t)}const V=(0,m.computed)(()=>{if(!b.value||!l.tableData)return 1;let e=1;for(const t of l.tableData.rows){const a=x(t);a>e&&(e=a)}return e}),E=(0,m.computed)(()=>s.value>=V.value);function B(){s.value>1&&(s.value===1/0||s.value>V.value?s.value=V.value-1:s.value--)}function S(){if(E.value){if(s.value=1,l.tableData){const e=new Set;for(const t of l.tableData.rows)y(t)&&e.add(h(t));u.value=e}}else s.value=1/0,u.value=new Set}const T=(0,m.computed)(()=>s.value>1),D=(0,m.computed)(()=>b.value&&T.value),A=(0,m.computed)(()=>b.value&&V.value>1);function I(e){if(!l.tableData||!l.aiDiffMap)return!1;const t=l.tableData.name,a=`${t}-row-${e.index}`;if(l.aiDiffMap.has(a))return!0;for(let a=0;a<e.cells.length;a++){const o=`${t}-${e.index}-${a}`;if(l.aiDiffMap.has(o))return!0}return!1}const M=(0,m.computed)(()=>!(!l.tableData||!l.aiDiffMap)&&l.tableData.rows.some(e=>I(e)));const U=(0,m.computed)(()=>{if(!l.tableData)return[];let e=[...l.tableData.rows];return l.searchTerm&&(e=e.filter(e=>function(e){if(!l.searchTerm)return!1;const t=l.searchTerm.toLowerCase().trim();return!!t&&e.cells.some(e=>String(e.value).toLowerCase().includes(t))}(e))),b.value&&s.value!==1/0&&(e=e.filter(e=>x(e)<=s.value)),b.value&&u.value.size>0&&(e=e.filter(e=>!w(e))),b.value?(e=function(e){const t=new Map;for(const a of e)t.set(h(a),a.index);return[...e].sort((e,a)=>{const o=h(e),n=h(a);if(o===n)return e.index-a.index;if(n.startsWith(o+'/'))return-1;if(o.startsWith(n+'/'))return 1;const r=o.split('/'),l=n.split('/');let i=0;for(let e=0;e<Math.min(r.length,l.length)&&r[e]===l[e];e++)i=e+1;const c=r.slice(0,i+1).join('/'),s=l.slice(0,i+1).join('/'),u=t.get(c),d=t.get(s);return void 0!==u&&void 0!==d?u-d:c.localeCompare(s)})}(e),e):e.sort((e,t)=>{const a=I(e),o=I(t);return a!==o?o?1:-1:e.index-t.index})}),L=(0,m.computed)(()=>U.value.length>30),{list:P,containerProps:F,wrapperProps:j}=(O=U,(0,de.niW)(O,{itemHeight:32,overscan:5}));var O;const{list:R,containerProps:H,wrapperProps:W}=function(e,t=3){const a=(0,m.computed)(()=>function(e,t){const a=[];for(let o=0;o<e.length;o+=t)a.push(e.slice(o,o+t));return a}(e.value,t));return{...(0,de.niW)(a,{itemHeight:48,overscan:5}),rowGroups:a}}(U),G=(0,m.computed)(()=>({'acu-dash-body-scrollable':!0})),Y=(0,m.computed)(()=>{const e=l.config;return(e?.widgetTagConfig?.displayedTagIds||[]).map(e=>o.getTagById(e)).filter(e=>void 0!==e)}),X=(0,m.computed)(()=>{const e=l.config;return(e?.widgetTagConfig?.displayedCategoryIds||[]).map(e=>o.getCategoryById(e)).filter(e=>void 0!==e)});function q(e){const t=e.path.split('/');return t[t.length-1]}function K(e){return e.icon?e.icon:q(e)}function J(e){return e.startsWith('fa')||e.includes(' fa-')}(0,m.computed)(()=>l.config.actions.filter(e=>'goToTable'!==e));const Q=(0,m.computed)(()=>l.config.actions.filter(e=>'goToTable'!==e&&'settings'!==e));function Z(e){return ae(e).length+ne(e).length+Y.value.length+X.value.length}function ee(e){const{titleColumn:t,displayColumns:a}=l.config;if(t){const a=e.cells.find(e=>e.key.toLowerCase()===t.toLowerCase()||e.key.toLowerCase().includes(t.toLowerCase()));if(a&&a.value)return String(a.value)}if(a.length>0)for(const t of a){const a=e.cells.find(e=>e.key.toLowerCase().includes(t.toLowerCase()));if(a&&a.value)return String(a.value)}const o=e.cells.find(e=>e.value&&String(e.value).trim());return o?String(o.value):`è¡Œ ${e.index+1}`}function te(e){if(!l.tableData)return!1;const t=l.tableData.name,a=`${t}-row-${e.index}`;if(l.diffMap.has(a))return!0;for(let a=0;a<e.cells.length;a++){const o=`${t}-${e.index}-${a}`;if(l.diffMap.has(o))return!0}return!1}function ae(e){const t=l.config.displayTagColumns;if(!t||0===t.length)return[];const a=[];for(const o of t){const t=e.cells.find(e=>e.key.toLowerCase()===o.toLowerCase()||e.key.toLowerCase().includes(o.toLowerCase()));if(t&&t.value){const e=String(t.value).trim();e&&a.push({column:o,value:e})}}return a}const oe=/[,ï¼Œï¼›;|/]/;function ne(e){const t=l.config.interactiveTagConfig;if(!t||0===t.sourceColumns.length)return[];const a=[],o=t.tagDefinitions||[];for(const n of t.sourceColumns){const t=e.cells.find(e=>e.key.toLowerCase()===n.toLowerCase()||e.key.toLowerCase().includes(n.toLowerCase()));if(t&&t.value){const e=String(t.value).trim();if(!e)continue;const n=e.split(oe).map(e=>e.trim()).filter(Boolean);for(const e of n){const t=o.find(t=>t.label.toLowerCase()===e.toLowerCase());if(t)a.push({tag:t,value:e,matchedDefinition:!0});else{const t={id:`dynamic_${e}`,label:e,promptTemplate:'{{value}}',isFixed:!1};a.push({tag:t,value:e,matchedDefinition:!1})}}}}return a}function re(e){if(!e.promptTemplate)return e.label;let t=e.promptTemplate;return t=t.replace(/\{\{value\}\}/gi,`[${e.label}]`),t=t.replace(/\{\{rowTitle\}\}/gi,'[è¡Œæ ‡é¢˜]'),t=t.replace(/\{\{playerName\}\}/gi,'[ä¸»è§’å]'),t.length>50?t.substring(0,50)+'...':t}function le(e,t){let a=e.promptTemplate;a=a.replace(/\{\{value\}\}/gi,e.label);const o=ee(t);a=a.replace(/\{\{rowTitle\}\}/gi,o);const r=pe();a=a.replace(/\{\{playerName\}\}/gi,r);const i=l.tableData?.name||l.config.title||'';a=a.replace(/\{\{tableName\}\}/gi,i),a&&n(a)}function ie(e,t){const r=function(e,t){let a=e.promptTemplate;a=a.replace(/\{\{value\}\}/gi,e.label),a=t?.title?a.replace(/\{\{rowTitle\}\}/gi,t.title):a.replace(/\{\{rowTitle\}\}/gi,'');const o=pe();a=a.replace(/\{\{playerName\}\}/gi,o);const n=l.tableData?.name||l.config.title||'';return a=a.replace(/\{\{tableName\}\}/gi,n),a.trim()}(e,t),i=o.getCategoryById(e.categoryId),c=!!i&&(i.path.includes('åœ°ç‚¹')||i.path.includes('Location'));e.allowPreEdit||c?a.openTagPreEditDialog({tagLabel:e.label,resolvedPrompt:r,showCompanions:c,widgetId:l.config.id}):r&&n(r)}function ce(e,t){a.openCategorySelectDialog({categoryId:e.id,rowContext:t,widgetId:l.config.id})}function se(e){if(!e.promptTemplate)return e.label;let t=e.promptTemplate;return t=t.replace(/\{\{value\}\}/gi,`[${e.label}]`),t=t.replace(/\{\{rowTitle\}\}/gi,'[è¡Œæ ‡é¢˜]'),t=t.replace(/\{\{playerName\}\}/gi,'[ä¸»è§’å]'),t=t.replace(/\{\{tableName\}\}/gi,'[è¡¨æ ¼å]'),t.length>50?t.substring(0,50)+'...':t}function pe(){const e=window.parent||window;try{const t=e.SillyTavern?.getContext?.();if(t?.name1)return t.name1}catch(e){console.warn('[ACU] è·å–ä¸»è§’åå¤±è´¥',e)}return'{{user}}'}function me(){a.openWidgetActionsDialog({widgetId:l.config.id,currentActions:l.config.actions})}function fe(e){return _t.bT[e]?.icon??'fa-question'}function ge(e){return!!_t.bT[e]?.secondaryIcon}function ve(e){return _t.bT[e]?.secondaryIcon??''}function be(e){return _t.bT[e]?.tooltip??e}function he(e){if('settings'===e){const e=l.tableData?.headers??[];return void a.openWidgetSettingsDialog({widgetId:l.config.id,widgetConfig:l.config,tableHeaders:e})}'nativeEdit'!==e?'divination'!==e?d('action',e,l.config.tableId||''):r():function(e){try{const t=(window.parent||window).AutoCardUpdaterAPI;e&&t?.openTableEditor?t.openTableEditor(e):t?.openVisualizer?(t.openVisualizer(),console.info('[ACU] å·²æ‰“å¼€åŸç”Ÿç¼–è¾‘å™¨'),a.isCollapsed=!0):t?.openModal?t.openModal():console.warn('[ACU] æ— æ³•æ‰“å¼€åŸç”Ÿç¼–è¾‘å™¨ï¼šAPI ä¸å¯ç”¨')}catch(e){console.error('[ACU] æ‰“å¼€åŸç”Ÿç¼–è¾‘å™¨å¤±è´¥',e)}}(l.config.tableId)}function xe(){l.config.tableId&&d('navigate',l.config.tableId)}function ye(e){d('navigate',e)}function we(){!l.isEditing&&l.config.tableId&&d('navigate',l.config.tableId)}function ke(){l.isEditing||(i.value=!i.value)}function Ce(e){l.config.tableId&&d('row-edit',l.config.tableId,e)}function Ne(e){e.preventDefault();const t=1===l.config.colSpan?2:1;d('resize',l.config.id,t)}function Ve(e){l.isEditing?(e.dataTransfer?.setData('text/plain',l.config.id),d('drag-start',l.config.id)):e.preventDefault()}function Ee(){d('drag-end')}function Be(e){e.preventDefault(),d('drop',l.config.id)}return(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:(0,m.normalizeClass)(['acu-dash-widget',{'acu-dash-widget-wide':2===e.config.colSpan,'acu-dash-widget-editing':e.isEditing,'acu-highlight-ai-table':M.value&&!e.searchTerm}]),draggable:e.isEditing,onDragstart:Ve,onDragend:Ee,onDragover:a[2]||(a[2]=(0,m.withModifiers)(()=>{},['prevent'])),onDrop:Be},[(0,m.createCommentVNode)(' ç¼–è¾‘æ§ä»¶ (ä»…ç¼–è¾‘æ€æ˜¾ç¤º) '),e.isEditing?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createElementVNode)('button',{class:'acu-widget-remove',title:'ç§»é™¤ç»„ä»¶',onClick:a[0]||(a[0]=(0,m.withModifiers)(t=>d('remove',e.config.id),['stop']))},[...a[3]||(a[3]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-widget-config',title:'é…ç½®å¿«æ·æŒ‰é’®',onClick:(0,m.withModifiers)(me,['stop'])},[...a[4]||(a[4]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])]),(0,m.createElementVNode)('div',{class:'acu-widget-resize',title:'æ‹–åŠ¨æ”¹å˜å¤§å°',onMousedown:(0,m.withModifiers)(Ne,['stop']),onTouchstart:(0,m.withModifiers)(Ne,['stop'])},[...a[5]||(a[5]=[(0,m.createElementVNode)('i',{class:'fas fa-expand-alt'},null,-1)])],32)],64)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å¤´éƒ¨ - ç‚¹å‡»æ ‡é¢˜è·³è½¬ï¼Œç‚¹å‡»å…¶ä»–åŒºåŸŸæŠ˜å /å±•å¼€ '),(0,m.createCommentVNode)(' å…¨å±€çŠ¶æ€ç»„ä»¶åœ¨å±•ç¤ºæ€éšè—è¡¨å¤´ '),'global'!==e.config.displayStyle||e.isEditing?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:1,class:(0,m.normalizeClass)(['acu-dash-title',{'acu-dash-title-clickable':!e.isEditing}]),style:{'font-size':'1.2em !important'},onClick:ke},[(0,m.createElementVNode)('span',{class:'acu-dash-title-text',onClick:(0,m.withModifiers)(we,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',g.value])},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(f.value)+' ',1),p.value>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',bo,(0,m.toDisplayString)(p.value),1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' æŒ‰é’®åŒºï¼ˆåŒ…å«æŠ˜å æŒ‡ç¤ºå™¨ï¼‰ '),(0,m.createElementVNode)('div',ho,[(0,m.createCommentVNode)(' è¿”å›æŒ‰é’®ï¼ˆå±‚çº§æ¨¡å¼ï¼Œéç¬¬1å±‚æ—¶æ˜¾ç¤ºï¼‰ '),D.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-icon-btn',title:'è¿”å›ä¸Šä¸€å±‚çº§',onClick:(0,m.withModifiers)(B,['stop'])},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å±•å¼€/æ”¶èµ·æŒ‰é’®ï¼ˆå±‚çº§æ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ '),A.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:1,class:'acu-icon-btn',title:E.value?'æ”¶èµ·åˆ°ç¬¬ä¸€å±‚':'å±•å¼€å…¨éƒ¨å±‚çº§',onClick:(0,m.withModifiers)(S,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',E.value?'fa-compress-alt':'fa-expand-alt'])},null,2)],8,xo)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è®¾ç½®æŒ‰é’®å¸¸é©» (updateStatus ç±»å‹ä¸æ˜¾ç¤º) '),'updateStatus'!==e.config.type?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:2,class:'acu-icon-btn',title:be('settings'),onClick:a[1]||(a[1]=(0,m.withModifiers)(e=>he('settings'),['stop']))},[...a[7]||(a[7]=[(0,m.createElementVNode)('i',{class:'fas fa-cog'},null,-1)])],8,yo)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å…¶ä»–é…ç½®çš„å¿«æ·æŒ‰é’® '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(Q.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e,class:(0,m.normalizeClass)(['acu-icon-btn',{'acu-dual-icon':ge(e)}]),title:be(e),onClick:(0,m.withModifiers)(t=>he(e),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',fe(e)])},null,2),ge(e)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(['fas icon-secondary',ve(e)])},null,2)):(0,m.createCommentVNode)('v-if',!0)],10,wo))),128)),(0,m.createCommentVNode)(' æŠ˜å æŒ‡ç¤ºå™¨æ”¾åœ¨æŒ‰é’®åŒºæœ€å³è¾¹ '),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas acu-dash-collapse-icon',i.value?'fa-chevron-down':'fa-chevron-up'])},null,2)])],2)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å†…å®¹åŒº (å¯æ»šåŠ¨, å¯æŠ˜å ) '),(0,m.withDirectives)((0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-dash-body',G.value])},[(0,m.createCommentVNode)(' ç‰¹æ®Šç»„ä»¶: è¡¨æ ¼æ›´æ–°çŠ¶æ€ '),'updateStatus'===e.config.type?((0,m.openBlock)(),(0,m.createBlock)(go,{key:0,onTableClick:ye})):'optionsPanel'===e.config.type?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' ç‰¹æ®Šç»„ä»¶: é€‰é¡¹èšåˆé¢æ¿ '),(0,m.createVNode)(Wt,{tables:e.allTables??[],onNavigate:xe},null,8,['tables'])],64)):'global'===e.config.displayStyle?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' å…¨å±€çŠ¶æ€ç»„ä»¶ (æ— è¡¨å¤´ï¼Œæ²‰æµ¸å¼) '),(0,m.createVNode)(ka,{'table-data':e.tableData,'is-editing':e.isEditing},null,8,['table-data','is-editing'])],64)):e.tableData&&U.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:3},[(0,m.createCommentVNode)(' æ™®é€šè¡¨æ ¼ç»„ä»¶ '),(0,m.createCommentVNode)(' ============================================================ '),(0,m.createCommentVNode)(' ç½‘æ ¼å¼å±•ç¤º (NPCé£æ ¼) - è™šæ‹Ÿæ»šåŠ¨ç‰ˆ '),(0,m.createCommentVNode)(' ============================================================ '),'grid'===e.config.displayStyle?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createCommentVNode)(' è™šæ‹Ÿæ»šåŠ¨æ¨¡å¼ '),L.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',(0,m.mergeProps)({key:0},(0,m.unref)(H),{class:'acu-dash-virtual-container'}),[(0,m.createElementVNode)('div',(0,m.normalizeProps)((0,m.guardReactiveProps)((0,m.unref)(W))),[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)((0,m.unref)(R),({data:t,index:a})=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:a,class:'acu-dash-npc-grid'},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(t,t=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t.key,class:(0,m.normalizeClass)(['acu-dash-npc-item acu-dash-interactive',{'acu-highlight-changed':te(t),'acu-highlight-ai':I(t)&&!e.searchTerm}]),onClick:(0,m.withModifiers)(e=>Ce(t),['stop'])},[(0,m.createElementVNode)('span',Co,(0,m.toDisplayString)(ee(t)),1),(0,m.createCommentVNode)(' å±•ç¤ºæ ‡ç­¾ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ae(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.column,class:'acu-dash-display-tag'},(0,m.toDisplayString)(e.value),1))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ—§ç³»ç»Ÿï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ne(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.tag.id,class:(0,m.normalizeClass)(['acu-dash-interactive-tag',{fixed:e.tag.isFixed}]),title:re(e.tag),onClick:(0,m.withModifiers)(a=>le(e.tag,t),['stop'])},(0,m.toDisplayString)(e.value),11,No))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ–°ç³»ç»Ÿ - ä»å…¨å±€æ ‡ç­¾åº“ï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(Y.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:se(e),onClick:(0,m.withModifiers)(a=>ie(e,{title:ee(t),value:ee(t)}),['stop'])},(0,m.toDisplayString)(e.label),9,Vo))),128)),(0,m.createCommentVNode)(' åˆ†ç±»æŒ‰é’® '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(X.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:`ç‚¹å‡»é€‰æ‹© ${q(e)} ä¸‹çš„æ ‡ç­¾`,onClick:(0,m.withModifiers)(a=>ce(e,{title:ee(t),value:ee(t)}),['stop'])},[J(K(e))?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(K(e))},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Bo,(0,m.toDisplayString)(K(e)),1))],8,Eo))),128))],10,ko))),128))]))),128))],16)],16)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ™®é€šæ¨¡å¼ï¼ˆæ•°æ®é‡å°æ—¶ä¸ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼‰ '),(0,m.createElementVNode)('div',So,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(U.value,t=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t.key,class:(0,m.normalizeClass)(['acu-dash-npc-item acu-dash-interactive',{'acu-highlight-changed':te(t),'acu-highlight-ai':I(t)&&!e.searchTerm}]),onClick:(0,m.withModifiers)(e=>Ce(t),['stop'])},[(0,m.createElementVNode)('span',Do,(0,m.toDisplayString)(ee(t)),1),(0,m.createCommentVNode)(' å±•ç¤ºæ ‡ç­¾ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ae(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.column,class:'acu-dash-display-tag'},(0,m.toDisplayString)(e.value),1))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ—§ç³»ç»Ÿï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ne(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.tag.id,class:(0,m.normalizeClass)(['acu-dash-interactive-tag',{fixed:e.tag.isFixed}]),title:re(e.tag),onClick:(0,m.withModifiers)(a=>le(e.tag,t),['stop'])},(0,m.toDisplayString)(e.value),11,Ao))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ–°ç³»ç»Ÿ - ä»å…¨å±€æ ‡ç­¾åº“ï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(Y.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:se(e),onClick:(0,m.withModifiers)(a=>ie(e,{title:ee(t),value:ee(t)}),['stop'])},(0,m.toDisplayString)(e.label),9,zo))),128)),(0,m.createCommentVNode)(' åˆ†ç±»æŒ‰é’® '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(X.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:`ç‚¹å‡»é€‰æ‹© ${q(e)} ä¸‹çš„æ ‡ç­¾`,onClick:(0,m.withModifiers)(a=>ce(e,{title:ee(t),value:ee(t)}),['stop'])},[J(K(e))?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(K(e))},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',_o,(0,m.toDisplayString)(K(e)),1))],8,Io))),128))],10,To))),128))])],2112))],64)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' ============================================================ '),(0,m.createCommentVNode)(' åˆ—è¡¨å¼å±•ç¤º (ä»»åŠ¡é£æ ¼) - è™šæ‹Ÿæ»šåŠ¨ç‰ˆ '),(0,m.createCommentVNode)(' ============================================================ '),(0,m.createCommentVNode)(' è™šæ‹Ÿæ»šåŠ¨æ¨¡å¼ '),L.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',(0,m.mergeProps)({key:0},(0,m.unref)(F),{class:'acu-dash-virtual-container'}),[(0,m.createElementVNode)('div',(0,m.mergeProps)((0,m.unref)(j),{class:'acu-dash-list'}),[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)((0,m.unref)(P),({data:t})=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t.key,class:(0,m.normalizeClass)(['acu-dash-list-item acu-dash-interactive',{'acu-highlight-changed':te(t),'acu-highlight-ai':I(t)&&!e.searchTerm,'acu-multi-tags':Z(t)>1}]),style:(0,m.normalizeStyle)({minHeight:(0,m.unref)(32)+'px'}),onClick:(0,m.withModifiers)(e=>Ce(t),['stop'])},[a[8]||(a[8]=(0,m.createElementVNode)('i',{class:'fas fa-circle',style:{'font-size':'6px'}},null,-1)),(0,m.createElementVNode)('span',Uo,(0,m.toDisplayString)(ee(t)),1),(0,m.createCommentVNode)(' å±‚çº§æŠ˜å æŒ‰é’®ï¼ˆæœ‰å­å±‚çº§æ—¶æ˜¾ç¤ºï¼‰ '),b.value&&y(t)?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-icon-btn acu-dash-row-collapse-btn',title:N(t)?'æ”¶èµ·å­å±‚çº§':'å±•å¼€å­å±‚çº§',onClick:(0,m.withModifiers)(e=>C(t),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',N(t)?'fa-chevron-down':'fa-chevron-right'])},null,2)],8,$o)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å±•ç¤ºæ ‡ç­¾ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ae(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.column,class:'acu-dash-display-tag'},(0,m.toDisplayString)(e.value),1))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ—§ç³»ç»Ÿï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ne(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.tag.id,class:(0,m.normalizeClass)(['acu-dash-interactive-tag',{fixed:e.tag.isFixed}]),title:re(e.tag),onClick:(0,m.withModifiers)(a=>le(e.tag,t),['stop'])},(0,m.toDisplayString)(e.value),11,Lo))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ–°ç³»ç»Ÿ - ä»å…¨å±€æ ‡ç­¾åº“ï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(Y.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:se(e),onClick:(0,m.withModifiers)(a=>ie(e,{title:ee(t),value:ee(t)}),['stop'])},(0,m.toDisplayString)(e.label),9,Po))),128)),(0,m.createCommentVNode)(' åˆ†ç±»æŒ‰é’® '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(X.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:`ç‚¹å‡»é€‰æ‹© ${q(e)} ä¸‹çš„æ ‡ç­¾`,onClick:(0,m.withModifiers)(a=>ce(e,{title:ee(t),value:ee(t)}),['stop'])},[J(K(e))?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(K(e))},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',jo,(0,m.toDisplayString)(K(e)),1))],8,Fo))),128))],14,Mo))),128))],16)],16)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ™®é€šæ¨¡å¼ï¼ˆæ•°æ®é‡å°æ—¶ä¸ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼‰ '),(0,m.createElementVNode)('div',Oo,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(U.value,t=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t.key,class:(0,m.normalizeClass)(['acu-dash-list-item acu-dash-interactive',{'acu-highlight-changed':te(t),'acu-highlight-ai':I(t)&&!e.searchTerm,'acu-multi-tags':Z(t)>1}]),onClick:(0,m.withModifiers)(e=>Ce(t),['stop'])},[a[9]||(a[9]=(0,m.createElementVNode)('i',{class:'fas fa-circle',style:{'font-size':'6px'}},null,-1)),(0,m.createElementVNode)('span',Ho,(0,m.toDisplayString)(ee(t)),1),(0,m.createCommentVNode)(' å±‚çº§æŠ˜å æŒ‰é’®ï¼ˆæœ‰å­å±‚çº§æ—¶æ˜¾ç¤ºï¼‰ '),b.value&&y(t)?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-icon-btn acu-dash-row-collapse-btn',title:N(t)?'æ”¶èµ·å­å±‚çº§':'å±•å¼€å­å±‚çº§',onClick:(0,m.withModifiers)(e=>C(t),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',N(t)?'fa-chevron-down':'fa-chevron-right'])},null,2)],8,Wo)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å±•ç¤ºæ ‡ç­¾ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ae(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.column,class:'acu-dash-display-tag'},(0,m.toDisplayString)(e.value),1))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ—§ç³»ç»Ÿï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(ne(t),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.tag.id,class:(0,m.normalizeClass)(['acu-dash-interactive-tag',{fixed:e.tag.isFixed}]),title:re(e.tag),onClick:(0,m.withModifiers)(a=>le(e.tag,t),['stop'])},(0,m.toDisplayString)(e.value),11,Go))),128)),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾ï¼ˆæ–°ç³»ç»Ÿ - ä»å…¨å±€æ ‡ç­¾åº“ï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(Y.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:se(e),onClick:(0,m.withModifiers)(a=>ie(e,{title:ee(t),value:ee(t)}),['stop'])},(0,m.toDisplayString)(e.label),9,Yo))),128)),(0,m.createCommentVNode)(' åˆ†ç±»æŒ‰é’® '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(X.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-dash-category-btn',title:`ç‚¹å‡»é€‰æ‹© ${q(e)} ä¸‹çš„æ ‡ç­¾`,onClick:(0,m.withModifiers)(a=>ce(e,{title:ee(t),value:ee(t)}),['stop'])},[J(K(e))?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(K(e))},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',qo,(0,m.toDisplayString)(K(e)),1))],8,Xo))),128))],10,Ro))),128))])],2112))],64))],64)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:4},[(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),(0,m.createElementVNode)('div',Ko,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.config.icon])},null,2),a[10]||(a[10]=(0,m.createElementVNode)('span',null,'æš‚æ— æ•°æ®',-1))])],2112))],2),[[m.vShow,!i.value]])],42,vo))}});function Qo(){const e=(0,$t.A)(),t=(0,f.JH)(),{success:a}=(0,S.d)();function o(t){try{if(!t||t.length<5)return!1;const a=String(t[1]||'').trim(),o=String(t[2]||'').trim(),n=String(t[3]||'').trim(),r=String(t[4]||'').trim(),l=t[5]?String(t[5]).trim():'';if(!o||!r)return!1;let i=l||r;const c=function(){const e=window.parent||window;try{const t=e.SillyTavern?.getContext?.();if(t?.name1)return t.name1}catch(e){console.warn('[InteractionImporter] è·å–ä¸»è§’åå¤±è´¥',e)}return''}();c&&(i=i.split(c).join('{{user}}')),a&&(i=i.split(a).join('{{rowTitle}}'));const s=i,u=function(t){if(!t)return'';const a=e.getCategoryByPath(t);if(a)return a.id;const o=1===t.split('/').length?'fa-star':void 0;return e.addCategory(t,o).id}(n),d=e.library.tags.find(e=>e.label===o&&e.categoryId===u);return d?e.upsertTag({...d,promptTemplate:s}):e.createTag(o,u,s),!0}catch(e){return console.error('[InteractionImporter] Import row failed:',e),!1}}return{importFromRow:o,importAll:function(e,n=!1){if(n&&!t.config.autoImportInteractions)return 0;let r=0;return e&&Array.isArray(e)?(e.forEach(e=>{o(e)&&r++}),r>0&&a(`æˆåŠŸå¯¼å…¥ ${r} ä¸ªäº¤äº’åŠ¨ä½œ`),r):0}}}const Zo=['draggable'],en={key:0,class:'acu-dash-count'},tn={key:0,class:'acu-dash-actions'},an=['title'],on=['title','onClick'],nn={class:'acu-dash-body acu-dash-body-scrollable'},rn={key:0,class:'acu-interaction-list'},ln=['onClick'],cn={class:'acu-interaction-header'},sn={class:'acu-interaction-target'},un={class:'acu-interaction-actions'},dn=['onClick'],pn=['title','disabled','onClick'],mn={class:'acu-interaction-meta'},fn={class:'acu-badge acu-badge-primary'},gn={class:'acu-badge acu-badge-secondary'},vn={key:0,class:'acu-badge acu-badge-secondary'},bn={class:'acu-interaction-text'},hn={class:'acu-dash-empty'},xn=(0,m.defineComponent)({__name:'InteractionTableWidget',props:{config:{},tableData:{},isEditing:{type:Boolean},diffMap:{},aiDiffMap:{},searchTerm:{}},emits:['navigate','row-edit','action','remove','resize','drag-start','drag-end','drop'],setup(e,{emit:t}){const{setInput:a}=ue(),{importFromRow:o,importAll:n}=Qo(),{success:r,error:l}=(0,S.d)(),i=(0,k.j_)(),c=e,s=t,u=(0,m.ref)(!1),d=(0,m.ref)(new Set),p=((0,m.computed)(()=>c.tableData?.rows.length??0),(0,m.computed)(()=>h.value.length)),f=(0,m.computed)(()=>c.tableData?.name||c.config.title),g=(0,m.computed)(()=>(c.config.actions||[]).filter(e=>'settings'!==e&&'goToTable'!==e)),v=(0,m.computed)(()=>{if(c.config.icon&&'fa-table'!==c.config.icon)return c.config.icon;const e=c.tableData?.name||c.config.title;if(e){return(0,k.Sj)(e).replace('fas ','')}return'fa-table'}),b=(0,m.computed)(()=>!(!c.tableData||!c.aiDiffMap)&&c.tableData.rows.some(e=>E(e))),h=(0,m.computed)(()=>{if(!c.tableData)return[];let e=[...c.tableData.rows];if(c.searchTerm){const t=c.searchTerm.toLowerCase().trim();e=e.filter(e=>e.cells.some(e=>String(e.value).toLowerCase().includes(t)))}return e});function x(e){return _t.bT[e]?.tooltip||''}function y(e){return _t.bT[e]?.icon??'fa-question'}function w(e){return!!_t.bT[e]?.secondaryIcon}function C(e){return _t.bT[e]?.secondaryIcon??''}function N(e,t){const a=e.cells.find(e=>e.key===t);return a?String(a.value):''}function V(e){if(!c.tableData)return!1;const t=`${c.tableData.name}-row-${e.index}`;return c.diffMap.has(t)}function E(e){if(!c.tableData||!c.aiDiffMap)return!1;const t=`${c.tableData.name}-row-${e.index}`;return c.aiDiffMap.has(t)}function B(e){return d.value.has(e.key)}function T(e){c.isEditing||e.target.closest('.acu-dash-actions')||(u.value=!u.value)}function D(){c.isEditing||c.config.tableId&&s('navigate',c.config.tableId)}function A(e){if('settings'===e){const e=c.tableData?.headers??[];return void i.openWidgetSettingsDialog({widgetId:c.config.id,widgetConfig:c.config,tableHeaders:e})}c.config.tableId&&s('action',e,c.config.tableId)}function I(){s('drag-start',c.config.id)}function M(){s('drag-end')}function U(){s('drop',c.config.id)}function L(){i.openWidgetActionsDialog({widgetId:c.config.id,currentActions:c.config.actions})}function P(e){e.preventDefault();const t=1===c.config.colSpan?2:1;s('resize',c.config.id,t)}function F(){if(!c.tableData)return;const e=c.tableData.rows.map(e=>[null,N(e,'äº¤äº’å¯¹è±¡'),N(e,'äº¤äº’åç§°'),N(e,'äº¤äº’ç±»å‹'),N(e,'äº¤äº’å†…å®¹'),N(e,'äº¤äº’ç®€ä»‹')]);n(e)>0&&c.tableData.rows.forEach(e=>d.value.add(e.key))}(0,m.watch)(()=>c.aiDiffMap,e=>{if(!e||!c.tableData)return;if(c.tableData.rows.some(t=>{const a=`${c.tableData.name}-row-${t.index}`;return e.has(a)})){const e=c.tableData.rows.map(e=>[null,N(e,'äº¤äº’å¯¹è±¡'),N(e,'äº¤äº’åç§°'),N(e,'äº¤äº’ç±»å‹'),N(e,'äº¤äº’å†…å®¹'),N(e,'äº¤äº’ç®€ä»‹')]);n(e,!0)>0&&c.tableData.rows.forEach(e=>d.value.add(e.key))}},{deep:!0});let j=!1;return(0,m.watch)(()=>c.isEditing,e=>{e?(j=u.value,u.value=!0):u.value=j},{immediate:!0}),(t,n)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:(0,m.normalizeClass)(['acu-dash-widget',{'acu-dash-widget-wide':2===e.config.colSpan,'acu-dash-widget-editing':e.isEditing,'acu-highlight-ai-table':b.value&&!e.searchTerm}]),draggable:e.isEditing,onDragstart:I,onDragend:M,onDragover:n[2]||(n[2]=(0,m.withModifiers)(()=>{},['prevent'])),onDrop:U},[(0,m.createCommentVNode)(' ç¼–è¾‘æ§ä»¶ (ä»…ç¼–è¾‘æ€æ˜¾ç¤º) '),e.isEditing?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createElementVNode)('button',{class:'acu-widget-remove',title:'ç§»é™¤ç»„ä»¶',onClick:n[0]||(n[0]=(0,m.withModifiers)(t=>s('remove',e.config.id),['stop']))},[...n[3]||(n[3]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-widget-config',title:'é…ç½®å¿«æ·æŒ‰é’®',onClick:(0,m.withModifiers)(L,['stop'])},[...n[4]||(n[4]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])]),(0,m.createElementVNode)('div',{class:'acu-widget-resize',title:'æ‹–åŠ¨æ”¹å˜å¤§å°',onMousedown:(0,m.withModifiers)(P,['stop']),onTouchstart:(0,m.withModifiers)(P,['stop'])},[...n[5]||(n[5]=[(0,m.createElementVNode)('i',{class:'fas fa-expand-alt'},null,-1)])],32)],64)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-dash-title',{'acu-dash-title-clickable':!e.isEditing}]),onClick:T},[(0,m.createElementVNode)('span',{class:'acu-dash-title-text',onClick:(0,m.withModifiers)(D,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',v.value])},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(f.value)+' ',1),p.value>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',en,(0,m.toDisplayString)(p.value),1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' æŒ‰é’®åŒº '),e.isEditing?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('div',tn,[(0,m.createCommentVNode)(' å…¨éƒ¨å­˜å…¥æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'å°†æ‰€æœ‰äº¤äº’å­˜å…¥æ ‡ç­¾åº“',onClick:(0,m.withModifiers)(F,['stop'])},[...n[6]||(n[6]=[(0,m.createElementVNode)('i',{class:'fas fa-save'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:x('settings'),onClick:n[1]||(n[1]=(0,m.withModifiers)(e=>A('settings'),['stop']))},[...n[7]||(n[7]=[(0,m.createElementVNode)('i',{class:'fas fa-cog'},null,-1)])],8,an),(0,m.createCommentVNode)(' è‡ªå®šä¹‰å¿«æ·æŒ‰é’® '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(g.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e,class:(0,m.normalizeClass)(['acu-icon-btn',{'acu-dual-icon':w(e)}]),title:x(e),onClick:(0,m.withModifiers)(t=>A(e),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',y(e)])},null,2),w(e)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(['fas icon-secondary',C(e)])},null,2)):(0,m.createCommentVNode)('v-if',!0)],10,on))),128)),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas acu-dash-collapse-icon',u.value?'fa-chevron-down':'fa-chevron-up'])},null,2)]))],2),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.withDirectives)((0,m.createElementVNode)('div',nn,[h.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',rn,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(h.value,t=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t.key,class:(0,m.normalizeClass)(['acu-interaction-item',{'acu-highlight-changed':V(t),'acu-highlight-ai':E(t)&&!e.searchTerm}]),onClick:e=>function(e){c.isEditing||c.config.tableId&&s('row-edit',c.config.tableId,e)}(t)},[(0,m.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šäº¤äº’å¯¹è±¡ + æŒ‰é’® '),(0,m.createElementVNode)('div',cn,[(0,m.createElementVNode)('span',sn,(0,m.toDisplayString)(N(t,'äº¤äº’å¯¹è±¡')),1),(0,m.createElementVNode)('div',un,[(0,m.createCommentVNode)(' è¿½åŠ åˆ°è¾“å…¥æ¡† '),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'è¿½åŠ åˆ°è¾“å…¥æ¡†',onClick:(0,m.withModifiers)(e=>async function(e){const t=N(e,'äº¤äº’å†…å®¹');t&&(a(t),r('å·²è¿½åŠ åˆ°è¾“å…¥æ¡†'))}(t),['stop'])},[...n[8]||(n[8]=[(0,m.createElementVNode)('i',{class:'fas fa-reply'},null,-1)])],8,dn),(0,m.createCommentVNode)(' å•æ¡å­˜å…¥ '),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-icon-btn',{'acu-btn-success':B(t)}]),title:B(t)?'å·²å­˜å…¥':'å­˜å…¥æ ‡ç­¾åº“',disabled:B(t),onClick:(0,m.withModifiers)(e=>function(e){const t=N(e,'äº¤äº’å¯¹è±¡'),a=N(e,'äº¤äº’åç§°'),n=N(e,'äº¤äº’ç±»å‹'),i=N(e,'äº¤äº’å†…å®¹'),c=N(e,'äº¤äº’ç®€ä»‹');o([null,t,a,n,i,c])?(d.value.add(e.key),r('å·²å­˜å…¥æ ‡ç­¾åº“')):l('å­˜å…¥å¤±è´¥ï¼Œæ•°æ®ä¸å®Œæ•´')}(t),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',B(t)?'fa-check':'fa-download'])},null,2)],10,pn)])]),(0,m.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šBadge '),(0,m.createElementVNode)('div',mn,[(0,m.createElementVNode)('span',fn,(0,m.toDisplayString)(N(t,'äº¤äº’åç§°')),1),(0,m.createElementVNode)('span',gn,(0,m.toDisplayString)(N(t,'äº¤äº’ç±»å‹')),1),N(t,'äº¤äº’ç®€ä»‹')?((0,m.openBlock)(),(0,m.createElementBlock)('span',vn,(0,m.toDisplayString)(N(t,'äº¤äº’ç®€ä»‹')),1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šå†…å®¹ '),(0,m.createElementVNode)('div',bn,(0,m.toDisplayString)(N(t,'äº¤äº’å†…å®¹')),1)],10,ln))),128))])):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),(0,m.createElementVNode)('div',hn,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.config.icon])},null,2),n[9]||(n[9]=(0,m.createElementVNode)('span',null,'æš‚æ— äº¤äº’æ•°æ®',-1))])],2112))],512),[[m.vShow,!u.value]])],42,Zo))}});d(7590);const yn=xn,wn=['draggable'],kn={class:'acu-dash-title-text'},Cn={key:0,class:'acu-dash-count'},Nn={class:'acu-dash-actions'},Vn=['title'],En=['title','onClick'],Bn={class:'acu-dash-body rwp-body'},Sn={key:0,class:'acu-dash-empty'},Tn=['onClick'],Dn={class:'rwp-header-left'},An={class:'rwp-column-name'},zn={class:'rwp-word-count'},In={class:'rwp-limit-wrapper'},_n=['onClick'],Mn={class:'popover-body'},Un={class:'limit-control'},$n=['value','onInput'],Ln={class:'limit-value'},Pn={class:'popover-actions'},Fn=['onClick'],jn={class:'acu-switch small'},On=['checked','onChange'],Rn={class:'rwp-group-content'},Hn={key:0,class:'rwp-empty-hint'},Wn=(0,m.defineComponent)({__name:'RandomWordPoolWidget',props:{isEditing:{type:Boolean},widgetId:{default:'random-word-pool'},colSpan:{default:1},config:{default:()=>({})}},emits:['remove','resize','action','drag-start','drag-end','drop'],setup(e,{emit:t}){const a=e,o=t,n=(0,Mt.E)(),r=(0,k.j_)(),l=(0,w.D)(),i=(0,m.ref)(!1),c=(0,m.ref)(!1),s=(0,m.reactive)({}),u=(0,m.ref)(null),d=(0,m.ref)([]),p=(0,m.computed)(()=>d.value.length),f=(0,m.computed)(()=>(a.config?.actions||[]).filter(e=>'settings'!==e)),g=(0,m.computed)(()=>0!==d.value.length&&d.value.every(e=>s[e.id]));function v(){const e=(0,ze.dK)(),t=[];for(const a of e){const e=(0,ze.o9)(a);if(e.length<=1)continue;const o=e[e.length-1],n=[];if(Array.isArray(o))for(const e of o)if(e&&'string'==typeof e){const t=e.trim();t&&n.push(t)}t.push({id:a,name:(0,ze._V)(a),words:n})}d.value=t;for(const e of d.value)void 0===s[e.id]&&(s[e.id]=!1);console.info(`[RandomWordPoolWidget] åŠ è½½äº† ${d.value.length} ä¸ªè¡¨æ•°æ®`)}function b(e){const t=n.config.tablePoolConfig[e];return!t||t.enabled}function h(e){return n.config.tablePoolConfig[e]?.limit||0}function x(e){const t=h(e);return t>0?`é™ ${t}`:'ä¸é™'}function y(e,t){const a=n.config.tablePoolConfig[e]||{enabled:!0,limit:0};n.config.tablePoolConfig[e]={...a,limit:t}}function C(){u.value=null}function N(){const e=!g.value;for(const t of d.value)s[t.id]=e}function V(){a.isEditing||(i.value=!i.value)}function E(){r.openDivinationSettingsDialog()}function B(e){return _t.bT[e]?.icon??'fa-question'}function S(e){return!!_t.bT[e]?.secondaryIcon}function T(e){return _t.bT[e]?.secondaryIcon??''}function D(e){return _t.bT[e]?.tooltip??e}function A(){r.openWidgetActionsDialog({widgetId:a.config.id||a.widgetId,currentActions:a.config.actions||[]})}function I(e){e.preventDefault();const t=1===a.colSpan?2:1;o('resize',a.widgetId,t)}function M(e){a.isEditing?(e.dataTransfer?.setData('text/plain',a.widgetId),o('drag-start',a.widgetId)):e.preventDefault()}function U(){o('drag-end')}function L(e){e.preventDefault(),o('drop',a.widgetId)}return(0,m.onMounted)(()=>{v(),window.addEventListener('click',C)}),(0,m.onUnmounted)(()=>{window.removeEventListener('click',C)}),(0,m.watch)(()=>n.config.tablePoolConfig,()=>{},{deep:!0}),(0,m.watch)(()=>a.isEditing,e=>{e?(c.value=i.value,i.value=!0):i.value=c.value}),(0,m.watch)(()=>l.tables,()=>{console.log('[RandomWordPoolWidget] æ£€æµ‹åˆ°æ•°æ®å˜æ›´ï¼Œåˆ·æ–°è¯åº“...'),v()},{deep:!1}),(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:(0,m.normalizeClass)(['acu-dash-widget rwp-widget',{'acu-dash-widget-wide':2===e.colSpan,'acu-dash-widget-editing':e.isEditing}]),draggable:e.isEditing,onDragstart:M,onDragend:U,onDragover:a[3]||(a[3]=(0,m.withModifiers)(()=>{},['prevent'])),onDrop:L},[(0,m.createCommentVNode)(' ç¼–è¾‘æ§ä»¶ (ä»…ç¼–è¾‘æ€æ˜¾ç¤º) '),e.isEditing?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createElementVNode)('button',{class:'acu-widget-remove',title:'ç§»é™¤ç»„ä»¶',onClick:a[0]||(a[0]=(0,m.withModifiers)(t=>o('remove',e.widgetId),['stop']))},[...a[4]||(a[4]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-widget-config',title:'é…ç½®å¿«æ·æŒ‰é’®',onClick:(0,m.withModifiers)(A,['stop'])},[...a[5]||(a[5]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])]),(0,m.createElementVNode)('div',{class:'acu-widget-resize',title:'ç‚¹å‡»åˆ‡æ¢å•/åŒæ ',onMousedown:(0,m.withModifiers)(I,['stop']),onTouchstart:(0,m.withModifiers)(I,['stop'])},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-expand-alt'},null,-1)])],32)],64)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',{class:'acu-dash-title rwp-header',onClick:V},[(0,m.createElementVNode)('span',kn,[a[7]||(a[7]=(0,m.createElementVNode)('i',{class:'fas fa-dice'},null,-1)),a[8]||(a[8]=(0,m.createTextVNode)(' éšæœºè¯è¡¨ ',-1)),p.value>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',Cn,(0,m.toDisplayString)(p.value),1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.withDirectives)((0,m.createElementVNode)('div',Nn,[(0,m.createCommentVNode)(' ä¸€é”®å±•å¼€/æŠ˜å  '),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:g.value?'å…¨éƒ¨æŠ˜å ':'å…¨éƒ¨å±•å¼€',onClick:(0,m.withModifiers)(N,['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',g.value?'fa-compress-alt':'fa-expand-alt'])},null,2)],8,Vn),(0,m.createCommentVNode)(' è®¾ç½®æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'æŠ½è¯è®¾ç½®',onClick:(0,m.withModifiers)(E,['stop'])},[...a[9]||(a[9]=[(0,m.createElementVNode)('i',{class:'fas fa-cog'},null,-1)])]),(0,m.createCommentVNode)(' è‡ªå®šä¹‰å¿«æ·æŒ‰é’® '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(f.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e,class:(0,m.normalizeClass)(['acu-icon-btn',{'acu-dual-icon':S(e)}]),title:D(e),onClick:(0,m.withModifiers)(t=>function(e){o('action',e,'')}(e),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',B(e)])},null,2),S(e)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(['fas icon-secondary',T(e)])},null,2)):(0,m.createCommentVNode)('v-if',!0)],10,En))),128)),(0,m.createCommentVNode)(' æŠ˜å æŒ‡ç¤ºå™¨ '),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas acu-dash-collapse-icon',i.value?'fa-chevron-down':'fa-chevron-up'])},null,2)],512),[[m.vShow,!e.isEditing]])]),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.withDirectives)((0,m.createElementVNode)('div',Bn,[(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===p.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Sn,[...a[10]||(a[10]=[(0,m.createElementVNode)('i',{class:'fas fa-dice'},null,-1),(0,m.createElementVNode)('span',null,'æœªæ£€æµ‹åˆ°éšæœºè¡¨',-1),(0,m.createElementVNode)('span',{class:'hint'},'è¡¨åéœ€åŒ…å«"éšæœº"ã€"Random"ç­‰å…³é”®è¯',-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è¡¨åˆ†ç»„ (V2: æŒ‰è¡¨ååˆ†ç»„) '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(d.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['rwp-column-group',{collapsed:!s[e.id]}])},[(0,m.createCommentVNode)(' è¡¨å¤´ '),(0,m.createElementVNode)('div',{class:'rwp-group-header',onClick:t=>{return a=e.id,void(s[a]=!s[a]);var a}},[(0,m.createElementVNode)('div',Dn,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',s[e.id]?'fa-chevron-down':'fa-chevron-right'])},null,2),(0,m.createElementVNode)('span',An,(0,m.toDisplayString)(e.name),1),(0,m.createElementVNode)('span',zn,'('+(0,m.toDisplayString)(e.words.length)+')',1)]),(0,m.createElementVNode)('div',{class:'rwp-header-right',onClick:a[2]||(a[2]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createCommentVNode)(' Limit è®¾ç½® Badge '),(0,m.createElementVNode)('div',In,[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-badge-pill acu-badge-interactive',u.value===e.id?'acu-badge-primary':'acu-badge-secondary']),title:'ç‚¹å‡»è®¾ç½®æŠ½å–æ•°é‡é™åˆ¶',onClick:(0,m.withModifiers)(t=>{return a=e.id,void(u.value===a?u.value=null:u.value=a);var a},['stop'])},[a[11]||(a[11]=(0,m.createElementVNode)('i',{class:'fas fa-filter',style:{'margin-right':'4px','font-size':'11px'}},null,-1)),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(x(e.id)),1)],10,_n),(0,m.createCommentVNode)(' Limit è®¾ç½® Popover '),u.value===e.id?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'rwp-limit-popover',onClick:a[1]||(a[1]=(0,m.withModifiers)(()=>{},['stop']))},[a[12]||(a[12]=(0,m.createElementVNode)('div',{class:'popover-header'},'æŠ½å–æ•°é‡é™åˆ¶ (0=ä¸é™)',-1)),(0,m.createElementVNode)('div',Mn,[(0,m.createElementVNode)('div',Un,[(0,m.createElementVNode)('input',{type:'range',class:'acu-range-input',min:'0',max:'10',step:'1',value:h(e.id),onInput:t=>y(e.id,+t.target.value)},null,40,$n),(0,m.createElementVNode)('span',Ln,(0,m.toDisplayString)(h(e.id)||'ä¸é™'),1)]),(0,m.createElementVNode)('div',Pn,[(0,m.createElementVNode)('button',{class:'acu-tool-btn small',onClick:t=>y(e.id,0)},'é‡ç½®ä¸ºä¸é™',8,Fn)])])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createElementVNode)('label',jn,[(0,m.createElementVNode)('input',{type:'checkbox',checked:b(e.id),onChange:(0,m.withModifiers)(t=>function(e){const t=n.config.tablePoolConfig[e]||{enabled:!0,limit:0};n.config.tablePoolConfig[e]={...t,enabled:!t.enabled}}(e.id),['stop'])},null,40,On),a[13]||(a[13]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])],8,Tn),(0,m.createCommentVNode)(' è¯åˆ—è¡¨ '),(0,m.withDirectives)((0,m.createElementVNode)('div',Rn,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.words,(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:a,class:(0,m.normalizeClass)(['rwp-word-badge',{disabled:!b(e.id)}])},(0,m.toDisplayString)(t),3))),128)),0===e.words.length?((0,m.openBlock)(),(0,m.createElementBlock)('span',Hn,' æš‚æ— è¯æ¡ ')):(0,m.createCommentVNode)('v-if',!0)],512),[[m.vShow,s[e.id]]])],2))),128))],512),[[m.vShow,!i.value]])],42,wn))}}),Gn={class:'acu-dash-container-new'},Yn={class:'acu-dash-header'},Xn={class:'acu-dash-header-actions'},qn={key:0,class:'acu-dash-add-section'},Kn={key:0,class:'acu-switch-list acu-dash-add-list'},Jn={class:'acu-switch-list-body'},Qn=['onClick'],Zn={class:'item-label'},er=['onChange'],tr=['onClick'],ar={class:'item-label'},or=['onChange'],nr=['onClick'],rr={class:'item-label'},lr=['onChange'],ir={key:1,class:'acu-dash-empty-state'},cr=(0,m.defineComponent)({__name:'Dashboard',props:{tables:{}},emits:['navigate','rowClick','showRelationshipGraph','action','heightDragStart','heightReset'],setup(e,{emit:t}){const a=(0,S.d)(),o=e,n=t,r=(0,w.D)(),l=(0,It.f)(),i=(0,k.j_)(),c=(0,m.ref)(!1),s=(0,m.ref)(!1),u=(0,m.ref)(''),d=(0,m.ref)(null),p=(0,m.ref)(null),f=(0,m.ref)(null),g=(0,m.ref)(null);let v=null;const b=(0,m.computed)(()=>l.enabledWidgets),h=(0,m.computed)(()=>o.tables.filter(e=>!l.hasWidget(e.id))),x=(0,m.computed)(()=>{const e=l.config.widgets,t=[];return e.some(e=>'updateStatus'===e.type)||t.push({type:'updateStatus',name:'è¡¨æ ¼æ›´æ–°çŠ¶æ€',icon:'fa-sync-alt'}),e.some(e=>'optionsPanel'===e.type)||t.push({type:'optionsPanel',name:'é€‰é¡¹èšåˆé¢æ¿',icon:'fa-list-check'}),e.some(e=>'randomWordPool'===e.type)||t.push({type:'randomWordPool',name:'éšæœºè¯è¡¨',icon:'fa-dice'}),t}),y=(0,m.computed)(()=>r.diffMap),C=(0,m.computed)(()=>r.aiDiffMap),N=(0,m.computed)(()=>{const e=new Set;for(const t of l.enabledWidgets){if(!t.tableId)continue;const a=B(t.tableId);if(!a)continue;a.rows.some(e=>{const a=`${t.tableId}:${e.key}`;return r.aiDiffMap.has(a)})&&e.add(t.tableId)}return e});const V=(0,m.computed)(()=>{let e=[...l.enabledWidgets];return u.value?e=e.filter(e=>function(e){if(!u.value)return!0;const t=u.value.toLowerCase().trim();if(!t)return!0;if('updateStatus'===e.type||'optionsPanel'===e.type||'randomWordPool'===e.type)return!1;const a=B(e.tableId);return!!a&&(!!a.name.toLowerCase().includes(t)||a.rows.some(e=>e.cells.some(e=>String(e.value).toLowerCase().includes(t))))}(e)):e.sort((e,t)=>{const a=N.value.has(e.tableId||''),o=N.value.has(t.tableId||'');return a!==o?o?1:-1:e.order-t.order}),e}),E=(0,m.computed)(()=>o.tables);function B(e){return e?o.tables.find(t=>t.id===e)??null:null}function T(e){if('updateStatus'===e.type)return'è¡¨æ ¼æ›´æ–°çŠ¶æ€';if('optionsPanel'===e.type)return'é€‰é¡¹èšåˆé¢æ¿';const t=o.tables.find(t=>t.id===e.tableId);return t?.name||e.title||e.tableId||'æœªçŸ¥è¡¨æ ¼'}function D(e){const t=B(e),a=t?.name||e;for(const[t,o]of Object.entries(_t.JT))if(o.some(e=>a.toLowerCase().includes(e.toLowerCase()))){const a=l.config.widgets.find(t=>t.tableId===e);if(a?.icon)return a.icon;if('global'===t)return'fa-globe';if('task'===t)return'fa-tasks';if('item'===t)return'fa-box-open';if('character'===t)return'fa-user';if('location'===t)return'fa-map-marker-alt'}return'fa-table'}function A(){c.value=!0,a.info('æ‹–åŠ¨ç»„ä»¶é¡¶æ å¯æ’åº')}function I(){c.value=!1,s.value=!1,d.value=null,p.value=null}function M(e){if(function(e){return l.hasWidget(e)}(e)){const t=l.findWidgetByTableId(e);t&&l.removeWidget(t.id)}else{const t=o.tables.find(t=>t.id===e);l.addWidget(e,t?.name)}}function U(e){!function(e){return l.hasSpecialWidget(e)}(e)?l.addSpecialWidget(e):l.removeSpecialWidget(e)}function L(e){l.removeWidget(e)}function P(e,t){l.updateWidget(e,{colSpan:t})}function F(e){d.value=e}function j(){d.value=null,p.value=null}function O(e){if(!d.value||d.value===e)return;const t=l.config.widgets.find(t=>t.id===e);t&&l.moveWidget(d.value,t.order),d.value=null,p.value=null}function R(e){g.value&&n('heightDragStart',e,g.value)}function H(){n('heightReset')}function W(){v&&(clearTimeout(v),v=null)}function G(e){n('navigate',e)}function Y(e,t){n('rowClick',e,t)}function X(e,t){const a=B(e);i.openRowEditDialog({tableId:e,tableName:a?.name??e,rowIndex:t.index,currentRowData:t})}function q(e,t){switch(e){case'goToTable':n('navigate',t);break;case'relationshipGraph':n('showRelationshipGraph');break;default:n('action',e,t)}}return(0,m.onMounted)(async()=>{await l.loadConfig(),0===l.config.widgets.length&&function(){for(const e of o.tables)for(const[t,a]of Object.entries(_t.JT))if(a.some(t=>e.id.toLowerCase().includes(t.toLowerCase())||e.name.includes(t))){l.addWidget(e.id,e.name,t);break}}()}),(0,m.watch)(()=>o.tables,()=>{}),(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Gn,[(0,m.createCommentVNode)(' é¡¶æ  - å¸ƒå±€ï¼šæ ‡é¢˜ / (ç©º) / ç¼–è¾‘æŒ‰é’® / é«˜åº¦æ‹–æ‰‹ / æœç´¢æ¡† '),(0,m.createElementVNode)('div',Yn,[(0,m.createCommentVNode)(' å·¦ä¾§ï¼šæ ‡é¢˜ '),t[11]||(t[11]=(0,m.createElementVNode)('div',{class:'acu-dash-header-left'},[(0,m.createElementVNode)('span',{class:'acu-dash-header-title'},[(0,m.createElementVNode)('i',{class:'fas fa-th-large'}),(0,m.createTextVNode)(' ä»ªè¡¨ç›˜ ')])],-1)),(0,m.createCommentVNode)(' ä¸­é—´ï¼šå¼¹æ€§ç©ºé—´ '),t[12]||(t[12]=(0,m.createElementVNode)('div',{class:'acu-dash-header-spacer'},null,-1)),(0,m.createCommentVNode)(' å³ä¾§ï¼šæŒ‰é’®åŒº '),(0,m.createElementVNode)('div',Xn,[(0,m.createCommentVNode)(' ç¼–è¾‘æ¨¡å¼æŒ‰é’®ç»„ '),c.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-icon-btn acu-btn-primary',title:'å®Œæˆç¼–è¾‘',onClick:(0,m.withModifiers)(I,['stop'])},[...t[8]||(t[8]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1)])])):((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:1,class:'acu-icon-btn',title:'ç¼–è¾‘ä»ªè¡¨ç›˜',onClick:(0,m.withModifiers)(A,['stop'])},[...t[9]||(t[9]=[(0,m.createElementVNode)('i',{class:'fas fa-edit'},null,-1)])])),(0,m.createCommentVNode)(' é«˜åº¦æ‹–æ‰‹ '),(0,m.createElementVNode)('button',{ref_key:'heightHandleRef',ref:g,class:'acu-icon-btn acu-height-handle',title:'æ‹–åŠ¨è°ƒæ•´é«˜åº¦ / åŒå‡»é‡ç½®',onPointerdown:R,onDblclick:H,onTouchend:(0,m.withModifiers)(W,['stop'])},[...t[10]||(t[10]=[(0,m.createElementVNode)('i',{class:'fas fa-grip-lines'},null,-1)])],544),(0,m.createCommentVNode)(' æœç´¢æ¡† '),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[0]||(t[0]=e=>u.value=e),type:'text',class:'acu-search-input acu-search-inline',placeholder:'æœç´¢...'},null,512),[[m.vModelText,u.value]]),u.value?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:2,class:'fas fa-times acu-search-clear',onClick:t[1]||(t[1]=e=>u.value='')})):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createCommentVNode)(' ç»„ä»¶ç½‘æ ¼ '),(0,m.createElementVNode)('div',{ref_key:'gridRef',ref:f,class:'acu-dash-grid'},[(0,m.createCommentVNode)(' ç¼–è¾‘æ¨¡å¼ï¼šæ·»åŠ é¢æ¿ '),c.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',qn,[(0,m.createCommentVNode)(' ä½¿ç”¨é€šç”¨æŒ‰é’®æ ·å¼ '),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-action-btn',{active:s.value}]),onClick:t[2]||(t[2]=(0,m.withModifiers)(e=>s.value=!s.value,['stop']))},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',s.value?'fa-chevron-up':'fa-plus'])},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(s.value?'æ”¶èµ·':'æ·»åŠ è¡¨æ ¼'),1)],2),(0,m.createCommentVNode)(' å±•å¼€çš„æ·»åŠ é¢æ¿ï¼šå¤ç”¨ switch-list '),s.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Kn,[(0,m.createElementVNode)('div',Jn,[(0,m.createCommentVNode)(' å·²æ·»åŠ çš„è¡¨æ ¼ï¼ˆæ’å‰é¢ï¼Œswitch å¼€å¯ï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(b.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-switch-list-item is-selected',onClick:(0,m.withModifiers)(t=>L(e.id),['stop'])},[(0,m.createElementVNode)('span',Zn,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.icon])},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(T(e)),1)]),(0,m.createElementVNode)('label',{class:'acu-switch small',onClick:t[3]||(t[3]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('input',{type:'checkbox',checked:'',onChange:(0,m.withModifiers)(t=>L(e.id),['stop'])},null,40,er),t[13]||(t[13]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])],8,Qn))),128)),(0,m.createCommentVNode)(' æœªæ·»åŠ çš„ç‰¹æ®Šç»„ä»¶ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(x.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.type,class:'acu-switch-list-item',onClick:(0,m.withModifiers)(t=>U(e.type),['stop'])},[(0,m.createElementVNode)('span',ar,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.icon])},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(e.name),1)]),(0,m.createElementVNode)('label',{class:'acu-switch small',onClick:t[4]||(t[4]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('input',{type:'checkbox',checked:!1,onChange:(0,m.withModifiers)(t=>U(e.type),['stop'])},null,40,or),t[14]||(t[14]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])],8,tr))),128)),(0,m.createCommentVNode)(' æœªæ·»åŠ çš„è¡¨æ ¼ï¼ˆæ’åé¢ï¼Œswitch å…³é—­ï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(h.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-switch-list-item',onClick:(0,m.withModifiers)(t=>M(e.id),['stop'])},[(0,m.createElementVNode)('span',rr,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',D(e.id)])},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(e.name),1)]),(0,m.createElementVNode)('label',{class:'acu-switch small',onClick:t[5]||(t[5]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('input',{type:'checkbox',onChange:(0,m.withModifiers)(t=>M(e.id),['stop'])},null,40,lr),t[15]||(t[15]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])],8,nr))),128))])])):(0,m.createCommentVNode)('v-if',!0)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' åŠ¨æ€é…ç½®çš„çœ‹æ¿ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(V.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:e.id},[(0,m.createCommentVNode)(' éšæœºè¯è¡¨ç»„ä»¶ '),'randomWordPool'===e.type?((0,m.openBlock)(),(0,m.createBlock)((0,m.unref)(Wn),{key:0,'is-editing':c.value,'widget-id':e.id,'col-span':e.colSpan,config:e,class:(0,m.normalizeClass)({'acu-dash-widget-dragging':d.value===e.id,'acu-dash-widget-drop-target':p.value===e.id}),onRemove:L,onResize:P,onAction:q,onDragStart:F,onDragEnd:j,onDrop:O},null,8,['is-editing','widget-id','col-span','config','class'])):'interaction'===e.displayStyle?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' äº¤äº’è¡¨æ ¼ä¸“ç”¨ç»„ä»¶ '),(0,m.createVNode)((0,m.unref)(yn),{config:e,'table-data':B(e.tableId),'is-editing':c.value,'diff-map':y.value,'ai-diff-map':C.value,'search-term':u.value,class:(0,m.normalizeClass)({'acu-dash-widget-dragging':d.value===e.id,'acu-dash-widget-drop-target':p.value===e.id}),onNavigate:G,onRowEdit:X,onAction:q,onRemove:L,onResize:P,onDragStart:F,onDragEnd:j,onDrop:O},null,8,['config','table-data','is-editing','diff-map','ai-diff-map','search-term','class'])],2112)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' æ™®é€šçœ‹æ¿ç»„ä»¶ '),(0,m.createVNode)((0,m.unref)(Jo),{config:e,'table-data':B(e.tableId),'is-editing':c.value,'diff-map':y.value,'ai-diff-map':C.value,'search-term':u.value,'all-tables':E.value,class:(0,m.normalizeClass)({'acu-dash-widget-dragging':d.value===e.id,'acu-dash-widget-drop-target':p.value===e.id}),onNavigate:G,onRowClick:Y,onRowEdit:X,onAction:q,onRemove:L,onResize:P,onDragStart:F,onDragEnd:j,onDrop:O},null,8,['config','table-data','is-editing','diff-map','ai-diff-map','search-term','all-tables','class'])],2112))],64))),128)),(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===V.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',ir,[u.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[t[17]||(t[17]=(0,m.createElementVNode)('i',{class:'fas fa-search'},null,-1)),(0,m.createElementVNode)('p',null,'æ²¡æœ‰æ‰¾åˆ°åŒ¹é… "'+(0,m.toDisplayString)(u.value)+'" çš„å†…å®¹',1),(0,m.createElementVNode)('button',{class:'acu-dash-add-first-btn',onClick:t[6]||(t[6]=(0,m.withModifiers)(e=>u.value='',['stop']))},[...t[16]||(t[16]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1),(0,m.createTextVNode)(' æ¸…é™¤æœç´¢ ',-1)])])],64)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[t[19]||(t[19]=(0,m.createElementVNode)('i',{class:'fas fa-layer-group'},null,-1)),t[20]||(t[20]=(0,m.createElementVNode)('p',null,'è¿˜æ²¡æœ‰é…ç½®ä»»ä½•çœ‹æ¿',-1)),(0,m.createElementVNode)('button',{class:'acu-dash-add-first-btn',onClick:t[7]||(t[7]=(0,m.withModifiers)(e=>{A(),s.value=!0},['stop']))},[...t[18]||(t[18]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1),(0,m.createTextVNode)(' æ·»åŠ ç¬¬ä¸€ä¸ªçœ‹æ¿ ',-1)])])],64))])):(0,m.createCommentVNode)('v-if',!0)],512)]))}}),sr={class:'acu-table-toolbar'},ur={class:'acu-toolbar-left'},dr={class:'acu-table-title'},pr={class:'acu-table-count'},mr={key:0,class:'acu-table-badge acu-badge-changed'},fr={key:1,class:'acu-table-badge acu-badge-deleting'},gr={class:'acu-toolbar-right'},vr=['title'],br={key:0,class:'acu-empty-state'},hr={key:0,class:'acu-pagination-container'},xr={class:'acu-pagination-numbers'},yr={key:0,class:'acu-page-dots'},wr=['onClick'],kr=(0,m.defineComponent)({__name:'DataTable',props:{tableId:{},tableName:{},rows:{},headers:{default:()=>[]},searchTerm:{default:''},showIndex:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showPagination:{type:Boolean,default:!0},emptyText:{default:'æš‚æ— æ•°æ®'},isLoading:{type:Boolean,default:!1}},emits:['cellClick','insertRow','toggleDelete','contextMenu','searchChange','pageChange','close','heightDragStart','heightReset','showHistory'],setup(e,{emit:t}){const a=e,o=t,n=(0,w.D)(),r=(0,f.JH)(),l=(0,k.j_)(),i=(0,m.ref)(),c=(0,m.ref)(),s=(0,m.ref)(l.getTableStyle(a.tableName)),u=(0,m.ref)(a.searchTerm),d=(0,m.ref)(1),p=(0,m.computed)(()=>{if(a.tableName.includes('æ€»ç»“')||a.tableName.includes('å¤§çº²')){const e=a.headers.findIndex(e=>e&&(e.includes('ç´¢å¼•')||e.includes('ç¼–å·')||e.includes('ä»£ç ')));if(e>0)return e}return 1}),g=(0,m.computed)(()=>l.isTableReversed(a.tableName)),v=(0,m.ref)(new Map);(0,m.onMounted)(()=>{!function(){const e=new Map;for(const t of a.rows){const o=n.getRowChangeType(a.tableName,t.index,t.cells.length);o&&e.set(t.index,o)}v.value=e}()});const b=(0,m.computed)(()=>{let e=a.rows;if(l.showLockedOnly&&l.isLockEditMode){const t=(0,xe.t)();e=e.filter(e=>{const o=e.cells.map(e=>e.key),n=e.cells.map(e=>String(e.value??'')),r=t.getRowKey(a.tableName,n,o,e.index);return!!r&&t.hasRowAnyLockPending(a.tableName,r)})}const t=u.value.toLowerCase().trim();return t?e.filter(e=>e.cells.some(e=>String(e.value).toLowerCase().includes(t))):e});function h(e){return v.value.get(e.index)??null}function x(e){return'manual'===e?2:'ai'===e?1:0}const y=(0,m.computed)(()=>[...b.value].sort((e,t)=>{const a=h(e),o=h(t),n=x(a),r=x(o);return n!==r?r-n:g.value?t.index-e.index:e.index-t.index})),C=(0,m.computed)(()=>r.config.itemsPerPage||20),N=(0,m.computed)(()=>Math.max(1,Math.ceil(y.value.length/C.value))),V=(0,m.computed)(()=>{const e=(d.value-1)*C.value;return y.value.slice(e,e+C.value)}),E=(0,m.computed)(()=>a.rows.length),B=(0,m.computed)(()=>a.rows.filter(e=>I(e)).length),T=(0,m.computed)(()=>a.rows.filter(e=>{const t=`${a.tableName}-row-${e.index}`;return n.pendingDeletes.has(t)}).length),D=(0,m.computed)(()=>a.showPagination&&!1!==r.config.showPagination),A=(0,m.computed)(()=>{const e=[],t=N.value,a=d.value;if(t<=7)for(let a=1;a<=t;a++)e.push(a);else{e.push(1),a>3&&e.push('...');const o=Math.max(2,a-1),n=Math.min(t-1,a+1);for(let t=o;t<=n;t++)e.push(t);a<t-2&&e.push('...'),e.push(t)}return e});function I(e){return n.isRowChanged(a.tableName,e.index,e.cells.length)}function M(){l.toggleTableReverse(a.tableName)}function U(){const e=(0,xe.t)();if(l.isLockEditMode){const t=e.pendingLockCount.value;e.savePendingLocks(),l.isLockEditMode=!1,S.toast.success(`å·²ä¿å­˜ ${t} ä¸ªå•å…ƒæ ¼é”å®š`)}else e.initPendingLocks(),l.isLockEditMode=!0,S.toast.info('å·²è¿›å…¥æ‰¹é‡é”å®šæ¨¡å¼ï¼Œè¯·ç‚¹å‡»å•å…ƒæ ¼è¿›è¡Œé”å®š')}function L(){l.showLockedOnly=!l.showLockedOnly}function P(){o('close')}function F(){d.value=1,o('searchChange',u.value)}function j(){u.value='',d.value=1,o('searchChange','')}function O(e){e<1||e>N.value||(d.value=e,o('pageChange',e),(0,m.nextTick)(()=>{i.value?.scrollTo({top:0,behavior:'smooth'})}))}function R(e,t){o('cellClick',a.tableId,e,t)}function H(e,t){o('contextMenu',e,a.tableId,t)}function W(e){c.value&&o('heightDragStart',e,c.value)}function G(){o('heightReset')}let Y=0;function X(){const e=Date.now();e-Y<300?(G(),Y=0):Y=e}return(0,m.watch)(()=>a.searchTerm,e=>{u.value=e}),(0,m.watch)(s,e=>{l.setTableStyle(a.tableName,e)}),(0,m.watch)(N,e=>{d.value>e&&(d.value=Math.max(1,e))}),(t,n)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:(0,m.normalizeClass)(['acu-data-table',{'acu-table-loading':e.isLoading}])},[(0,m.createCommentVNode)(' å›ºå®šå·¥å…·æ  '),(0,m.createElementVNode)('div',sr,[(0,m.createCommentVNode)(' å·¦ä¾§ï¼šè¡¨å + (æ¡æ•°) '),(0,m.createElementVNode)('div',ur,[(0,m.createElementVNode)('span',dr,(0,m.toDisplayString)(e.tableName),1),(0,m.createElementVNode)('span',pr,'('+(0,m.toDisplayString)(E.value)+')',1),B.value>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',mr,(0,m.toDisplayString)(B.value),1)):(0,m.createCommentVNode)('v-if',!0),T.value>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',fr,(0,m.toDisplayString)(T.value),1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' å³ä¾§ï¼šä»å³åˆ°å·¦ - å…³é—­ã€æœç´¢ã€é«˜åº¦æ‹–æ‰‹ã€å€’åºã€é”å®š '),(0,m.createElementVNode)('div',gr,[(0,m.createCommentVNode)(' é”å®šæ¨¡å¼ç­›é€‰æŒ‰é’® '),(0,m.unref)(l).isLockEditMode?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:(0,m.normalizeClass)(['acu-icon-btn',{active:(0,m.unref)(l).showLockedOnly}]),title:'åªæ˜¾ç¤ºé”å®šçš„å¡ç‰‡',onClick:(0,m.withModifiers)(L,['stop'])},[...n[3]||(n[3]=[(0,m.createElementVNode)('i',{class:'fas fa-filter'},null,-1)])],2)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' é”å®šå•å…ƒæ ¼æŒ‰é’® '),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-icon-btn',{active:(0,m.unref)(l).isLockEditMode}]),title:(0,m.unref)(l).isLockEditMode?'ä¿å­˜å¹¶é€€å‡ºé”å®šæ¨¡å¼':'è¿›å…¥æ‰¹é‡é”å®šæ¨¡å¼',onClick:(0,m.withModifiers)(U,['stop'])},[...n[4]||(n[4]=[(0,m.createElementVNode)('i',{class:'fas fa-lock'},null,-1)])],10,vr),(0,m.createCommentVNode)(' å€’åºæŒ‰é’® '),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-icon-btn',{active:g.value}]),title:'å€’åºæ˜¾ç¤º',onClick:M},[...n[5]||(n[5]=[(0,m.createElementVNode)('i',{class:'fas fa-sort-amount-down-alt'},null,-1)])],2),(0,m.createCommentVNode)(' é«˜åº¦æ‹–æ‰‹ '),(0,m.createElementVNode)('button',{ref_key:'heightHandleRef',ref:c,class:'acu-icon-btn acu-height-handle',title:'æ‹–åŠ¨è°ƒæ•´é«˜åº¦ / åŒå‡»é‡ç½®',onPointerdown:W,onDblclick:G,onTouchend:(0,m.withModifiers)(X,['stop'])},[...n[6]||(n[6]=[(0,m.createElementVNode)('i',{class:'fas fa-grip-lines'},null,-1)])],544),(0,m.createCommentVNode)(' æœç´¢æ¡† '),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':n[0]||(n[0]=e=>u.value=e),type:'text',class:'acu-search-input acu-search-inline',placeholder:'æœç´¢...',onInput:F},null,544),[[m.vModelText,u.value]]),u.value?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:1,class:'fas fa-times acu-search-clear',onClick:j})):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å…³é—­æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-icon-btn acu-close-btn',title:'å…³é—­æ•°æ®åŒº',onClick:(0,m.withModifiers)(P,['stop'])},[...n[7]||(n[7]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])])]),(0,m.createCommentVNode)(' æ•°æ®å¡ç‰‡åˆ—è¡¨ '),(0,m.createElementVNode)('div',{ref_key:'containerRef',ref:i,class:(0,m.normalizeClass)(['acu-cards-container',[`acu-view-${s.value}`]])},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(V.value,t=>((0,m.openBlock)(),(0,m.createBlock)(zt,{key:`${e.tableId}-${t.index}`,data:t,'table-id':e.tableId,'table-name':e.tableName,'is-changed':I(t),layout:(0,m.unref)(r).config.layout,'view-mode':s.value,'show-index':e.showIndex,'show-header':e.showHeader,'title-col-index':p.value,'show-history-button':!0,onCellClick:R,onInsertRow:e=>{return n=t.index,void o('insertRow',a.tableId,n);var n},onToggleDelete:e=>{return n=t.index,void o('toggleDelete',a.tableId,n);var n},onContextMenu:H,onShowHistory:e=>function(e){o('showHistory',a.tableId,a.tableName,e.index,e)}(t)},null,8,['data','table-id','table-name','is-changed','layout','view-mode','show-index','show-header','title-col-index','onInsertRow','onToggleDelete','onShowHistory']))),128)),(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===b.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',br,[n[8]||(n[8]=(0,m.createElementVNode)('i',{class:'fas fa-inbox'},null,-1)),(0,m.createElementVNode)('p',null,(0,m.toDisplayString)(e.emptyText),1)])):(0,m.createCommentVNode)('v-if',!0)],2),(0,m.createCommentVNode)(' åˆ†é¡µå™¨ (è¯»å–å…¨å±€é…ç½®) '),(0,m.renderSlot)(t.$slots,'pagination',{},()=>[D.value&&N.value>1?((0,m.openBlock)(),(0,m.createElementBlock)('div',hr,[(0,m.createCommentVNode)(' ä¸Šä¸€é¡µ (å›ºå®šåœ¨æœ€å·¦) '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-page-btn acu-page-arrow',{disabled:1===d.value}]),title:'ä¸Šä¸€é¡µ',onClick:n[1]||(n[1]=e=>d.value>1&&O(d.value-1))},[...n[9]||(n[9]=[(0,m.createElementVNode)('i',{class:'fa-solid fa-chevron-left'},null,-1)])],2),(0,m.createCommentVNode)(' ä¸­é—´æ•°å­—åŒº (å±…ä¸­) '),(0,m.createElementVNode)('div',xr,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(A.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:e},['...'===e?((0,m.openBlock)(),(0,m.createElementBlock)('div',yr,'...')):((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:1,class:(0,m.normalizeClass)(['acu-page-btn',{active:e===d.value}]),onClick:t=>O(e)},(0,m.toDisplayString)(e),11,wr))],64))),128))]),(0,m.createCommentVNode)(' ä¸‹ä¸€é¡µ (å›ºå®šåœ¨æœ€å³) '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-page-btn acu-page-arrow',{disabled:d.value===N.value}]),title:'ä¸‹ä¸€é¡µ',onClick:n[2]||(n[2]=e=>d.value<N.value&&O(d.value+1))},[...n[10]||(n[10]=[(0,m.createElementVNode)('i',{class:'fa-solid fa-chevron-right'},null,-1)])],2)])):(0,m.createCommentVNode)('v-if',!0)])],2))}}),Cr={class:'acu-options-panel'},Nr={class:'acu-panel-header acu-options-header'},Vr={class:'acu-header-actions'},Er={class:'acu-options-count'},Br={class:'acu-panel-content acu-options-content'},Sr={key:0,class:'acu-empty-state'},Tr={class:'acu-options-list'},Dr={class:'acu-dash-title'},Ar={class:'acu-option-rows'},zr=['onClick'],Ir={class:'acu-embedded-option-tags'},_r={class:'acu-embedded-option-text'},Mr=(0,m.defineComponent)({__name:'OptionsPanel',props:{tables:{}},emits:['navigate','optionClick'],setup(e,{emit:t}){const a=e,o=t,{setInput:n}=ue(),r=(0,Pe.j_)(),l=(0,m.computed)(()=>a.tables.filter(e=>e.name.includes('é€‰é¡¹')));function i(e){const t=[],{isMatrix:a,optionColIndices:o}=function(e){const t=e.headers||[],a=[];return t.forEach((e,t)=>{e&&/(é€‰é¡¹|Option|åˆ†æ”¯)/i.test(String(e))&&a.push(t)}),{isMatrix:a.length>=2,optionColIndices:a}}(e),n=e.headers||[];return e.rows.forEach(e=>{const r=e.cells.map(e=>String(e.value||'').trim());if(a){const e=[];r.forEach((t,a)=>{!o.includes(a)&&t&&e.push(t)}),o.forEach(a=>{const o=r[a];if(o){const r=n[a]||'',l=[...e];r&&l.push(r),t.push({text:o,tags:l})}})}else{const e=r.filter(e=>''!==e);if(0===e.length)return;const a=e[e.length-1],o=e.slice(0,e.length-1);t.push({text:a,tags:o})}}),t}function c(e,t){const a=e.currentTarget;t?(a.style.background='var(--acu-table-hover)',a.style.borderColor='var(--acu-title-color)'):(a.style.background='rgba(255,255,255,0.05)',a.style.borderColor='var(--acu-border)')}function s(){r.setActiveTab(Pe.H6)}return(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Cr,[(0,m.createCommentVNode)(' é¢æ¿å¤´éƒ¨ '),(0,m.createElementVNode)('div',Nr,[t[5]||(t[5]=(0,m.createElementVNode)('div',{class:'acu-panel-title acu-options-title'},[(0,m.createElementVNode)('i',{class:'fa-solid fa-list-check'}),(0,m.createTextVNode)(' é€‰é¡¹èšåˆ ')],-1)),(0,m.createElementVNode)('div',Vr,[(0,m.createElementVNode)('span',Er,(0,m.toDisplayString)(l.value.length)+' ä¸ªé€‰é¡¹è¡¨',1),(0,m.createElementVNode)('button',{class:'acu-icon-btn acu-close-btn',title:'è¿”å›ä»ªè¡¨ç›˜',onClick:(0,m.withModifiers)(s,['stop'])},[...t[4]||(t[4]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])])]),(0,m.createCommentVNode)(' å†…å®¹æ»šåŠ¨åŒºåŸŸ '),(0,m.createElementVNode)('div',Br,[(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===l.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Sr,'æœªæ‰¾åˆ°åç§°åŒ…å«"é€‰é¡¹"çš„è¡¨æ ¼')):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' é€‰é¡¹è¡¨æ ¼åˆ—è¡¨ '),(0,m.createElementVNode)('div',Tr,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(l.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-dash-card'},[(0,m.createCommentVNode)(' è¡¨æ ¼æ ‡é¢˜ '),(0,m.createElementVNode)('div',Dr,(0,m.toDisplayString)(e.name),1),(0,m.createCommentVNode)(' é€‰é¡¹è¡Œåˆ—è¡¨ '),(0,m.createElementVNode)('div',Ar,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(i(e),(e,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:a,class:'acu-embedded-option-row',title:'ç‚¹å‡»è¿½åŠ ',onClick:t=>{return a=e.text,n(a),o('optionClick',a),void S.toast.success('å·²è¿½åŠ åˆ°è¾“å…¥æ¡†');var a},onMouseover:t[0]||(t[0]=e=>c(e,!0)),onMouseout:t[1]||(t[1]=e=>c(e,!1)),onMousedown:t[2]||(t[2]=e=>{e.currentTarget.style.transform='translateY(1px)'}),onMouseup:t[3]||(t[3]=e=>{e.currentTarget.style.transform='translateY(0)'})},[(0,m.createCommentVNode)(' æ ‡ç­¾åŒºåŸŸ '),(0,m.createElementVNode)('div',Ir,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.tags,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:t,class:'acu-badge acu-option-tag'},(0,m.toDisplayString)(e),1))),128))]),(0,m.createCommentVNode)(' é€‰é¡¹æ–‡æœ¬ '),(0,m.createElementVNode)('div',_r,(0,m.toDisplayString)(e.text),1)],40,zr))),128))])]))),128))])],2112))])]))}}),Ur=(0,m.defineComponent)({__name:'ContextMenu',props:{visible:{type:Boolean},x:{},y:{},tableId:{},tableName:{},rowIndex:{},cellValue:{}},emits:['update:visible','insertRow','delete','undoDelete','copied'],setup(e,{expose:t,emit:a}){const o=e,n=a,r=(0,m.ref)(),l=(0,w.D)(),{copy:i,copied:c}=(0,de.iDZ)(),s=(0,m.computed)(()=>{const e=`${o.tableName||o.tableId}-row-${o.rowIndex}`;return l.pendingDeletes.has(e)}),u=(0,m.computed)(()=>{const e=window.parent||window,t=e.innerWidth,a=e.innerHeight;let n=o.x,r=o.y;return n+180>t&&(n=t-180-10),r+200>a&&(r=a-200-10),n=Math.max(10,n),r=Math.max(10,r),{left:`${n}px`,top:`${r}px`}});let d=null,p=null;(0,m.onMounted)(()=>{const e=window.parent?.document||document;d=e=>{if(!o.visible||!r.value)return;const t=e.target;r.value.contains(t)||(console.info('[ACU] ç‚¹å‡»å¤–éƒ¨å…³é—­å³é”®èœå•'),f())},p=e=>{if(!o.visible||!r.value)return;const t=e.target;r.value.contains(t)||(console.info('[ACU] å³é”®ç‚¹å‡»å¤–éƒ¨å…³é—­å³é”®èœå•'),f())},e.addEventListener('click',d,!0),e.addEventListener('contextmenu',p,!0),e.addEventListener('touchstart',d,!0)}),(0,m.onUnmounted)(()=>{const e=window.parent?.document||document;d&&(e.removeEventListener('click',d,!0),e.removeEventListener('touchstart',d,!0),d=null),p&&(e.removeEventListener('contextmenu',p,!0),p=null)}),(0,m.watch)(()=>o.visible,e=>{e&&(0,m.nextTick)(()=>{r.value?.focus()})});const f=()=>{n('update:visible',!1)},g=()=>{n('insertRow',o.tableId,o.rowIndex),f()},v=async()=>{if(o.cellValue)try{await i(o.cellValue),n('copied')}catch(e){console.error('[ACU] Copy failed:',e)}f()},b=()=>{n('delete',o.tableId,o.rowIndex),f()},h=()=>{n('undoDelete',o.tableId,o.rowIndex),f()};return t({close:f,copied:c}),(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'acu-menu-fade'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,ref_key:'menuRef',ref:r,class:'acu-context-menu',style:(0,m.normalizeStyle)(u.value),tabindex:'-1',onKeydown:(0,m.withKeys)(f,['escape']),onClick:a[0]||(a[0]=(0,m.withModifiers)(()=>{},['stop'])),onMousedown:a[1]||(a[1]=(0,m.withModifiers)(()=>{},['stop'])),onTouchstart:a[2]||(a[2]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createCommentVNode)(' æ’å…¥è¡Œ '),(0,m.createElementVNode)('div',{class:'acu-menu-item',onClick:(0,m.withModifiers)(g,['stop'])},[...a[3]||(a[3]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1),(0,m.createElementVNode)('span',null,'æ’å…¥è¡Œ',-1)])]),(0,m.createCommentVNode)(' å¤åˆ¶å†…å®¹ '),(0,m.createElementVNode)('div',{class:'acu-menu-item',onClick:(0,m.withModifiers)(v,['stop'])},[...a[4]||(a[4]=[(0,m.createElementVNode)('i',{class:'fas fa-copy'},null,-1),(0,m.createElementVNode)('span',null,'å¤åˆ¶å†…å®¹',-1)])]),(0,m.createCommentVNode)(' åˆ†éš”çº¿ '),a[7]||(a[7]=(0,m.createElementVNode)('div',{class:'acu-menu-divider'},null,-1)),(0,m.createCommentVNode)(' åˆ é™¤è¡Œï¼ˆæœªæ ‡è®°åˆ é™¤æ—¶æ˜¾ç¤ºï¼‰ '),s.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ’¤é”€åˆ é™¤ï¼ˆå·²æ ‡è®°åˆ é™¤æ—¶æ˜¾ç¤ºï¼‰ '),(0,m.createElementVNode)('div',{class:'acu-menu-item acu-menu-warning',onClick:(0,m.withModifiers)(h,['stop'])},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createElementVNode)('span',null,'æ’¤é”€åˆ é™¤',-1)])])],2112)):((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-menu-item acu-menu-danger',onClick:(0,m.withModifiers)(b,['stop'])},[...a[5]||(a[5]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1),(0,m.createElementVNode)('span',null,'åˆ é™¤æ•´è¡Œ',-1)])]))],36)):(0,m.createCommentVNode)('v-if',!0)]),_:1}))}}),$r={class:'acu-pagination'},Lr={class:'acu-pagination-info'},Pr={class:'acu-pagination-current'},Fr={key:0,class:'acu-pagination-total'},jr={class:'acu-pagination-controls'},Or=['disabled'],Rr=['disabled'],Hr={class:'acu-page-list'},Wr={key:0,class:'acu-page-ellipsis'},Gr=['onClick'],Yr=['disabled'],Xr=['disabled'],qr={key:0,class:'acu-pagination-jump'},Kr=['max'];Boolean,Boolean;d(7499);const Jr={class:'acu-modal-body'},Qr={class:'acu-settings-section'},Zr={class:'acu-settings-group'},el={class:'acu-purge-range-row'},tl={class:'acu-settings-section'},al={class:'acu-modal-footer'},ol=['disabled'],nl={key:0,class:'fas fa-spinner fa-spin'},rl={key:1,class:'fas fa-trash-alt'},ll=(0,m.defineComponent)({__name:'AdvancedPurgeDialog',props:{visible:{type:Boolean},initialStartFloor:{default:void 0},initialEndFloor:{default:void 0},initialSelectedTables:{default:()=>[]}},emits:['update:visible','confirm'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(),r=(0,m.ref)(),l=(0,m.ref)(),i=(0,m.ref)(null),c=(0,m.ref)(null),s=(0,m.ref)([]),u=(0,m.ref)([]),d=(0,m.ref)(!1),{purgeTableDataByRange:p}=te(),f=(0,m.computed)(()=>u.value.map(e=>({key:e.key,label:e.name}))),g=(0,m.computed)(()=>null!==i.value&&null!==c.value&&(!isNaN(i.value)&&!isNaN(c.value)&&(!(i.value<0||c.value<0)&&(!(i.value>c.value)&&0!==s.value.length))));function b(){i.value=0,c.value=9999999}function h(){l.value?.focus()}function x(){o('update:visible',!1)}async function y(){if(g.value&&!d.value){d.value=!0;try{const e=await p(s.value,i.value,c.value);if(e.changed){const t=s.value.map(e=>u.value.find(t=>t.key===e)?.name||e).join(', ');S.toast.success(`å·²æ¸…é™¤ ${e.changedCount} å±‚æ•°æ® (${t})`),o('confirm',{changedCount:e.changedCount,tables:s.value}),x()}else S.toast.info('æœªæ‰¾åˆ°éœ€è¦æ¸…é™¤çš„æ•°æ®')}catch(e){console.error('[ACU] é«˜çº§æ¸…é™¤å¤±è´¥:',e),S.toast.error('æ¸…é™¤å¤±è´¥: '+(e instanceof Error?e.message:String(e)))}finally{d.value=!1}}}return(0,m.watch)(()=>a.visible,e=>{if(e){if(void 0!==a.initialStartFloor&&void 0!==a.initialEndFloor)i.value=a.initialStartFloor,c.value=a.initialEndFloor;else{const e=function(){let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern);let t=-1,a=0;if(e&&e.chat){a=Math.max(0,e.chat.length-1);for(let a=e.chat.length-1;a>=0;a--){const o=e.chat[a];if(!o.is_user&&o.TavernDB_ACU_IsolatedData){const e=Object.keys(o.TavernDB_ACU_IsolatedData);let n=!1;for(const t of e){const e=o.TavernDB_ACU_IsolatedData[t];if(e&&e.independentData&&Object.keys(e.independentData).length>0){n=!0;break}}if(n){t=a;break}}}}return{start:-1!==t?t:a,end:-1!==t?t:a}}();i.value=e.start,c.value=e.end}a.initialSelectedTables&&a.initialSelectedTables.length>0?s.value=[...a.initialSelectedTables]:s.value=[],d.value=!1,function(){try{const e=(0,v.tu)();if(!e)return void(u.value=[]);const t=[];Object.keys(e).forEach(a=>{if(!a.startsWith('sheet_'))return;const o=e[a];o&&'object'==typeof o&&o.name&&t.push({key:a,name:o.name})}),u.value=t}catch(e){console.warn('[ACU] åŠ è½½è¡¨æ ¼åˆ—è¡¨å¤±è´¥:',e),u.value=[]}}()}}),(0,de.X2F)(n,()=>{d.value||x()}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(x,['self'])},[(0,m.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-advanced-purge-modal'},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',{class:'acu-modal-header'},[(0,m.createElementVNode)('button',{class:'acu-modal-back',onClick:x},[...a[3]||(a[3]=[(0,m.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])]),a[4]||(a[4]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'é«˜çº§æ¸…é™¤',-1)),a[5]||(a[5]=(0,m.createElementVNode)('span',null,null,-1))]),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',Jr,[(0,m.createCommentVNode)(' æ¥¼å±‚èŒƒå›´è®¾ç½® '),(0,m.createElementVNode)('div',Qr,[a[8]||(a[8]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-layer-group'}),(0,m.createTextVNode)(' æ¥¼å±‚èŒƒå›´ ')],-1)),(0,m.createElementVNode)('div',Zr,[(0,m.createElementVNode)('div',el,[(0,m.withDirectives)((0,m.createElementVNode)('input',{ref_key:'startInputRef',ref:r,'onUpdate:modelValue':a[0]||(a[0]=e=>i.value=e),type:'number',class:'acu-purge-input',placeholder:'èµ·å§‹',min:'0',onKeydown:(0,m.withKeys)(h,['enter'])},null,544),[[m.vModelText,i.value,void 0,{number:!0}]]),a[6]||(a[6]=(0,m.createElementVNode)('span',{class:'acu-purge-separator'},'â€”',-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{ref_key:'endInputRef',ref:l,'onUpdate:modelValue':a[1]||(a[1]=e=>c.value=e),type:'number',class:'acu-purge-input',placeholder:'ç»“æŸ',min:'0'},null,512),[[m.vModelText,c.value,void 0,{number:!0}]])]),a[7]||(a[7]=(0,m.createElementVNode)('div',{class:'acu-purge-range-hint'},[(0,m.createElementVNode)('i',{class:'fas fa-info-circle'}),(0,m.createTextVNode)(' è¾“å…¥ Chat ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰ ')],-1)),(0,m.createElementVNode)('div',{class:'acu-purge-quick-actions'},[(0,m.createElementVNode)('button',{class:'acu-tool-btn small',onClick:b},'æ‰€æœ‰æ¥¼å±‚')])])]),(0,m.createCommentVNode)(' è¡¨æ ¼é€‰æ‹© '),(0,m.createElementVNode)('div',tl,[a[9]||(a[9]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-table'}),(0,m.createTextVNode)(' é€‰æ‹©è¦æ¸…é™¤çš„è¡¨æ ¼ ')],-1)),(0,m.createVNode)(za,{modelValue:s.value,'onUpdate:modelValue':a[2]||(a[2]=e=>s.value=e),items:f.value,'empty-text':'æš‚æ— å¯ç”¨è¡¨æ ¼','footer-template':'å·²é€‰æ‹©: {selected}/{total} ä¸ªè¡¨æ ¼'},null,8,['modelValue','items'])]),(0,m.createCommentVNode)(' è­¦å‘Šæç¤º '),a[10]||(a[10]=(0,m.createElementVNode)('div',{class:'acu-purge-warning'},[(0,m.createElementVNode)('i',{class:'fas fa-exclamation-triangle'}),(0,m.createElementVNode)('span',null,'æ­¤æ“ä½œå°†ä»æŒ‡å®šæ¥¼å±‚èŒƒå›´å†…åˆ é™¤é€‰ä¸­è¡¨æ ¼çš„æ•°æ®ï¼Œæ“ä½œä¸å¯æ’¤é”€ï¼')],-1))]),(0,m.createCommentVNode)(' åº•éƒ¨æŒ‰é’® '),(0,m.createElementVNode)('div',al,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:x},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-modal-btn danger',disabled:!g.value||d.value,onClick:y},[d.value?((0,m.openBlock)(),(0,m.createElementBlock)('i',nl)):((0,m.openBlock)(),(0,m.createElementBlock)('i',rl)),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(d.value?'æ‰§è¡Œä¸­...':'ç¡®è®¤æ¸…é™¤'),1)],8,ol)])],512)])):(0,m.createCommentVNode)('v-if',!0)}}),il={class:'acu-modal',style:{'max-width':'400px'}},cl={class:'acu-modal-header'},sl={class:'acu-modal-body'},ul={class:'acu-settings-row column'},dl={class:'acu-settings-control',style:{display:'flex',gap:'8px','align-items':'center'}},pl=['value'],ml=['value'],fl={class:'acu-settings-row column'},gl={class:'acu-settings-control',style:{display:'flex',gap:'8px','align-items':'center'}},vl=['value'],bl=['value'],hl=(0,m.defineComponent)({__name:'DirectorDialog',props:{visible:{type:Boolean}},emits:['update:visible','close'],setup(e,{emit:t}){(0,k.j_)();const a=e,o=t,n=(0,m.ref)([]),r=(0,m.ref)([]),l=(0,m.ref)(''),i=(0,m.ref)(''),c=()=>{o('update:visible',!1),o('close')},s=async(e=0)=>{console.log('[DirectorDialog] loadData called, attempt:',e+1);const t=window.AutoCardUpdaterAPI||window.parent.AutoCardUpdaterAPI;if(!t)return console.warn('[DirectorDialog] AutoCardUpdaterAPI not found.'),void(e<5?setTimeout(()=>s(e+1),200):S.toast.error('API åˆå§‹åŒ–å¤±è´¥ï¼Œæ— æ³•åŠ è½½æ•°æ®ã€‚'));try{const e=t.getTemplatePresetNames()||[];n.value=e,console.log('[DirectorDialog] Templates loaded:',e)}catch(e){console.error('[DirectorDialog] Failed to load template presets:',e)}try{const e=t.getPlotPresetNames()||[];r.value=e;const a=t.getCurrentPlotPreset()||'';i.value=a,console.log('[DirectorDialog] Plots loaded:',e,'Current:',a)}catch(e){console.error('[DirectorDialog] Failed to load plot presets:',e)}};(0,m.watch)(()=>a.visible,e=>{e&&s()});const u=async e=>{const t=e.target,a=t.value,o=window.AutoCardUpdaterAPI||window.parent.AutoCardUpdaterAPI;if(a&&o)try{const e=await o.switchTemplatePreset(a);e.success?(l.value=a,S.toast.success(e.message)):(S.toast.error(e.message),t.value=l.value)}catch(e){S.toast.error('åˆ‡æ¢æ¨¡æ¿å¤±è´¥: '+e.message)}},d=e=>{const t=e.target,a=t.value,o=window.AutoCardUpdaterAPI||window.parent.AutoCardUpdaterAPI;if(a&&o)try{o.switchPlotPreset(a)?(i.value=a,S.toast.success(`å·²åˆ‡æ¢å‰§æƒ…é£æ ¼: ${a}`)):(S.toast.error('åˆ‡æ¢å‰§æƒ…é£æ ¼å¤±è´¥'),t.value=i.value)}catch(e){S.toast.error('åˆ‡æ¢å‰§æƒ…é£æ ¼å¤±è´¥: '+e.message)}},p=async()=>{const e=prompt('è¯·ç²˜è´´è¡¨æ ¼æ¨¡æ¿é…ç½® (JSON):');if(!e||!e.trim())return;const t=window.AutoCardUpdaterAPI||window.parent.AutoCardUpdaterAPI;if(t)try{const a=await t.importTemplateFromData(e);a.success?(S.toast.success(a.message),s()):S.toast.error(a.message)}catch(e){S.toast.error('å¯¼å…¥å¤±è´¥: '+e.message)}},f=async()=>{const e=prompt('è¯·ç²˜è´´å‰§æƒ…æ¨è¿›é¢„è®¾ (JSON):');if(!e||!e.trim())return;const t=window.AutoCardUpdaterAPI||window.parent.AutoCardUpdaterAPI;if(t)try{const a=await t.importPlotPresetFromData(e,{switchTo:!0});a.success?(S.toast.success(a.message),s(),a.presetName&&(i.value=a.presetName)):S.toast.error(a.message)}catch(e){S.toast.error('å¯¼å…¥å¤±è´¥: '+e.message)}};return(0,m.onMounted)(()=>{a.visible&&s()}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(c,['self'])},[(0,m.createElementVNode)('div',il,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',cl,[a[0]||(a[0]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'å¯¼æ¼”æ§åˆ¶å°',-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(c,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',sl,[(0,m.createCommentVNode)(' è¡¨æ ¼æ¨¡æ¿è®¾ç½® '),(0,m.createElementVNode)('div',ul,[a[3]||(a[3]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è¡¨æ ¼æ¨¡æ¿ '),(0,m.createElementVNode)('span',{class:'hint'},'åˆ‡æ¢æ¸¸æˆæ•°æ®ç»“æ„')],-1)),(0,m.createElementVNode)('div',dl,[(0,m.createElementVNode)('select',{class:'acu-select',value:l.value,style:{flex:'1'},onChange:u},[a[1]||(a[1]=(0,m.createElementVNode)('option',{value:'',disabled:''},'é€‰æ‹©æ¨¡æ¿...',-1)),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(n.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e,value:e},(0,m.toDisplayString)(e),9,ml))),128))],40,pl),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'ç²˜è´´å¯¼å…¥æ¨¡æ¿é…ç½®',onClick:(0,m.withModifiers)(p,['stop'])},[...a[2]||(a[2]=[(0,m.createElementVNode)('i',{class:'fas fa-file-import'},null,-1)])])])]),(0,m.createCommentVNode)(' å‰§æƒ…æ¨è¿›è®¾ç½® '),(0,m.createElementVNode)('div',fl,[a[6]||(a[6]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å‰§æƒ…æ¨è¿› '),(0,m.createElementVNode)('span',{class:'hint'},'åˆ‡æ¢ AI å™äº‹é£æ ¼')],-1)),(0,m.createElementVNode)('div',gl,[(0,m.createElementVNode)('select',{class:'acu-select',value:i.value,style:{flex:'1'},onChange:d},[a[4]||(a[4]=(0,m.createElementVNode)('option',{value:'',disabled:''},'é€‰æ‹©é¢„è®¾...',-1)),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(r.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e,value:e},(0,m.toDisplayString)(e),9,bl))),128))],40,vl),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'ç²˜è´´å¯¼å…¥å‰§æƒ…é¢„è®¾',onClick:(0,m.withModifiers)(f,['stop'])},[...a[5]||(a[5]=[(0,m.createElementVNode)('i',{class:'fas fa-file-import'},null,-1)])])])])])])])):(0,m.createCommentVNode)('v-if',!0)}}),xl={class:'acu-modal-header'},yl={class:'acu-modal-title'},wl={class:'acu-history-layout acu-pc-layout'},kl={key:0,class:'acu-loading-state'},Cl={key:1,class:'acu-empty-hint'},Nl={key:2,class:'acu-history-list'},Vl=['open','onToggle'],El={class:'acu-history-summary'},Bl={class:'acu-history-title'},Sl={class:'acu-history-time'},Tl={class:'acu-history-card-wrapper'},Dl={class:'acu-current-card-label'},Al={key:0,class:'acu-changes-count'},zl={class:'acu-current-card'},Il={class:'acu-history-actions'},_l=['disabled'],Ml=['disabled'],Ul={class:'acu-config-hint'},$l={key:0},Ll={key:1},Pl={class:'acu-history-mobile-list'},Fl={key:0,class:'acu-loading-state'},jl={key:1,class:'acu-empty-hint'},Ol={key:2,class:'acu-history-list'},Rl=['open','onToggle'],Hl={class:'acu-history-summary'},Wl={class:'acu-history-title'},Gl={class:'acu-history-time'},Yl={class:'acu-history-card-wrapper'},Xl={class:'acu-mobile-actions'},ql={class:'acu-mobile-history-section'},Kl={class:'acu-history-scroll'},Jl={key:0,class:'acu-empty-hint'},Ql={key:1,class:'acu-history-list'},Zl=['open','onToggle'],ei={class:'acu-history-summary'},ti={class:'acu-history-title'},ai={class:'acu-history-time'},oi={class:'acu-history-card-wrapper'},ni={class:'acu-mobile-current-section'},ri={class:'acu-section-label'},li={key:0,class:'acu-changes-count'},ii={class:'acu-current-scroll'},ci={class:'acu-mobile-actions'},si=['disabled'],ui=['disabled'],di={key:0,class:'acu-preview-overlay'},pi=(0,m.defineComponent)({__name:'HistoryDialog',props:{visible:{type:Boolean,default:!1},tableName:{},tableId:{},rowIndex:{},currentRowData:{default:null},titleColIndex:{default:-1},headers:{default:()=>[]}},emits:['update:visible','close','apply'],setup(e,{emit:t}){const a=e,o=t,n=(0,f.JH)(),{getSnapshots:r,snapshotToTableRow:l,tableRowToCells:i,formatRelativeTime:c,getDiff:s,getCurrentChatId:u}=((0,w.D)(),(0,B.m)()),{isMobile:d}=fe(),p=(0,m.ref)([]),g=(0,m.ref)(!1),v=(0,m.ref)(!1),b=(0,m.ref)(new Map),h=(0,m.ref)([]),x=(0,m.ref)(null),y=(0,m.ref)(!1),k=(0,m.ref)(''),C=(0,m.ref)(-1),N=(0,m.computed)(()=>n.config.cardWidth||280),V=(0,m.computed)(()=>{if(a.titleColIndex>=0)return a.titleColIndex;if(a.tableName.includes('æ€»ç»“')||a.tableName.includes('å¤§çº²')){if(a.headers.length>0){const e=a.headers.findIndex(e=>e&&(e.includes('ç´¢å¼•')||e.includes('ç¼–å·')||e.includes('ä»£ç ')));if(e>0)return e}if(a.currentRowData){const e=a.currentRowData.cells.findIndex(e=>e.key&&(e.key.includes('ç´¢å¼•')||e.key.includes('ç¼–å·')||e.key.includes('ä»£ç ')));if(e>0)return e}}return 1}),E=(0,m.computed)(()=>{const e=function(e){if(!e)return'';const t=V.value;if(t>=0&&e.cells.length>t){const a=e.cells[t]?.value;return void 0!==a?String(a):''}return''}(a.currentRowData);return e?`${a.tableName} - ${e}`:a.tableName}),S=(0,m.computed)(()=>new Set(b.value.keys())),T=(0,m.computed)(()=>[...b.value.entries()].map(([e,t])=>`${e}:${t.substring(0,10)}`).join(',')),D=(0,m.computed)(()=>a.currentRowData?0===b.value.size?a.currentRowData:{index:a.currentRowData.index,key:a.currentRowData.key,cells:a.currentRowData.cells.map((e,t)=>b.value.has(t)?{...e,value:b.value.get(t)}:e)}:{index:0,key:'',cells:[]});function A(e){const t=V.value;return t>=0&&e.cells[t]?e.cells[t]:''}function I(e){return a.currentRowData?l(e,a.currentRowData):{index:0,key:'',cells:[]}}function M(e){const t=i(D.value);return s(e,t)}function U(e,t){t.target.open&&v.value&&(x.value=e)}function L(){v.value=!0,b.value=new Map,h.value=[],x.value=p.value.length>0?p.value[0]:null}function P(){v.value=!1,b.value=new Map,h.value=[],x.value=null}function F(e,t){if(!v.value)return;x.value=e,h.value.push(new Map(b.value));const a=e.cells[t];if(void 0!==a){const e=new Map(b.value);e.set(t,a),b.value=e}}function j(){if(!x.value)return;h.value.push(new Map(b.value));const e=new Map;for(const[t,a]of Object.entries(x.value.cells))e.set(Number(t),a);b.value=e}function O(){0!==h.value.length&&(b.value=new Map(h.value.pop()))}function R(){y.value=!0}function H(){y.value=!1}function W(){b.value.size>0&&o('apply',new Map(b.value)),o('update:visible',!1),o('close')}function G(){p.value=[],v.value=!1,b.value=new Map,h.value=[],x.value=null,y.value=!1}async function Y(){g.value=!0;try{console.info('[HistoryDialog] åŠ è½½å†å²å¿«ç…§, å‚æ•°:',{tableName:a.tableName,tableId:a.tableId,rowIndex:a.rowIndex}),p.value=await r(a.tableName,a.rowIndex),console.info('[HistoryDialog] åŠ è½½åˆ°å¿«ç…§æ•°é‡:',p.value.length),p.value.length>0&&console.info('[HistoryDialog] å¿«ç…§ç¤ºä¾‹:',p.value[0])}catch(e){console.error('[HistoryDialog] åŠ è½½å†å²å¿«ç…§å¤±è´¥:',e),p.value=[]}finally{g.value=!1}}return(0,m.watch)(()=>a.visible,e=>{e?(console.info('[HistoryDialog] visible å˜ä¸º trueï¼Œå¼€å§‹åŠ è½½æ•°æ®'),k.value=a.tableName,C.value=a.rowIndex,G(),Y()):G()},{immediate:!0}),(0,m.watch)(()=>[a.tableName,a.rowIndex],([e,t])=>{a.visible&&(e===k.value&&t===C.value||(console.info('[HistoryDialog] è¡Œå‚æ•°å˜åŒ–ï¼Œé‡æ–°åŠ è½½æ•°æ®'),k.value=e,C.value=t,G(),Y()))}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,m.withModifiers)(W,['self'])},[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-modal acu-history-modal',{'acu-mobile-edit-mode':v.value}])},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',xl,[(0,m.createCommentVNode)(' ç§»åŠ¨ç«¯æ‹–åŠ¨æŠŠæ‰‹ '),a[1]||(a[1]=(0,m.createElementVNode)('div',{class:'acu-drag-handle acu-mobile-only'},null,-1)),(0,m.createElementVNode)('span',yl,[a[0]||(a[0]=(0,m.createElementVNode)('i',{class:'fas fa-history'},null,-1)),(0,m.createTextVNode)(' å†å²è®°å½• - '+(0,m.toDisplayString)(E.value),1)]),(0,m.createCommentVNode)(' PCç«¯åœ¨å¤´éƒ¨æ˜¾ç¤ºå®ŒæˆæŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-close-pill acu-pc-only',onClick:W},'å®Œæˆ')]),(0,m.createCommentVNode)(' PC ç«¯å¸ƒå±€ï¼šå·¦å³åˆ†æ ï¼ˆä½¿ç”¨ CSS åª’ä½“æŸ¥è¯¢æ§åˆ¶æ˜¾ç¤ºï¼‰ '),(0,m.createElementVNode)('div',wl,[(0,m.createCommentVNode)(' å·¦ä¾§ï¼šå†å²è®°å½•åˆ—è¡¨ '),(0,m.createElementVNode)('div',{class:'acu-history-sidebar',style:(0,m.normalizeStyle)({width:`${N.value+64}px`})},[g.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',kl,[...a[2]||(a[2]=[(0,m.createElementVNode)('i',{class:'fas fa-spinner fa-spin'},null,-1),(0,m.createElementVNode)('span',null,'åŠ è½½å†å²è®°å½•...',-1)])])):0===p.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Cl,[...a[3]||(a[3]=[(0,m.createElementVNode)('i',{class:'fas fa-history'},null,-1),(0,m.createElementVNode)('span',null,'æš‚æ— å†å²è®°å½•',-1)])])):((0,m.openBlock)(),(0,m.createElementBlock)('div',Nl,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(p.value,(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('details',{key:t.id||t.timestamp,open:0===a,class:'acu-history-item',onToggle:e=>U(t,e)},[(0,m.createElementVNode)('summary',El,[(0,m.createElementVNode)('span',{class:(0,m.normalizeClass)(['acu-history-badge',t.source])},(0,m.toDisplayString)('manual'===t.source?'æ‰‹åŠ¨':'AI'),3),(0,m.createElementVNode)('span',Bl,' #'+(0,m.toDisplayString)(a+1)+' '+(0,m.toDisplayString)(A(t)),1),(0,m.createElementVNode)('span',Sl,(0,m.toDisplayString)((0,m.unref)(c)(t.timestamp)),1)]),(0,m.createElementVNode)('div',Tl,[(0,m.createVNode)(zt,{data:I(t),'table-name':e.tableName,'table-id':e.tableId,'view-mode':'list','show-header':!1,'show-index':!1,'show-history-button':!1,'title-col-index':V.value,'custom-highlights':v.value?M(t):void 0,'allow-edit':!1,onCellClick:(e,a)=>F(t,a)},null,8,['data','table-name','table-id','title-col-index','custom-highlights','onCellClick'])])],40,Vl))),128))]))],4),(0,m.createCommentVNode)(' å³ä¾§ï¼šå½“å‰å¡ç‰‡ + æ“ä½œåŒº '),(0,m.createElementVNode)('div',{class:'acu-history-main',style:(0,m.normalizeStyle)({width:`${N.value+64}px`})},[(0,m.createElementVNode)('div',Dl,[a[4]||(a[4]=(0,m.createElementVNode)('i',{class:'fas fa-file-alt'},null,-1)),a[5]||(a[5]=(0,m.createTextVNode)(' å½“å‰ç‰ˆæœ¬ ',-1)),b.value.size>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',Al,' (å·²ä¿®æ”¹ '+(0,m.toDisplayString)(b.value.size)+' å¤„) ',1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createElementVNode)('div',zl,[((0,m.openBlock)(),(0,m.createBlock)(zt,{key:`current-pc-${T.value}`,data:D.value,'table-name':e.tableName,'table-id':e.tableId,'view-mode':'list','show-header':!0,'show-index':!0,'show-history-button':!1,'title-col-index':V.value,'custom-highlights':S.value},null,8,['data','table-name','table-id','title-col-index','custom-highlights']))]),(0,m.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,m.createElementVNode)('div',Il,[v.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',disabled:!x.value,onClick:j},[...a[7]||(a[7]=[(0,m.createElementVNode)('i',{class:'fas fa-layer-group'},null,-1),(0,m.createTextVNode)(' æ•´å¡è¦†ç›– ',-1)])],8,_l),(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',disabled:0===h.value.length,onClick:O},[...a[8]||(a[8]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' æ’¤é”€ ',-1)])],8,Ml),(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:P},[...a[9]||(a[9]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1),(0,m.createTextVNode)(' é€€å‡ºç¼–è¾‘',-1)])])],64)):((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-modal-btn primary acu-btn-start-edit',onClick:L},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-edit'},null,-1),(0,m.createTextVNode)(' å¯åŠ¨ç¼–è¾‘ ',-1)])]))]),(0,m.createCommentVNode)(' æç¤ºä¿¡æ¯ '),(0,m.createElementVNode)('div',Ul,[a[10]||(a[10]=(0,m.createElementVNode)('i',{class:'fas fa-info-circle'},null,-1)),v.value?((0,m.openBlock)(),(0,m.createElementBlock)('span',Ll,'ç‚¹å‡»å·¦ä¾§å†å²å¡ç‰‡çš„å•å…ƒæ ¼è¿›è¡Œè¦†ç›–')):((0,m.openBlock)(),(0,m.createElementBlock)('span',$l,'ç‚¹å‡»"å¯åŠ¨ç¼–è¾‘"å¼€å§‹ä¿®æ”¹'))])],4)]),(0,m.createCommentVNode)(' ç§»åŠ¨ç«¯å¸ƒå±€ï¼šå…¨å±åˆ†åŒºï¼ˆä½¿ç”¨ CSS åª’ä½“æŸ¥è¯¢æ§åˆ¶æ˜¾ç¤ºï¼‰ '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-history-layout acu-mobile-layout',{'acu-mobile-edit-mode':v.value}])},[(0,m.createCommentVNode)(' éç¼–è¾‘æ¨¡å¼ï¼šåªæ˜¾ç¤ºå†å²åˆ—è¡¨ '),v.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' ç¼–è¾‘æ¨¡å¼ï¼šä¸Šä¸‹åˆ†å± '),(0,m.createCommentVNode)(' ä¸ŠåŠéƒ¨åˆ†ï¼šå†å²è®°å½•æ»šåŠ¨åŒº '),(0,m.createElementVNode)('div',ql,[a[17]||(a[17]=(0,m.createElementVNode)('div',{class:'acu-section-label'},[(0,m.createElementVNode)('i',{class:'fas fa-history'}),(0,m.createTextVNode)(' å†å²è®°å½•ï¼ˆç‚¹å‡»å•å…ƒæ ¼è¦†ç›–ï¼‰')],-1)),(0,m.createElementVNode)('div',Kl,[0===p.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Jl,[...a[16]||(a[16]=[(0,m.createElementVNode)('i',{class:'fas fa-history'},null,-1),(0,m.createElementVNode)('span',null,'æš‚æ— å†å²è®°å½•',-1)])])):((0,m.openBlock)(),(0,m.createElementBlock)('div',Ql,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(p.value,(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('details',{key:t.id||t.timestamp,open:0===a,class:'acu-history-item',onToggle:e=>U(t,e)},[(0,m.createElementVNode)('summary',ei,[(0,m.createElementVNode)('span',{class:(0,m.normalizeClass)(['acu-history-badge',t.source])},(0,m.toDisplayString)('manual'===t.source?'æ‰‹åŠ¨':'AI'),3),(0,m.createElementVNode)('span',ti,' #'+(0,m.toDisplayString)(a+1)+' '+(0,m.toDisplayString)(A(t)),1),(0,m.createElementVNode)('span',ai,(0,m.toDisplayString)((0,m.unref)(c)(t.timestamp)),1)]),(0,m.createElementVNode)('div',oi,[(0,m.createVNode)(zt,{data:I(t),'table-name':e.tableName,'table-id':e.tableId,'view-mode':'list','show-header':!1,'show-index':!1,'show-history-button':!1,'title-col-index':V.value,'custom-highlights':M(t),'allow-edit':!1,onCellClick:(e,a)=>F(t,a)},null,8,['data','table-name','table-id','title-col-index','custom-highlights','onCellClick'])])],40,Zl))),128))]))])]),(0,m.createCommentVNode)(' ä¸‹åŠéƒ¨åˆ†ï¼šå½“å‰ç‰ˆæœ¬æ»šåŠ¨åŒº '),(0,m.createElementVNode)('div',ni,[(0,m.createElementVNode)('div',ri,[a[18]||(a[18]=(0,m.createElementVNode)('i',{class:'fas fa-file-alt'},null,-1)),a[19]||(a[19]=(0,m.createTextVNode)(' å½“å‰ç‰ˆæœ¬ ',-1)),b.value.size>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',li,'(å·²ä¿®æ”¹ '+(0,m.toDisplayString)(b.value.size)+' å¤„)',1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createElementVNode)('div',ii,[((0,m.openBlock)(),(0,m.createBlock)(zt,{key:`current-mobile-${T.value}`,data:D.value,'table-name':e.tableName,'table-id':e.tableId,'view-mode':'list','show-header':!0,'show-index':!0,'show-history-button':!1,'title-col-index':V.value,'custom-highlights':S.value},null,8,['data','table-name','table-id','title-col-index','custom-highlights']))])]),(0,m.createCommentVNode)(' ç¼–è¾‘æ¨¡å¼åº•éƒ¨æŒ‰é’® '),(0,m.createElementVNode)('div',ci,[(0,m.createElementVNode)('button',{disabled:0===h.value.length,onClick:O},[...a[20]||(a[20]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' æ’¤é”€',-1)])],8,si),(0,m.createElementVNode)('button',{class:'acu-btn-primary',disabled:!x.value,onClick:j},[...a[21]||(a[21]=[(0,m.createElementVNode)('i',{class:'fas fa-layer-group'},null,-1),(0,m.createTextVNode)(' æ•´å¡è¦†ç›– ',-1)])],8,ui),(0,m.createElementVNode)('button',{onClick:P},[...a[22]||(a[22]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1),(0,m.createTextVNode)(' é€€å‡ºç¼–è¾‘',-1)])]),(0,m.createElementVNode)('button',{class:'acu-btn-done',onClick:W},[...a[23]||(a[23]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1),(0,m.createTextVNode)(' å®Œæˆ',-1)])])])],64)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createElementVNode)('div',Pl,[g.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Fl,[...a[11]||(a[11]=[(0,m.createElementVNode)('i',{class:'fas fa-spinner fa-spin'},null,-1),(0,m.createElementVNode)('span',null,'åŠ è½½å†å²è®°å½•...',-1)])])):0===p.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',jl,[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-history'},null,-1),(0,m.createElementVNode)('span',null,'æš‚æ— å†å²è®°å½•',-1)])])):((0,m.openBlock)(),(0,m.createElementBlock)('div',Ol,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(p.value,(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('details',{key:t.id||t.timestamp,open:0===a,class:'acu-history-item',onToggle:e=>U(t,e)},[(0,m.createElementVNode)('summary',Hl,[(0,m.createElementVNode)('span',{class:(0,m.normalizeClass)(['acu-history-badge',t.source])},(0,m.toDisplayString)('manual'===t.source?'æ‰‹åŠ¨':'AI'),3),(0,m.createElementVNode)('span',Wl,' #'+(0,m.toDisplayString)(a+1)+' '+(0,m.toDisplayString)(A(t)),1),(0,m.createElementVNode)('span',Gl,(0,m.toDisplayString)((0,m.unref)(c)(t.timestamp)),1)]),(0,m.createElementVNode)('div',Yl,[(0,m.createVNode)(zt,{data:I(t),'table-name':e.tableName,'table-id':e.tableId,'view-mode':'list','show-header':!1,'show-index':!1,'show-history-button':!1,'title-col-index':V.value,'allow-edit':!1},null,8,['data','table-name','table-id','title-col-index'])])],40,Rl))),128))]))]),(0,m.createCommentVNode)(' éç¼–è¾‘æ¨¡å¼åº•éƒ¨æŒ‰é’® '),(0,m.createElementVNode)('div',Xl,[(0,m.createElementVNode)('button',{class:'acu-btn-preview',onTouchstart:(0,m.withModifiers)(R,['prevent']),onTouchend:(0,m.withModifiers)(H,['prevent']),onMousedown:R,onMouseup:H,onMouseleave:H},[...a[13]||(a[13]=[(0,m.createElementVNode)('i',{class:'fas fa-eye'},null,-1),(0,m.createTextVNode)(' é¢„è§ˆæœ€æ–° ',-1)])],32),(0,m.createElementVNode)('button',{class:'acu-btn-primary',onClick:L},[...a[14]||(a[14]=[(0,m.createElementVNode)('i',{class:'fas fa-edit'},null,-1),(0,m.createTextVNode)(' å¯åŠ¨ç¼–è¾‘',-1)])]),(0,m.createElementVNode)('button',{class:'acu-btn-done',onClick:W},[...a[15]||(a[15]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1),(0,m.createTextVNode)(' å®Œæˆ',-1)])])])],64)),(0,m.createCommentVNode)(' é¢„è§ˆæ‚¬æµ®å±‚ '),(0,m.createVNode)(m.Transition,{name:'preview-fade'},{default:(0,m.withCtx)(()=>[y.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',di,[(0,m.createVNode)(zt,{data:D.value,'table-name':e.tableName,'table-id':e.tableId,'view-mode':'list','show-header':!0,'show-index':!0,'show-history-button':!1,'title-col-index':V.value},null,8,['data','table-name','table-id','title-col-index'])])):(0,m.createCommentVNode)('v-if',!0)]),_:1})],2)],2)])):(0,m.createCommentVNode)('v-if',!0)}}),mi=pi,fi=['ğŸ“¦','ğŸ·ï¸','ğŸ“','ğŸ“‚','ğŸ“„','ğŸ“','ğŸ“Œ','ğŸ“','ğŸ“','ğŸ”’','ğŸ”“','ğŸ”‘','âš™ï¸','ğŸ”§','ğŸ”¨','ğŸ› ï¸','âš–ï¸','ğŸ›’','ğŸ’°','ğŸ’','â¤ï¸','ğŸ§¡','ğŸ’›','ğŸ’š','ğŸ’™','ğŸ’œ','ğŸ–¤','ğŸ¤','ğŸ¤','ğŸ’”','â­','ğŸŒŸ','âœ¨','âš¡','ğŸ”¥','ğŸ’§','â„ï¸','ğŸŒˆ','â˜€ï¸','ğŸŒ™','ğŸ˜€','ğŸ˜ƒ','ğŸ˜„','ğŸ˜','ğŸ˜†','ğŸ˜…','ğŸ˜‚','ğŸ¤£','ğŸ˜Š','ğŸ˜‡','ğŸ™‚','ğŸ™ƒ','ğŸ˜‰','ğŸ˜Œ','ğŸ˜','ğŸ¥°','ğŸ˜˜','ğŸ˜—','ğŸ˜™','ğŸ˜š','ğŸ˜‹','ğŸ˜›','ğŸ˜','ğŸ˜œ','ğŸ¤ª','ğŸ¤¨','ğŸ§','ğŸ¤“','ğŸ˜','ğŸ¤©','ğŸ¥³','ğŸ˜','ğŸ˜’','ğŸ˜','ğŸ˜”','ğŸ˜Ÿ','ğŸ˜•','ğŸ™','â˜¹ï¸','ğŸ˜£','ğŸ˜–','ğŸ˜«','ğŸ˜©','ğŸ¥º','ğŸ˜¢','ğŸ˜­','ğŸ˜¤','ğŸ˜ ','ğŸ˜¡','ğŸ¤¬','ğŸ¤¯','ğŸ˜³','ğŸ¥µ','ğŸ¥¶','ğŸ˜±','ğŸ˜¨','ğŸ˜°','ğŸ˜¥','ğŸ˜“','ğŸ¤—','ğŸ¤”','ğŸ¤­','ğŸ¤«','ğŸ¤¥','ğŸ˜¶','ğŸ˜','ğŸ˜‘','ğŸ˜¬','ğŸ™„','ğŸ˜¯','ğŸ˜¦','ğŸ˜§','ğŸ˜®','ğŸ˜²','ğŸ¥±','ğŸ˜´','ğŸ¤¤','ğŸ˜ª','ğŸ˜µ','ğŸ¤','ğŸ¥´','ğŸ¤¢','ğŸ¤®','ğŸ¤§','ğŸ˜·','ğŸ¤’','ğŸ¤•','ğŸ¤‘','ğŸ¤ ','ğŸ˜ˆ','ğŸ‘¿','ğŸ‘¹','ğŸ‘º','ğŸ¤¡','ğŸ’©','ğŸ‘»','ğŸ’€','â˜ ï¸','ğŸ‘½','ğŸ‘¾','ğŸ¤–','ğŸƒ','ğŸ˜º','ğŸ˜¸','ğŸ˜¹','ğŸ˜»','ğŸ˜¼','ğŸ˜½','ğŸ™€','ğŸ˜¿','ğŸ˜¾','ğŸ‘‹','ğŸ¤š','ğŸ–ï¸','âœ‹','ğŸ––','ğŸ‘Œ','ğŸ¤','âœŒï¸','ğŸ¤','ğŸ¤Ÿ','ğŸ¤˜','ğŸ¤™','ğŸ‘ˆ','ğŸ‘‰','ğŸ‘†','ğŸ–•','ğŸ‘‡','â˜ï¸','ğŸ‘','ğŸ‘','âœŠ','ğŸ‘Š','ğŸ¤›','ğŸ¤œ','ğŸ‘','ğŸ™Œ','ğŸ‘','ğŸ¤²','ğŸ¤','ğŸ™','âœï¸','ğŸ’…','ğŸ¤³','ğŸ’ª','ğŸ¦¾','ğŸ¦¿','ğŸ¦µ','ğŸ¦¶','ğŸ‘‚','ğŸ¦»','ğŸ‘ƒ','ğŸ§ ','ğŸ¦·','ğŸ¦´','ğŸ‘€','ğŸ‘ï¸','ğŸ‘…','ğŸ‘„','ğŸ’‹','ğŸ‘¶','ğŸ§’','ğŸ‘¦','ğŸ‘§','ğŸ§‘','ğŸ‘±','ğŸ‘¨','ğŸ§”','ğŸ‘¨â€ğŸ¦°','ğŸ‘¨â€ğŸ¦±','ğŸ‘¨â€ğŸ¦³','ğŸ‘¨â€ğŸ¦²','ğŸ‘©','ğŸ‘©â€ğŸ¦°','ğŸ‘©â€ğŸ¦±','ğŸ‘©â€ğŸ¦³','ğŸ‘©â€ğŸ¦²','ğŸ‘±â€â™€ï¸','ğŸ‘±â€â™‚ï¸','ğŸ§“','ğŸ‘´','ğŸ‘µ','ğŸ™','ğŸ™â€â™‚ï¸','ğŸ™â€â™€ï¸','ğŸ™','ğŸ™â€â™‚ï¸','ğŸ™â€â™€ï¸','ğŸ™…','ğŸ™…â€â™‚ï¸','ğŸ™…â€â™€ï¸','ğŸ™†','ğŸ™†â€â™‚ï¸','ğŸ™†â€â™€ï¸','ğŸ’','ğŸ’â€â™‚ï¸','ğŸ’â€â™€ï¸','ğŸ™‹','ğŸ™‹â€â™‚ï¸','ğŸ™‹â€â™€ï¸','ğŸ™‡','ğŸ™‡â€â™‚ï¸','ğŸ™‡â€â™€ï¸','ğŸ¤¦','ğŸ¤¦â€â™‚ï¸','ğŸ¤¦â€â™€ï¸','ğŸ¤·','ğŸ¤·â€â™‚ï¸','ğŸ¤·â€â™€ï¸','ğŸ‘¨â€âš•ï¸','ğŸ‘©â€âš•ï¸','ğŸ‘¨â€ğŸ“','ğŸ‘©â€ğŸ“','ğŸ‘¨â€ğŸ«','ğŸ‘©â€ğŸ«','ğŸ‘¨â€âš–ï¸','ğŸ‘©â€âš–ï¸','ğŸ‘¨â€ğŸŒ¾','ğŸ‘©â€ğŸŒ¾','ğŸ‘¨â€ğŸ³','ğŸ‘©â€ğŸ³','ğŸ‘¨â€ğŸ”§','ğŸ‘©â€ğŸ”§','ğŸ‘¨â€ğŸ­','ğŸ‘©â€ğŸ­','ğŸ‘¨â€ğŸ’¼','ğŸ‘©â€ğŸ’¼','ğŸ‘¨â€ğŸ”¬','ğŸ‘©â€ğŸ”¬','ğŸ‘¨â€ğŸ’»','ğŸ‘©â€ğŸ’»','ğŸ‘¨â€ğŸ¤','ğŸ‘©â€ğŸ¤','ğŸ‘¨â€ğŸ¨','ğŸ‘©â€ğŸ¨','ğŸ‘¨â€âœˆï¸','ğŸ‘©â€âœˆï¸','ğŸ‘¨â€ğŸš€','ğŸ‘©â€ğŸš€','ğŸ‘¨â€ğŸš’','ğŸ‘©â€ğŸš’','ğŸ‘®','ğŸ‘®â€â™‚ï¸','ğŸ‘®â€â™€ï¸','ğŸ•µï¸','ğŸ•µï¸â€â™‚ï¸','ğŸ•µï¸â€â™€ï¸','ğŸ’‚','ğŸ’‚â€â™‚ï¸','ğŸ’‚â€â™€ï¸','ğŸ‘·','ğŸ‘·â€â™‚ï¸','ğŸ‘·â€â™€ï¸','ğŸ¤´','ğŸ‘¸','ğŸ‘³','ğŸ‘³â€â™‚ï¸','ğŸ‘³â€â™€ï¸','ğŸ‘²','ğŸ§•','ğŸ¤µ','ğŸ‘°','ğŸ¤°','ğŸ¤±','ğŸ‘¼','ğŸ…','ğŸ¤¶','ğŸ¦¸','ğŸ¦¸â€â™‚ï¸','ğŸ¦¸â€â™€ï¸','ğŸ¦¹','ğŸ¦¹â€â™‚ï¸','ğŸ¦¹â€â™€ï¸','ğŸ§™','ğŸ§™â€â™‚ï¸','ğŸ§™â€â™€ï¸','ğŸ§š','ğŸ§šâ€â™‚ï¸','ğŸ§šâ€â™€ï¸','ğŸ§›','ğŸ§›â€â™‚ï¸','ğŸ§›â€â™€ï¸','ğŸ§œ','ğŸ§œâ€â™‚ï¸','ğŸ§œâ€â™€ï¸','ğŸ§','ğŸ§â€â™‚ï¸','ğŸ§â€â™€ï¸','ğŸ§','ğŸ§â€â™‚ï¸','ğŸ§â€â™€ï¸','ğŸ§Ÿ','ğŸ§Ÿâ€â™‚ï¸','ğŸ§Ÿâ€â™€ï¸','ğŸ’†','ğŸ’†â€â™‚ï¸','ğŸ’†â€â™€ï¸','ğŸ’‡','ğŸ’‡â€â™‚ï¸','ğŸ’‡â€â™€ï¸','ğŸš¶','ğŸš¶â€â™‚ï¸','ğŸš¶â€â™€ï¸','ğŸƒ','ğŸƒâ€â™‚ï¸','ğŸƒâ€â™€ï¸','ğŸ’ƒ','ğŸ•º','ğŸ•´ï¸','ğŸ‘¯','ğŸ‘¯â€â™‚ï¸','ğŸ‘¯â€â™€ï¸','ğŸ§–','ğŸ§–â€â™‚ï¸','ğŸ§–â€â™€ï¸','ğŸ§˜','ğŸ§˜â€â™‚ï¸','ğŸ§˜â€â™€ï¸','âš”ï¸','ğŸ›¡ï¸','ğŸ¹','ğŸ”®','ğŸ§¿','ğŸ“¿','ğŸº','ğŸ“œ','ğŸ©¸','ğŸ’Š','ğŸ©¹','ğŸ¦ '],gi=['fas fa-star','far fa-star','fas fa-heart','far fa-heart','fas fa-user','far fa-user','fas fa-check','fas fa-times','fas fa-plus','fas fa-minus','fas fa-cog','fas fa-home','fas fa-search','fas fa-envelope','far fa-envelope','fas fa-bell','far fa-bell','fas fa-calendar','far fa-calendar','fas fa-clock','far fa-clock','fas fa-camera','fas fa-image','far fa-image','fas fa-video','fas fa-music','fas fa-microphone','fas fa-headphones','fas fa-book','fas fa-bookmark','far fa-bookmark','fas fa-folder','far fa-folder','fas fa-folder-open','far fa-folder-open','fas fa-file','far fa-file','fas fa-file-alt','far fa-file-alt','fas fa-download','fas fa-upload','fas fa-cloud','fas fa-comment','far fa-comment','fas fa-comments','far fa-comments','fas fa-quote-left','fas fa-quote-right','fas fa-pen','fas fa-edit','far fa-edit','fas fa-trash','far fa-trash-alt','fas fa-save','far fa-save','fas fa-share','fas fa-share-alt','fas fa-reply','fas fa-history','fas fa-list','fas fa-list-ul','fas fa-list-ol','fas fa-th','fas fa-th-list','fas fa-bars','fas fa-ellipsis-h','fas fa-ellipsis-v','fas fa-arrow-right','fas fa-arrow-left','fas fa-arrow-up','fas fa-arrow-down','fas fa-chevron-right','fas fa-chevron-left','fas fa-chevron-up','fas fa-chevron-down','fas fa-caret-right','fas fa-caret-left','fas fa-caret-up','fas fa-caret-down','fas fa-angle-right','fas fa-angle-left','fas fa-angle-up','fas fa-angle-down','fas fa-play','fas fa-pause','fas fa-stop','fas fa-forward','fas fa-backward','fas fa-fast-forward','fas fa-fast-backward','fas fa-step-forward','fas fa-step-backward','fas fa-info-circle','fas fa-question-circle','fas fa-exclamation-circle','fas fa-exclamation-triangle','fas fa-lock','fas fa-unlock','fas fa-key','fas fa-shield-alt','fas fa-bug','fas fa-code','fas fa-terminal','fas fa-database','fas fa-server','fas fa-network-wired','fas fa-wifi','fas fa-signal','fas fa-battery-full','fas fa-power-off','fas fa-desktop','fas fa-laptop','fas fa-mobile-alt','fas fa-tablet-alt','fas fa-gamepad','fas fa-keyboard','fas fa-mouse','fas fa-print','fas fa-cube','fas fa-cubes','fas fa-puzzle-piece','fas fa-lightbulb','far fa-lightbulb','fas fa-magic','fas fa-crown','fas fa-gem','far fa-gem','fas fa-gift','fas fa-trophy','fas fa-medal','fas fa-certificate','fas fa-map-marker-alt','fas fa-map','far fa-map','fas fa-location-arrow','fas fa-compass','far fa-compass','fas fa-globe','fas fa-globe-americas','fas fa-flag','far fa-flag','fas fa-plane','fas fa-car','fas fa-bus','fas fa-train','fas fa-bicycle','fas fa-walking','fas fa-running','fas fa-wheelchair','fas fa-shopping-cart','fas fa-shopping-bag','fas fa-credit-card','far fa-credit-card','fas fa-money-bill-wave','fas fa-tag','fas fa-tags','fas fa-ticket-alt','fas fa-users','fas fa-user-friends','fas fa-user-plus','fas fa-user-minus','fas fa-user-check','fas fa-user-times','fas fa-user-circle','far fa-user-circle','fas fa-id-card','far fa-id-card','fas fa-address-book','far fa-address-book','fas fa-address-card','far fa-address-card','fas fa-smile','far fa-smile','fas fa-frown','far fa-frown','fas fa-meh','far fa-meh','fas fa-hand-paper','far fa-hand-paper','fas fa-thumbs-up','far fa-thumbs-up','fas fa-thumbs-down','far fa-thumbs-down','fas fa-sun','far fa-sun','fas fa-moon','far fa-moon','fas fa-cloud-sun','fas fa-cloud-moon','fas fa-umbrella','fas fa-snowflake','far fa-snowflake','fas fa-fire','fas fa-water','fas fa-leaf','fas fa-seedling','fas fa-tree','fas fa-paw','fas fa-dog','fas fa-cat','fas fa-fish','fas fa-dragon','fas fa-feather','fas fa-feather-alt'],vi={class:'acu-modal acu-icon-select-modal'},bi={class:'acu-modal-header'},hi={class:'acu-header-actions'},xi={class:'acu-icon-tabs'},yi={class:'acu-icon-search-bar'},wi={class:'acu-search-input-wrapper'},ki={class:'acu-modal-body'},Ci={class:'acu-icon-grid-container'},Ni={key:0,class:'acu-icon-grid'},Vi=['title','onClick'],Ei={key:1},Bi={key:1,class:'acu-no-icons'},Si={class:'acu-icon-manual-input'},Ti={class:'acu-manual-field'},Di={class:'acu-preview-icon'},Ai={key:1},zi=(0,m.defineComponent)({__name:'IconSelectDialog',props:{visible:{type:Boolean},currentIcon:{default:''}},emits:['update:visible','select','close'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)('emoji'),r=(0,m.ref)(''),l=(0,m.ref)('');function i(e){return e.startsWith('fa')||e.includes(' fa-')}(0,m.watch)(()=>a.visible,e=>{e&&(l.value=a.currentIcon,r.value='',a.currentIcon&&i(a.currentIcon)?n.value='fa':n.value='emoji')});const c=(0,m.computed)(()=>{const e=r.value.toLowerCase().trim(),t='emoji'===n.value?fi:gi;return e?t.filter(t=>t.toLowerCase().includes(e)):t});function s(){o('update:visible',!1),o('close')}function u(e){o('select',e),s()}function d(){}function p(){const e=l.value.trim();e&&u(e)}return(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(s,['self'])},[(0,m.createElementVNode)('div',vi,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',bi,[a[4]||(a[4]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'é€‰æ‹©å›¾æ ‡',-1)),(0,m.createElementVNode)('div',hi,[(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(s,['stop'])},'å–æ¶ˆ')])]),(0,m.createCommentVNode)(' é¡¶éƒ¨ Tab æ  '),(0,m.createElementVNode)('div',xi,[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-icon-tab',{active:'emoji'===n.value}]),onClick:a[0]||(a[0]=e=>n.value='emoji')},' Emoji è¡¨æƒ… ',2),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-icon-tab',{active:'fa'===n.value}]),onClick:a[1]||(a[1]=e=>n.value='fa')},'FontAwesome',2)]),(0,m.createCommentVNode)(' æœç´¢æ  '),(0,m.createElementVNode)('div',yi,[(0,m.createElementVNode)('div',wi,[a[5]||(a[5]=(0,m.createElementVNode)('i',{class:'fas fa-search'},null,-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>r.value=e),type:'text',placeholder:'æœç´¢å›¾æ ‡...',onInput:d},null,544),[[m.vModelText,r.value]])])]),(0,m.createCommentVNode)(' å†…å®¹åŒºåŸŸ '),(0,m.createElementVNode)('div',ki,[(0,m.createElementVNode)('div',Ci,[c.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ni,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(c.value,t=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t,class:(0,m.normalizeClass)(['acu-icon-item',{selected:e.currentIcon===t}]),title:t,onClick:(0,m.withModifiers)(e=>u(t),['stop'])},['fa'===n.value?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(t)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Ei,(0,m.toDisplayString)(t),1))],10,Vi))),128))])):((0,m.openBlock)(),(0,m.createElementBlock)('div',Bi,[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-search'},null,-1),(0,m.createElementVNode)('span',null,'æœªæ‰¾åˆ°ç›¸å…³å›¾æ ‡',-1)])]))]),(0,m.createCommentVNode)(' åº•éƒ¨æ‰‹åŠ¨è¾“å…¥ '),(0,m.createElementVNode)('div',Si,[a[8]||(a[8]=(0,m.createElementVNode)('span',{class:'acu-manual-label'},'æ‰‹åŠ¨è¾“å…¥:',-1)),(0,m.createElementVNode)('div',Ti,[(0,m.createElementVNode)('div',Di,[i(l.value)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(l.value)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Ai,(0,m.toDisplayString)(l.value),1))]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>l.value=e),type:'text',placeholder:'è¾“å…¥ Emoji æˆ– fa-class',onKeyup:(0,m.withKeys)(p,['enter'])},null,544),[[m.vModelText,l.value]])]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',onClick:(0,m.withModifiers)(p,['stop'])},[...a[7]||(a[7]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1)])])])])])])):(0,m.createCommentVNode)('v-if',!0)}}),Ii={class:'acu-modal-body'},_i={class:'floor-input-group'},Mi={key:0,class:'floor-info'},Ui={key:1,class:'floor-error'},$i={class:'acu-modal-footer'},Li=['disabled'],Pi=(0,m.defineComponent)({__name:'InputFloorDialog',props:{visible:{type:Boolean},currentFloorInfo:{default:''},maxFloor:{default:999}},emits:['update:visible','confirm'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(),r=(0,m.ref)(),l=(0,m.ref)(null),i=(0,m.computed)(()=>{if(null===l.value||void 0===l.value)return!1;const e=l.value;return Number.isInteger(e)&&0!==e}),c=(0,m.computed)(()=>null===l.value||void 0===l.value?'':0===l.value?'æ¥¼å±‚ç´¢å¼•ä¸èƒ½ä¸º 0':Number.isInteger(l.value)?Math.abs(l.value)>a.maxFloor?`æ¥¼å±‚ç´¢å¼•è¶…å‡ºèŒƒå›´ (Â±${a.maxFloor})`:'':'è¯·è¾“å…¥æ•´æ•°');(0,m.watch)(()=>a.visible,e=>{e&&(l.value=null,(0,m.nextTick)(()=>{r.value?.focus()}))}),(0,de.X2F)(n,()=>{u()});const s=()=>{i.value&&null!==l.value&&(o('confirm',l.value),o('update:visible',!1))},u=()=>{o('update:visible',!1)};return(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(u,['self'])},[(0,m.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-input-floor-modal'},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',{class:'acu-modal-header'},[a[2]||(a[2]=(0,m.createElementVNode)('h3',null,[(0,m.createElementVNode)('i',{class:'fas fa-layer-group'}),(0,m.createTextVNode)(' æŒ‡å®šä¿å­˜æ¥¼å±‚ ')],-1)),(0,m.createElementVNode)('button',{class:'acu-modal-close',onClick:u},[...a[1]||(a[1]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Ii,[(0,m.createElementVNode)('div',_i,[a[5]||(a[5]=(0,m.createElementVNode)('p',{class:'floor-hint'},'è¾“å…¥ç›®æ ‡æ¥¼å±‚ç´¢å¼•ã€‚æ­£æ•°ä¸ºä»å¤´å¼€å§‹è®¡æ•°ï¼Œè´Ÿæ•°ä¸ºå€’æ•°è®¡æ•°ï¼ˆ-1 è¡¨ç¤ºæœ€åä¸€æ¥¼ï¼‰ã€‚',-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{ref_key:'inputRef',ref:r,'onUpdate:modelValue':a[0]||(a[0]=e=>l.value=e),type:'number',class:'floor-input',placeholder:'ä¾‹å¦‚: 5 æˆ– -1',onKeydown:[(0,m.withKeys)(s,['enter']),(0,m.withKeys)(u,['escape'])]},null,544),[[m.vModelText,l.value,void 0,{number:!0}]]),e.currentFloorInfo?((0,m.openBlock)(),(0,m.createElementBlock)('div',Mi,[a[3]||(a[3]=(0,m.createElementVNode)('i',{class:'fas fa-info-circle'},null,-1)),(0,m.createElementVNode)('span',null,'å½“å‰è‡ªåŠ¨ç›®æ ‡æ¥¼å±‚: '+(0,m.toDisplayString)(e.currentFloorInfo),1)])):(0,m.createCommentVNode)('v-if',!0),c.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ui,[a[4]||(a[4]=(0,m.createElementVNode)('i',{class:'fas fa-exclamation-circle'},null,-1)),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(c.value),1)])):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createCommentVNode)(' åº•éƒ¨ '),(0,m.createElementVNode)('div',$i,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:u},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',disabled:!i.value,onClick:s},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-save'},null,-1),(0,m.createTextVNode)(' ä¿å­˜åˆ°æ­¤æ¥¼å±‚ ',-1)])],8,Li)])],512)])):(0,m.createCommentVNode)('v-if',!0)}}),Fi={class:'acu-modal-body'},ji={key:0,class:'acu-loading-state'},Oi={class:'acu-update-layout'},Ri={class:'acu-update-left'},Hi={class:'acu-settings-section'},Wi={class:'acu-settings-row'},Gi={class:'acu-settings-control acu-preset-control'},Yi=['value'],Xi={class:'acu-settings-row'},qi={class:'acu-settings-control'},Ki=['value'],Ji={class:'acu-settings-section'},Qi={class:'acu-settings-row'},Zi={class:'acu-settings-control'},ec={class:'acu-settings-row'},tc={class:'acu-settings-control'},ac={class:'acu-settings-row'},oc={class:'acu-settings-control'},nc={class:'acu-settings-row'},rc={class:'acu-settings-control'},lc={class:'acu-settings-section acu-show-mobile-only'},ic={class:'acu-collapse-indicator'},cc={class:'acu-table-selector-mobile'},sc={class:'acu-settings-section'},uc={class:'acu-settings-row'},dc={class:'acu-settings-control'},pc={class:'acu-switch'},mc={key:0,class:'acu-settings-row'},fc={class:'acu-settings-control'},gc={class:'acu-switch'},vc={key:0,class:'acu-settings-section'},bc={class:'acu-update-right acu-hide-mobile'},hc={key:0,class:'acu-issue-alert'},xc={class:'acu-update-action-group'},yc=['disabled'],wc={key:0,class:'fas fa-spinner fa-spin'},kc={key:1,class:'fas fa-hand-sparkles'},Cc=(0,m.defineComponent)({__name:'ManualUpdateDialog',props:{visible:{type:Boolean}},emits:['update:visible'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(),r=(0,m.ref)(!0),l=(0,m.ref)(!1),i=(0,m.reactive)({autoUpdateThreshold:void 0,autoUpdateFrequency:void 0,updateBatchSize:void 0,skipUpdateFloors:void 0}),c=(0,m.ref)(''),s=(0,m.ref)(''),u=(0,k.j_)(),d=(0,m.ref)(!1),p=(0,m.ref)(!1),f=(0,m.ref)([]),g=(0,m.ref)([]),v=(0,m.ref)(!1),b=(0,m.ref)([]),h=(0,m.ref)([]),{settings:x,loadSettings:y,saveSettings:C,executeManualUpdate:N,getTableList:V,executeWithPreset:B}=E(),T=R(),D=(0,w.D)(),A=(0,m.computed)(()=>T.presets.value),I=(0,m.computed)(()=>D.hasIntegrityIssues),M=(0,m.computed)(()=>D.getIntegritySummary()),U=((0,m.computed)(()=>0!==f.value.length&&g.value.length===f.value.length),(0,m.computed)(()=>{const e=f.value.filter(e=>e.isSummaryOrOutline);return 0!==e.length&&(g.value.length===e.length&&e.every(e=>g.value.includes(e.name)))}),(0,m.computed)(()=>b.value.map(e=>({key:e,label:e})))),L=(0,m.computed)(()=>f.value.map(e=>({key:e.name,label:e.name,badge:e.isSummaryOrOutline?'â˜…':void 0})));(0,m.computed)(()=>0!==b.value.length&&h.value.length===b.value.length);function P(){o('update:visible',!1)}async function F(e,t){if(void 0!==t&&!isNaN(t))try{await C({[e]:t}),console.info(`[ACU] é…ç½®é¡¹ ${e} å·²æ›´æ–°ä¸º:`,t)}catch(t){console.error(`[ACU] ä¿å­˜é…ç½®é¡¹ ${e} å¤±è´¥:`,t),S.toast.error('ä¿å­˜é…ç½®å¤±è´¥')}}async function j(){if(!c.value)return;const e=A.value.find(e=>e.id===c.value);e&&(Object.assign(i,e.settings),g.value=e.autoTrigger.updateTargetTables||[],await C(e.settings),T.setActivePreset(c.value),S.toast.success('å·²åº”ç”¨é¢„è®¾é…ç½®'))}function O(){T.setAutoFixPreset(s.value||null),S.toast.info(s.value?'å·²è®¾ç½®è‡ªåŠ¨ä¿®å¤é¢„è®¾':'å·²ç¦ç”¨è‡ªåŠ¨ä¿®å¤')}function H(){const e=[`ä¸Šä¸‹æ–‡å±‚æ•°: ${i.autoUpdateThreshold}`,`æ›´æ–°é¢‘ç‡: æ¯ ${i.autoUpdateFrequency} å±‚`,`æ‰¹æ¬¡å¤§å°: ${i.updateBatchSize}`,`è·³è¿‡å±‚æ•°: ${i.skipUpdateFloors}`,`è¡¨æ ¼é€‰æ‹©: ${g.value.length?g.value.join(', '):'å…¨éƒ¨è¡¨æ ¼'}`];u.openPresetSaveDialog({presetType:'manual-update',summaryItems:e,initialName:'',checkDuplicate:e=>null!==T.findPresetByName(e)},{onSave:e=>{const{preset:t,isNew:a}=T.createOrUpdatePreset(e,{autoUpdateThreshold:i.autoUpdateThreshold,updateBatchSize:i.updateBatchSize,skipUpdateFloors:i.skipUpdateFloors,autoUpdateFrequency:i.autoUpdateFrequency},{enabled:d.value,onEmptyCell:!0,onIndexGap:!0,targetTables:['æ€»ç»“è¡¨','å¤§çº²è¡¨'],updateTargetTables:g.value,emptyCheckColumns:h.value});a?S.toast.success(`é¢„è®¾"${e}"å·²åˆ›å»º`):S.toast.success(`é¢„è®¾"${e}"å·²æ›´æ–°`)}})}function W(){if(!c.value)return;const e=c.value,t=A.value.find(t=>t.id===e);t&&confirm(`ç¡®å®šåˆ é™¤é¢„è®¾"${t.name}"å—ï¼Ÿ`)&&(T.deletePreset(c.value),c.value='',S.toast.success('é¢„è®¾å·²åˆ é™¤'))}function G(){T.setGlobalAutoTrigger(d.value),c.value&&T.updatePreset(c.value,{autoTrigger:{enabled:d.value,onEmptyCell:!0,onIndexGap:!0,targetTables:['æ€»ç»“è¡¨','å¤§çº²è¡¨'],updateTargetTables:g.value,emptyCheckColumns:h.value}}),d.value||(p.value=!1,T.setAutoFixPreset(null),D.clearIntegrityIssues())}function Y(){if(T.setGlobalAutoExecute(p.value),p.value)if(!s.value&&A.value.length>0)s.value=A.value[0].id,T.setAutoFixPreset(s.value),S.toast.info(`å·²è‡ªåŠ¨é€‰æ‹©é¢„è®¾"${A.value[0].name}"ç”¨äºè‡ªåŠ¨ä¿®å¤`);else{if(0===A.value.length)return S.toast.warning('è¯·å…ˆä¿å­˜ä¸€ä¸ªé¢„è®¾å†å¯ç”¨è‡ªåŠ¨æ‰§è¡Œ'),p.value=!1,void T.setGlobalAutoExecute(!1);T.setAutoFixPreset(s.value)}else T.setAutoFixPreset(null),s.value=''}function X(e){c.value&&T.updatePreset(c.value,{autoTrigger:{enabled:d.value,onEmptyCell:!0,onIndexGap:!0,targetTables:['æ€»ç»“è¡¨','å¤§çº²è¡¨'],updateTargetTables:e,emptyCheckColumns:h.value}})}function q(){c.value&&T.updatePreset(c.value,{autoTrigger:{enabled:d.value,onEmptyCell:!0,onIndexGap:!0,targetTables:['æ€»ç»“è¡¨','å¤§çº²è¡¨'],updateTargetTables:g.value,emptyCheckColumns:h.value}})}async function K(){if(!l.value){l.value=!0;try{const e=await B({autoUpdateThreshold:i.autoUpdateThreshold,updateBatchSize:i.updateBatchSize,skipUpdateFloors:i.skipUpdateFloors,autoUpdateFrequency:i.autoUpdateFrequency},g.value);e.success?S.toast.success('âœ… æ‰‹åŠ¨æ›´æ–°å·²æ‰§è¡Œ'):S.toast.warning('âš ï¸ '+(e.message||'æ›´æ–°æ‰§è¡Œå®Œæˆï¼Œè¯·æ£€æŸ¥ç»“æœ'))}catch(e){console.error('[ACU] æ‰‹åŠ¨æ›´æ–°æ‰§è¡Œå¤±è´¥:',e),S.toast.error('æ‰‹åŠ¨æ›´æ–°æ‰§è¡Œå¤±è´¥')}finally{l.value=!1}}}return(0,m.watch)(()=>a.visible,async e=>{if(e){r.value=!0;try{await y(),Object.assign(i,{autoUpdateThreshold:x.value.autoUpdateThreshold,autoUpdateFrequency:x.value.autoUpdateFrequency,updateBatchSize:x.value.updateBatchSize,skipUpdateFloors:x.value.skipUpdateFloors}),T.loadPresets();const e=T.autoFixPreset.value?.id;s.value=e||'',d.value=T.globalAutoTriggerEnabled.value,p.value=T.globalAutoExecuteEnabled.value;const t=T.activePreset.value;t&&(g.value=t.autoTrigger.updateTargetTables||[],h.value=t.autoTrigger.emptyCheckColumns||[]),f.value=V(),function(){const e=f.value.filter(e=>e.isSummaryOrOutline);if(0===e.length)return void(b.value=[]);try{const t=window.parent?.AutoCardUpdaterAPI||window.AutoCardUpdaterAPI;if(!t?.exportTableAsJson)return void(b.value=[]);const a=t.exportTableAsJson(),o=new Set;for(const t of e){const e=a[t.key];e?.content?.[0]&&e.content[0].forEach(e=>{const t=String(e).trim();t&&o.add(t)})}b.value=Array.from(o)}catch(e){console.warn('[ACU] åŠ è½½å¯ç”¨åˆ—å¤±è´¥:',e),b.value=[]}}()}catch(e){console.error('[ACU] åŠ è½½é…ç½®å¤±è´¥:',e),S.toast.error('åŠ è½½é…ç½®å¤±è´¥')}finally{r.value=!1}}},{immediate:!0}),(0,de.X2F)(n,()=>{P()}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(P,['self'])},[(0,m.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-manual-update-modal'},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',{class:'acu-modal-header'},[(0,m.createCommentVNode)(' è¿”å›æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-modal-back',onClick:P},[...a[16]||(a[16]=[(0,m.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])]),a[17]||(a[17]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'æ‰‹åŠ¨æ›´æ–°é…ç½®',-1)),(0,m.createCommentVNode)(' èƒ¶å›Šå¼å®ŒæˆæŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:P},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Fi,[(0,m.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),r.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',ji,[...a[18]||(a[18]=[(0,m.createElementVNode)('i',{class:'fas fa-spinner fa-spin'},null,-1),(0,m.createElementVNode)('span',null,'åŠ è½½é…ç½®ä¸­...',-1)])])):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' é…ç½®é¡¹ '),(0,m.createCommentVNode)(' PCç«¯å¹¶æ’å¸ƒå±€ '),(0,m.createElementVNode)('div',Oi,[(0,m.createCommentVNode)(' å·¦ä¾§ï¼šå‚æ•°è®¾ç½® '),(0,m.createElementVNode)('div',Ri,[(0,m.createCommentVNode)(' é¢„è®¾ç®¡ç†åŒºåŸŸ '),(0,m.createElementVNode)('div',Hi,[a[25]||(a[25]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-bookmark'}),(0,m.createTextVNode)(' é¢„è®¾ç®¡ç† ')],-1)),(0,m.createCommentVNode)(' é¢„è®¾é€‰æ‹© '),(0,m.createElementVNode)('div',Wi,[a[22]||(a[22]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' é€‰æ‹©é¢„è®¾ '),(0,m.createElementVNode)('span',{class:'hint'},'å¿«é€Ÿåº”ç”¨ä¿å­˜çš„é…ç½®')],-1)),(0,m.createElementVNode)('div',Gi,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[0]||(a[0]=e=>c.value=e),class:'acu-config-select',onChange:j},[a[19]||(a[19]=(0,m.createElementVNode)('option',{value:''},'-- å½“å‰é…ç½® --',-1)),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(A.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e.id,value:e.id},(0,m.toDisplayString)(e.name),9,Yi))),128))],544),[[m.vModelSelect,c.value]]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'ä¿å­˜ä¸ºæ–°é¢„è®¾',onClick:H},[...a[20]||(a[20]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])]),c.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-tool-btn acu-btn-danger',title:'åˆ é™¤é¢„è®¾',onClick:W},[...a[21]||(a[21]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createCommentVNode)(' è‡ªåŠ¨ä¿®å¤é¢„è®¾ '),(0,m.createElementVNode)('div',Xi,[a[24]||(a[24]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ£€æµ‹é—®é¢˜æ—¶ä½¿ç”¨ '),(0,m.createElementVNode)('span',{class:'hint'},'æ£€æµ‹åˆ°é—®é¢˜æ—¶è‡ªåŠ¨åº”ç”¨æ­¤é¢„è®¾')],-1)),(0,m.createElementVNode)('div',qi,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[1]||(a[1]=e=>s.value=e),class:'acu-config-select',onChange:O},[a[23]||(a[23]=(0,m.createElementVNode)('option',{value:''},'-- ç¦ç”¨ --',-1)),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(A.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e.id,value:e.id},(0,m.toDisplayString)(e.name),9,Ki))),128))],544),[[m.vModelSelect,s.value]])])])]),(0,m.createCommentVNode)(' å‚æ•°è®¾ç½®åŒºåŸŸ '),(0,m.createElementVNode)('div',Ji,[a[30]||(a[30]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-sliders-h'}),(0,m.createTextVNode)(' æ›´æ–°å‚æ•°è®¾ç½® ')],-1)),(0,m.createCommentVNode)(' AIè¯»å–ä¸Šä¸‹æ–‡å±‚æ•° '),(0,m.createElementVNode)('div',Qi,[a[26]||(a[26]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' AIè¯»å–ä¸Šä¸‹æ–‡å±‚æ•° '),(0,m.createElementVNode)('span',{class:'hint'},'AIé˜…è¯»æœ€è¿‘å¤šå°‘å±‚æ¥ç†è§£å‰§æƒ…')],-1)),(0,m.createElementVNode)('div',Zi,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.autoUpdateThreshold=e),type:'number',class:'acu-config-input',min:'1',max:'500',onChange:a[3]||(a[3]=e=>F('autoUpdateThreshold',i.autoUpdateThreshold))},null,544),[[m.vModelText,i.autoUpdateThreshold,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' æ¯Nå±‚è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡ '),(0,m.createElementVNode)('div',ec,[a[27]||(a[27]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ¯Nå±‚è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡ '),(0,m.createElementVNode)('span',{class:'hint'},'è®¾ç½®è‡ªåŠ¨è§¦å‘æ›´æ–°çš„æ¥¼å±‚é—´éš”')],-1)),(0,m.createElementVNode)('div',tc,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>i.autoUpdateFrequency=e),type:'number',class:'acu-config-input',min:'1',max:'100',onChange:a[5]||(a[5]=e=>F('autoUpdateFrequency',i.autoUpdateFrequency))},null,544),[[m.vModelText,i.autoUpdateFrequency,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' æ¯æ‰¹æ¬¡æ›´æ–°æ¥¼å±‚æ•° '),(0,m.createElementVNode)('div',ac,[a[28]||(a[28]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ¯æ‰¹æ¬¡æ›´æ–°æ¥¼å±‚æ•° '),(0,m.createElementVNode)('span',{class:'hint'},'å•æ¬¡æ›´æ–°å¤„ç†çš„æœ€å¤§æ¥¼å±‚æ•°')],-1)),(0,m.createElementVNode)('div',oc,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[6]||(a[6]=e=>i.updateBatchSize=e),type:'number',class:'acu-config-input',min:'1',max:'50',onChange:a[7]||(a[7]=e=>F('updateBatchSize',i.updateBatchSize))},null,544),[[m.vModelText,i.updateBatchSize,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' ä¿ç•™Xå±‚æ¥¼ä¸æ›´æ–° '),(0,m.createElementVNode)('div',nc,[a[29]||(a[29]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ä¿ç•™Xå±‚æ¥¼ä¸æ›´æ–° '),(0,m.createElementVNode)('span',{class:'hint'},'æœ€è¿‘çš„å‡ å±‚æ¥¼è·³è¿‡æ›´æ–°')],-1)),(0,m.createElementVNode)('div',rc,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[8]||(a[8]=e=>i.skipUpdateFloors=e),type:'number',class:'acu-config-input',min:'0',max:'20',onChange:a[9]||(a[9]=e=>F('skipUpdateFloors',i.skipUpdateFloors))},null,544),[[m.vModelText,i.skipUpdateFloors,void 0,{number:!0}]])])])]),(0,m.createCommentVNode)(' ç§»åŠ¨ç«¯ï¼šæŠ˜å å¼è¡¨æ ¼é€‰æ‹©ï¼ˆæ”¾åœ¨æ™ºèƒ½æ£€æµ‹ä¹‹å‰ï¼‰ '),(0,m.createElementVNode)('div',lc,[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-settings-title acu-collapsible',{'is-expanded':v.value}]),onClick:a[10]||(a[10]=e=>v.value=!v.value)},[a[31]||(a[31]=(0,m.createElementVNode)('i',{class:'fas fa-table'},null,-1)),a[32]||(a[32]=(0,m.createTextVNode)(' æ›´æ–°è¡¨æ ¼é€‰æ‹© ',-1)),(0,m.createElementVNode)('span',ic,(0,m.toDisplayString)(v.value?'â–²':'â–¼'),1)],2),(0,m.withDirectives)((0,m.createElementVNode)('div',cc,[(0,m.createVNode)((0,m.unref)(za),{modelValue:g.value,'onUpdate:modelValue':[a[11]||(a[11]=e=>g.value=e),X],items:L.value,'empty-text':'æš‚æ— å¯ç”¨è¡¨æ ¼','footer-template':'å·²é€‰æ‹©: {selected}/{total} ä¸ªè¡¨æ ¼','empty-hint':'(æ›´æ–°å…¨éƒ¨)'},null,8,['modelValue','items'])],512),[[m.vShow,v.value]])]),(0,m.createCommentVNode)(' æ™ºèƒ½æ£€æµ‹è®¾ç½® '),(0,m.createElementVNode)('div',sc,[a[37]||(a[37]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-magic'}),(0,m.createTextVNode)(' æ™ºèƒ½æ£€æµ‹ ')],-1)),(0,m.createCommentVNode)(' å¯ç”¨æ™ºèƒ½æ£€æµ‹ '),(0,m.createElementVNode)('div',uc,[a[34]||(a[34]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¯ç”¨é—®é¢˜æ£€æµ‹æç¤º '),(0,m.createElementVNode)('span',{class:'hint'},'æ£€æµ‹ç¼–ç ç´¢å¼•æ–­è£‚æˆ–ç©ºå•å…ƒæ ¼æ—¶æ˜¾ç¤ºè­¦å‘Š')],-1)),(0,m.createElementVNode)('div',dc,[(0,m.createElementVNode)('label',pc,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[12]||(a[12]=e=>d.value=e),type:'checkbox',onChange:G},null,544),[[m.vModelCheckbox,d.value]]),a[33]||(a[33]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])]),(0,m.createCommentVNode)(' è‡ªåŠ¨æ‰§è¡Œä¿®å¤ '),d.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',mc,[a[36]||(a[36]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ£€æµ‹åˆ°é—®é¢˜æ—¶è‡ªåŠ¨æ‰§è¡Œ '),(0,m.createElementVNode)('span',{class:'hint'},'è‡ªåŠ¨æŒ‰é€‰å®šé¢„è®¾è§¦å‘æ‰‹åŠ¨æ›´æ–°')],-1)),(0,m.createElementVNode)('div',fc,[(0,m.createElementVNode)('label',gc,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[13]||(a[13]=e=>p.value=e),type:'checkbox',onChange:Y},null,544),[[m.vModelCheckbox,p.value]]),a[35]||(a[35]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' ç©ºå€¼æ£€æµ‹åˆ—è®¾ç½®ï¼ˆä»…å½“å¯ç”¨æ™ºèƒ½æ£€æµ‹æ—¶æ˜¾ç¤ºï¼‰ '),d.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',vc,[a[38]||(a[38]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-columns'}),(0,m.createTextVNode)(' ç©ºå€¼æ£€æµ‹åˆ— ')],-1)),(0,m.createVNode)((0,m.unref)(za),{modelValue:h.value,'onUpdate:modelValue':[a[14]||(a[14]=e=>h.value=e),q],items:U.value,'empty-text':'æš‚æ— å¯ç”¨åˆ—ï¼ˆè¯·å…ˆé€‰æ‹©æ€»ç»“è¡¨/å¤§çº²è¡¨ï¼‰','footer-template':'å·²é€‰æ‹©: {selected}/{total} åˆ—','empty-hint':'(æ£€æµ‹å…¨éƒ¨)'},null,8,['modelValue','items'])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' å³ä¾§ï¼šè¡¨æ ¼é€‰æ‹© (PCç«¯æ˜¾ç¤º) '),(0,m.createElementVNode)('div',bc,[(0,m.createVNode)((0,m.unref)(za),{modelValue:g.value,'onUpdate:modelValue':[a[15]||(a[15]=e=>g.value=e),X],items:L.value,'empty-text':'æš‚æ— å¯ç”¨è¡¨æ ¼','footer-template':'å·²é€‰æ‹©: {selected}/{total} ä¸ªè¡¨æ ¼','empty-hint':'(æ›´æ–°å…¨éƒ¨)'},null,8,['modelValue','items'])])]),(0,m.createCommentVNode)(' é—®é¢˜æç¤º '),I.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',hc,[a[39]||(a[39]=(0,m.createElementVNode)('i',{class:'fas fa-exclamation-triangle'},null,-1)),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(M.value),1)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' æ‰§è¡ŒæŒ‰é’® '),(0,m.createElementVNode)('div',xc,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-update-btn',{'is-updating':l.value}]),disabled:l.value,onClick:K},[l.value?((0,m.openBlock)(),(0,m.createElementBlock)('i',wc)):((0,m.openBlock)(),(0,m.createElementBlock)('i',kc)),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(l.value?'æ­£åœ¨æ›´æ–°...':'ç«‹å³æ‰§è¡Œæ‰‹åŠ¨æ›´æ–°'),1)],10,yc)])],64))])],512),(0,m.createCommentVNode)(' é¢„è®¾ä¿å­˜å¼¹çª—å·²è¿ç§»åˆ°å…¨å±€ App.vue ä¸­ ')])):(0,m.createCommentVNode)('v-if',!0)}});d(2778);const Nc=(0,Ye.A)(Cc,[['__scopeId','data-v-5df49713']]),Vc={class:'acu-modal acu-preset-save-modal'},Ec={class:'acu-modal-header'},Bc={class:'acu-modal-body'},Sc={class:'acu-settings-group'},Tc={key:0,class:'acu-preset-warning'},Dc={key:1,class:'acu-preset-summary'},Ac={class:'acu-preset-summary-list'},zc={class:'acu-modal-footer'},Ic=['disabled'],_c=(0,m.defineComponent)({__name:'PresetSaveDialog',props:{visible:{type:Boolean},presetType:{default:'manual-update'},summaryItems:{default:()=>[]},initialName:{default:''},checkDuplicate:{type:Function,default:()=>!1}},emits:['update:visible','save'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(null),r=(0,m.ref)(''),l=(0,m.computed)(()=>r.value.trim().length>0),i=(0,m.computed)(()=>{const e=r.value.trim();return!!e&&(a.checkDuplicate?.(e)??!1)});function c(){o('update:visible',!1)}function s(){const e=r.value.trim();e&&(o('save',e),o('update:visible',!1))}return(0,m.watch)(()=>a.visible,e=>{e&&(r.value=a.initialName||'',(0,m.nextTick)(()=>{n.value?.focus()}))},{immediate:!0}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(c,['self'])},[(0,m.createElementVNode)('div',Vc,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Ec,[a[1]||(a[1]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'ä¿å­˜ä¸ºé¢„è®¾',-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(c,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Bc,[(0,m.createCommentVNode)(' é¢„è®¾åç§°è¾“å…¥ '),(0,m.createElementVNode)('div',Sc,[(0,m.withDirectives)((0,m.createElementVNode)('input',{ref_key:'inputRef',ref:n,'onUpdate:modelValue':a[0]||(a[0]=e=>r.value=e),type:'text',class:'acu-settings-input',placeholder:'è¾“å…¥é¢„è®¾åç§°',onKeyup:(0,m.withKeys)(s,['enter'])},null,544),[[m.vModelText,r.value]])]),(0,m.createCommentVNode)(' é‡åè­¦å‘Š '),i.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Tc,[...a[2]||(a[2]=[(0,m.createElementVNode)('i',{class:'fas fa-exclamation-circle'},null,-1),(0,m.createTextVNode)(' å·²å­˜åœ¨åŒåé¢„è®¾ï¼Œä¿å­˜å°†è¦†ç›–åŸæœ‰é…ç½® ',-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' ä¿å­˜å†…å®¹æ‘˜è¦ '),e.summaryItems.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Dc,[a[3]||(a[3]=(0,m.createElementVNode)('div',{class:'acu-preset-summary-title'},'å°†ä¿å­˜ä»¥ä¸‹é…ç½®ï¼š',-1)),(0,m.createElementVNode)('ul',Ac,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.summaryItems,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('li',{key:t},(0,m.toDisplayString)(e),1))),128))])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' åº•éƒ¨æŒ‰é’® '),(0,m.createElementVNode)('div',zc,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(c,['stop'])},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',disabled:!l.value,onClick:(0,m.withModifiers)(s,['stop'])},(0,m.toDisplayString)(i.value?'è¦†ç›–ä¿å­˜':'ä¿å­˜'),9,Ic)])])])):(0,m.createCommentVNode)('v-if',!0)}});d(4493);const Mc=(0,Ye.A)(_c,[['__scopeId','data-v-619b7a49']]),Uc={class:'acu-purge-content'},$c={class:'acu-purge-inputs'},Lc={class:'acu-purge-btns'},Pc={class:'acu-purge-btns-right'},Fc=['disabled'],jc=(0,m.defineComponent)({__name:'PurgeRangeDialog',props:{visible:{type:Boolean},maxFloor:{default:999}},emits:['update:visible','confirm','advanced-confirm'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(),r=(0,m.ref)(),l=(0,m.ref)(),i=(0,m.ref)(null),c=(0,m.ref)(null),s=(0,m.ref)(!1),u=(0,m.ref)(!1);const d=(0,m.computed)(()=>null!==i.value&&null!==c.value&&(!isNaN(i.value)&&!isNaN(c.value)&&(!(i.value<0||c.value<0)&&!(i.value>c.value))));(0,m.watch)(()=>a.visible,e=>{if(e){const e=function(){let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern);let t=-1,a=0;if(e&&e.chat){a=Math.max(0,e.chat.length-1);for(let a=e.chat.length-1;a>=0;a--){const o=e.chat[a];if(!o.is_user&&o.TavernDB_ACU_IsolatedData){const e=Object.keys(o.TavernDB_ACU_IsolatedData);let n=!1;for(const t of e){const e=o.TavernDB_ACU_IsolatedData[t];if(e&&e.independentData&&Object.keys(e.independentData).length>0){n=!0;break}}if(n){t=a;break}}}}return{start:-1!==t?t:a,end:-1!==t?t:a}}();i.value=e.start,c.value=e.end,s.value=!1}}),(0,de.X2F)(n,()=>{g()});const p=()=>{l.value?.focus()},f=()=>{d.value&&null!==i.value&&null!==c.value?(o('confirm',i.value,c.value),o('update:visible',!1)):(s.value=!0,setTimeout(()=>{s.value=!1},500),S.toast.warning('è¯·è¾“å…¥æœ‰æ•ˆçš„æ¥¼å±‚èŒƒå›´ (Start <= End)'))},g=()=>{o('update:visible',!1)},v=()=>{u.value=!0},b=e=>{o('advanced-confirm',e),o('update:visible',!1)};return(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,null,[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-purge-overlay',onClick:(0,m.withModifiers)(g,['self'])},[(0,m.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-purge-range-modal'},[(0,m.createCommentVNode)(' æ ‡é¢˜åŒº '),a[7]||(a[7]=(0,m.createElementVNode)('div',{class:'acu-purge-title'},'æ¸…é™¤æ•°æ®èŒƒå›´',-1)),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',Uc,[(0,m.createCommentVNode)(' è£…é¥°å›¾æ ‡ '),a[4]||(a[4]=(0,m.createElementVNode)('div',{class:'acu-purge-icon'},[(0,m.createElementVNode)('i',{class:'fa-solid fa-eraser'})],-1)),(0,m.createCommentVNode)(' æç¤ºæ–‡å­— '),a[5]||(a[5]=(0,m.createElementVNode)('p',{class:'acu-purge-hint'},[(0,m.createTextVNode)(' è¯·è¾“å…¥è¦æ¸…é™¤æ•°æ®çš„æ¥¼å±‚èŒƒå›´'),(0,m.createElementVNode)('br'),(0,m.createElementVNode)('span',{class:'acu-purge-hint-sub'},'(èµ·å§‹æ¥¼å±‚ - ç»“æŸæ¥¼å±‚)')],-1)),(0,m.createCommentVNode)(' èŒƒå›´è¾“å…¥ '),(0,m.createElementVNode)('div',$c,[(0,m.withDirectives)((0,m.createElementVNode)('input',{ref_key:'startInputRef',ref:r,'onUpdate:modelValue':a[0]||(a[0]=e=>i.value=e),type:'number',class:'acu-purge-input',placeholder:'Start',min:'0',onKeydown:(0,m.withKeys)(p,['enter'])},null,544),[[m.vModelText,i.value,void 0,{number:!0}]]),a[3]||(a[3]=(0,m.createElementVNode)('span',{class:'acu-purge-separator'},'-',-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{ref_key:'endInputRef',ref:l,'onUpdate:modelValue':a[1]||(a[1]=e=>c.value=e),type:'number',class:'acu-purge-input',placeholder:'End',min:'0',onKeydown:(0,m.withKeys)(f,['enter'])},null,544),[[m.vModelText,c.value,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' æŒ‰é’®åŒº '),(0,m.createElementVNode)('div',Lc,[(0,m.createElementVNode)('button',{class:'acu-purge-btn acu-purge-btn-advanced',onClick:v},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-cogs'},null,-1),(0,m.createTextVNode)(' é«˜çº§ ',-1)])]),(0,m.createElementVNode)('div',Pc,[(0,m.createElementVNode)('button',{class:'acu-purge-btn acu-purge-btn-cancel',onClick:g},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-purge-btn acu-purge-btn-confirm',disabled:!d.value,onClick:f},' ç¡®è®¤æ¸…é™¤ ',8,Fc)])])],512)])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' é«˜çº§æ¸…é™¤å¼¹çª— '),(0,m.createVNode)(ll,{visible:u.value,'onUpdate:visible':a[2]||(a[2]=e=>u.value=e),'initial-start-floor':i.value??void 0,'initial-end-floor':c.value??void 0,onConfirm:b},null,8,['visible','initial-start-floor','initial-end-floor'])],64))}}),Oc='8.2.2';Oc.split('.')[0];const Rc={class:'acu-ball-appearance-panel'},Hc={class:'acu-ball-preview-fixed'},Wc=['src'],Gc={key:3,class:'fa-solid fa-image'},Yc={class:'acu-ball-scroll-content'},Xc={class:'acu-settings-section'},qc={class:'acu-settings-title-row'},Kc={class:'acu-preview-buttons'},Jc={class:'acu-anim-grid'},Qc={class:'acu-settings-section'},Zc={class:'acu-settings-group'},es={class:'acu-settings-row'},ts={class:'acu-settings-control acu-color-picker-inline'},as={class:'acu-settings-row'},os={class:'acu-settings-label'},ns={class:'hint'},rs={class:'acu-settings-control'},ls={class:'acu-settings-section'},is={class:'acu-settings-group'},cs={class:'acu-settings-row'},ss={class:'acu-settings-control acu-color-picker-inline'},us={class:'acu-settings-row'},ds={class:'acu-settings-label'},ps={class:'hint'},ms={class:'acu-settings-control'},fs={class:'acu-settings-section'},gs={class:'acu-settings-group'},vs={class:'acu-settings-row'},bs={class:'acu-settings-label'},hs={class:'hint'},xs={class:'acu-settings-control'},ys={class:'acu-settings-section'},ws={class:'acu-icon-type-row'},ks={key:0,class:'acu-icon-input-area'},Cs={class:'acu-icon-input'},Ns={key:1,class:'acu-icon-input-area'},Vs={class:'acu-emoji-input'},Es={class:'acu-icon-input-area'},Bs={class:'acu-url-input'},Ss={key:0,class:'acu-image-preview-row',style:{'margin-top':'10px'}},Ts={class:'acu-image-actions'},Ds={class:'acu-icon-input-area'},As={class:'acu-image-preview-row'},zs={class:'acu-image-actions'},Is=(0,m.defineComponent)({__name:'BallAppearancePanel',setup(e){const t=(0,Pe.MP)(),a=(0,Pe.j_)(),o=(0,m.reactive)({...t.appearance}),n=(0,m.ref)(!1),r=(0,m.ref)(!1),l=(0,m.ref)(),i=(0,m.ref)('local'),c=(0,m.ref)(''),s=(0,m.computed)(()=>'image'===o.type&&'url'===i.value);'image'===o.type&&o.content?.startsWith('http')&&(i.value='url',c.value=o.content),(0,m.watch)(o,e=>{t.updateAppearance(e)},{deep:!0});const u=(0,m.computed)(()=>({'p-anim-ripple':n.value&&'ripple'===o.notifyAnimation,'p-anim-arc':n.value&&'arc'===o.notifyAnimation,'p-notify':r.value})),d=(0,m.computed)(()=>({'--ball-size':`${o.size}px`,'--ball-border-color':o.borderColor,'--ball-border-color-rgba':(0,v.j5)(o.borderColor,o.borderOpacity),'--ball-bg-color':(0,v.j5)(o.bgColor,o.bgOpacity)})),p=(0,m.computed)(()=>o.content?{backgroundImage:`url('${o.content}')`,backgroundPosition:`${o.imageOffsetX??50}% ${o.imageOffsetY??50}%`,backgroundSize:`${o.imageScale??150}%`,backgroundRepeat:'no-repeat'}:{});function f(){n.value=!0,r.value=!1,setTimeout(()=>{n.value=!1},3e3)}function g(){r.value=!0,n.value=!1,setTimeout(()=>{r.value=!1},3e3)}function b(){o.type='image',i.value='local',l.value?.click()}function h(){o.type='image',i.value='url',o.content&&!o.content.startsWith('http')&&(o.content=''),o.content?.startsWith('http')&&(c.value=o.content)}function x(){const e=c.value.trim();e&&e.startsWith('http')&&(o.content=e,o.imageOffsetX=50,o.imageOffsetY=50,o.imageScale=150)}async function y(e){const t=e.target,a=t.files?.[0];if(a){try{let e=await(0,v.bB)(a);e=await(0,v.w4)(e,100,.8),o.content=e,o.imageOffsetX=50,o.imageOffsetY=50,o.imageScale=150,w()}catch(e){console.error('[ACU] å›¾ç‰‡ä¸Šä¼ å¤±è´¥:',e)}t.value=''}}function w(){o.content&&a.openAvatarCropDialog({imageUrl:o.content,name:'æ‚¬æµ®çƒå›¾ç‰‡',initialOffsetX:o.imageOffsetX??50,initialOffsetY:o.imageOffsetY??50,initialScale:o.imageScale??150,initialInvert:o.imageInvert??!1,showInvertOption:!0},{onApply:e=>{o.imageOffsetX=e.offsetX,o.imageOffsetY=e.offsetY,o.imageScale=e.scale,void 0!==e.invert&&(o.imageInvert=e.invert)},onUpload:async e=>{try{let t=await(0,v.bB)(e);t=await(0,v.w4)(t,100,.8),o.content=t,o.imageOffsetX=50,o.imageOffsetY=50,o.imageScale=150}catch(e){console.error('[ACU] å›¾ç‰‡ä¸Šä¼ å¤±è´¥:',e)}}})}function k(){o.content='',o.imageOffsetX=50,o.imageOffsetY=50,o.imageScale=150}function C(){Object.assign(o,Pe.$P)}return(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Rc,[(0,m.createCommentVNode)(' é¢„è§ˆåŒºåŸŸ - å›ºå®šåœ¨é¡¶éƒ¨ï¼ˆä½¿ç”¨ position: absoluteï¼‰ '),(0,m.createElementVNode)('div',Hc,[(0,m.createElementVNode)('button',{class:'acu-icon-btn acu-reset-btn',title:'é‡ç½®ä¸ºé»˜è®¤',onClick:(0,m.withModifiers)(C,['stop'])},[...t[15]||(t[15]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1)])]),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-ball-preview',u.value]),style:(0,m.normalizeStyle)(d.value)},['icon'===o.type?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(['fa-solid',o.content])},null,2)):'emoji'===o.type?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createTextVNode)((0,m.toDisplayString)(o.content),1)],64)):'image'===o.type&&o.content?((0,m.openBlock)(),(0,m.createElementBlock)('img',{key:2,src:o.content,alt:''},null,8,Wc)):((0,m.openBlock)(),(0,m.createElementBlock)('i',Gc))],6)]),(0,m.createCommentVNode)(' å¯æ»šåŠ¨å†…å®¹åŒº '),(0,m.createElementVNode)('div',Yc,[(0,m.createCommentVNode)(' é€šçŸ¥åŠ¨ç”»ç±»å‹ - æ ‡é¢˜ä¸æŒ‰é’®åŒè¡Œ '),(0,m.createElementVNode)('div',Xc,[(0,m.createElementVNode)('div',qc,[t[16]||(t[16]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-bell'}),(0,m.createTextVNode)(' AI å¡«è¡¨é€šçŸ¥åŠ¨ç”» ')],-1)),(0,m.createElementVNode)('div',Kc,[(0,m.createElementVNode)('button',{class:'acu-tool-btn',onClick:(0,m.withModifiers)(f,['stop'])},'â–¶ï¸ æ’­æ”¾'),(0,m.createElementVNode)('button',{class:'acu-tool-btn',onClick:(0,m.withModifiers)(g,['stop'])},'ğŸ”” é€šçŸ¥')])]),(0,m.createElementVNode)('div',Jc,[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-anim-option',{active:'ripple'===o.notifyAnimation}]),onClick:t[0]||(t[0]=(0,m.withModifiers)(e=>o.notifyAnimation='ripple',['stop']))},[...t[17]||(t[17]=[(0,m.createElementVNode)('span',{class:'acu-anim-icon'},'ğŸŒŠ',-1),(0,m.createElementVNode)('span',{class:'acu-anim-name'},'è„‰å†²æ³¢çº¹',-1)])],2),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-anim-option',{active:'arc'===o.notifyAnimation}]),onClick:t[1]||(t[1]=(0,m.withModifiers)(e=>o.notifyAnimation='arc',['stop']))},[...t[18]||(t[18]=[(0,m.createElementVNode)('span',{class:'acu-anim-icon'},'âš¡',-1),(0,m.createElementVNode)('span',{class:'acu-anim-name'},'ç”µç£é—ªçƒ',-1)])],2)])]),(0,m.createCommentVNode)(' è¾¹æ¡†é¢œè‰² '),(0,m.createElementVNode)('div',Qc,[t[21]||(t[21]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-palette'}),(0,m.createTextVNode)(' è¾¹æ¡†é¢œè‰² ')],-1)),(0,m.createElementVNode)('div',Zc,[(0,m.createElementVNode)('div',es,[t[19]||(t[19]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},'é¢œè‰²',-1)),(0,m.createElementVNode)('div',ts,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[2]||(t[2]=e=>o.borderColor=e),type:'text',class:'acu-color-input',placeholder:'#RRGGBB'},null,512),[[m.vModelText,o.borderColor]]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[3]||(t[3]=e=>o.borderColor=e),type:'color',class:'acu-color-swatch acu-dashed'},null,512),[[m.vModelText,o.borderColor]])])]),(0,m.createElementVNode)('div',as,[(0,m.createElementVNode)('div',os,[t[20]||(t[20]=(0,m.createTextVNode)(' é€æ˜åº¦ ',-1)),(0,m.createElementVNode)('span',ns,(0,m.toDisplayString)(o.borderOpacity)+'%',1)]),(0,m.createElementVNode)('div',rs,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[4]||(t[4]=e=>o.borderOpacity=e),type:'range',min:'0',max:'100',step:'5'},null,512),[[m.vModelText,o.borderOpacity,void 0,{number:!0}]])])])])]),(0,m.createCommentVNode)(' èƒŒæ™¯é¢œè‰² '),(0,m.createElementVNode)('div',ls,[t[24]||(t[24]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-fill-drip'}),(0,m.createTextVNode)(' èƒŒæ™¯é¢œè‰² ')],-1)),(0,m.createElementVNode)('div',is,[(0,m.createElementVNode)('div',cs,[t[22]||(t[22]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},'é¢œè‰²',-1)),(0,m.createElementVNode)('div',ss,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[5]||(t[5]=e=>o.bgColor=e),type:'text',class:'acu-color-input',placeholder:'#RRGGBB'},null,512),[[m.vModelText,o.bgColor]]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[6]||(t[6]=e=>o.bgColor=e),type:'color',class:'acu-color-swatch'},null,512),[[m.vModelText,o.bgColor]])])]),(0,m.createElementVNode)('div',us,[(0,m.createElementVNode)('div',ds,[t[23]||(t[23]=(0,m.createTextVNode)(' é€æ˜åº¦ ',-1)),(0,m.createElementVNode)('span',ps,(0,m.toDisplayString)(o.bgOpacity)+'%',1)]),(0,m.createElementVNode)('div',ms,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[7]||(t[7]=e=>o.bgOpacity=e),type:'range',min:'0',max:'100',step:'5'},null,512),[[m.vModelText,o.bgOpacity,void 0,{number:!0}]])])])])]),(0,m.createCommentVNode)(' å°ºå¯¸ '),(0,m.createElementVNode)('div',fs,[t[26]||(t[26]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-expand-arrows-alt'}),(0,m.createTextVNode)(' å°ºå¯¸ ')],-1)),(0,m.createElementVNode)('div',gs,[(0,m.createElementVNode)('div',vs,[(0,m.createElementVNode)('div',bs,[t[25]||(t[25]=(0,m.createTextVNode)(' çƒä½“å¤§å° ',-1)),(0,m.createElementVNode)('span',hs,(0,m.toDisplayString)(o.size)+'px',1)]),(0,m.createElementVNode)('div',xs,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[8]||(t[8]=e=>o.size=e),type:'range',min:'40',max:'100',step:'2'},null,512),[[m.vModelText,o.size,void 0,{number:!0}]])])])])]),(0,m.createCommentVNode)(' å›¾æ ‡ç±»å‹ '),(0,m.createElementVNode)('div',ys,[t[44]||(t[44]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-icons'}),(0,m.createTextVNode)(' å›¾æ ‡ ')],-1)),(0,m.createCommentVNode)(' å›¾æ ‡ç±»å‹æŒ‰é’® - å›¾æ ‡å’Œæ–‡å­—åŒè¡Œ '),(0,m.createElementVNode)('div',ws,[(0,m.createElementVNode)('label',{class:(0,m.normalizeClass)(['acu-type-btn',{active:'icon'===o.type}])},[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[9]||(t[9]=e=>o.type=e),type:'radio',value:'icon'},null,512),[[m.vModelRadio,o.type]]),t[27]||(t[27]=(0,m.createElementVNode)('i',{class:'fa-solid fa-icons'},null,-1)),t[28]||(t[28]=(0,m.createElementVNode)('span',null,'FAå›¾æ ‡',-1))],2),(0,m.createElementVNode)('label',{class:(0,m.normalizeClass)(['acu-type-btn',{active:'emoji'===o.type}])},[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[10]||(t[10]=e=>o.type=e),type:'radio',value:'emoji'},null,512),[[m.vModelRadio,o.type]]),t[29]||(t[29]=(0,m.createElementVNode)('span',{class:'emoji-icon'},'ğŸ˜€',-1)),t[30]||(t[30]=(0,m.createElementVNode)('span',null,'Emoji',-1))],2),(0,m.createCommentVNode)(' æœ¬åœ°å›¾ç‰‡æŒ‰é’® - ç‚¹å‡»ç›´æ¥ä¸Šä¼  '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-type-btn',{active:'image'===o.type&&!s.value}]),onClick:(0,m.withModifiers)(b,['stop'])},[(0,m.createElementVNode)('input',{ref_key:'imageInputRef',ref:l,type:'file',accept:'image/*',hidden:'',onChange:y},null,544),t[31]||(t[31]=(0,m.createElementVNode)('i',{class:'fa-solid fa-image'},null,-1)),t[32]||(t[32]=(0,m.createElementVNode)('span',null,'å›¾ç‰‡',-1))],2),(0,m.createCommentVNode)(' URL å›¾ç‰‡æŒ‰é’® '),(0,m.createElementVNode)('label',{class:(0,m.normalizeClass)(['acu-type-btn',{active:'image'===o.type&&s.value}])},[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[11]||(t[11]=e=>i.value=e),type:'radio',value:'url',onChange:h},null,544),[[m.vModelRadio,i.value]]),t[33]||(t[33]=(0,m.createElementVNode)('i',{class:'fa-solid fa-link'},null,-1)),t[34]||(t[34]=(0,m.createElementVNode)('span',null,'URL',-1))],2)]),(0,m.createCommentVNode)(' æ ¹æ®ç±»å‹æ˜¾ç¤ºä¸åŒè¾“å…¥ï¼ˆä»…å›¾æ ‡/Emojiéœ€è¦è¾“å…¥ï¼Œå›¾ç‰‡æ— éœ€é¢å¤–è¾“å…¥ï¼‰ '),'icon'===o.type?((0,m.openBlock)(),(0,m.createElementBlock)('div',ks,[(0,m.createElementVNode)('div',Cs,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[12]||(t[12]=e=>o.content=e),placeholder:'fa-layer-group'},null,512),[[m.vModelText,o.content]]),t[35]||(t[35]=(0,m.createElementVNode)('span',{class:'acu-input-hint'},'è¾“å…¥ FontAwesome å›¾æ ‡ç±»å',-1))])])):'emoji'===o.type?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ns,[(0,m.createElementVNode)('div',Vs,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[13]||(t[13]=e=>o.content=e),placeholder:'ğŸ­'},null,512),[[m.vModelText,o.content]]),t[36]||(t[36]=(0,m.createElementVNode)('span',{class:'acu-input-hint'},'è¾“å…¥ Emoji è¡¨æƒ…',-1))])])):'image'===o.type&&s.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' URL å›¾ç‰‡æ¨¡å¼ï¼šæ˜¾ç¤º URL è¾“å…¥æ¡† '),(0,m.createElementVNode)('div',Es,[(0,m.createElementVNode)('div',Bs,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[14]||(t[14]=e=>c.value=e),placeholder:'https://example.com/image.png',onBlur:x,onKeyup:(0,m.withKeys)(x,['enter'])},null,544),[[m.vModelText,c.value]]),t[37]||(t[37]=(0,m.createElementVNode)('span',{class:'acu-input-hint'},'è¾“å…¥å›¾ç‰‡ URLï¼ˆæ”¯æŒ catboxã€imgur ç­‰å¤–é“¾ï¼‰',-1))]),(0,m.createCommentVNode)(' å¦‚æœæœ‰å›¾ç‰‡ï¼Œæ˜¾ç¤ºé¢„è§ˆå’Œè°ƒæ•´æŒ‰é’® '),o.content&&o.content.startsWith('http')?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ss,[(0,m.createElementVNode)('div',{class:'acu-preview-thumb-wrapper',style:(0,m.normalizeStyle)(p.value),onClick:(0,m.withModifiers)(w,['stop'])},[...t[38]||(t[38]=[(0,m.createElementVNode)('span',{class:'acu-edit-hint'},[(0,m.createElementVNode)('i',{class:'fas fa-crop-simple'})],-1)])],4),(0,m.createElementVNode)('div',Ts,[(0,m.createElementVNode)('button',{class:'acu-adjust-btn',onClick:(0,m.withModifiers)(w,['stop'])},[...t[39]||(t[39]=[(0,m.createElementVNode)('i',{class:'fas fa-crop-simple'},null,-1),(0,m.createTextVNode)(' è°ƒæ•´ ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-adjust-btn',style:{'margin-left':'8px'},onClick:(0,m.withModifiers)(k,['stop'])},[...t[40]||(t[40]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1),(0,m.createTextVNode)(' æ¸…é™¤ ',-1)])])])])):(0,m.createCommentVNode)('v-if',!0)])],2112)):'image'===o.type&&o.content?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:3},[(0,m.createCommentVNode)(' æœ¬åœ°å›¾ç‰‡æ¨¡å¼ï¼šå·²ä¸Šä¼ æ—¶æ˜¾ç¤ºè°ƒæ•´å’Œæ¸…é™¤æŒ‰é’® '),(0,m.createElementVNode)('div',Ds,[(0,m.createElementVNode)('div',As,[(0,m.createElementVNode)('div',{class:'acu-preview-thumb-wrapper',style:(0,m.normalizeStyle)(p.value),onClick:(0,m.withModifiers)(w,['stop'])},[...t[41]||(t[41]=[(0,m.createElementVNode)('span',{class:'acu-edit-hint'},[(0,m.createElementVNode)('i',{class:'fas fa-crop-simple'})],-1)])],4),(0,m.createElementVNode)('div',zs,[(0,m.createElementVNode)('button',{class:'acu-adjust-btn',onClick:(0,m.withModifiers)(w,['stop'])},[...t[42]||(t[42]=[(0,m.createElementVNode)('i',{class:'fas fa-crop-simple'},null,-1),(0,m.createTextVNode)(' è°ƒæ•´ ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-adjust-btn',style:{'margin-left':'8px'},onClick:(0,m.withModifiers)(k,['stop'])},[...t[43]||(t[43]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1),(0,m.createTextVNode)(' æ¸…é™¤ ',-1)])])])])])],2112)):(0,m.createCommentVNode)('v-if',!0)])])]))}}),_s={class:'acu-button-config-panel'},Ms={class:'acu-settings-row'},Us={class:'acu-settings-control'},$s={class:'acu-config-section acu-visible-area'},Ls={key:0,class:'acu-btn-visible-grid'},Ps=['title','onClick','onDragstart','onDragover','onDrop'],Fs={key:0,class:'required-dot'},js=['title','onClick'],Os=['onClick'],Rs={key:1,class:'acu-empty-hint'},Hs={class:'acu-config-section acu-hidden-area'},Ws={key:0,class:'acu-btn-hidden-grid'},Gs=['title','onClick'],Ys={key:1,class:'acu-empty-hint'},Xs={class:'picker-header'},qs={class:'picker-content'},Ks={class:'picker-hint'},Js={class:'picker-options'},Qs=['onClick'],Zs=(0,m.defineComponent)({__name:'NavButtonConfigPanel',setup(e){const t=(0,f.JH)(),a=e=>{const t=f.mu.find(t=>t.id===e);return t?.icon||'fa-circle'},o=e=>{const t=f.mu.find(t=>t.id===e);return t?.label||e},n=(0,m.computed)(()=>{const e=t.config.buttonOrder,a=t.config.visibleButtons,o=t.config.buttonGroups||[];return e.filter(e=>a.includes(e)).map(e=>{const t=f.mu.find(t=>t.id===e),a=o.find(t=>t.primaryId===e);return{id:e,icon:t?.icon||'fa-circle',label:t?.label||e,secondaryId:a?.secondaryId||null}})}),r=(0,m.computed)(()=>{const e=t.config.visibleButtons,a=(t.config.buttonGroups||[]).map(e=>e.secondaryId).filter(Boolean);return f.mu.filter(t=>!t.hidden&&!e.includes(t.id)&&!a.includes(t.id))}),l=(0,m.computed)(()=>{const e=(t.config.buttonGroups||[]).map(e=>e.secondaryId).filter(Boolean);return f.mu.filter(t=>t.id!==u.value&&!e.includes(t.id))}),i=(0,m.ref)(null),c=e=>{e.target.classList.remove('dragging');document.querySelectorAll('.acu-button-card').forEach(e=>e.classList.remove('drop-target')),i.value=null},s=(0,m.ref)(!1),u=(0,m.ref)(''),d=()=>{s.value=!1,u.value=''},p=()=>{t.resetButtonConfig()};return(e,f)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',_s,[(0,m.createCommentVNode)(' é•¿æŒ‰ç›´æ¥æ‰§è¡Œå¼€å…³ - ä½¿ç”¨è®¾ç½®é¢æ¿çš„è¡Œå¼€å…³æ ·å¼ '),(0,m.createElementVNode)('div',Ms,[f[2]||(f[2]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' é•¿æŒ‰ç›´æ¥æ‰§è¡Œ '),(0,m.createElementVNode)('span',{class:'hint'},'å¼€å¯åï¼Œé•¿æŒ‰å°†è·³è¿‡å¼¹å‡ºæŒ‰é’®ï¼Œç›´æ¥æ‰§è¡Œé™„å±åŠŸèƒ½')],-1)),(0,m.createElementVNode)('div',Us,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:(0,m.unref)(t).longPressDirectExec}]),onClick:f[0]||(f[0]=(0,m.withModifiers)(e=>(0,m.unref)(t).toggleLongPressDirectExec(),['stop']))},null,2)])]),(0,m.createCommentVNode)(' å±•ç¤ºåŒºï¼šç½‘æ ¼å¸ƒå±€ï¼Œåªæ˜¾ç¤ºå›¾æ ‡ '),(0,m.createElementVNode)('div',$s,[(0,m.createElementVNode)('h4',null,[f[4]||(f[4]=(0,m.createElementVNode)('i',{class:'fas fa-th-large'},null,-1)),(0,m.createTextVNode)(' å±•ç¤ºä¸­ ('+(0,m.toDisplayString)(n.value.length)+') ',1),(0,m.createElementVNode)('button',{class:'acu-btn-text acu-btn-reset',onClick:(0,m.withModifiers)(p,['stop'])},[...f[3]||(f[3]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' é‡ç½®',-1)])])]),n.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ls,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(n.value,(e,n)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['acu-btn-config-item',{'is-required':'settings'===e.id}]),title:e.label+('settings'===e.id?' (å¿…é€‰)':' (ç‚¹å‡»ç§»é™¤)'),draggable:'true',onClick:(0,m.withModifiers)(a=>(e=>{if('settings'===e)return;const a=[...t.config.visibleButtons],o=a.indexOf(e);o>-1&&(a.splice(o,1),t.setVisibleButtons(a))})(e.id),['stop']),onDragstart:e=>((e,t)=>{i.value=t,e.dataTransfer&&(e.dataTransfer.effectAllowed='move',e.dataTransfer.setData('text/plain',String(t))),e.target.classList.add('dragging')})(e,n),onDragover:(0,m.withModifiers)(e=>((e,t)=>{if(e.preventDefault(),null===i.value||i.value===t)return;document.querySelectorAll('.acu-button-card').forEach(e=>e.classList.remove('drop-target')),e.currentTarget.classList.add('drop-target')})(e,n),['prevent']),onDrop:e=>((e,a)=>{if(e.preventDefault(),null===i.value||i.value===a)return;const o=[...t.config.buttonOrder],n=t.config.visibleButtons,r=o.filter(e=>n.includes(e)),[l]=r.splice(i.value,1);r.splice(a,0,l);const c=o.filter(e=>!n.includes(e));t.setButtonOrder([...r,...c]),document.querySelectorAll('.acu-button-card').forEach(e=>e.classList.remove('drop-target')),i.value=null})(e,n),onDragend:c},[(0,m.createCommentVNode)(' ä¸»æŒ‰é’®å›¾æ ‡ '),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)([['fas',e.icon],'btn-icon'])},null,2),(0,m.createCommentVNode)(' å¿…é€‰æ ‡è®° '),'settings'===e.id?((0,m.openBlock)(),(0,m.createElementBlock)('span',Fs)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' é™„å±æŒ‰é’®æŒ‡ç¤ºå™¨/æ·»åŠ æŒ‰é’® '),e.secondaryId?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:1,class:'attachment-indicator',title:'é•¿æŒ‰é™„å±: '+o(e.secondaryId)+' (ç‚¹å‡»ç§»é™¤)',onClick:(0,m.withModifiers)(a=>{return o=e.id,void t.removeButtonGroupSecondary(o);var o},['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',a(e.secondaryId)])},null,2)],8,js)):((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:2,class:'attachment-add-btn',title:'æ·»åŠ é•¿æŒ‰é™„å±',onClick:(0,m.withModifiers)(t=>{return a=e.id,u.value=a,void(s.value=!0);var a},['stop'])},[...f[5]||(f[5]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])],8,Os))],42,Ps))),128))])):((0,m.openBlock)(),(0,m.createElementBlock)('div',Rs,[...f[6]||(f[6]=[(0,m.createElementVNode)('i',{class:'fas fa-exclamation-triangle'},null,-1),(0,m.createElementVNode)('span',null,'è¯·è‡³å°‘ä¿ç•™ä¸€ä¸ªæŒ‰é’®',-1)])]))]),(0,m.createCommentVNode)(' éšè—åŒºï¼šå¯ç”¨æŒ‰é’® '),(0,m.createElementVNode)('div',Hs,[(0,m.createElementVNode)('h4',null,[f[7]||(f[7]=(0,m.createElementVNode)('i',{class:'fas fa-eye-slash'},null,-1)),(0,m.createTextVNode)(' æœªå±•ç¤º ('+(0,m.toDisplayString)(r.value.length)+') ',1)]),r.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ws,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(r.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e.id,class:'acu-btn-hidden-item',title:e.label+' (ç‚¹å‡»æ·»åŠ )',onClick:(0,m.withModifiers)(a=>(e=>{const a=[...t.config.visibleButtons],o=[...t.config.buttonOrder];if(a.includes(e)||(a.push(e),t.setVisibleButtons(a)),!o.includes(e)){const a=o.indexOf('settings');a>=0?o.splice(a,0,e):o.push(e),t.setButtonOrder(o)}})(e.id),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.icon])},null,2)],8,Gs))),128))])):((0,m.openBlock)(),(0,m.createElementBlock)('div',Ys,[...f[8]||(f[8]=[(0,m.createElementVNode)('i',{class:'fas fa-check-circle'},null,-1),(0,m.createElementVNode)('span',null,'æ‰€æœ‰æŒ‰é’®éƒ½å·²å±•ç¤º',-1)])]))]),(0,m.createCommentVNode)(' é™„å±æŒ‰é’®é€‰æ‹©å¼¹çª— '),s.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-attachment-picker-overlay',onClick:(0,m.withModifiers)(d,['self'])},[(0,m.createElementVNode)('div',{class:'acu-attachment-picker',onClick:f[1]||(f[1]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('div',Xs,[f[10]||(f[10]=(0,m.createElementVNode)('h4',null,'é€‰æ‹©é•¿æŒ‰é™„å±æŒ‰é’®',-1)),(0,m.createElementVNode)('button',{class:'btn-close',onClick:(0,m.withModifiers)(d,['stop'])},[...f[9]||(f[9]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])]),(0,m.createElementVNode)('div',qs,[(0,m.createElementVNode)('p',Ks,'é€‰æ‹©ä¸€ä¸ªæŒ‰é’®ä½œä¸º "'+(0,m.toDisplayString)(o(u.value))+'" çš„é•¿æŒ‰é™„å±åŠŸèƒ½ï¼š',1),(0,m.createElementVNode)('div',Js,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(l.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e.id,class:'picker-option',onClick:(0,m.withModifiers)(a=>{return o=e.id,t.addButtonGroup(u.value,o),void d();var o},['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.icon])},null,2),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(e.label),1)],8,Qs))),128))])])])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' æç¤ºä¿¡æ¯ï¼ˆå›ºå®šåœ¨åº•éƒ¨ï¼‰ '),f[11]||(f[11]=(0,m.createElementVNode)('div',{class:'acu-config-hint acu-config-hint-fixed'},[(0,m.createElementVNode)('i',{class:'fas fa-info-circle'}),(0,m.createElementVNode)('span',null,'æ‹–åŠ¨æ’åº Â· ç‚¹å‡»ç§»é™¤ Â· +å·æ·»åŠ é•¿æŒ‰é™„å±')],-1))]))}});d(4503);const eu=(0,Ye.A)(Zs,[['__scopeId','data-v-5b5624ec']]),tu={class:'acu-tab-config-panel'},au={class:'acu-config-section acu-visible-area'},ou=['onClick','onDragstart','onDragover','onDrop'],nu={key:1,class:'tab-type-badge-mini'},ru={key:1,class:'acu-empty-hint'},lu={class:'acu-config-section acu-hidden-area'},iu={key:0,class:'acu-tab-hidden-list'},cu=['title','onClick'],su={class:'tab-name'},uu={key:1,class:'tab-type-badge'},du={key:1,class:'acu-empty-hint'},pu=(0,m.defineComponent)({__name:'TabConfigPanel',setup(e){const t=(0,f.JH)(),a=(0,m.computed)(()=>{const e=t.config.gridColumns;return 0===e?{gridTemplateColumns:'repeat(auto-fill, minmax(90px, 1fr))'}:{gridTemplateColumns:`repeat(${e}, 1fr)`}}),o=(0,k.j_)(),n=(0,w.D)(),r=(0,m.computed)(()=>{const e=[];t.config.showDashboard&&e.push({id:k.H6,name:'ä»ªè¡¨ç›˜',icon:'fas fa-home',type:'dashboard'});const a=n.stagedData;if(a){const t=(0,v.tE)(a);if(t)for(const[a,o]of Object.entries(t)){const t=o.key,n=a.includes('é€‰é¡¹');e.push({id:t,name:a,icon:n?'fas fa-sliders-h':void 0,type:n?'special':'normal'})}}e.some(e=>'normal'===e.type&&(0,v._C)(e.name,e.id))&&e.push({id:k.SC,name:'å…³ç³»å›¾',icon:'fas fa-project-diagram',type:'graph'});return e.some(e=>'special'===e.type)&&e.push({id:k.$9,name:'é€‰é¡¹é¢æ¿',icon:'fas fa-sliders-h',type:'options'}),e}),l=(0,m.computed)(()=>{const e=o.visibleTabs;return e&&0!==e.length?e.map(e=>r.value.find(t=>t.id===e)).filter(e=>void 0!==e):[]}),i=(0,m.computed)(()=>{const e=o.visibleTabs;return e&&0!==e.length?r.value.filter(t=>!e.includes(t.id)):r.value}),c=e=>'dashboard'===e||'graph'===e||'options'===e,s=e=>{switch(e){case'dashboard':return'é¦–é¡µ';case'graph':return'å…³ç³»';case'options':return'èšåˆ';default:return''}},u=(0,m.ref)(null),d=()=>{u.value=null},p=()=>{const e=r.value.map(e=>e.id);o.setVisibleTabs(e)},g=()=>{o.setVisibleTabs([])};return(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',tu,[(0,m.createCommentVNode)(' å±•ç¤ºåŒºï¼šå½“å‰æ˜¾ç¤ºçš„ Tabï¼ˆç½‘æ ¼å¸ƒå±€ï¼Œå¤ç”¨å¯¼èˆªæ æ ·å¼ï¼‰ '),(0,m.createElementVNode)('div',au,[(0,m.createElementVNode)('h4',null,[t[1]||(t[1]=(0,m.createElementVNode)('i',{class:'fas fa-eye'},null,-1)),(0,m.createTextVNode)(' å±•ç¤ºä¸­ ('+(0,m.toDisplayString)(l.value.length)+') ',1),(0,m.createElementVNode)('button',{class:'acu-btn-text acu-btn-reset',onClick:(0,m.withModifiers)(p,['stop'])},[...t[0]||(t[0]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' é‡ç½®',-1)])])]),l.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-tab-visible-grid',style:(0,m.normalizeStyle)(a.value)},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(l.value,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e.id,class:(0,m.normalizeClass)(['acu-nav-btn acu-tab-config-btn',{dragging:u.value===t}]),draggable:'true',title:'ç‚¹å‡»ç§»é™¤ï¼Œæ‹–æ‹½æ’åº',onClick:(0,m.withModifiers)(t=>(e=>{const t=[...o.visibleTabs];if(0===t.length){const t=r.value.map(e=>e.id).filter(t=>t!==e);return void(t.length>0&&o.setVisibleTabs(t))}const a=t.indexOf(e);a>-1&&t.length>1&&(t.splice(a,1),o.setVisibleTabs(t))})(e.id),['stop']),onDragstart:e=>((e,t)=>{u.value=t,e.dataTransfer&&(e.dataTransfer.effectAllowed='move',e.dataTransfer.setData('text/plain',String(t)))})(e,t),onDragover:(0,m.withModifiers)(e=>(e.preventDefault(),void(null!==u.value&&u.value)),['prevent']),onDrop:e=>((e,t)=>{if(e.preventDefault(),null===u.value||u.value===t)return;let a=[...o.visibleTabs];0===a.length&&(a=r.value.map(e=>e.id));const[n]=a.splice(u.value,1);a.splice(t,0,n),o.setVisibleTabs(a),document.querySelectorAll('.acu-tab-config-btn').forEach(e=>e.classList.remove('drop-target')),u.value=null})(e,t),onDragend:d},[e.icon?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(e.icon)},null,2)):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(e.name),1),c(e.type)?((0,m.openBlock)(),(0,m.createElementBlock)('span',nu,(0,m.toDisplayString)(s(e.type)),1)):(0,m.createCommentVNode)('v-if',!0)],42,ou))),128))],4)):((0,m.openBlock)(),(0,m.createElementBlock)('div',ru,[...t[2]||(t[2]=[(0,m.createElementVNode)('i',{class:'fas fa-info-circle'},null,-1),(0,m.createElementVNode)('span',null,'å±•ç¤ºåŒºä¸ºç©ºæ—¶æ˜¾ç¤ºå…¨éƒ¨Tabï¼Œä»ä¸‹æ–¹æ·»åŠ éœ€è¦çš„',-1)])]))]),(0,m.createCommentVNode)(' ä¸å±•ç¤ºåŒºï¼šéšè—çš„ Tab '),(0,m.createElementVNode)('div',lu,[(0,m.createElementVNode)('h4',null,[t[4]||(t[4]=(0,m.createElementVNode)('i',{class:'fas fa-eye-slash'},null,-1)),(0,m.createTextVNode)(' æœªå±•ç¤º ('+(0,m.toDisplayString)(i.value.length)+') ',1),(0,m.createElementVNode)('button',{class:'acu-btn-text acu-btn-clear',title:'å°†å±•ç¤ºåŒºæ‰€æœ‰Tabç§»åˆ°æœªå±•ç¤ºåŒº',onClick:(0,m.withModifiers)(g,['stop'])},[...t[3]||(t[3]=[(0,m.createElementVNode)('i',{class:'fas fa-angle-double-down'},null,-1),(0,m.createTextVNode)(' å…¨éƒ¨ä¸‹ç§» ',-1)])])]),i.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',iu,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(i.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e.id,class:(0,m.normalizeClass)(['acu-tab-hidden-item',{'is-special':c(e.type)}]),title:'æ·»åŠ  '+e.name,onClick:(0,m.withModifiers)(t=>(e=>{const t=[...o.visibleTabs];t.includes(e)||(t.push(e),o.setVisibleTabs(t))})(e.id),['stop'])},[e.icon?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)([e.icon,'tab-icon'])},null,2)):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',su,(0,m.toDisplayString)(e.name),1),c(e.type)?((0,m.openBlock)(),(0,m.createElementBlock)('span',uu,(0,m.toDisplayString)(s(e.type)),1)):(0,m.createCommentVNode)('v-if',!0),t[5]||(t[5]=(0,m.createElementVNode)('i',{class:'fas fa-plus add-icon'},null,-1))],10,cu))),128))])):((0,m.openBlock)(),(0,m.createElementBlock)('div',du,[...t[6]||(t[6]=[(0,m.createElementVNode)('i',{class:'fas fa-check-circle'},null,-1),(0,m.createElementVNode)('span',null,'æ‰€æœ‰è¡¨æ ¼éƒ½å·²å±•ç¤º',-1)])]))]),(0,m.createCommentVNode)(' æç¤ºä¿¡æ¯ï¼ˆå›ºå®šåœ¨åº•éƒ¨ï¼‰ '),t[7]||(t[7]=(0,m.createElementVNode)('div',{class:'acu-config-hint acu-config-hint-fixed'},[(0,m.createElementVNode)('i',{class:'fas fa-info-circle'}),(0,m.createElementVNode)('span',null,'ç‚¹å‡»ç§»é™¤/æ·»åŠ ï¼Œæ‹–æ‹½æ’åº | å±•ç¤ºåŒºä¸ºç©ºæ—¶ä¸»ç•Œé¢æ˜¾ç¤ºå…¨éƒ¨')],-1))]))}});d(2523);const mu=(0,Ye.A)(pu,[['__scopeId','data-v-2b134c50']]);var fu=d(2448);const gu={class:'acu-settings-section'},vu={class:'acu-settings-group'},bu={class:'acu-settings-row'},hu={class:'acu-settings-control'},xu={class:'acu-switch'},yu={key:0,class:'acu-background-config-section'},wu={class:'acu-background-preview-container'},ku={class:'acu-background-actions'},Cu={key:0,class:'acu-settings-row acu-url-input-row'},Nu={class:'acu-settings-row'},Vu={class:'acu-settings-label'},Eu={class:'hint'},Bu={class:'acu-settings-control'},Su={class:'acu-settings-row'},Tu={class:'acu-settings-label'},Du={class:'hint'},Au={class:'acu-settings-control'},zu={class:'acu-settings-row'},Iu={class:'acu-settings-control'},_u={class:'acu-settings-row'},Mu={class:'acu-settings-label'},Uu={class:'hint'},$u={class:'acu-settings-control'},Lu=2097152,Pu=(0,m.defineComponent)({__name:'BackgroundConfigPanel',props:{storageKey:{},modelValue:{}},emits:['update:modelValue'],setup(e,{emit:t}){const a=e,o=(0,g.C)(),n=(0,m.computed)(()=>o.activePresetId||a.storageKey),r=t,l=(0,m.reactive)({...a.modelValue}),i=(0,m.ref)(l.imageUrl||''),c=(0,m.ref)(null),s=(0,m.ref)(!1),u=(0,m.ref)(null),d=(0,m.ref)(!1),p={x:0,y:0},f={x:0,y:0},v=(0,m.ref)(null),b=(0,m.computed)(()=>{if(!l.imageUrl)return{};const e=l.offsetX||0,t=l.offsetY||0,a=(l.scale||100)/100;return{backgroundImage:`url(${l.imageUrl})`,backgroundPosition:'center center',backgroundSize:'auto'===l.size?'100%':l.size,transform:`translate(${e}%, ${t}%) scale(${a})`,transformOrigin:'center center',backgroundRepeat:'no-repeat'}});function h(){r('update:modelValue',{...l})}function x(){h()}function y(e){return'touches'in e?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:e.clientX,y:e.clientY}}function w(e){if(!l.imageUrl)return;d.value=!0;const t=y(e);p.x=t.x,p.y=t.y,f.x=l.offsetX||0,f.y=l.offsetY||0;const a=window.parent.document;a.addEventListener('mousemove',k),a.addEventListener('mouseup',C),a.addEventListener('touchmove',k,{passive:!1}),a.addEventListener('touchend',C)}function k(e){if(!d.value)return;e.preventDefault();const t=y(e),a=u.value;if(!a)return;const o=a.getBoundingClientRect(),n=(t.x-p.x)/o.width*100,r=(t.y-p.y)/o.height*100;l.offsetX=Math.max(-50,Math.min(50,f.x+n)),l.offsetY=Math.max(-50,Math.min(50,f.y+r))}function C(){if(!d.value)return;d.value=!1;const e=window.parent.document;e.removeEventListener('mousemove',k),e.removeEventListener('mouseup',C),e.removeEventListener('touchmove',k),e.removeEventListener('touchend',C),x()}function N(){c.value?.click()}function V(e){const t=e.target,o=t.files?.[0];o&&async function(e){if(!['image/jpeg','image/png','image/gif','image/webp'].includes(e.type))return void alert('ä¸æ”¯æŒçš„å›¾ç‰‡æ ¼å¼ï¼Œè¯·ä½¿ç”¨ jpg/png/gif/webp æ ¼å¼');if(e.size>Lu)return void alert('å›¾ç‰‡å¤§å°è¶…è¿‡é™åˆ¶ï¼ˆæœ€å¤§ 2MBï¼‰');try{const{blob:t,mimeType:o}=await(0,fu.DZ)(e);await(0,fu.saveBackground)(n.value,t,o),n.value!==a.storageKey&&await(0,fu.saveBackground)(a.storageKey,t,o),v.value&&(0,fu.dQ)(v.value);const r=await(0,fu.$H)(n.value);r&&(v.value=r,l.imageUrl=r),l.hasIndexedDBImage=!0,l.externalUrl=void 0,i.value='',h(),console.info('[BackgroundConfigPanel] èƒŒæ™¯å›¾ç‰‡å·²ä¿å­˜åˆ° IndexedDB')}catch(e){console.error('[BackgroundConfigPanel] ä¿å­˜èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',e),alert('ä¿å­˜èƒŒæ™¯å›¾ç‰‡å¤±è´¥')}}(o),t.value=''}async function E(){const e=i.value.trim();if(e&&e!==l.imageUrl){if(e.startsWith('http://')||e.startsWith('https://'))return v.value&&((0,fu.dQ)(v.value),v.value=null),l.imageUrl=e,l.externalUrl=e,l.hasIndexedDBImage=!1,h(),void console.info('[BackgroundConfigPanel] ä½¿ç”¨å¤–éƒ¨ URL:',e);if(e.startsWith('data:'))try{const{blob:t,mimeType:o}=await(0,fu.eO)(e);await(0,fu.saveBackground)(n.value,t,o),n.value!==a.storageKey&&await(0,fu.saveBackground)(a.storageKey,t,o),v.value&&(0,fu.dQ)(v.value);const r=await(0,fu.$H)(n.value);r&&(v.value=r,l.imageUrl=r),l.hasIndexedDBImage=!0,l.externalUrl=void 0,h(),console.info('[BackgroundConfigPanel] data URL å·²ä¿å­˜åˆ° IndexedDB')}catch(e){console.error('[BackgroundConfigPanel] ä¿å­˜ data URL å¤±è´¥:',e),alert('ä¿å­˜å›¾ç‰‡å¤±è´¥')}}}async function B(){v.value&&((0,fu.dQ)(v.value),v.value=null);try{await(0,fu.e$)(n.value)}catch(e){console.warn('[BackgroundConfigPanel] åˆ é™¤èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',e)}l.imageUrl='',l.hasIndexedDBImage=!1,l.externalUrl=void 0,i.value='',h()}return(0,m.watch)(()=>a.modelValue,e=>{Object.assign(l,e),e.externalUrl&&(i.value=e.externalUrl)},{deep:!0}),(0,m.watch)(()=>a.modelValue.imageUrl,e=>{e!==l.imageUrl&&(v.value&&v.value!==e&&((0,fu.dQ)(v.value),v.value=null),l.imageUrl=e||'',e&&e.startsWith('blob:')&&(v.value=e),console.info('[BackgroundConfigPanel] imageUrl å·²åŒæ­¥:',e?'æœ‰å›¾ç‰‡':'æ— å›¾ç‰‡'))}),(0,m.onMounted)(()=>{!async function(){if(l.imageUrl)l.imageUrl.startsWith('blob:')&&(v.value=l.imageUrl);else if(l.externalUrl)l.imageUrl=l.externalUrl,i.value=l.externalUrl;else if(l.hasIndexedDBImage)try{let e=await(0,fu.$H)(n.value);e||n.value===a.storageKey||(e=await(0,fu.$H)(a.storageKey)),e&&(v.value&&(0,fu.dQ)(v.value),v.value=e,l.imageUrl=e)}catch(e){console.warn('[BackgroundConfigPanel] åŠ è½½èƒŒæ™¯å›¾ç‰‡å¤±è´¥:',e)}}()}),(0,m.onBeforeUnmount)(()=>{v.value&&((0,fu.dQ)(v.value),v.value=null)}),(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',gu,[t[18]||(t[18]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-image'}),(0,m.createTextVNode)(' èƒŒæ™¯é…ç½® '),(0,m.createElementVNode)('span',{style:{'font-weight':'400','font-size':'11px',color:'var(--acu-text-sub)','margin-left':'auto'}},' è‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡ ')],-1)),(0,m.createElementVNode)('div',vu,[(0,m.createCommentVNode)(' å¯ç”¨èƒŒæ™¯ '),(0,m.createElementVNode)('div',bu,[t[8]||(t[8]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¯ç”¨èƒŒæ™¯ '),(0,m.createElementVNode)('span',{class:'hint'},'æ˜¾ç¤ºè‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡')],-1)),(0,m.createElementVNode)('div',hu,[(0,m.createElementVNode)('label',xu,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[0]||(t[0]=e=>l.enabled=e),type:'checkbox',onChange:x},null,544),[[m.vModelCheckbox,l.enabled]]),t[7]||(t[7]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])])]),(0,m.createCommentVNode)(' èƒŒæ™¯è¯¦ç»†è®¾ç½® '),l.enabled?((0,m.openBlock)(),(0,m.createElementBlock)('div',yu,[(0,m.createCommentVNode)(' å›¾ç‰‡é¢„è§ˆåŒºåŸŸ - å¯æ‹–åŠ¨å®šä½ '),(0,m.createElementVNode)('div',wu,[(0,m.createElementVNode)('div',{ref_key:'previewRef',ref:u,class:(0,m.normalizeClass)(['acu-background-preview',{dragging:d.value,'has-image':!!l.imageUrl}]),onMousedown:(0,m.withModifiers)(w,['prevent']),onTouchstart:(0,m.withModifiers)(w,['prevent'])},[(0,m.createCommentVNode)(' æœ‰å›¾ç‰‡æ—¶æ˜¾ç¤ºé¢„è§ˆ '),l.imageUrl?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-preview-image',style:(0,m.normalizeStyle)(b.value)},null,4)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ— å›¾ç‰‡æ—¶æ˜¾ç¤ºæç¤º '),t[9]||(t[9]=(0,m.createElementVNode)('div',{class:'acu-no-image-hint'},[(0,m.createElementVNode)('i',{class:'fas fa-image'}),(0,m.createElementVNode)('span',null,'æš‚æ— èƒŒæ™¯å›¾ç‰‡')],-1))],64))],34)]),(0,m.createCommentVNode)(' æ“ä½œæŒ‰é’®è¡Œ '),(0,m.createElementVNode)('div',ku,[(0,m.createElementVNode)('button',{class:'acu-action-btn',onClick:(0,m.withModifiers)(N,['stop'])},[...t[10]||(t[10]=[(0,m.createElementVNode)('i',{class:'fas fa-camera'},null,-1),(0,m.createTextVNode)(' ä¸Šä¼ å›¾ç‰‡ ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-action-btn',onClick:t[1]||(t[1]=(0,m.withModifiers)(e=>s.value=!s.value,['stop']))},[...t[11]||(t[11]=[(0,m.createElementVNode)('i',{class:'fas fa-link'},null,-1),(0,m.createTextVNode)(' ä½¿ç”¨URL ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-danger',onClick:(0,m.withModifiers)(B,['stop'])},[...t[12]||(t[12]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1),(0,m.createTextVNode)(' æ¸…é™¤ ',-1)])]),(0,m.createCommentVNode)(' éšè—çš„æ–‡ä»¶è¾“å…¥ '),(0,m.createElementVNode)('input',{ref_key:'fileInputRef',ref:c,type:'file',accept:'image/jpeg,image/png,image/gif,image/webp',style:{display:'none'},onChange:V},null,544)]),(0,m.createCommentVNode)(' URL è¾“å…¥æ¡†ï¼ˆå¯æŠ˜å ï¼‰ '),s.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',Cu,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[2]||(t[2]=e=>i.value=e),type:'text',placeholder:'è¾“å…¥å›¾ç‰‡ URLï¼ˆhttps://...ï¼‰',class:'acu-background-url-input',onBlur:E,onKeyup:(0,m.withKeys)(E,['enter'])},null,544),[[m.vModelText,i.value]])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' ç¼©æ”¾ '),(0,m.createElementVNode)('div',Nu,[(0,m.createElementVNode)('div',Vu,[t[13]||(t[13]=(0,m.createTextVNode)(' ç¼©æ”¾ ',-1)),(0,m.createElementVNode)('span',Eu,(0,m.toDisplayString)(l.scale)+'%',1)]),(0,m.createElementVNode)('div',Bu,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[3]||(t[3]=e=>l.scale=e),type:'range',min:'50',max:'200',step:'5',onChange:x},null,544),[[m.vModelText,l.scale,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' é€æ˜åº¦ '),(0,m.createElementVNode)('div',Su,[(0,m.createElementVNode)('div',Tu,[t[14]||(t[14]=(0,m.createTextVNode)(' é€æ˜åº¦ ',-1)),(0,m.createElementVNode)('span',Du,(0,m.toDisplayString)(l.opacity)+'%',1)]),(0,m.createElementVNode)('div',Au,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[4]||(t[4]=e=>l.opacity=e),type:'range',min:'0',max:'100',step:'5',onChange:x},null,544),[[m.vModelText,l.opacity,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' å¡«å……æ–¹å¼ '),(0,m.createElementVNode)('div',zu,[t[16]||(t[16]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¡«å……æ–¹å¼ '),(0,m.createElementVNode)('span',{class:'hint'},'å›¾ç‰‡å¦‚ä½•å¡«å……å®¹å™¨')],-1)),(0,m.createElementVNode)('div',Iu,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':t[5]||(t[5]=e=>l.size=e),class:'acu-select',onChange:x},[...t[15]||(t[15]=[(0,m.createElementVNode)('option',{value:'cover'},'è¦†ç›–',-1),(0,m.createElementVNode)('option',{value:'auto'},'è‡ªåŠ¨',-1)])],544),[[m.vModelSelect,l.size]])])]),(0,m.createCommentVNode)(' æ¨¡ç³Šåº¦ '),(0,m.createElementVNode)('div',_u,[(0,m.createElementVNode)('div',Mu,[t[17]||(t[17]=(0,m.createTextVNode)(' æ¨¡ç³Šåº¦ ',-1)),(0,m.createElementVNode)('span',Uu,(0,m.toDisplayString)(l.blur)+'px',1)]),(0,m.createElementVNode)('div',$u,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t[6]||(t[6]=e=>l.blur=e),type:'range',min:'0',max:'20',step:'1',onChange:x},null,544),[[m.vModelText,l.blur,void 0,{number:!0}]])])])])):(0,m.createCommentVNode)('v-if',!0)]))}});d(3671);const Fu=(0,Ye.A)(Pu,[['__scopeId','data-v-acd94642']]),ju={class:'acu-preset-header'},Ou={class:'acu-settings-row'},Ru={class:'acu-settings-label'},Hu={class:'hint'},Wu={class:'acu-settings-control acu-preset-control'},Gu={class:'acu-preset-selected-name'},Yu={class:'acu-preset-dropdown-menu'},Xu={key:0,class:'acu-migrate-hint'},qu=['onClick'],Ku={class:'acu-preset-option-name'},Ju=['onClick'],Qu=['onClick'],Zu={key:2,class:'acu-migrate-hint'},ed={class:'acu-preset-actions'},td={key:0,class:'acu-dimension-toolbar'},ad=['title'],od={key:0,class:'toolbar-badge'},nd=(0,m.defineComponent)({__name:'PresetManagerHeader',props:{presets:{},activePresetId:{},title:{},hint:{},showToolbar:{type:Boolean,default:!1},isMigrating:{type:Boolean,default:!1},selectedCount:{default:0}},emits:['select','restore-default','delete','save','save-as','collapse-all','expand-all','import','export-current','export-all','toggle-migrate','migrate-to'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(!1),r=(0,m.computed)(()=>{if(!a.activePresetId)return'é»˜è®¤é…ç½®';const e=a.presets.find(e=>e.id===a.activePresetId);return e?e.name:'é»˜è®¤é…ç½®'});function l(){n.value=!n.value}function i(e){e.target.closest('.acu-preset-dropdown')||(n.value=!1)}return(0,m.onMounted)(()=>{document.addEventListener('click',i)}),(0,m.onUnmounted)(()=>{document.removeEventListener('click',i)}),(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',ju,[(0,m.createElementVNode)('div',Ou,[(0,m.createElementVNode)('div',Ru,[(0,m.createTextVNode)((0,m.toDisplayString)(e.title||'é¢„è®¾ç®¡ç†')+' ',1),(0,m.createElementVNode)('span',Hu,(0,m.toDisplayString)(e.hint||'ä¿å­˜å’ŒåŠ è½½é…ç½®'),1)]),(0,m.createElementVNode)('div',Wu,[(0,m.createCommentVNode)(' ä¸‹æ‹‰é€‰æ‹©æ¡† '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-preset-dropdown',{open:n.value}])},[(0,m.createElementVNode)('button',{class:'acu-preset-dropdown-btn',onClick:(0,m.withModifiers)(l,['stop'])},[(0,m.createElementVNode)('span',Gu,(0,m.toDisplayString)(r.value),1),a[9]||(a[9]=(0,m.createElementVNode)('i',{class:'fas fa-chevron-down'},null,-1))]),(0,m.withDirectives)((0,m.createElementVNode)('div',Yu,[(0,m.createCommentVNode)(' é»˜è®¤é…ç½® '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-preset-option',{active:!e.activePresetId,'migrate-disabled':e.isMigrating}]),onClick:a[0]||(a[0]=(0,m.withModifiers)(t=>!e.isMigrating&&(o('restore-default'),void(n.value=!1)),['stop']))},[a[10]||(a[10]=(0,m.createElementVNode)('span',{class:'acu-preset-option-name'},'é»˜è®¤é…ç½®',-1)),e.isMigrating?((0,m.openBlock)(),(0,m.createElementBlock)('span',Xu,'ä¸å¯è¿å…¥')):(0,m.createCommentVNode)('v-if',!0)],2),(0,m.createCommentVNode)(' ç”¨æˆ·é¢„è®¾ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.presets,r=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:r.id,class:(0,m.normalizeClass)(['acu-preset-option',{active:e.activePresetId===r.id,'migrate-target':e.isMigrating&&e.activePresetId!==r.id,'migrate-disabled':e.isMigrating&&e.activePresetId===r.id}]),onClick:(0,m.withModifiers)(t=>{return!e.isMigrating&&(a=r.id,o('select',a),void(n.value=!1));var a},['stop'])},[(0,m.createElementVNode)('span',Ku,(0,m.toDisplayString)(r.name),1),(0,m.createCommentVNode)(' æ­£å¸¸æ¨¡å¼ï¼šåˆ é™¤æŒ‰é’® '),e.isMigrating||r.isBuiltin?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-preset-delete-btn',title:'åˆ é™¤',onClick:(0,m.withModifiers)(e=>{return t=r.id,void o('delete',t);var t},['stop'])},[...a[11]||(a[11]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])],8,Ju)),(0,m.createCommentVNode)(' è¿ç§»æ¨¡å¼ï¼šè¿å…¥æŒ‰é’®ï¼ˆæ’é™¤å½“å‰æ¿€æ´»çš„é¢„è®¾ï¼‰ '),e.isMigrating&&e.activePresetId!==r.id?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:1,class:'acu-icon-btn migrate-in',title:'è¿ç§»é€‰ä¸­çš„ç»´åº¦åˆ°æ­¤é¢„è®¾',onClick:(0,m.withModifiers)(e=>t.$emit('migrate-to',r.id),['stop'])},[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-arrow-down'},null,-1)])],8,Qu)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è¿ç§»æ¨¡å¼ï¼šå½“å‰é¢„è®¾æç¤º '),e.isMigrating&&e.activePresetId===r.id?((0,m.openBlock)(),(0,m.createElementBlock)('span',Zu,'å½“å‰')):(0,m.createCommentVNode)('v-if',!0)],10,qu))),128))],512),[[m.vShow,n.value]])],2),(0,m.createCommentVNode)(' æ“ä½œæŒ‰é’®ç»„ '),(0,m.createElementVNode)('div',ed,[(0,m.createCommentVNode)(' å¦å­˜ä¸º '),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'å¦å­˜ä¸ºæ–°é¢„è®¾',onClick:a[1]||(a[1]=(0,m.withModifiers)(e=>t.$emit('save-as'),['stop']))},[...a[13]||(a[13]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])]),(0,m.createCommentVNode)(' ä¿å­˜ '),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'ä¿å­˜å½“å‰é¢„è®¾',onClick:a[2]||(a[2]=(0,m.withModifiers)(e=>t.$emit('save'),['stop']))},[...a[14]||(a[14]=[(0,m.createElementVNode)('i',{class:'fas fa-save'},null,-1)])]),(0,m.createCommentVNode)(' æ’æ§½ï¼šå…è®¸çˆ¶ç»„ä»¶æ·»åŠ é¢å¤–æŒ‰é’® '),(0,m.renderSlot)(t.$slots,'actions')])])]),(0,m.createCommentVNode)(' å·¥å…·æ ï¼ˆå¯é€‰æ˜¾ç¤ºï¼‰ '),e.showToolbar?((0,m.openBlock)(),(0,m.createElementBlock)('div',td,[a[21]||(a[21]=(0,m.createElementVNode)('span',{class:'toolbar-label'},'å·¥å…·',-1)),a[22]||(a[22]=(0,m.createElementVNode)('span',{class:'toolbar-spacer'},null,-1)),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'å…¨éƒ¨æŠ˜å ',onClick:a[3]||(a[3]=(0,m.withModifiers)(e=>t.$emit('collapse-all'),['stop']))},[...a[15]||(a[15]=[(0,m.createElementVNode)('i',{class:'fas fa-compress-alt'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'å…¨éƒ¨å±•å¼€',onClick:a[4]||(a[4]=(0,m.withModifiers)(e=>t.$emit('expand-all'),['stop']))},[...a[16]||(a[16]=[(0,m.createElementVNode)('i',{class:'fas fa-expand-alt'},null,-1)])]),a[23]||(a[23]=(0,m.createElementVNode)('span',{class:'toolbar-divider'},null,-1)),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'å¯¼å…¥é¢„è®¾',onClick:a[5]||(a[5]=(0,m.withModifiers)(e=>t.$emit('import'),['stop']))},[...a[17]||(a[17]=[(0,m.createElementVNode)('i',{class:'fas fa-file-import'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'å¯¼å‡ºå½“å‰é¢„è®¾',onClick:a[6]||(a[6]=(0,m.withModifiers)(e=>t.$emit('export-current'),['stop']))},[...a[18]||(a[18]=[(0,m.createElementVNode)('i',{class:'fas fa-file-export'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'å¤‡ä»½æ‰€æœ‰é¢„è®¾',onClick:a[7]||(a[7]=(0,m.withModifiers)(e=>t.$emit('export-all'),['stop']))},[...a[19]||(a[19]=[(0,m.createElementVNode)('i',{class:'fas fa-archive'},null,-1)])]),a[24]||(a[24]=(0,m.createElementVNode)('span',{class:'toolbar-divider'},null,-1)),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-icon-btn',{active:e.isMigrating}]),title:e.isMigrating?`é€€å‡ºè¿ç§» (å·²é€‰${e.selectedCount}ä¸ª)`:'è¿ç§»æ¨¡å¼',onClick:a[8]||(a[8]=(0,m.withModifiers)(e=>t.$emit('toggle-migrate'),['stop']))},[...a[20]||(a[20]=[(0,m.createElementVNode)('i',{class:'fas fa-exchange-alt'},null,-1)])],10,ad),e.isMigrating?((0,m.openBlock)(),(0,m.createElementBlock)('span',od,(0,m.toDisplayString)(e.selectedCount),1)):(0,m.createCommentVNode)('v-if',!0)])):(0,m.createCommentVNode)('v-if',!0)]))}}),rd={class:'acu-theme-panel'},ld={class:'acu-theme-scroll-content'},id={class:'acu-settings-section'},cd={class:'acu-settings-group'},sd={class:'acu-settings-row'},ud={class:'acu-settings-control'},dd=['value'],pd={class:'acu-settings-section'},md={class:'acu-settings-group'},fd={class:'acu-settings-row'},gd={class:'acu-settings-control acu-color-picker-inline'},vd={class:'acu-settings-row'},bd={class:'acu-settings-control acu-color-picker-inline'},hd={class:'acu-settings-row'},xd={class:'acu-settings-control acu-color-picker-inline'},yd={class:'acu-settings-section'},wd={class:'acu-var-groups-container'},kd=['onClick'],Cd={class:'acu-var-count'},Nd={class:'acu-var-group-body'},Vd={class:'acu-var-line-primary'},Ed={class:'acu-var-label'},Bd={class:'acu-var-color-row'},Sd=['onClick'],Td=['value','onChange'],Dd=['value','onChange'],Ad={class:'acu-var-line-secondary'},zd={class:'acu-var-name'},Id={class:'acu-var-opacity-row'},_d=['value','onInput'],Md={class:'acu-opacity-value'},Ud={class:'acu-settings-section'},$d={class:'acu-settings-group'},Ld={class:'acu-settings-row'},Pd={class:'acu-settings-label'},Fd={class:'hint'},jd={class:'acu-settings-control acu-css-actions'},Od=(0,m.defineComponent)({__name:'ThemePanel',setup(e){const t=(0,g.C)(),a=(0,f.JH)(),o=(0,k.j_)(),n=(0,S.d)();function r(){return t.presets||[]}function l(){return t.activePresetId}function i(){return t.currentThemeVars||{}}function c(){return t.currentHighlight}function s(){return t.customCSS||''}function u(){return t.currentThemeVarOpacities||{}}function d(){return t.getBackgroundConfig()}const p=(0,m.ref)('#d35400'),v=(0,m.ref)('#3498db'),b=(0,m.ref)('#d35400'),h=(0,m.ref)('retro'),x=(0,m.ref)([]),y=(0,m.ref)(''),w=(0,m.ref)();(0,m.computed)(()=>{const e=l();if(!e)return'é»˜è®¤é…ç½®';const t=r().find(t=>t.id===e);return t?.name||'é»˜è®¤é…ç½®'});function C(){p.value=t.manualHighlightColor,v.value=t.aiHighlightColor,b.value=t.titleColor}function N(){var e;e=null,t.activePresetId=e,t.clearThemeVars(),t.clearThemeVarOpacities(),C(),y.value='',t.clearCustomCSS(),n.success('å·²æ¢å¤é»˜è®¤é…ç½®')}function V(e){t.applyPreset(e),C(),y.value=s(),h.value=a.config.theme||'retro',n.success('é¢„è®¾å·²åº”ç”¨')}function E(e){const a=r().find(t=>t.id===e);a&&confirm(`ç¡®å®šè¦åˆ é™¤é¢„è®¾ã€Œ${a.name}ã€å—ï¼Ÿ`)&&(t.deletePreset(e),n.info('é¢„è®¾å·²åˆ é™¤'))}function B(){try{const e=l();if(e){const a=r().find(t=>t.id===e);if(a)return t.saveCurrentToPreset(a.name),void n.success(`é¢„è®¾ã€Œ${a.name}ã€å·²æ›´æ–°`)}T()}catch(e){console.error('ä¿å­˜å¤±è´¥:',e),n.error('ä¿å­˜å¤±è´¥ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°')}}function T(){o.openPresetSaveDialog({presetType:'theme',summaryItems:[],initialName:'',checkDuplicate:e=>r().some(t=>t.name===e)},{onSave:e=>{t.saveCurrentToPreset(e),n.success(`é¢„è®¾ã€Œ${e}ã€å·²ä¿å­˜`)}})}function D(){a.setTheme(h.value),setTimeout(()=>{const e=p.value;p.value=e},100)}function A(){t.setManualHighlightColor('custom',p.value)}function I(){t.setAiHighlightColor('custom',v.value)}function M(){t.setTitleColor('custom',b.value)}function U(e){const t=i();return e.vars.filter(e=>t[e.key]).length}function L(e){return i()[e]||''}function P(e){const t=L(e);return t&&t.startsWith('#')&&(4===t.length||7===t.length)?t:'#888888'}function F(e,a){a.trim()?t.setThemeVar(e,a.trim()):t.removeThemeVar(e)}function j(e){const t=u();return void 0!==t[e]&&100!==t[e]}function O(e){return u()[e]??100}function R(){t.setCustomCSS(y.value)}function H(){confirm('ç¡®å®šè¦æ¸…ç©ºè‡ªå®šä¹‰ CSS å—ï¼Ÿ')&&(y.value='',t.clearCustomCSS())}function W(){const e={type:'acu_theme_config',version:'1.1',timestamp:(new Date).toISOString(),theme:h.value,highlight:c(),themeVars:i(),themeVarOpacities:u(),backgroundConfig:d(),customCSS:s()},t=new Blob([JSON.stringify(e,null,2)],{type:'application/json'}),a=URL.createObjectURL(t),o=document.createElement('a');o.href=a,o.download=`acu-theme-${Date.now()}.json`,o.click(),URL.revokeObjectURL(a),n.success('é…ç½®å·²å¯¼å‡º')}function G(){w.value?.click()}function Y(e){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);if(t){const e=parseInt(t[1]),a=parseInt(t[2]),o=parseInt(t[3]),n=t[4]?parseFloat(t[4]):1,r=e=>{const t=e.toString(16);return 1===t.length?'0'+t:t};return{hex:`#${r(e)}${r(a)}${r(o)}`,opacity:Math.round(100*n)}}if(e.startsWith('#')&&9===e.length){const t=e.slice(0,7),a=e.slice(7,9),o=parseInt(a,16)/255;return{hex:t,opacity:Math.round(100*o)}}return null}function X(){if(!y.value.trim())return void n.info('CSS å†…å®¹ä¸ºç©º');const e={};for(const[t,a]of Object.entries(_t.DR))e[a]=t;const a=y.value.split('\n'),o=[];let r=0;for(const n of a){const a=n.match(/^\s*(--acu-[a-z0-9-]+)\s*:\s*([^;]+);/);if(a){const o=a[1],n=a[2].trim(),l=e[o];if(l){const e=n.replace(/\s*!important\s*$/,'').trim(),a=Y(e);a?(t.setThemeVar(l,a.hex),t.setThemeVarOpacity(l,a.opacity)):(t.setThemeVar(l,e),t.setThemeVarOpacity(l,100)),r++;continue}}o.push(n)}if(r>0){let e=o.join('\n');e=e.replace(/\n\s*\n\s*\n/g,'\n\n').trim(),y.value=e,t.setCustomCSS(e),C(),n.success(`æˆåŠŸæå– ${r} ä¸ªå˜é‡åˆ°æ»‘å—è®¾ç½®`)}else n.info('æœªæ‰¾åˆ°å¯åŒæ­¥çš„ä¸»é¢˜å˜é‡ (æ ¼å¼éœ€ä¸º --acu-xxx: val;)')}function q(e){const o=e.target.files?.[0];if(!o)return;const r=new FileReader;r.onload=e=>{try{const r=e.target?.result;if(o.name.endsWith('.json')){const e=JSON.parse(r);if('acu_theme_config'!==e.type)throw new Error('æ— æ•ˆçš„é…ç½®æ–‡ä»¶æ ¼å¼');if(e.theme&&(h.value=e.theme,a.setTheme(e.theme)),e.highlight){const t=c();t.manualColor=e.highlight.manualColor||'custom',t.manualHex=e.highlight.manualHex,t.aiColor=e.highlight.aiColor||'custom',t.aiHex=e.highlight.aiHex,t.titleColor=e.highlight.titleColor||'custom',t.titleHex=e.highlight.titleHex}if(e.themeVars){const t=i();Object.assign(t,e.themeVars)}if(e.themeVarOpacities){const t=u();Object.assign(t,e.themeVarOpacities)}e.backgroundConfig&&t.setBackgroundConfig(e.backgroundConfig),e.customCSS&&(y.value=e.customCSS,t.setCustomCSS(e.customCSS)),C(),n.success('ä¸»é¢˜é…ç½®å·²å¯¼å…¥')}else y.value=r,t.setCustomCSS(r),n.success('CSS å·²å¯¼å…¥')}catch(e){console.error('[ThemePanel] å¯¼å…¥å¤±è´¥:',e),n.error('å¯¼å…¥å¤±è´¥ï¼šæ— æ•ˆçš„æ–‡ä»¶æ ¼å¼')}},r.readAsText(o),e.target.value=''}return(0,m.onMounted)(async()=>{await t.loadFromStorage(),C(),h.value=a.config.theme||'retro',y.value=s()}),(0,m.watch)(()=>c(),()=>C(),{deep:!0}),(0,m.watch)(()=>a.config.theme,e=>{h.value=e||'retro'}),(e,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',rd,[(0,m.createCommentVNode)(' å›ºå®šåŒºåŸŸï¼šé¢„è®¾ç®¡ç† '),(0,m.createVNode)(nd,{presets:r(),'active-preset-id':l(),title:'é¢„è®¾ç®¡ç†',hint:'ä¿å­˜å’ŒåŠ è½½ä¸»é¢˜é…ç½®',onSelect:V,onRestoreDefault:N,onDelete:E,onSave:B,onSaveAs:T},null,8,['presets','active-preset-id']),(0,m.createCommentVNode)(' å¯æ»šåŠ¨åŒºåŸŸ '),(0,m.createElementVNode)('div',ld,[(0,m.createCommentVNode)(' ä¸»é¢˜é£æ ¼é€‰æ‹© '),(0,m.createElementVNode)('div',id,[a[10]||(a[10]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-palette'}),(0,m.createTextVNode)(' ä¸»é¢˜é£æ ¼ ')],-1)),(0,m.createElementVNode)('div',cd,[(0,m.createElementVNode)('div',sd,[a[9]||(a[9]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ç•Œé¢é…è‰² '),(0,m.createElementVNode)('span',{class:'hint'},'é€‰æ‹©ç•Œé¢é…è‰²æ–¹æ¡ˆ')],-1)),(0,m.createElementVNode)('div',ud,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[0]||(a[0]=e=>h.value=e),class:'acu-select',onChange:D},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)((0,m.unref)(f.zG),e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e.id,value:e.id},(0,m.toDisplayString)(e.name),9,dd))),128))],544),[[m.vModelSelect,h.value]])])])])]),(0,m.createCommentVNode)(' èƒŒæ™¯é…ç½® '),(0,m.createVNode)(Fu,{'storage-key':(0,m.unref)(fu.Aq),'model-value':d(),'onUpdate:modelValue':a[1]||(a[1]=e=>(0,m.unref)(t).setBackgroundConfig(e))},null,8,['storage-key','model-value']),(0,m.createCommentVNode)(' é«˜äº®é¢œè‰²é…ç½® '),(0,m.createElementVNode)('div',pd,[a[14]||(a[14]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-highlighter'}),(0,m.createTextVNode)(' é«˜äº®é¢œè‰² ')],-1)),(0,m.createElementVNode)('div',md,[(0,m.createCommentVNode)(' æ‰‹åŠ¨ä¿®æ”¹é«˜äº®é¢œè‰² '),(0,m.createElementVNode)('div',fd,[a[11]||(a[11]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ‰‹åŠ¨ä¿®æ”¹é«˜äº® '),(0,m.createElementVNode)('span',{class:'hint'},'æ‰‹åŠ¨ç¼–è¾‘å†…å®¹çš„æ ‡è®°é¢œè‰²')],-1)),(0,m.createElementVNode)('div',gd,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>p.value=e),type:'text',class:'acu-color-input',placeholder:'#RRGGBB',onChange:A},null,544),[[m.vModelText,p.value]]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>p.value=e),type:'color',class:'acu-color-swatch',onChange:A},null,544),[[m.vModelText,p.value]])])]),(0,m.createCommentVNode)(' AI å¡«è¡¨é«˜äº®é¢œè‰² '),(0,m.createElementVNode)('div',vd,[a[12]||(a[12]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' AI å¡«è¡¨é«˜äº® '),(0,m.createElementVNode)('span',{class:'hint'},'AI è‡ªåŠ¨å¡«å†™å†…å®¹çš„æ ‡è®°é¢œè‰²')],-1)),(0,m.createElementVNode)('div',bd,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>v.value=e),type:'text',class:'acu-color-input',placeholder:'#RRGGBB',onChange:I},null,544),[[m.vModelText,v.value]]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>v.value=e),type:'color',class:'acu-color-swatch',onChange:I},null,544),[[m.vModelText,v.value]])])]),(0,m.createCommentVNode)(' æ ‡é¢˜é¢œè‰² '),(0,m.createElementVNode)('div',hd,[a[13]||(a[13]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ ‡é¢˜é¢œè‰² '),(0,m.createElementVNode)('span',{class:'hint'},'è¡¨æ ¼æ ‡é¢˜çš„é¢œè‰²')],-1)),(0,m.createElementVNode)('div',xd,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[6]||(a[6]=e=>b.value=e),type:'text',class:'acu-color-input',placeholder:'#RRGGBB',onChange:M},null,544),[[m.vModelText,b.value]]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[7]||(a[7]=e=>b.value=e),type:'color',class:'acu-color-swatch',onChange:M},null,544),[[m.vModelText,b.value]])])])])]),(0,m.createCommentVNode)(' ä¸»é¢˜å˜é‡è‡ªå®šä¹‰ '),(0,m.createElementVNode)('div',yd,[a[16]||(a[16]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-paint-brush'}),(0,m.createTextVNode)(' ä¸»é¢˜å˜é‡è‡ªå®šä¹‰ '),(0,m.createElementVNode)('span',{class:'hint',style:{'margin-left':'auto','font-weight':'normal'}},'è¦†ç›–å½“å‰ä¸»é¢˜çš„ CSS å˜é‡')],-1)),(0,m.createCommentVNode)(' è¿ç»­çš„å¯æŠ˜å ç»„ '),(0,m.createElementVNode)('div',wd,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)((0,m.unref)(_t.j7),(e,o)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['acu-var-group',{first:0===o,last:o===(0,m.unref)(_t.j7).length-1}])},[(0,m.createElementVNode)('div',{class:'acu-var-group-header',onClick:(0,m.withModifiers)(t=>function(e){const t=x.value.indexOf(e);t>-1?x.value.splice(t,1):x.value.push(e)}(e.id),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.icon])},null,2),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(e.name),1),(0,m.createElementVNode)('span',Cd,(0,m.toDisplayString)(U(e))+'/'+(0,m.toDisplayString)(e.vars.length),1),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',x.value.includes(e.id)?'fa-chevron-up':'fa-chevron-down'])},null,2)],8,kd),(0,m.withDirectives)((0,m.createElementVNode)('div',Nd,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.vars,e=>{return(0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.key,class:'acu-var-row acu-var-row-tall'},[(0,m.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šæ ‡ç­¾ + é¢œè‰²æ§ä»¶ '),(0,m.createElementVNode)('div',Vd,[(0,m.createElementVNode)('div',Ed,(0,m.toDisplayString)(e.label),1),(0,m.createElementVNode)('div',Bd,[(o=e.key,i()[o]||j(e.key)?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-var-reset',title:'æ¢å¤é»˜è®¤',onClick:(0,m.withModifiers)(a=>function(e){t.removeThemeVar(e),t.removeThemeVarOpacity(e)}(e.key),['stop'])},[...a[15]||(a[15]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1)])],8,Sd)):(0,m.createCommentVNode)('v-if',!0)),(0,m.createElementVNode)('input',{value:L(e.key),type:'text',class:'acu-color-input',placeholder:'ä½¿ç”¨ä¸»é¢˜é»˜è®¤å€¼',onChange:t=>F(e.key,t.target.value)},null,40,Td),(0,m.createElementVNode)('input',{value:P(e.key),type:'color',class:'acu-color-swatch',onChange:t=>F(e.key,t.target.value)},null,40,Dd)])]),(0,m.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šå˜é‡å + é€æ˜åº¦æ»‘å— '),(0,m.createElementVNode)('div',Ad,[(0,m.createElementVNode)('code',zd,(0,m.toDisplayString)((0,m.unref)(_t.DR)[e.key]),1),(0,m.createElementVNode)('div',Id,[(0,m.createElementVNode)('input',{type:'range',class:'acu-range-input',min:'0',max:'100',value:O(e.key),onInput:a=>function(e,a){t.setThemeVarOpacity(e,a)}(e.key,Number(a.target.value))},null,40,_d),(0,m.createElementVNode)('span',Md,(0,m.toDisplayString)(O(e.key)),1)])])]);var o}),128))],512),[[m.vShow,x.value.includes(e.id)]])],2))),128))])]),(0,m.createCommentVNode)(' è‡ªå®šä¹‰ CSS '),(0,m.createElementVNode)('div',Ud,[a[23]||(a[23]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-code'}),(0,m.createTextVNode)(' è‡ªå®šä¹‰ CSS ')],-1)),(0,m.createElementVNode)('div',$d,[(0,m.createElementVNode)('div',Ld,[(0,m.createElementVNode)('div',Pd,[a[17]||(a[17]=(0,m.createTextVNode)(' CSS ä»£ç  ',-1)),(0,m.createElementVNode)('span',Fd,(0,m.toDisplayString)(y.value.length)+' å­—ç¬¦',1)]),(0,m.createElementVNode)('div',jd,[(0,m.createElementVNode)('button',{class:'acu-tool-btn',onClick:(0,m.withModifiers)(W,['stop'])},[...a[18]||(a[18]=[(0,m.createElementVNode)('i',{class:'fas fa-download'},null,-1),(0,m.createTextVNode)(' å¯¼å‡º ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',onClick:(0,m.withModifiers)(G,['stop'])},[...a[19]||(a[19]=[(0,m.createElementVNode)('i',{class:'fas fa-upload'},null,-1),(0,m.createTextVNode)(' å¯¼å…¥ ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'å°† CSS ä¸­çš„å˜é‡æå–åˆ°æ»‘å—è®¾ç½®ä¸­ï¼Œå¹¶ä» CSS ä¸­ç§»é™¤',onClick:(0,m.withModifiers)(X,['stop'])},[...a[20]||(a[20]=[(0,m.createElementVNode)('i',{class:'fas fa-magic'},null,-1),(0,m.createTextVNode)(' è½¬ä¸ºæ»‘å— ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-tool-btn acu-btn-danger',onClick:(0,m.withModifiers)(H,['stop'])},[...a[21]||(a[21]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1),(0,m.createTextVNode)(' æ¸…ç©º ',-1)])])])]),a[22]||(a[22]=(0,m.createElementVNode)('div',{class:'acu-css-hint'},[(0,m.createElementVNode)('p',null,'å¸¸ç”¨é€‰æ‹©å™¨ï¼š'),(0,m.createElementVNode)('code',null,'.acu-app, .acu-wrapper'),(0,m.createTextVNode)(),(0,m.createElementVNode)('code',null,'.acu-floating-ball'),(0,m.createElementVNode)('code',null,'.acu-data-card')],-1)),(0,m.withDirectives)((0,m.createElementVNode)('textarea',{'onUpdate:modelValue':a[8]||(a[8]=e=>y.value=e),class:'acu-css-editor',placeholder:'/* åœ¨æ­¤è¾“å…¥è‡ªå®šä¹‰ CSS */',rows:'8',onChange:R},null,544),[[m.vModelText,y.value]])])])]),(0,m.createCommentVNode)(' é¢„è®¾ä¿å­˜å¼¹çª—å·²è¿ç§»åˆ°å…¨å±€ App.vue ä¸­ '),(0,m.createCommentVNode)(' éšè—çš„æ–‡ä»¶è¾“å…¥ '),(0,m.createElementVNode)('input',{ref_key:'fileInputRef',ref:w,type:'file',accept:'.json,.css,.txt',style:{display:'none'},onChange:q},null,544)]))}}),Rd={class:'acu-dimension-manager'},Hd=['onClick'],Wd=['onClick'],Gd={class:'header-left'},Yd=['onUpdate:modelValue'],Xd={class:'header-right'},qd=['onUpdate:modelValue'],Kd=['disabled','title','onClick'],Jd={class:'dimension-content'},Qd={class:'tier-list'},Zd={class:'tier-row basic-info'},ep={class:'tier-name-wrapper'},tp=['onUpdate:modelValue'],ap=['onUpdate:modelValue'],op=['onClick'],np={class:'tier-row weight-control'},rp=['onUpdate:modelValue'],lp={class:'acu-badge'},ip={class:'tier-row prompt-editor'},cp=['onUpdate:modelValue'],sp=['onClick'],up={class:'acu-settings-section advanced-settings'},dp={class:'acu-settings-group template-settings-group'},pp={class:'template-shortcuts-row'},mp={class:'template-editor-row'},fp={class:'template-help-row'},gp={class:'acu-wildcard-help'},vp=(0,m.defineComponent)({__name:'DimensionManagerPanel',setup(e){const t=(0,Mt.E)(),a=(0,k.j_)(),o=(0,S.d)(),n=(0,m.ref)({}),r=(0,m.ref)(null),l=(0,m.ref)(null),i=(0,m.ref)(!0),s=(0,m.ref)(!1),u=(0,m.ref)(new Set),d=(0,m.toRef)(t.config,'customTemplate');(0,de.AHd)({element:l,input:d});const p=()=>{i.value=!i.value};function f(e){t.applyPreset(e),o.success('å·²åº”ç”¨ç»´åº¦é¢„è®¾')}function g(){confirm('ç¡®å®šè¦æ¢å¤é»˜è®¤ç»´åº¦é…ç½®å—ï¼Ÿå½“å‰æœªä¿å­˜çš„ä¿®æ”¹å°†ä¸¢å¤±ã€‚')&&(t.restoreDefaultDimensions(),o.success('å·²æ¢å¤é»˜è®¤ç»´åº¦é…ç½®'))}function v(e){const a=t.presets.find(t=>t.id===e);a&&confirm(`ç¡®å®šè¦åˆ é™¤é¢„è®¾ã€Œ${a.name}ã€å—ï¼Ÿ`)&&(t.deletePreset(e),o.info('é¢„è®¾å·²åˆ é™¤'))}function b(){const e=t.activePresetId;if(e){const a=t.presets.find(t=>t.id===e);if(a)return t.saveCurrentToPreset(a.name),void o.success(`é¢„è®¾ã€Œ${a.name}ã€å·²æ›´æ–°`)}h()}function h(){a.openPresetSaveDialog({presetType:'divination',summaryItems:[],initialName:'',checkDuplicate:e=>t.presets.some(t=>t.name===e)},{onSave:e=>{t.saveCurrentToPreset(e),o.success(`é¢„è®¾ã€Œ${e}ã€å·²ä¿å­˜`)}})}function x(){const e=t.activePresetId;if(!e)return void o.warning('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªé¢„è®¾');const a=t.presets.find(t=>t.id===e);if(!a)return;w({type:'acu_divination_presets',version:'1.0',timestamp:(new Date).toISOString(),presets:[a]},`acu-preset-${a.name}-${Date.now()}.json`),o.success(`é¢„è®¾ã€Œ${a.name}ã€å·²å¯¼å‡º`)}function y(){w({type:'acu_divination_presets',version:'1.0',timestamp:(new Date).toISOString(),presets:t.presets},`acu-divination-backup-${Date.now()}.json`),o.success('æ‰€æœ‰é¢„è®¾å·²å¤‡ä»½')}function w(e,t){const a=new Blob([JSON.stringify(e,null,2)],{type:'application/json'}),o=URL.createObjectURL(a),n=document.createElement('a');n.href=o,n.download=t,n.click(),URL.revokeObjectURL(o)}function C(){r.value?.click()}function N(e){const a=e.target.files?.[0];if(!a)return;const n=new FileReader;n.onload=e=>{try{const a=e.target?.result,n=JSON.parse(a);if('acu_divination_presets'===n.type&&Array.isArray(n.presets)){let e=0;n.presets.forEach(a=>{if(t.presets.find(e=>e.id===a.id)){const e=t.presets.findIndex(e=>e.id===a.id);t.presets[e]=a}else t.presets.push(a);e++}),t.saveConfig(),o.success(`æˆåŠŸå¯¼å…¥ ${e} ä¸ªé¢„è®¾`)}else o.error('æ— æ•ˆçš„é¢„è®¾æ–‡ä»¶æ ¼å¼')}catch(e){console.error('å¯¼å…¥å¤±è´¥:',e),o.error('å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ ¼å¼é”™è¯¯')}},n.readAsText(a),e.target.value=''}(0,m.onMounted)(()=>{t.config.customTemplate||(t.config.customTemplate=_e)});function V(){t.config.dimensions.forEach(e=>{n.value[e.id]=!0})}function E(){t.config.dimensions.forEach(e=>{n.value[e.id]=!1})}function B(){s.value=!s.value,s.value?(u.value.clear(),o.info('è¿ç§»æ¨¡å¼ï¼šç‚¹å‡»é€‰ä¸­è¦è¿ç§»çš„ç»´åº¦ï¼Œç„¶åé€‰æ‹©ç›®æ ‡é¢„è®¾')):u.value.clear()}function T(e){if(0===u.value.size)return void o.warning('è¯·å…ˆé€‰ä¸­è¦è¿ç§»çš„ç»´åº¦');const a=t.presets.find(t=>t.id===e);if(!a)return;const n=t.config.dimensions.filter(e=>u.value.has(e.id));t.migrateDimensionsToPreset(n,e),o.success(`å·²è¿ç§» ${n.length} ä¸ªç»´åº¦åˆ°ã€Œ${a.name}ã€`),s.value=!1,u.value.clear()}const D=()=>{const e={id:c(),name:'æ–°ç»´åº¦',enabled:!0,tiers:[{id:c(),name:'é»˜è®¤æ¡£ä½',weight:50,prompt:''}]};t.addDimension(e),n.value[e.id]=!1},A=e=>{const a=t.config.customTemplate||'';t.config.customTemplate=a+e;const o=l.value;o&&setTimeout(()=>{o.focus(),o.scrollTop=o.scrollHeight;const e=t.config.customTemplate.length;o.setSelectionRange(e,e)},0)};return(e,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Rd,[(0,m.createCommentVNode)(' é¢„è®¾ç®¡ç†å¤´éƒ¨ '),(0,m.createVNode)(nd,{presets:(0,m.unref)(t).presets,'active-preset-id':(0,m.unref)(t).activePresetId,'show-toolbar':!0,'is-migrating':s.value,'selected-count':u.value.size,title:'ç»´åº¦é¢„è®¾',hint:'ä¿å­˜å’ŒåŠ è½½ç»´åº¦é…ç½®',onSelect:f,onRestoreDefault:g,onDelete:v,onSave:b,onSaveAs:h,onCollapseAll:V,onExpandAll:E,onImport:C,onExportCurrent:x,onExportAll:y,onToggleMigrate:B,onMigrateTo:T},null,8,['presets','active-preset-id','is-migrating','selected-count']),(0,m.createCommentVNode)(' ç»´åº¦åˆ—è¡¨ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)((0,m.unref)(t).config.dimensions,(e,o)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['acu-settings-section dimension-container',{'is-collapsed':n.value[e.id],'is-selected':s.value&&u.value.has(e.id)}]),onClick:t=>{return s.value?(a=e.id,u.value.has(a)?u.value.delete(a):u.value.add(a),void(u.value=new Set(u.value))):null;var a}},[(0,m.createCommentVNode)(' ç»´åº¦æ ‡é¢˜è¡Œ '),(0,m.createElementVNode)('div',{class:'acu-settings-title dimension-header',onClick:t=>{return!s.value&&(a=e.id,void(n.value[a]=!n.value[a]));var a}},[(0,m.createElementVNode)('div',Gd,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas fa-chevron-right collapse-icon',{'is-expanded':!n.value[e.id]}])},null,2),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t=>e.name=t,class:'acu-input-minimal dimension-name-input',placeholder:'ç»´åº¦åç§°',onClick:a[0]||(a[0]=(0,m.withModifiers)(()=>{},['stop']))},null,8,Yd),[[m.vModelText,e.name]])]),(0,m.createElementVNode)('div',Xd,[(0,m.createElementVNode)('label',{class:'acu-switch',onClick:a[1]||(a[1]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':t=>e.enabled=t,type:'checkbox'},null,8,qd),[[m.vModelCheckbox,e.enabled]]),a[6]||(a[6]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))]),(0,m.createElementVNode)('button',{class:'acu-icon-btn danger',disabled:'luck'===e.id,title:'luck'===e.id?'è¿åŠ¿ç»´åº¦ä¸å¯åˆ é™¤':'åˆ é™¤ç»´åº¦',onClick:(0,m.withModifiers)(e=>{return a=o,void(confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç»´åº¦å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')&&t.removeDimension(a));var a},['stop'])},[...a[7]||(a[7]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1)])],8,Kd)])],8,Wd),(0,m.createCommentVNode)(' æ¡£ä½åˆ—è¡¨ (å±•å¼€åŒºåŸŸ) '),(0,m.withDirectives)((0,m.createElementVNode)('div',Jd,[(0,m.createElementVNode)('div',Qd,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.tiers,(n,r)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:n.id,class:'tier-item'},[(0,m.createCommentVNode)(' ç¬¬ä¸€è¡Œ: åŸºæœ¬ä¿¡æ¯ '),(0,m.createElementVNode)('div',Zd,[(0,m.createElementVNode)('div',ep,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':e=>n.name=e,class:'acu-input-minimal tier-name-input',placeholder:'æ¡£ä½åç§°'},null,8,tp),[[m.vModelText,n.name]]),(0,m.createCommentVNode)(' é¢œè‰²é€‰æ‹©å™¨ (ä»…è¿åŠ¿ç»´åº¦æ˜¾ç¤º) '),'luck'===e.id?(0,m.withDirectives)(((0,m.openBlock)(),(0,m.createElementBlock)('input',{key:0,'onUpdate:modelValue':e=>n.color=e,type:'color',class:'acu-color-picker-mini',title:'æ¡£ä½é¢œè‰²'},null,8,ap)),[[m.vModelText,n.color]]):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createElementVNode)('button',{class:'acu-icon-btn small danger',title:'åˆ é™¤æ¡£ä½',onClick:e=>((e,a)=>{t.config.dimensions[e].tiers.splice(a,1)})(o,r)},[...a[8]||(a[8]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])],8,op)]),(0,m.createCommentVNode)(' ç¬¬äºŒè¡Œ: æƒé‡è°ƒèŠ‚ '),(0,m.createElementVNode)('div',np,[a[9]||(a[9]=(0,m.createElementVNode)('span',{class:'label'},'æƒé‡',-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':e=>n.weight=e,type:'range',min:'0',max:'100',step:'1',class:'acu-range-input'},null,8,rp),[[m.vModelText,n.weight,void 0,{number:!0}]]),(0,m.createElementVNode)('span',lp,(0,m.toDisplayString)(n.weight),1)]),(0,m.createCommentVNode)(' ç¬¬ä¸‰è¡Œ: æç¤ºè¯ '),(0,m.createElementVNode)('div',ip,[(0,m.withDirectives)((0,m.createElementVNode)('textarea',{'onUpdate:modelValue':e=>n.prompt=e,class:'acu-textarea-scrollable compact',placeholder:'åœ¨æ­¤è¾“å…¥è¯¥æ¡£ä½çš„æç¤ºè¯...',rows:'2'},null,8,cp),[[m.vModelText,n.prompt]])])]))),128))]),(0,m.createCommentVNode)(' æ·»åŠ æ¡£ä½æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-btn-dashed full-width',onClick:e=>(e=>{const a={id:c(),name:'æ–°æ¡£ä½',weight:10,prompt:'',color:'#808080'};t.config.dimensions[e].tiers.push(a)})(o)},[...a[10]||(a[10]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1),(0,m.createTextVNode)(' æ·»åŠ æ–°æ¡£ä½ ',-1)])],8,sp)],512),[[m.vShow,!n.value[e.id]]])],10,Hd))),128)),(0,m.createCommentVNode)(' æ–°å»ºç»´åº¦æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-btn-dashed full-width add-dimension-btn',onClick:D},[...a[11]||(a[11]=[(0,m.createElementVNode)('i',{class:'fas fa-layer-group'},null,-1),(0,m.createTextVNode)(' æ–°å»ºç»´åº¦ ',-1)])]),(0,m.createCommentVNode)(' é«˜çº§è®¾ç½®ï¼šè‡ªå®šä¹‰æ¨¡æ¿ '),(0,m.createElementVNode)('div',up,[a[19]||(a[19]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('div',{class:'header-left'},[(0,m.createElementVNode)('i',{class:'fas fa-file-alt'}),(0,m.createTextVNode)(' æç¤ºè¯æ¨¡æ¿ ')])],-1)),(0,m.createElementVNode)('div',dp,[(0,m.createCommentVNode)(' 1. å¿«æ·æŒ‰é’®è¡Œ '),(0,m.createElementVNode)('div',pp,[a[15]||(a[15]=(0,m.createElementVNode)('span',{class:'hint'},'å¿«æ·æ’å…¥:',-1)),(0,m.createElementVNode)('button',{class:'acu-wildcard-btn',onClick:a[2]||(a[2]=e=>A('{{luck}}'))},[...a[12]||(a[12]=[(0,m.createElementVNode)('code',null,(0,m.toDisplayString)('{{luck}}'),-1)])]),(0,m.createElementVNode)('button',{class:'acu-wildcard-btn',onClick:a[3]||(a[3]=e=>A('{{words}}'))},[...a[13]||(a[13]=[(0,m.createElementVNode)('code',null,(0,m.toDisplayString)('{{words}}'),-1)])]),(0,m.createElementVNode)('button',{class:'acu-wildcard-btn',onClick:a[4]||(a[4]=e=>A('{{dimensions}}'))},[...a[14]||(a[14]=[(0,m.createElementVNode)('code',null,(0,m.toDisplayString)('{{dimensions}}'),-1)])])]),(0,m.createCommentVNode)(' 2. æ–‡æœ¬æ¡†è¡Œ '),(0,m.createElementVNode)('div',mp,[(0,m.withDirectives)((0,m.createElementVNode)('textarea',{ref_key:'templateInputRef',ref:l,'onUpdate:modelValue':a[5]||(a[5]=e=>(0,m.unref)(t).config.customTemplate=e),class:'acu-edit-textarea template-textarea',placeholder:'åœ¨æ­¤è¾“å…¥è‡ªå®šä¹‰æ¨¡æ¿...',rows:'6'},null,512),[[m.vModelText,(0,m.unref)(t).config.customTemplate]])]),(0,m.createCommentVNode)(' 3. è¯´æ˜è¡Œ '),(0,m.createElementVNode)('div',fp,[(0,m.createElementVNode)('div',gp,[(0,m.createElementVNode)('div',{class:'acu-help-header',onClick:p},[a[16]||(a[16]=(0,m.createElementVNode)('i',{class:'fas fa-lightbulb'},null,-1)),a[17]||(a[17]=(0,m.createElementVNode)('strong',null,'é€šé…ç¬¦è¯´æ˜',-1)),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',i.value?'fa-chevron-up':'fa-chevron-down'])},null,2)]),(0,m.withDirectives)((0,m.createElementVNode)('ul',null,[...a[18]||(a[18]=[(0,m.createElementVNode)('li',null,[(0,m.createElementVNode)('code',null,(0,m.toDisplayString)('{{luck}}')),(0,m.createTextVNode)(' - è¿åŠ¿ç»“æœï¼ˆå¦‚ï¼šå¤§å‰...ï¼‰ ')],-1),(0,m.createElementVNode)('li',null,[(0,m.createElementVNode)('code',null,(0,m.toDisplayString)('{{words}}')),(0,m.createTextVNode)(' - éšæœºè¯åˆ—è¡¨ï¼ˆå¦‚ï¼šè‹¹æœã€é¦™è•‰ï¼‰ ')],-1),(0,m.createElementVNode)('li',null,[(0,m.createElementVNode)('code',null,(0,m.toDisplayString)('{{dimensions}}')),(0,m.createTextVNode)(' - å…¶ä»–ç»´åº¦ç»“æœæ‹¼æ¥ ')],-1)])],512),[[m.vShow,i.value]])])])])]),(0,m.createCommentVNode)(' éšè—çš„æ–‡ä»¶è¾“å…¥ '),(0,m.createElementVNode)('input',{ref_key:'fileInputRef',ref:r,type:'file',accept:'.json',style:{display:'none'},onChange:N},null,544)]))}});d(8546);const bp=(0,Ye.A)(vp,[['__scopeId','data-v-2a4c34ca']]),hp={class:'mystic-card-back'},xp=['src'],yp='https://i.postimg.cc/rmY9D1fL/wei-xin-tu-pian-20260121220508-79-297.jpg',wp=(0,m.defineComponent)({__name:'CardBack',props:{imageUrl:{default:''}},emits:['load'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.computed)(()=>a.imageUrl&&''!==a.imageUrl.trim()?a.imageUrl:yp);function r(e){const t=e.target;if(t.naturalWidth&&t.naturalHeight){const e=t.naturalWidth/t.naturalHeight;o('load',e)}}function l(e){const t=e.target;t.src!==yp&&(t.src=yp)}return(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',hp,[(0,m.createElementVNode)('img',{src:n.value,alt:'Mystic Tarot Card Back',class:'mystic-card-back__image',onLoad:r,onError:l},null,40,xp),(0,m.createCommentVNode)(' å…‰æ³½é®ç½© '),t[0]||(t[0]=(0,m.createElementVNode)('div',{class:'mystic-card-back__sheen'},null,-1))]))}}),kp={class:'mystic-card-front'},Cp={class:'mystic-card-front__content'},Np={key:0,class:'mystic-card-front__loading'},Vp={class:'mystic-card-front__title'},Ep={class:'mystic-card-front__luck-name'},Bp={key:0,class:'mystic-card-front__dimensions'},Sp={key:1,class:'mystic-card-front__dimensions'},Tp={class:'mystic-card-front__message-box'},Dp={key:0,class:'mystic-card-front__word-list'},Ap=(0,m.defineComponent)({__name:'CardFront',props:{luckName:{},luckColor:{default:'#ffd700'},dimensions:{default:()=>[]},words:{},loading:{type:Boolean,default:!1},peepMode:{type:Boolean,default:!1}},setup(e){const t=e,a=(0,m.computed)(()=>t.peepMode?'???':t.luckName);function o(e){return e?e.split('').map(e=>/[\p{P}\s]/u.test(e)?e:Math.random()<.6?'...':e).join(''):''}const n=(0,m.computed)(()=>t.peepMode?t.words.map(o):t.words);return(t,o)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',kp,[(0,m.createCommentVNode)(' åŸºç¡€çº¹ç†/æ¸å˜ '),o[4]||(o[4]=(0,m.createElementVNode)('div',{class:'mystic-card-front__texture'},null,-1)),(0,m.createCommentVNode)(' åŒå±‚é‡‘è¾¹ '),o[5]||(o[5]=(0,m.createElementVNode)('div',{class:'mystic-card-front__border-outer'},null,-1)),o[6]||(o[6]=(0,m.createElementVNode)('div',{class:'mystic-card-front__border-inner'},null,-1)),(0,m.createCommentVNode)(' Art Nouveau é£æ ¼å››è§’è£…é¥° '),o[7]||(o[7]=(0,m.createElementVNode)('div',{class:'mystic-card-front__corner mystic-card-front__corner--tl'},null,-1)),o[8]||(o[8]=(0,m.createElementVNode)('div',{class:'mystic-card-front__corner mystic-card-front__corner--tr'},null,-1)),o[9]||(o[9]=(0,m.createElementVNode)('div',{class:'mystic-card-front__corner mystic-card-front__corner--bl'},null,-1)),o[10]||(o[10]=(0,m.createElementVNode)('div',{class:'mystic-card-front__corner mystic-card-front__corner--br'},null,-1)),(0,m.createCommentVNode)(' ä¸­å¿ƒå…‰æ™• '),o[11]||(o[11]=(0,m.createElementVNode)('div',{class:'mystic-card-front__glow'},null,-1)),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',Cp,[(0,m.createCommentVNode)(' é¡¶éƒ¨æ˜Ÿæ˜Ÿè£…é¥° '),o[2]||(o[2]=(0,m.createElementVNode)('div',{class:'mystic-card-front__top-icon'},[(0,m.createElementVNode)('svg',{width:'40',height:'40',viewBox:'0 0 24 24',fill:'currentColor'},[(0,m.createElementVNode)('path',{d:'M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z'})])],-1)),(0,m.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),e.loading?((0,m.openBlock)(),(0,m.createElementBlock)('div',Np,[...o[0]||(o[0]=[(0,m.createElementVNode)('div',{class:'mystic-card-front__spinner'},null,-1),(0,m.createElementVNode)('p',{class:'mystic-card-front__loading-text'},'å‘½è¿æ˜¾ç°ä¸­...',-1)])])):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createCommentVNode)(' è¿åŠ¿æ ‡é¢˜ '),(0,m.createElementVNode)('div',Vp,[(0,m.createElementVNode)('h2',Ep,(0,m.toDisplayString)(a.value),1),o[1]||(o[1]=(0,m.createElementVNode)('div',{class:'mystic-card-front__divider'},null,-1))]),(0,m.createCommentVNode)(' ç»´åº¦æ ‡ç­¾ '),!e.peepMode&&e.dimensions.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Bp,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.dimensions,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:t,class:'mystic-card-front__dimension-tag'},(0,m.toDisplayString)(e),1))),128))])):e.peepMode&&e.dimensions.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Sp,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.dimensions,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:t,class:'mystic-card-front__dimension-tag'},' ??? '))),128))])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' ä¸»ä¿¡æ¯åŒº '),(0,m.createElementVNode)('div',Tp,[n.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Dp,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(n.value,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t,class:'mystic-card-front__word-item'},(0,m.toDisplayString)(e),1))),128))])):(0,m.createCommentVNode)('v-if',!0)])],64)),(0,m.createCommentVNode)(' åº•éƒ¨è£…é¥° '),o[3]||(o[3]=(0,m.createElementVNode)('div',{class:'mystic-card-front__bottom-icon'},[(0,m.createElementVNode)('svg',{width:'24',height:'24',viewBox:'0 0 24 24',fill:'currentColor'},[(0,m.createElementVNode)('path',{d:'M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z'})])],-1))])]))}}),zp={class:'card-back'},Ip=['src'],_p='https://i.postimg.cc/j2MPbGv3/IMG-1590.jpg',Mp=(0,m.defineComponent)({__name:'CardBack',props:{imageUrl:{default:''}},emits:['load'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.computed)(()=>a.imageUrl&&''!==a.imageUrl.trim()?a.imageUrl:_p);function r(e){const t=e.target;if(t.naturalWidth&&t.naturalHeight){const e=t.naturalWidth/t.naturalHeight;o('load',e)}}function l(e){const t=e.target;t.src!==_p&&(t.src=_p)}return(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',zp,[(0,m.createElementVNode)('img',{src:n.value,alt:'Tarot Card Back',class:'card-back__image',onLoad:r,onError:l},null,40,Ip),t[0]||(t[0]=(0,m.createElementVNode)('div',{class:'card-back__overlay'},null,-1))]))}}),Up={viewBox:'0 0 100 100',fill:'currentColor'},$p=(0,m.defineComponent)({__name:'CornerOrnament',setup:e=>(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('svg',Up,[...t[0]||(t[0]=[(0,m.createElementVNode)('path',{d:'M0,0 L40,0 C20,0 10,10 10,30 L10,0 Z',opacity:'0.5'},null,-1),(0,m.createElementVNode)('path',{d:'M5,5 L95,5 L95,20 C70,20 20,70 20,95 L5,95 Z'},null,-1),(0,m.createElementVNode)('circle',{cx:'15',cy:'15',r:'3',fill:'#8B5E3C'},null,-1)])]))}),Lp={class:'card-front'},Pp={class:'card-front__content'},Fp={key:0,class:'card-front__dimensions'},jp={key:1,class:'card-front__dimensions'},Op={class:'card-front__keywords'},Rp={class:'card-front__keyword-text'},Hp={wafuku:{id:'wafuku',name:'ç™½å¡”ç½—',description:'ä¼ ç»Ÿæ—¥å¼å¾¡æœ­é£æ ¼ï¼Œç´ é›…æ·¡é»„çº¸è´¨',defaultBackImage:'https://i.postimg.cc/j2MPbGv3/IMG-1590.jpg',CardFront:(0,m.defineComponent)({__name:'CardFront',props:{luckName:{},luckColor:{default:'#4A3728'},dimensions:{default:()=>[]},words:{},peepMode:{type:Boolean,default:!1}},setup(e){const t=e,a=(0,m.computed)(()=>t.peepMode?'???':t.luckName);function o(e){return e?e.split('').map(e=>/[\p{P}\s]/u.test(e)?e:Math.random()<.6?'...':e).join(''):''}const n=(0,m.computed)(()=>t.peepMode?t.words.map(o):t.words);return(t,o)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Lp,[(0,m.createCommentVNode)(' çº¹ç†å±‚ '),o[1]||(o[1]=(0,m.createElementVNode)('div',{class:'card-front__texture'},null,-1)),(0,m.createCommentVNode)(' å†…è¾¹æ¡† '),o[2]||(o[2]=(0,m.createElementVNode)('div',{class:'card-front__border-outer'},null,-1)),o[3]||(o[3]=(0,m.createElementVNode)('div',{class:'card-front__border-inner'},null,-1)),(0,m.createCommentVNode)(' å››è§’è£…é¥° '),(0,m.createVNode)($p,{class:'card-front__corner card-front__corner--tl'}),(0,m.createVNode)($p,{class:'card-front__corner card-front__corner--tr'}),(0,m.createVNode)($p,{class:'card-front__corner card-front__corner--bl'}),(0,m.createVNode)($p,{class:'card-front__corner card-front__corner--br'}),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',Pp,[(0,m.createCommentVNode)(' é¡¶éƒ¨å›¾æ ‡ '),o[0]||(o[0]=(0,m.createStaticVNode)('<div class="card-front__top-icon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"></path><path d="M20 3v4"></path><path d="M22 5h-4"></path><path d="M4 17v2"></path><path d="M5 18H3"></path></svg></div>',1)),(0,m.createCommentVNode)(' è¿åŠ¿åç§° '),(0,m.createElementVNode)('h2',{class:'card-front__luck-name',style:(0,m.normalizeStyle)({color:e.luckColor})},(0,m.toDisplayString)(a.value),5),(0,m.createCommentVNode)(' ç»´åº¦å±•ç¤ºåŒºåŸŸ '),!e.peepMode&&e.dimensions.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Fp,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.dimensions,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t,class:'card-front__dimension-item'},(0,m.toDisplayString)(e),1))),128))])):e.peepMode&&e.dimensions.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',jp,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.dimensions,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t,class:'card-front__dimension-item'},'???'))),128))])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å…³é”®è¯åŒºåŸŸ '),(0,m.createElementVNode)('div',Op,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(n.value,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t,class:'card-front__keyword'},[(0,m.createElementVNode)('span',Rp,(0,m.toDisplayString)(e),1)]))),128))])])]))}}),CardBack:Mp},mystic:{id:'mystic',name:'ç¥ç§˜å¡”ç½—',description:'è¥¿æ–¹å¡”ç½—é£æ ¼ï¼Œæ·±è“åº•é‡‘è£…é¥°',defaultBackImage:'https://i.postimg.cc/rmY9D1fL/wei-xin-tu-pian-20260121220508-79-297.jpg',CardFront:Ap,CardBack:wp}};const Wp={class:'acu-settings-section'},Gp={class:'acu-settings-group'},Yp={class:'acu-settings-group'},Xp={class:'acu-settings-row'},qp={class:'acu-settings-control'},Kp=['value'],Jp={class:'acu-settings-row'},Qp={class:'acu-settings-control'},Zp={class:'acu-settings-row'},em={class:'acu-settings-control'},tm={class:'acu-settings-row'},am={class:'acu-settings-control'},om={class:'acu-image-upload-container'},nm={class:'acu-settings-section','data-section':'word-drawing'},rm={class:'acu-settings-group'},lm={class:'acu-settings-row'},im={class:'acu-settings-control'},cm={class:'acu-settings-row'},sm={class:'acu-settings-control'},um={class:'acu-settings-row'},dm={class:'acu-settings-label'},pm={class:'hint'},mm={class:'acu-settings-control acu-mode-control'},fm={key:0,class:'acu-range-wrapper'},gm={class:'acu-range-value'},vm={key:0,class:'acu-settings-row'},bm={class:'acu-settings-label'},hm={class:'hint'},xm={class:'acu-settings-control'},ym={class:'acu-settings-control'},wm={key:1,style:{padding:'0 16px 16px 16px'}},km=(0,m.defineComponent)({__name:'DivinationPanel',setup(e){const t=(0,m.inject)('settingsNavigation'),a=(0,Mt.E)(),{config:o}=(0,p.storeToRefs)(a),{show:n}=(0,S.d)(),r=(0,m.ref)(!1),l=()=>{r.value=!r.value},i=(0,m.computed)(()=>{const e=(0,v.tu)();if(!e)return[];const t=[];for(const a in e){const o=e[a];o.name&&(o.name.includes('Random')||o.name.includes('éšæœº'))&&t.push({key:o.id||a,label:o.name})}return t}),c=(0,m.computed)({get(){const e=[];return i.value.forEach(t=>{const a=t.key;!1!==o.value.tableSyncConfig?.[a]&&e.push(a)}),e},set(e){o.value.tableSyncConfig||(o.value.tableSyncConfig={}),i.value.forEach(t=>{const a=t.key;e.includes(a)?void 0!==o.value.tableSyncConfig[a]&&delete o.value.tableSyncConfig[a]:o.value.tableSyncConfig[a]=!1})}}),s=(0,m.computed)(()=>Object.values(Hp)),u=(0,m.computed)(()=>{switch(o.value.wordDrawMode){case'perItem':return'æ¯é¡¹å›ºå®šæŠ½å–ï¼Œä¸å—æ€»æ•°é™åˆ¶';case'custom':return'æŒ‰ limit æ§åˆ¶ï¼Œå—æ€»æ•°é™åˆ¶';case'mixed':return'æ‰€æœ‰å¼€å¯é¡¹æ··åˆæŠ½å–';default:return''}}),d=(0,m.ref)(null),f=()=>{d.value?.click()},g=async e=>{const t=e.target;if(t.files&&t.files[0])try{await a.uploadCardBack(t.files[0]),n('å¡èƒŒå›¾ç‰‡ä¸Šä¼ æˆåŠŸ','success')}catch(e){n('ä¸Šä¼ å¤±è´¥','error')}finally{t.value=''}};return(e,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Wp,[a[28]||(a[28]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-star'}),(0,m.createTextVNode)(' æŠ½ç­¾ç³»ç»Ÿè®¾ç½® ')],-1)),(0,m.createCommentVNode)(' åŸºç¡€è®¾ç½® '),(0,m.createElementVNode)('div',Gp,[(0,m.createCommentVNode)(' ç»´åº¦ç®¡ç†å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:a[0]||(a[0]=e=>(0,m.unref)(t).navigateTo('divinationDimensions'))},[...a[13]||(a[13]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ç»´åº¦ç®¡ç† '),(0,m.createElementVNode)('span',{class:'hint'},'é…ç½®è¿åŠ¿ã€æ‰­æ›²åº¦ç­‰ç»´åº¦')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])])]),(0,m.createCommentVNode)(' å¤–è§‚è®¾ç½® '),a[29]||(a[29]=(0,m.createElementVNode)('div',{class:'acu-settings-title',style:{'margin-top':'16px'}},[(0,m.createElementVNode)('i',{class:'fas fa-palette'}),(0,m.createTextVNode)(' å¤–è§‚ä¸è¡Œä¸º ')],-1)),(0,m.createElementVNode)('div',Yp,[(0,m.createCommentVNode)(' å¡é¢ä¸»é¢˜ '),(0,m.createElementVNode)('div',Xp,[a[14]||(a[14]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¡é¢ä¸»é¢˜ '),(0,m.createElementVNode)('span',{class:'hint'},'é€‰æ‹©å¡”ç½—ç‰Œçš„è§†è§‰é£æ ¼')],-1)),(0,m.createElementVNode)('div',qp,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[1]||(a[1]=e=>(0,m.unref)(o).themeId=e),class:'acu-select'},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(s.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e.id,value:e.id},(0,m.toDisplayString)(e.name),9,Kp))),128))],512),[[m.vModelSelect,(0,m.unref)(o).themeId]])])]),(0,m.createCommentVNode)(' ç¿»ç‰Œæ¨¡å¼ '),(0,m.createElementVNode)('div',Jp,[a[16]||(a[16]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ç¿»ç‰Œæ¨¡å¼ '),(0,m.createElementVNode)('span',{class:'hint'},'æ§åˆ¶æŠ½ç­¾æ—¶çš„åŠ¨ç”»è¡¨ç°')],-1)),(0,m.createElementVNode)('div',Qp,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[2]||(a[2]=e=>(0,m.unref)(o).flipMode=e),class:'acu-select'},[...a[15]||(a[15]=[(0,m.createElementVNode)('option',{value:'auto'},'è‡ªåŠ¨ç¿»ç‰Œ',-1),(0,m.createElementVNode)('option',{value:'manual'},'æ‰‹åŠ¨ç‚¹å‡»',-1),(0,m.createElementVNode)('option',{value:'skip'},'è·³è¿‡åŠ¨ç”»',-1)])],512),[[m.vModelSelect,(0,m.unref)(o).flipMode]])])]),(0,m.createCommentVNode)(' å·çœ‹æ¨¡å¼ '),(0,m.createElementVNode)('div',Zp,[a[17]||(a[17]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å·çœ‹æ¨¡å¼ '),(0,m.createElementVNode)('span',{class:'hint'},'æ¨¡ç³Šæ˜¾ç¤ºè¿åŠ¿å’Œå†…å®¹')],-1)),(0,m.createElementVNode)('div',em,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:(0,m.unref)(o).peepMode}]),onClick:a[3]||(a[3]=e=>(0,m.unref)(o).peepMode=!(0,m.unref)(o).peepMode)},null,2)])]),(0,m.createCommentVNode)(' å¡èƒŒå›¾ç‰‡ '),(0,m.createElementVNode)('div',tm,[a[19]||(a[19]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¡èƒŒå›¾ç‰‡ '),(0,m.createElementVNode)('span',{class:'hint'},'è‡ªå®šä¹‰å¡”ç½—ç‰ŒèƒŒé¢å›¾æ¡ˆ')],-1)),(0,m.createElementVNode)('div',am,[(0,m.createElementVNode)('div',om,[(0,m.createCommentVNode)(' URL è¾“å…¥ '),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>(0,m.unref)(o).cardBackImage=e),type:'text',class:'acu-settings-input',placeholder:'è¾“å…¥å›¾ç‰‡ URL'},null,512),[[m.vModelText,(0,m.unref)(o).cardBackImage]]),(0,m.createCommentVNode)(' ä¸Šä¼ æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'ä¸Šä¼ å›¾ç‰‡',onClick:f},[...a[18]||(a[18]=[(0,m.createElementVNode)('i',{class:'fas fa-upload'},null,-1)])]),(0,m.createCommentVNode)(' éšè—çš„æ–‡ä»¶è¾“å…¥ '),(0,m.createElementVNode)('input',{ref_key:'fileInput',ref:d,type:'file',accept:'image/*',class:'acu-hidden-input',onChange:g},null,544)])])])]),(0,m.createCommentVNode)(' æŠ½è¯è®¾ç½® '),(0,m.createElementVNode)('div',nm,[a[27]||(a[27]=(0,m.createElementVNode)('div',{class:'acu-settings-title',style:{'margin-top':'16px'}},[(0,m.createElementVNode)('i',{class:'fas fa-font'}),(0,m.createTextVNode)(' æŠ½è¯è®¾ç½® ')],-1)),(0,m.createElementVNode)('div',rm,[(0,m.createCommentVNode)(' è¡¨æ ¼éšæœºè¯ '),(0,m.createElementVNode)('div',lm,[a[20]||(a[20]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è¡¨æ ¼éšæœºè¯ '),(0,m.createElementVNode)('span',{class:'hint'},'ä»å«"éšæœº"çš„è¡¨æ ¼æŠ½è¯')],-1)),(0,m.createElementVNode)('div',im,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:(0,m.unref)(o).enableTableWords}]),onClick:a[5]||(a[5]=e=>(0,m.unref)(o).enableTableWords=!(0,m.unref)(o).enableTableWords)},null,2)])]),(0,m.createCommentVNode)(' ä¸–ç•Œä¹¦è¯åº“ '),(0,m.createElementVNode)('div',cm,[a[21]||(a[21]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ä¸–ç•Œä¹¦è¯åº“ '),(0,m.createElementVNode)('span',{class:'hint'},'ä»åŒæ­¥çš„ä¸–ç•Œä¹¦æŠ½è¯')],-1)),(0,m.createElementVNode)('div',sm,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:(0,m.unref)(o).enableWordPool}]),onClick:a[6]||(a[6]=e=>(0,m.unref)(o).enableWordPool=!(0,m.unref)(o).enableWordPool)},null,2)])]),(0,m.createCommentVNode)(' æŠ½è¯æ¨¡å¼ï¼ˆä»»ä¸€å¼€å¯æ—¶æ˜¾ç¤ºï¼‰ '),(0,m.unref)(o).enableTableWords||(0,m.unref)(o).enableWordPool?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createElementVNode)('div',um,[(0,m.createElementVNode)('div',dm,[a[22]||(a[22]=(0,m.createTextVNode)(' æŠ½è¯æ¨¡å¼ ',-1)),(0,m.createElementVNode)('span',pm,(0,m.toDisplayString)(u.value),1)]),(0,m.createElementVNode)('div',mm,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[7]||(a[7]=e=>(0,m.unref)(o).wordDrawMode=e),class:'acu-select'},[...a[23]||(a[23]=[(0,m.createElementVNode)('option',{value:'perItem'},'æ¯é¡¹æŠ½ x ä¸ª',-1),(0,m.createElementVNode)('option',{value:'custom'},'è‡ªå®šä¹‰',-1),(0,m.createElementVNode)('option',{value:'mixed'},'æ··æŠ½',-1)])],512),[[m.vModelSelect,(0,m.unref)(o).wordDrawMode]]),(0,m.createCommentVNode)(' perItem æ¨¡å¼ï¼šæ‹–åŠ¨æ¡åœ¨åŒä¸€è¡Œ '),'perItem'===(0,m.unref)(o).wordDrawMode?((0,m.openBlock)(),(0,m.createElementBlock)('div',fm,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[8]||(a[8]=e=>(0,m.unref)(o).wordsPerItem=e),type:'range',min:'1',max:'10',step:'1',class:'acu-inline-range'},null,512),[[m.vModelText,(0,m.unref)(o).wordsPerItem,void 0,{number:!0}]]),(0,m.createElementVNode)('span',gm,(0,m.toDisplayString)((0,m.unref)(o).wordsPerItem),1)])):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createCommentVNode)(' custom/mixed æ¨¡å¼ï¼šæŠ½è¯æ€»æ•°ï¼ˆå•ç‹¬ä¸€è¡Œæ‹–åŠ¨æ¡ 1-20ï¼‰ '),'perItem'!==(0,m.unref)(o).wordDrawMode?((0,m.openBlock)(),(0,m.createElementBlock)('div',vm,[(0,m.createElementVNode)('div',bm,[a[24]||(a[24]=(0,m.createTextVNode)(' æŠ½è¯æ€»æ•° ',-1)),(0,m.createElementVNode)('span',hm,'æœ€å¤šæŠ½å– '+(0,m.toDisplayString)((0,m.unref)(o).drawCount)+' ä¸ªè¯',1)]),(0,m.createElementVNode)('div',xm,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[9]||(a[9]=e=>(0,m.unref)(o).drawCount=e),type:'range',min:'1',max:'20',step:'1'},null,512),[[m.vModelText,(0,m.unref)(o).drawCount,void 0,{number:!0}]])])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è‡ªåŠ¨åŒæ­¥ '),(0,m.createElementVNode)('div',{class:'acu-settings-row',onClick:l},[a[25]||(a[25]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è‡ªåŠ¨åŒæ­¥ '),(0,m.createElementVNode)('span',{class:'hint'},'è¡¨æ ¼å˜åŠ¨æ—¶è‡ªåŠ¨æ›´æ–°ä¸–ç•Œä¹¦')],-1)),(0,m.createElementVNode)('div',ym,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:(0,m.unref)(o).autoSync}]),onClick:a[10]||(a[10]=(0,m.withModifiers)(e=>(0,m.unref)(o).autoSync=!(0,m.unref)(o).autoSync,['stop']))},null,2),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',r.value?'fa-chevron-up':'fa-chevron-down']),style:{'margin-left':'8px','font-size':'12px',color:'var(--acu-text-sub)'}},null,2)])]),(0,m.createCommentVNode)(' åŒæ­¥è¡¨æ ¼åˆ—è¡¨ (å¯æŠ˜å ) '),r.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',wm,[(0,m.createVNode)(za,{modelValue:c.value,'onUpdate:modelValue':a[11]||(a[11]=e=>c.value=e),items:i.value,'empty-text':'æ²¡æœ‰æ‰¾åˆ°åŒ…å«\'éšæœº\'çš„è¡¨æ ¼','footer-template':'å·²å¯ç”¨åŒæ­¥: {selected}/{total} ä¸ªè¡¨æ ¼','empty-hint':'(å°†è‡ªåŠ¨æ‰«ææ–°è¡¨æ ¼)'},null,8,['modelValue','items'])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è¯åº“ç®¡ç†å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:a[12]||(a[12]=e=>(0,m.unref)(t).navigateTo('divinationWordPool'))},[...a[26]||(a[26]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è¯åº“ç®¡ç† '),(0,m.createElementVNode)('span',{class:'hint'},'é…ç½®æ¯é¡¹çš„ limit å’Œå¼€å…³')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])])],64)):(0,m.createCommentVNode)('v-if',!0)])])]))}}),Cm={class:'acu-settings-section'},Nm={class:'acu-settings-group'},Vm={class:'acu-settings-row'},Em={class:'acu-settings-control',style:{width:'100%',display:'flex'}},Bm={key:0,class:'acu-empty-hint',style:{padding:'20px','text-align':'center'}},Sm={key:1,class:'acu-settings-group'},Tm={class:'acu-settings-row'},Dm={class:'acu-settings-label'},Am={style:{display:'flex','align-items':'center',gap:'8px'}},zm={key:0,class:'acu-badge acu-badge-success'},Im={key:1,class:'acu-badge acu-badge-danger'},_m={key:2,class:'acu-badge acu-badge-secondary'},Mm={class:'hint'},Um={class:'acu-settings-control'},$m=['onClick'],Lm=['onClick'],Pm={key:0,style:{padding:'0 16px 16px'}},Fm=['onUpdate:modelValue','onInput'],jm={style:{display:'flex','justify-content':'space-between','margin-top':'8px','font-size':'12px',color:'var(--acu-text-sub)'}},Om=(0,m.defineComponent)({__name:'WordPoolPanel',setup(e){const t=(0,Mt.E)(),a=(0,m.ref)(''),o=(0,m.ref)(null),n=(0,m.ref)({}),r=(0,m.ref)({}),l=(0,m.computed)(()=>{const e=a.value.toLowerCase().trim();return e?t.categories.filter(t=>t.name.toLowerCase().includes(e)||t.words.some(t=>t.toLowerCase().includes(e))):t.categories}),i=(0,X.Q0)(e=>{(async e=>{const a=n.value[e],o=t.categories.find(t=>t.id===e);if(o&&void 0!==a){r.value[e]=!0;try{const e=a.split(/[,ï¼Œã€\n]/).map(e=>e.trim()).filter(e=>e),n={...o,words:e};await t.updateCategory(n)}finally{setTimeout(()=>{r.value[e]=!1},500)}}})(e)},1e3);return(e,c)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',Cm,[c[1]||(c[1]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-book'}),(0,m.createTextVNode)(' éšæœºè¯åº“ç®¡ç† ')],-1)),(0,m.createCommentVNode)(' æœç´¢/è¿‡æ»¤ '),(0,m.createElementVNode)('div',Nm,[(0,m.createElementVNode)('div',Vm,[(0,m.createElementVNode)('div',Em,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':c[0]||(c[0]=e=>a.value=e),type:'text',class:'acu-word-pool-search',placeholder:'æœç´¢è¯åº“åç§°...',style:{flex:'1',width:'100%'}},null,512),[[m.vModelText,a.value]])])])]),(0,m.createCommentVNode)(' è¯åº“åˆ—è¡¨ '),0===l.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Bm,' æš‚æ— è¯åº“æ•°æ® ')):((0,m.openBlock)(),(0,m.createElementBlock)('div',Sm,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(l.value,e=>{return(0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-word-pool-item',style:{'border-bottom':'1px solid var(--acu-border)',padding:'12px 0'}},[(0,m.createCommentVNode)(' å¤´éƒ¨ï¼šåç§°ä¸å¼€å…³ '),(0,m.createElementVNode)('div',Tm,[(0,m.createElementVNode)('div',Dm,[(0,m.createElementVNode)('div',Am,[(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(e.name),1),(0,m.createCommentVNode)(' å€¾å‘å¾½ç«  '),'positive'===e.bias?((0,m.openBlock)(),(0,m.createElementBlock)('span',zm,'å‰')):'negative'===e.bias?((0,m.openBlock)(),(0,m.createElementBlock)('span',Im,'å‡¶')):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å¼ºåˆ¶æŠ½å–æ•°é‡ '),e.limit>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',_m,' å¼ºæŠ½: '+(0,m.toDisplayString)(e.limit),1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createElementVNode)('span',Mm,(0,m.toDisplayString)(e.words.length)+' ä¸ªè¯æ¡',1)]),(0,m.createElementVNode)('div',Um,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:e.enabled}]),onClick:a=>(e=>{const a={...e,enabled:!e.enabled};t.updateCategory(a)})(e)},null,10,$m),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-icon-btn',{active:o.value===e.id}]),style:{'margin-left':'8px'},onClick:a=>(e=>{if(o.value===e)o.value=null;else{o.value=e;const a=t.categories.find(t=>t.id===e);a&&(n.value[e]=a.words.join('\n'))}})(e.id)},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',o.value===e.id?'fa-chevron-up':'fa-chevron-down'])},null,2)],10,Lm)])]),(0,m.createCommentVNode)(' å±•å¼€å†…å®¹ï¼šç¼–è¾‘åŒºåŸŸ '),o.value===e.id?((0,m.openBlock)(),(0,m.createElementBlock)('div',Pm,[(0,m.withDirectives)((0,m.createElementVNode)('textarea',{'onUpdate:modelValue':t=>n.value[e.id]=t,class:'acu-textarea-scrollable',rows:'5',placeholder:'è¾“å…¥è¯æ¡ï¼Œç”¨é€—å·æˆ–æ¢è¡Œåˆ†éš”',onInput:t=>{return a=e.id,void i(a);var a}},null,40,Fm),[[m.vModelText,n.value[e.id]]]),(0,m.createElementVNode)('div',jm,[(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(r.value[e.id]?'ä¿å­˜ä¸­...':'è‡ªåŠ¨ä¿å­˜'),1),(0,m.createElementVNode)('span',null,'å½“å‰è¯æ•°: '+(0,m.toDisplayString)((a=n.value[e.id],a?a.split(/[,ï¼Œã€\n]/).map(e=>e.trim()).filter(e=>e).length:0)),1)])])):(0,m.createCommentVNode)('v-if',!0)]);var a}),128))]))]))}});d(2357);const Rm=(0,Ye.A)(Om,[['__scopeId','data-v-244ae7d6']]),Hm={class:'acu-modal-header'},Wm={class:'acu-modal-title'},Gm={class:'acu-modal-body'},Ym={class:'acu-settings-section'},Xm={class:'acu-settings-group'},qm={class:'acu-settings-row'},Km={class:'acu-settings-control acu-font-control'},Jm=['value'],Qm={class:'acu-settings-row'},Zm={class:'acu-settings-control'},ef={class:'acu-settings-row'},tf={class:'acu-settings-label'},af={class:'hint'},of={class:'acu-settings-control'},nf={class:'acu-settings-row'},rf={class:'acu-settings-label'},lf={class:'hint'},cf={class:'acu-settings-control'},sf={class:'acu-settings-row'},uf={class:'acu-settings-label'},df={class:'hint'},pf={class:'acu-settings-control'},mf={class:'acu-settings-row'},ff={class:'acu-settings-label'},gf={class:'hint'},vf={class:'acu-settings-control'},bf={class:'acu-settings-section'},hf={class:'acu-settings-group'},xf={class:'acu-settings-section'},yf={class:'acu-settings-group'},wf={class:'acu-settings-row'},kf={class:'acu-settings-control'},Cf={class:'acu-settings-row'},Nf={class:'acu-settings-control'},Vf={class:'acu-settings-row'},Ef={class:'acu-settings-control'},Bf={class:'acu-settings-row'},Sf={class:'acu-settings-control'},Tf={key:0,class:'acu-settings-row'},Df={class:'acu-settings-control'},Af={key:1,class:'acu-settings-row'},zf={class:'acu-settings-label'},If={class:'hint'},_f={class:'acu-settings-control'},Mf={class:'acu-settings-row'},Uf={class:'acu-settings-control'},$f={class:'acu-mini-dialog-header'},Lf={class:'acu-mini-dialog-body'},Pf={class:'acu-font-form'},Ff={class:'acu-form-row'},jf={class:'acu-form-row'},Of={class:'acu-mini-dialog-footer'},Rf=['disabled'],Hf={class:'acu-bottom-spacer'},Wf=(0,m.defineComponent)({__name:'SettingsDialog',props:{visible:{type:Boolean}},emits:['update:visible'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(),r=(0,f.JH)(),l=(0,f.MP)(),i=(0,k.j_)(),c=((0,xe.t)(),(0,m.ref)(!1)),s=(0,m.ref)(''),u=(0,m.ref)(''),d=(0,m.ref)('main'),p=(0,m.ref)([]),g=(0,m.ref)({}),v=(0,m.reactive)({...r.config});(0,m.watch)(v,e=>{r.updateConfig(e)},{deep:!0});const b=(0,m.computed)(()=>{if(g.value[d.value])return g.value[d.value];switch(d.value){case'tabConfig':return'è¡¨æ ¼å±•ç¤ºé€‰æ‹©';case'buttonConfig':return'å¯¼èˆªæ æŒ‰é’®é…ç½®';case'ballAppearance':return'æ‚¬æµ®çƒå¤–è§‚';case'themeConfig':return'ä¸»é¢˜ç¾åŒ–ä¸é«˜äº®é…ç½®';case'divination':return'æŠ½ç­¾ç³»ç»Ÿé…ç½®';case'divinationDimensions':return'ç»´åº¦ç®¡ç†';case'divinationWordPool':return'éšæœºè¯åº“ç®¡ç†';default:return'è®¾ç½®'}}),h=(e,t)=>{t&&(g.value[e]=t),p.value.push(d.value),d.value=e},x=()=>{const e=p.value.pop();d.value=e||'main'},y=()=>{p.value=[],d.value='main',g.value={}},w=e=>{h(e)};(0,m.provide)('settingsNavigation',{navigateTo:h,goBack:x});(0,m.watch)(()=>a.visible,e=>{e&&(Object.assign(v,r.config),i.initialSettingsPanel?(y(),h(i.initialSettingsPanel),i.initialSettingsPanel=null):y())}),(0,de.X2F)(n,()=>{N()});const C=()=>{o('update:visible',!1)},N=()=>{o('update:visible',!1)},V=(0,m.computed)(()=>l.allFonts),E=(0,m.computed)(()=>s.value.trim()&&u.value.trim()),B=()=>{if(!E.value)return;const e=s.value.trim(),t=`'${e}', sans-serif`;l.addFont({name:e,fontFamily:t,importUrl:u.value.trim()}),s.value='',u.value='',c.value=!1};return(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'modal'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,m.withModifiers)(N,['self'])},[(0,m.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-settings-modal'},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Hm,[(0,m.createCommentVNode)(' è¿”å›æŒ‰é’®ï¼ˆä»…åœ¨å­é¢æ¿æ—¶æ˜¾ç¤ºï¼‰ '),p.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-modal-back',onClick:(0,m.withModifiers)(x,['stop'])},[...a[25]||(a[25]=[(0,m.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',Wm,(0,m.toDisplayString)(b.value),1),(0,m.createCommentVNode)(' èƒ¶å›Šå¼å®ŒæˆæŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(C,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Gm,[(0,m.createCommentVNode)(' ============ ä¸»è®¾ç½®é¢æ¿ ============ '),'main'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createCommentVNode)(' å¤–è§‚ä¸å¸ƒå±€ï¼ˆåˆå¹¶ï¼‰'),(0,m.createElementVNode)('div',Ym,[a[34]||(a[34]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-palette'}),(0,m.createTextVNode)(' å¤–è§‚ä¸å¸ƒå±€ ')],-1)),(0,m.createElementVNode)('div',Xm,[(0,m.createCommentVNode)(' å­—ä½“é€‰æ‹© '),(0,m.createElementVNode)('div',qm,[a[27]||(a[27]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ˜¾ç¤ºå­—ä½“ '),(0,m.createElementVNode)('span',{class:'hint'},'é€‰æ‹©ç•Œé¢å­—ä½“')],-1)),(0,m.createElementVNode)('div',Km,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[0]||(a[0]=e=>v.fontFamily=e)},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(V.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e.id,value:e.id},(0,m.toDisplayString)(e.name),9,Jm))),128))],512),[[m.vModelSelect,v.fontFamily]]),(0,m.createElementVNode)('button',{class:'acu-add-font-btn',title:'æ·»åŠ è‡ªå®šä¹‰å­—ä½“',onClick:a[1]||(a[1]=(0,m.withModifiers)(e=>c.value=!0,['stop']))},[...a[26]||(a[26]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])])])]),(0,m.createCommentVNode)(' å¸ƒå±€æ¨¡å¼ '),(0,m.createElementVNode)('div',Qm,[a[29]||(a[29]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¸ƒå±€æ¨¡å¼ '),(0,m.createElementVNode)('span',{class:'hint'},'å¡ç‰‡æ’åˆ—æ–¹å‘')],-1)),(0,m.createElementVNode)('div',Zm,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[2]||(a[2]=e=>v.layout=e)},[...a[28]||(a[28]=[(0,m.createElementVNode)('option',{value:'vertical'},'çºµå‘å¸ƒå±€',-1),(0,m.createElementVNode)('option',{value:'horizontal'},'æ¨ªå‘å¸ƒå±€',-1)])],512),[[m.vModelSelect,v.layout]])])]),(0,m.createCommentVNode)(' å­—ä½“å¤§å° '),(0,m.createElementVNode)('div',ef,[(0,m.createElementVNode)('div',tf,[a[30]||(a[30]=(0,m.createTextVNode)(' å­—ä½“å¤§å° ',-1)),(0,m.createElementVNode)('span',af,(0,m.toDisplayString)(v.fontSize)+'px',1)]),(0,m.createElementVNode)('div',of,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>v.fontSize=e),type:'range',min:'12',max:'18',step:'1'},null,512),[[m.vModelText,v.fontSize,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' å¡ç‰‡å®½åº¦ '),(0,m.createElementVNode)('div',nf,[(0,m.createElementVNode)('div',rf,[a[31]||(a[31]=(0,m.createTextVNode)(' å¡ç‰‡å®½åº¦ ',-1)),(0,m.createElementVNode)('span',lf,(0,m.toDisplayString)(v.cardWidth)+'px',1)]),(0,m.createElementVNode)('div',cf,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>v.cardWidth=e),type:'range',min:'200',max:'400',step:'10'},null,512),[[m.vModelText,v.cardWidth,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' è¡¨æ ¼æŒ‰é’®åˆ—æ•° '),(0,m.createElementVNode)('div',sf,[(0,m.createElementVNode)('div',uf,[a[32]||(a[32]=(0,m.createTextVNode)(' è¡¨æ ¼æŒ‰é’®åˆ—æ•° ',-1)),(0,m.createElementVNode)('span',df,(0,m.toDisplayString)(0===v.gridColumns?'è‡ªé€‚åº”':`${v.gridColumns} åˆ—`),1)]),(0,m.createElementVNode)('div',pf,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>v.gridColumns=e),type:'range',min:'0',max:'6',step:'1'},null,512),[[m.vModelText,v.gridColumns,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' æ¯é¡µæ˜¾ç¤ºæ•° '),(0,m.createElementVNode)('div',mf,[(0,m.createElementVNode)('div',ff,[a[33]||(a[33]=(0,m.createTextVNode)(' æ¯é¡µæ˜¾ç¤ºæ¡æ•° ',-1)),(0,m.createElementVNode)('span',gf,(0,m.toDisplayString)(v.itemsPerPage)+' æ¡',1)]),(0,m.createElementVNode)('div',vf,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[6]||(a[6]=e=>v.itemsPerPage=e),type:'range',min:'10',max:'100',step:'10'},null,512),[[m.vModelText,v.itemsPerPage,void 0,{number:!0}]])])])])]),(0,m.createCommentVNode)(' ç•Œé¢é…ç½®å…¥å£ï¼ˆä½¿ç”¨åœ†è§’å®¹å™¨ï¼‰'),(0,m.createElementVNode)('div',bf,[a[40]||(a[40]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-columns'}),(0,m.createTextVNode)(' ç•Œé¢é…ç½® ')],-1)),(0,m.createElementVNode)('div',hf,[(0,m.createCommentVNode)(' ä¸»é¢˜ç¾åŒ–ä¸é«˜äº®é…ç½®å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:a[7]||(a[7]=e=>w('themeConfig'))},[...a[35]||(a[35]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ä¸»é¢˜ç¾åŒ–ä¸é«˜äº®é…ç½® '),(0,m.createElementVNode)('span',{class:'hint'},'è‡ªå®šä¹‰ä¸»é¢˜å˜é‡ã€é«˜äº®é¢œè‰²ã€CSS')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])]),(0,m.createCommentVNode)(' æ‚¬æµ®çƒå¤–è§‚é…ç½®å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:a[8]||(a[8]=e=>w('ballAppearance'))},[...a[36]||(a[36]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ‚¬æµ®çƒå¤–è§‚ '),(0,m.createElementVNode)('span',{class:'hint'},'è‡ªå®šä¹‰æ‚¬æµ®çƒæ ·å¼å’ŒAIå¡«è¡¨é€šçŸ¥åŠ¨ç”»')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])]),(0,m.createCommentVNode)(' è¡¨æ ¼å±•ç¤ºé€‰æ‹©å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:a[9]||(a[9]=e=>w('tabConfig'))},[...a[37]||(a[37]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è¡¨æ ¼è‡ªå®šä¹‰é…ç½® '),(0,m.createElementVNode)('span',{class:'hint'},'é€‰æ‹©è¦æ˜¾ç¤ºçš„è¡¨æ ¼åŠæ’åº')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])]),(0,m.createCommentVNode)(' å¯¼èˆªæ æŒ‰é’®é…ç½®å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:a[10]||(a[10]=e=>w('buttonConfig'))},[...a[38]||(a[38]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¯¼èˆªæ æŒ‰é’®è‡ªå®šä¹‰é…ç½® '),(0,m.createElementVNode)('span',{class:'hint'},'è‡ªå®šä¹‰å¯¼èˆªæ æ˜¾ç¤ºçš„æŒ‰é’®')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])]),(0,m.createCommentVNode)(' æŠ½ç­¾ç³»ç»Ÿé…ç½®å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:a[11]||(a[11]=e=>w('divination'))},[...a[39]||(a[39]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æŠ½ç­¾ç³»ç»Ÿé…ç½® '),(0,m.createElementVNode)('span',{class:'hint'},'é…ç½®è¿åŠ¿ã€ç»´åº¦å’Œéšæœºè¯åº“')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])])])]),(0,m.createCommentVNode)(' è¡Œä¸ºè®¾ç½® '),(0,m.createElementVNode)('div',xf,[a[48]||(a[48]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-sliders-h'}),(0,m.createTextVNode)(' è¡Œä¸º ')],-1)),(0,m.createElementVNode)('div',yf,[(0,m.createCommentVNode)(' æ˜¾ç¤ºåˆ†é¡µ (ç§»é™¤äº†ä»ªè¡¨ç›˜å¼€å…³) '),(0,m.createElementVNode)('div',wf,[a[41]||(a[41]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ˜¾ç¤ºåˆ†é¡µå™¨ '),(0,m.createElementVNode)('span',{class:'hint'},'è¡¨æ ¼åº•éƒ¨åˆ†é¡µæ§ä»¶')],-1)),(0,m.createElementVNode)('div',kf,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:v.showPagination}]),onClick:a[12]||(a[12]=e=>v.showPagination=!v.showPagination)},null,2)])]),(0,m.createCommentVNode)(' é™åˆ¶é•¿æ–‡æœ¬ '),(0,m.createElementVNode)('div',Cf,[a[42]||(a[42]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' é™åˆ¶é•¿æ–‡æœ¬ '),(0,m.createElementVNode)('span',{class:'hint'},'è¶…é•¿å†…å®¹è‡ªåŠ¨æˆªæ–­')],-1)),(0,m.createElementVNode)('div',Nf,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:v.limitLongText}]),onClick:a[13]||(a[13]=e=>v.limitLongText=!v.limitLongText)},null,2)])]),(0,m.createCommentVNode)(' é”å®šé¢æ¿ä½ç½® '),(0,m.createElementVNode)('div',Vf,[a[43]||(a[43]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' é”å®šé¢æ¿ä½ç½® '),(0,m.createElementVNode)('span',{class:'hint'},'ç¦æ­¢æ‹–åŠ¨é¢æ¿')],-1)),(0,m.createElementVNode)('div',Ef,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:v.lockPanel}]),onClick:a[14]||(a[14]=e=>v.lockPanel=!v.lockPanel)},null,2)])]),(0,m.createCommentVNode)(' æ”¶çº³Tabæ  '),(0,m.createElementVNode)('div',Bf,[a[44]||(a[44]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ”¶çº³Tabæ  '),(0,m.createElementVNode)('span',{class:'hint'},'å°†Tabæ æ”¶çº³åˆ°å¯¼èˆªæŒ‰é’®ä¸­')],-1)),(0,m.createElementVNode)('div',Sf,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:v.collapseTabBar}]),onClick:a[15]||(a[15]=e=>v.collapseTabBar=!v.collapseTabBar)},null,2)])]),(0,m.createCommentVNode)(' æ˜¾ç¤ºæ”¶çº³TabæŒ‰é’® (ä»…åœ¨æ”¶çº³Tabæ å¼€å¯æ—¶æ˜¾ç¤º) '),v.collapseTabBar?((0,m.openBlock)(),(0,m.createElementBlock)('div',Tf,[a[45]||(a[45]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ˜¾ç¤ºæ”¶çº³TabæŒ‰é’® '),(0,m.createElementVNode)('span',{class:'hint'},'åœ¨å¯¼èˆªæ æ˜¾ç¤ºæ‰“å¼€Tabæµ®çª—çš„æŒ‰é’®')],-1)),(0,m.createElementVNode)('div',Df,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:!1!==v.showCollapseTabButton}]),onClick:a[16]||(a[16]=e=>v.showCollapseTabButton=!1===v.showCollapseTabButton)},null,2)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' ç§»åŠ¨ç«¯åº•éƒ¨å®‰å…¨åŒºï¼ˆä»…ç§»åŠ¨ç«¯æ˜¾ç¤ºï¼‰ '),(0,m.unref)(i).isMobile?((0,m.openBlock)(),(0,m.createElementBlock)('div',Af,[(0,m.createElementVNode)('div',zf,[a[46]||(a[46]=(0,m.createTextVNode)(' ç§»åŠ¨ç«¯åº•éƒ¨å®‰å…¨åŒº ',-1)),(0,m.createElementVNode)('span',If,(0,m.toDisplayString)(v.mobileSafeAreaBottom??50)+'px',1)]),(0,m.createElementVNode)('div',_f,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[17]||(a[17]=e=>v.mobileSafeAreaBottom=e),type:'range',min:'0',max:'150',step:'10'},null,512),[[m.vModelText,v.mobileSafeAreaBottom,void 0,{number:!0}]])])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' Swipe æ—¶æ¸…é™¤è¡¨æ ¼ '),(0,m.createElementVNode)('div',Mf,[a[47]||(a[47]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' Swipe æ¸…é™¤è¡¨æ ¼ '),(0,m.createElementVNode)('span',{class:'hint'},'é‡ roll æ—¶è‹¥æœ€åä¸€æ¥¼æœ‰è¡¨æ ¼æ•°æ®åˆ™è‡ªåŠ¨æ¸…é™¤')],-1)),(0,m.createElementVNode)('div',Uf,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:v.clearTableOnSwipe}]),onClick:a[18]||(a[18]=e=>v.clearTableOnSwipe=!v.clearTableOnSwipe)},null,2)])])])])],64)):'tabConfig'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' ============ Tab é…ç½®é¢æ¿ ============ '),(0,m.createVNode)(mu)],2112)):'buttonConfig'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' ============ å¯¼èˆªæ æŒ‰é’®é…ç½®é¢æ¿ ============ '),(0,m.createVNode)(eu)],2112)):'ballAppearance'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:3},[(0,m.createCommentVNode)(' ============ æ‚¬æµ®çƒå¤–è§‚é…ç½®é¢æ¿ ============ '),(0,m.createVNode)(Is)],2112)):'themeConfig'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:4},[(0,m.createCommentVNode)(' ============ ä¸»é¢˜ç¾åŒ–ä¸é«˜äº®é…ç½®é¢æ¿ ============ '),(0,m.createVNode)(Od)],2112)):'divination'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:5},[(0,m.createCommentVNode)(' ============ æŠ½ç­¾ç³»ç»Ÿé…ç½®é¢æ¿ ============ '),(0,m.createVNode)(km)],2112)):'divinationDimensions'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:6},[(0,m.createCommentVNode)(' ============ ç»´åº¦ç®¡ç†é¢æ¿ ============ '),(0,m.createVNode)(bp)],2112)):'divinationWordPool'===d.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:7},[(0,m.createCommentVNode)(' ============ è¯åº“ç®¡ç†é¢æ¿ ============ '),(0,m.createVNode)(Rm)],2112)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' ============ æ·»åŠ è‡ªå®šä¹‰å­—ä½“å¼¹çª—ï¼ˆç›´æ¥æ¸²æŸ“ï¼Œä¸ä½¿ç”¨ Teleportï¼‰ ============ '),(0,m.createVNode)(m.Transition,{name:'modal'},{default:(0,m.withCtx)(()=>[c.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-font-dialog-overlay',onClick:a[24]||(a[24]=(0,m.withModifiers)(e=>c.value=!1,['self']))},[(0,m.createElementVNode)('div',{class:'acu-mini-dialog acu-add-font-dialog',onClick:a[23]||(a[23]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('div',$f,[a[50]||(a[50]=(0,m.createElementVNode)('span',null,'æ·»åŠ è‡ªå®šä¹‰å­—ä½“',-1)),(0,m.createElementVNode)('button',{class:'acu-icon-btn',onClick:a[19]||(a[19]=(0,m.withModifiers)(e=>c.value=!1,['stop']))},[...a[49]||(a[49]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])]),(0,m.createElementVNode)('div',Lf,[(0,m.createElementVNode)('div',Pf,[(0,m.createElementVNode)('div',Ff,[a[51]||(a[51]=(0,m.createElementVNode)('label',null,'å­—ä½“åç§°',-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[20]||(a[20]=e=>s.value=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šéœé¹œæ–‡æ¥·'},null,512),[[m.vModelText,s.value]])]),(0,m.createElementVNode)('div',jf,[a[52]||(a[52]=(0,m.createElementVNode)('label',null,'å­—ä½“é“¾æ¥',-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[21]||(a[21]=e=>u.value=e),type:'text',placeholder:'@import URL æˆ– CDN é“¾æ¥'},null,512),[[m.vModelText,u.value]])])])]),(0,m.createElementVNode)('div',Of,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:a[22]||(a[22]=(0,m.withModifiers)(e=>c.value=!1,['stop']))},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',disabled:!E.value,onClick:(0,m.withModifiers)(B,['stop'])},'æ·»åŠ ',8,Rf)])])])):(0,m.createCommentVNode)('v-if',!0)]),_:1}),(0,m.createCommentVNode)(' åº•éƒ¨ç•™ç™½é€‚é…ç§»åŠ¨ç«¯å®‰å…¨åŒº '),(0,m.createElementVNode)('div',Hf,'â€”â€” ACU Visualizer v'+(0,m.toDisplayString)((0,m.unref)(Oc))+' â€”â€”',1)],512)])):(0,m.createCommentVNode)('v-if',!0)]),_:1}))}});d(9843);const Gf=(0,Ye.A)(Wf,[['__scopeId','data-v-79d26fb6']]),Yf={class:'acu-modal acu-crop-dialog'},Xf={class:'acu-modal-header'},qf={class:'acu-modal-title'},Kf={class:'acu-modal-body acu-crop-body'},Jf={class:'acu-crop-preview-wrapper'},Qf={key:0,class:'acu-crop-placeholder'},Zf={class:'acu-crop-controls'},eg={class:'acu-crop-control-row'},tg=['value'],ag={class:'acu-crop-value'},og={class:'acu-crop-control-row'},ng=['value'],rg={class:'acu-crop-value'},lg={class:'acu-crop-control-row'},ig=['value'],cg={class:'acu-crop-value'},sg={key:0,class:'acu-crop-invert-section'},ug={class:'acu-settings-row'},dg={class:'acu-settings-control'},pg={class:'acu-switch'},mg={class:'acu-crop-upload-section'},fg={class:'acu-modal-footer'},gg=(0,m.defineComponent)({__name:'AvatarCropDialog',props:{visible:{type:Boolean,default:!1},imageUrl:{default:''},name:{default:''},initialOffsetX:{default:50},initialOffsetY:{default:50},initialScale:{default:150},initialInvert:{type:Boolean,default:!1},showInvertOption:{type:Boolean,default:!1}},emits:['close','apply','upload'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.ref)(a.initialOffsetX),r=(0,m.ref)(a.initialOffsetY),l=(0,m.ref)(a.initialScale),i=(0,m.ref)(a.initialInvert),c=(0,m.ref)(null),s=(0,m.ref)(null),u=(0,m.ref)(!1),d=(0,m.ref)(0),p=(0,m.ref)(0),f=(0,m.ref)(0),g=(0,m.ref)(0),v=(0,m.computed)(()=>{if(!a.imageUrl)return{};const e={backgroundImage:`url('${a.imageUrl}')`,backgroundPosition:`${n.value}% ${r.value}%`,backgroundSize:`${l.value}%`};return i.value&&a.showInvertOption&&(e.filter='invert(1)'),e});function b(){o('close')}function h(){o('apply',{offsetX:n.value,offsetY:r.value,scale:l.value,invert:a.showInvertOption?i.value:void 0})}function x(){n.value=50,r.value=50,l.value=150,i.value=!1}function y(){c.value?.click()}function w(e){const t=e.target,a=t.files?.[0];a&&o('upload',a),t.value=''}function k(e){if(!a.imageUrl)return;u.value=!0,d.value=e.clientX,p.value=e.clientY,f.value=n.value,g.value=r.value;const t=window.parent?.document||document;t.addEventListener('mousemove',N),t.addEventListener('mouseup',B)}function C(e){if(!a.imageUrl||1!==e.touches.length)return;const t=e.touches[0];u.value=!0,d.value=t.clientX,p.value=t.clientY,f.value=n.value,g.value=r.value;const o=window.parent?.document||document;o.addEventListener('touchmove',V,{passive:!1}),o.addEventListener('touchend',S)}function N(e){if(!u.value)return;E(e.clientX-d.value,e.clientY-p.value)}function V(e){if(!u.value||1!==e.touches.length)return;e.preventDefault();const t=e.touches[0];E(t.clientX-d.value,t.clientY-p.value)}function E(e,t){const a=f.value-e/120*100*.8,o=g.value-t/120*100*.8;n.value=Math.max(0,Math.min(100,Math.round(a))),r.value=Math.max(0,Math.min(100,Math.round(o)))}function B(){u.value=!1;const e=window.parent?.document||document;e.removeEventListener('mousemove',N),e.removeEventListener('mouseup',B)}function S(){u.value=!1;const e=window.parent?.document||document;e.removeEventListener('touchmove',V),e.removeEventListener('touchend',S)}return(0,m.watch)(()=>a.visible,e=>{e&&(n.value=a.initialOffsetX,r.value=a.initialOffsetY,l.value=a.initialScale,i.value=a.initialInvert)}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-crop-modal-overlay',onClick:(0,m.withModifiers)(b,['self'])},[(0,m.createElementVNode)('div',Yf,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Xf,[(0,m.createElementVNode)('span',qf,[a[4]||(a[4]=(0,m.createElementVNode)('i',{class:'fas fa-crop-simple'},null,-1)),(0,m.createTextVNode)(' è°ƒæ•´å¤´åƒ - '+(0,m.toDisplayString)(e.name),1)]),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(b,['stop'])},[...a[5]||(a[5]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])]),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',Kf,[(0,m.createCommentVNode)(' é¢„è§ˆåŒº - æ”¯æŒæ‹–åŠ¨ '),(0,m.createElementVNode)('div',Jf,[(0,m.createElementVNode)('div',{ref_key:'previewRef',ref:s,class:(0,m.normalizeClass)(['acu-crop-preview',{'is-dragging':u.value}]),style:(0,m.normalizeStyle)(v.value),onMousedown:k,onTouchstart:(0,m.withModifiers)(C,['prevent'])},[(0,m.createCommentVNode)(' æ— å›¾ç‰‡æ—¶æ˜¾ç¤ºå ä½ '),e.imageUrl?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('div',Qf,[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-image'},null,-1),(0,m.createElementVNode)('span',null,'æš‚æ— å›¾ç‰‡',-1)])]))],38)]),(0,m.createCommentVNode)(' æ»‘å—æ§åˆ¶ '),(0,m.createElementVNode)('div',Zf,[(0,m.createCommentVNode)(' X åç§» '),(0,m.createElementVNode)('div',eg,[a[7]||(a[7]=(0,m.createElementVNode)('label',{class:'acu-crop-label'},[(0,m.createElementVNode)('i',{class:'fas fa-arrows-left-right'}),(0,m.createTextVNode)(' Xåç§» ')],-1)),(0,m.createElementVNode)('input',{type:'range',class:'acu-crop-slider',min:'0',max:'100',value:n.value,onInput:a[0]||(a[0]=e=>n.value=Number(e.target.value))},null,40,tg),(0,m.createElementVNode)('span',ag,(0,m.toDisplayString)(n.value)+'%',1)]),(0,m.createCommentVNode)(' Y åç§» '),(0,m.createElementVNode)('div',og,[a[8]||(a[8]=(0,m.createElementVNode)('label',{class:'acu-crop-label'},[(0,m.createElementVNode)('i',{class:'fas fa-arrows-up-down'}),(0,m.createTextVNode)(' Yåç§» ')],-1)),(0,m.createElementVNode)('input',{type:'range',class:'acu-crop-slider',min:'0',max:'100',value:r.value,onInput:a[1]||(a[1]=e=>r.value=Number(e.target.value))},null,40,ng),(0,m.createElementVNode)('span',rg,(0,m.toDisplayString)(r.value)+'%',1)]),(0,m.createCommentVNode)(' ç¼©æ”¾ '),(0,m.createElementVNode)('div',lg,[a[9]||(a[9]=(0,m.createElementVNode)('label',{class:'acu-crop-label'},[(0,m.createElementVNode)('i',{class:'fas fa-magnifying-glass-plus'}),(0,m.createTextVNode)(' ç¼©æ”¾ ')],-1)),(0,m.createElementVNode)('input',{type:'range',class:'acu-crop-slider',min:'100',max:'300',value:l.value,onInput:a[2]||(a[2]=e=>l.value=Number(e.target.value))},null,40,ig),(0,m.createElementVNode)('span',cg,(0,m.toDisplayString)(l.value)+'%',1)])]),(0,m.createCommentVNode)(' åè‰²é€‰é¡¹ - ä»…å½“ showInvertOption ä¸º true æ—¶æ˜¾ç¤º '),e.showInvertOption?((0,m.openBlock)(),(0,m.createElementBlock)('div',sg,[(0,m.createElementVNode)('div',ug,[a[11]||(a[11]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createElementVNode)('i',{class:'fas fa-adjust'}),(0,m.createTextVNode)(' åè‰²æ•ˆæœ '),(0,m.createElementVNode)('span',{class:'hint'},'ç™½å˜é»‘/é»‘å˜ç™½')],-1)),(0,m.createElementVNode)('div',dg,[(0,m.createElementVNode)('label',pg,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>i.value=e),type:'checkbox'},null,512),[[m.vModelCheckbox,i.value]]),a[10]||(a[10]=(0,m.createElementVNode)('span',{class:'acu-switch-slider'},null,-1))])])])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' ä¸Šä¼ æ–°å›¾ç‰‡æŒ‰é’® '),(0,m.createElementVNode)('div',mg,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(y,['stop'])},[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-upload'},null,-1),(0,m.createTextVNode)(' ä¸Šä¼ æ–°å›¾ç‰‡ ',-1)])]),(0,m.createElementVNode)('input',{ref_key:'fileInputRef',ref:c,type:'file',accept:'image/*',style:{display:'none'},onChange:w},null,544)])]),(0,m.createCommentVNode)(' åº•éƒ¨æŒ‰é’® '),(0,m.createElementVNode)('div',fg,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(x,['stop'])},'é‡ç½®'),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',onClick:(0,m.withModifiers)(h,['stop'])},'ç¡®å®š')])])])):(0,m.createCommentVNode)('v-if',!0)}}),vg={class:'acu-modal acu-avatar-manager-dialog'},bg={class:'acu-modal-header'},hg={class:'acu-avatar-tab-bar'},xg={class:'acu-avatar-search-bar'},yg=['placeholder'],wg={class:'acu-modal-body acu-avatar-list'},kg={key:0,class:'acu-avatar-loading'},Cg={class:'acu-avatar-empty'},Ng={class:'acu-avatar-items'},Vg=['onClick'],Eg={class:'acu-avatar-column'},Bg=['onClick'],Sg={key:0,class:'acu-avatar-initial'},Tg={key:1,class:'fas fa-camera acu-avatar-camera-hint'},Dg={class:'acu-avatar-info'},Ag={class:'acu-avatar-name-row'},zg={class:'acu-avatar-name-left'},Ig={class:'acu-avatar-name'},_g={key:0,class:'acu-avatar-label-preview'},Mg={class:'acu-avatar-name-right'},Ug=['onClick'],$g={class:'acu-import-dropdown'},Lg=['onClick'],Pg={key:0,class:'acu-dropdown-menu'},Fg=['onClick'],jg=['onClick'],Og=['onClick'],Rg={class:'acu-avatar-url-row'},Hg=['value','onChange','onBlur'],Wg={class:'acu-avatar-alias-row'},Gg=['value','onChange','onBlur'],Yg={class:'acu-avatar-footer'},Xg={class:'acu-footer-left'},qg=['disabled'],Kg={class:'acu-footer-right'},Jg=['disabled'],Qg='acu_graph_config',Zg=(0,m.defineComponent)({__name:'AvatarManagerDialog',props:{visible:{type:Boolean,default:!1},nodes:{default:()=>[]},factions:{default:()=>[]}},emits:['close','update','label-change'],setup(e,{emit:t}){function a(){try{return getVariables({type:'chat'})[Qg]||{}}catch(e){return console.warn('[AvatarManager] è·å–èŠå¤©å˜é‡å¤±è´¥:',e),{}}}function o(e){try{insertOrAssignVariables({[Qg]:e},{type:'chat'})}catch(e){console.warn('[AvatarManager] ä¿å­˜èŠå¤©å˜é‡å¤±è´¥:',e)}}const n=e,r=t,l=(0,ye.o)(),i=(0,S.d)(),c=(0,k.j_)(),s=(0,m.ref)('character'),u=(0,m.ref)(!0),d=(0,m.ref)([]),p=(0,m.ref)([]),f=(0,m.ref)(new Map),g=(0,m.computed)(()=>f.value.size>0),b=(0,m.ref)(''),h=(0,m.ref)(!1),x=(0,m.ref)(new Set),y=(0,m.ref)(null),w=(0,m.ref)(null),C=(0,m.ref)(null),N=(0,m.ref)(null),V=(0,m.ref)(!1),E=(0,m.ref)(null),B=(0,m.computed)(()=>'character'===s.value?d.value:p.value),T=(0,m.computed)(()=>{if(!b.value.trim())return B.value;const e=b.value.toLowerCase().trim();return B.value.filter(t=>!!t.name.toLowerCase().includes(e)||(!!t.aliases.some(t=>t.toLowerCase().includes(e))||!!t.displayLabel?.toLowerCase().includes(e)))}),D=(0,m.computed)(()=>!!l.getSillyTavernCharacterAvatar()),A=(0,m.computed)(()=>!!l.getSillyTavernUserAvatar());async function I(e,t,a,o){const n=await l.getAvatar(t),r=await l.getAvatarUrl(t),i=!!n?.blob;let c=null;i?c='local':n?.url?c='url':r&&l.isPlayerNode(t)?c='auto':'faction'!==a||r?'faction'===a&&r&&(c='auto'):c=null;const s=o[t],u=s?.displayLabel,d=s?.selectedIndices,p=n?.aliases||[];return{id:e,name:t,label:u||t,type:a,avatarUrl:r,url:n?.url,offsetX:n?.offsetX??50,offsetY:n?.offsetY??50,scale:n?.scale??150,labelIndices:d,displayLabel:u,source:c,hasLocalBlob:i,aliases:p,aliasesText:p.join(', ')}}async function M(){u.value=!0;try{const e=[],t=[],o=new Set(n.factions.map(e=>e.name)),r=a().labels||{};for(const t of n.nodes){if(o.has(t.name))continue;const a=await I(t.id,t.name,t.type,r);e.push(a)}for(const e of n.factions){const a=await I(e.id,e.name,'faction',r);t.push(a)}if(f.value.size>0)for(const[a,o]of f.value){const n=e.findIndex(e=>e.name===a);if(-1!==n){const t=e[n];e[n]={...t,offsetX:o.offsetX??t.offsetX,offsetY:o.offsetY??t.offsetY,scale:o.scale??t.scale,url:o.url??t.url,avatarUrl:o.url??t.avatarUrl,source:o.url?'url':t.source,displayLabel:o.displayLabel??t.displayLabel,labelIndices:o.labelIndices??t.labelIndices,label:o.displayLabel??t.label,aliases:o.aliases??t.aliases,aliasesText:o.aliases?o.aliases.join(', '):t.aliasesText}}const r=t.findIndex(e=>e.name===a);if(-1!==r){const e=t[r];t[r]={...e,offsetX:o.offsetX??e.offsetX,offsetY:o.offsetY??e.offsetY,scale:o.scale??e.scale,url:o.url??e.url,avatarUrl:o.url??e.avatarUrl,source:o.url?'url':e.source,displayLabel:o.displayLabel??e.displayLabel,labelIndices:o.labelIndices??e.labelIndices,label:o.displayLabel??e.label,aliases:o.aliases??e.aliases,aliasesText:o.aliases?o.aliases.join(', '):e.aliasesText}}}d.value=e,p.value=t}catch(e){console.error('[AvatarManager] åŠ è½½æ•°æ®å¤±è´¥:',e),i.error('åŠ è½½æ•°æ®å¤±è´¥')}finally{u.value=!1}}function U(e){s.value=e,b.value='',J()}function L(){g.value&&!confirm('æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦å…³é—­å—ï¼Ÿ')||(f.value.clear(),r('close'))}function P(e){if(!e)return'?';if(/^[A-Za-z\s'-]+$/.test(e)&&e.includes(' ')){const t=e.split(' ')[0];return t.length>6?t.slice(0,6):t}return e[e.length-1]}function F(e){switch(e){case'local':return'æœ¬åœ°';case'url':return'URL';case'auto':return'é…’é¦†';default:return''}}function j(e){return e.avatarUrl?{backgroundImage:`url('${e.avatarUrl}')`,backgroundPosition:`${e.offsetX}% ${e.offsetY}%`,backgroundSize:`${e.scale}%`}:{}}function O(){y.value=null}async function R(e){const t=e.target,a=t.files?.[0];if(!a||!C.value)return void(t.value='');const o=C.value;try{const e=await(0,v.bB)(a),t=await(0,v.w4)(e,300,.85),n=await fetch(t),c=await n.blob();await l.saveAvatar({name:o.name,blob:c,offsetX:o.offsetX,offsetY:o.offsetY,scale:o.scale,aliases:[...(0,m.toRaw)(o.aliases)],updatedAt:Date.now()}),await M(),r('update'),i.success('å¤´åƒå·²ä¸Šä¼ ')}catch(e){console.error('[AvatarManager] ä¸Šä¼ å¤±è´¥:',e),alert('ä¸Šä¼ å¤±è´¥')}t.value='',C.value=null}function H(e,t){const a=t.trim();Z(e.name,{url:a||void 0}),ee(e.id,{url:a||void 0,avatarUrl:a||e.avatarUrl,source:a?'url':e.source})}function W(e,t){const a=t.split(/[,ï¼Œã€\s]+/).map(e=>e.trim()).filter(Boolean);Z(e.name,{aliases:a}),ee(e.id,{aliases:a,aliasesText:a.join(', ')})}function G(e){const t=a(),o=t.labels?.[e.name],n={...e,labelIndices:o?.selectedIndices||[],displayLabel:o?.displayLabel,label:o?.displayLabel||e.name};N.value=n,c.openNodeLabelDialog({fullName:n.name,initialIndices:n.labelIndices||[]},{onApply:e=>{const t=e.sort((e,t)=>e-t).map(e=>n.name[e]).join('');!function(e,t){Z(e.name,{displayLabel:t.displayLabel,labelIndices:t.selectedIndices}),ee(e.id,{displayLabel:t.displayLabel,labelIndices:t.selectedIndices,label:t.displayLabel})}(n,{displayLabel:t,selectedIndices:e})},onReset:()=>{!function(e){Z(e.name,{displayLabel:void 0,labelIndices:void 0}),ee(e.id,{displayLabel:void 0,labelIndices:void 0,label:e.name})}(n)}})}function Y(){V.value=!1,E.value=null}function X(e){if(!E.value)return;const t=E.value;Z(t.name,{offsetX:e.offsetX,offsetY:e.offsetY,scale:e.scale}),ee(t.id,{offsetX:e.offsetX,offsetY:e.offsetY,scale:e.scale}),E.value={...t,offsetX:e.offsetX,offsetY:e.offsetY,scale:e.scale},Y()}async function q(e){if(!E.value)return;C.value=E.value;const t=new DataTransfer;t.items.add(e);const a={target:{files:t.files,value:''}};await R(a),Y()}function K(){h.value=!0,x.value.clear()}function J(){h.value=!1,x.value.clear()}async function Q(){if(0===x.value.size)return;const e=B.value.filter(e=>x.value.has(e.id)).map(e=>e.name);if(confirm(`ç¡®å®šè¦åˆ é™¤ ${e.length} ä¸ªå¤´åƒé…ç½®å—ï¼Ÿ\n\nè¿™å°†ä» IndexedDB ä¸­æ°¸ä¹…åˆ é™¤å›¾ç‰‡æ•°æ®ã€‚`))try{await l.deleteAvatars(e);const t=a();if(t.labels){let a=!1;for(const o of e)t.labels[o]&&(delete t.labels[o],a=!0);a&&o(t)}await M(),J(),r('update'),i.success('åˆ é™¤æˆåŠŸ')}catch(e){console.error('[AvatarManager] åˆ é™¤å¤±è´¥:',e),i.error('åˆ é™¤å¤±è´¥')}}function Z(e,t){const a=f.value.get(e)||{};f.value.set(e,{...a,...t})}function ee(e,t){const a=d.value.findIndex(t=>t.id===e);-1!==a&&(d.value[a]={...d.value[a],...t});const o=p.value.findIndex(t=>t.id===e);-1!==o&&(p.value[o]={...p.value[o],...t})}async function te(){if(0!==f.value.size)try{const e=a();e.labels||(e.labels={});let t=!1;for(const[a,o]of f.value)if(void 0===o.displayLabel&&void 0===o.labelIndices||(o.displayLabel?e.labels[a]={displayLabel:o.displayLabel,selectedIndices:o.labelIndices||[]}:void 0===o.displayLabel&&void 0===o.labelIndices&&delete e.labels[a],t=!0),void 0!==o.url||void 0!==o.offsetX||void 0!==o.offsetY||void 0!==o.scale||void 0!==o.aliases){const e=await l.getAvatar(a);let t=[];void 0!==o.aliases?t=[...(0,m.toRaw)(o.aliases)]:e?.aliases&&(t=[...e.aliases]);const n={name:a,blob:e?.blob,url:void 0!==o.url?o.url:e?.url,offsetX:o.offsetX??e?.offsetX??50,offsetY:o.offsetY??e?.offsetY??50,scale:o.scale??e?.scale??150,aliases:t,updatedAt:Date.now()};await l.saveAvatar(n)}t&&o(e),f.value.clear(),i.success('ä¿å­˜æˆåŠŸ'),r('update'),r('label-change')}catch(e){console.error('[AvatarManager] ä¿å­˜å¤±è´¥:',e),i.error('ä¿å­˜å¤±è´¥: '+(e instanceof Error?e.message:String(e)))}}return(0,m.onMounted)(()=>{n.visible&&M()}),(0,m.watch)(()=>n.visible,e=>{e?M():(h.value=!1,x.value.clear(),y.value=null,s.value='character',f.value.clear())}),(0,m.watch)(y,e=>{if(e){const e=()=>{y.value=null,document.removeEventListener('click',e)};setTimeout(()=>{document.addEventListener('click',e)},0)}}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-avatar-manager-overlay',onClick:(0,m.withModifiers)(L,['self'])},[(0,m.createElementVNode)('div',vg,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',bg,[a[4]||(a[4]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},[(0,m.createElementVNode)('i',{class:'fas fa-user-circle'}),(0,m.createTextVNode)(' å¤´åƒç®¡ç† ')],-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(L,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' Tab åˆ‡æ¢æ  '),(0,m.createElementVNode)('div',hg,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-avatar-tab-btn',{active:'character'===s.value}]),onClick:a[0]||(a[0]=(0,m.withModifiers)(e=>U('character'),['stop']))},[...a[5]||(a[5]=[(0,m.createElementVNode)('i',{class:'fas fa-user'},null,-1),(0,m.createTextVNode)(' äººç‰©å¤´åƒ ',-1)])],2),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-avatar-tab-btn',{active:'faction'===s.value}]),onClick:a[1]||(a[1]=(0,m.withModifiers)(e=>U('faction'),['stop']))},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-users'},null,-1),(0,m.createTextVNode)(' åŠ¿åŠ›å¤´åƒ ',-1)])],2)]),(0,m.createCommentVNode)(' æœç´¢æ¡† '),(0,m.createElementVNode)('div',xg,[a[8]||(a[8]=(0,m.createElementVNode)('i',{class:'fas fa-search'},null,-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>b.value=e),type:'text',class:'acu-avatar-search-input',placeholder:'character'===s.value?'æœç´¢è§’è‰²åç§°æˆ–åˆ«å...':'æœç´¢åŠ¿åŠ›åç§°...'},null,8,yg),[[m.vModelText,b.value]]),b.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-search-clear',onClick:a[3]||(a[3]=(0,m.withModifiers)(e=>b.value='',['stop']))},[...a[7]||(a[7]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' å†…å®¹åŒº - å¯æ»šåŠ¨ '),(0,m.createElementVNode)('div',wg,[(0,m.createCommentVNode)(' åŠ è½½ä¸­ '),u.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',kg,[...a[9]||(a[9]=[(0,m.createElementVNode)('i',{class:'fas fa-spinner fa-spin'},null,-1),(0,m.createElementVNode)('span',null,'åŠ è½½ä¸­...',-1)])])):0===T.value.length?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),(0,m.createElementVNode)('div',Cg,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)('character'===s.value?'fas fa-user-slash':'fas fa-users-slash')},null,2),(0,m.createElementVNode)('p',null,(0,m.toDisplayString)(b.value?'æœªæ‰¾åˆ°åŒ¹é…çš„æ•°æ®':'character'===s.value?'æš‚æ— è§’è‰²æ•°æ®':'æš‚æ— åŠ¿åŠ›æ•°æ®'),1)])],2112)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' ç»Ÿä¸€å¤´åƒåˆ—è¡¨ '),(0,m.createElementVNode)('div',Ng,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(T.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['acu-avatar-item',{selected:x.value.has(e.id)}])},[(0,m.createCommentVNode)(' æ‰¹é‡åˆ é™¤é€‰æ‹©æ¡† '),h.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-avatar-checkbox',onClick:(0,m.withModifiers)(t=>function(e){const t=new Set(x.value);t.has(e)?t.delete(e):t.add(e),x.value=t}(e.id),['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(x.value.has(e.id)?'fas fa-check-square':'far fa-square')},null,2)],8,Vg)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' å¤´åƒåŒºï¼šå¤´åƒ + æ¥æºæ ‡ç­¾ '),(0,m.createElementVNode)('div',Eg,[(0,m.createCommentVNode)(' å¤´åƒé¢„è§ˆ '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-avatar-preview',{'has-image':!!e.avatarUrl}]),style:(0,m.normalizeStyle)(j(e)),onClick:(0,m.withModifiers)(t=>function(e){if(!e.avatarUrl)return C.value=e,void w.value?.click();E.value=e,V.value=!0}(e),['stop'])},[e.avatarUrl?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('span',Sg,(0,m.toDisplayString)(e.displayLabel||P(e.name)),1)),e.avatarUrl?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('i',Tg))],14,Bg),(0,m.createCommentVNode)(' æ¥æºæ ‡ç­¾ '),e.source?((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:0,class:(0,m.normalizeClass)(['acu-avatar-source','acu-source-'+e.source])},(0,m.toDisplayString)(F(e.source)),3)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' ä¿¡æ¯åŒº '),(0,m.createElementVNode)('div',Dg,[(0,m.createCommentVNode)(' åç§°è¡Œ '),(0,m.createElementVNode)('div',Ag,[(0,m.createCommentVNode)(' å·¦ä¾§ï¼šå…¨å + æ ‡ç­¾é¢„è§ˆ '),(0,m.createElementVNode)('div',zg,[(0,m.createElementVNode)('span',Ig,(0,m.toDisplayString)(e.name),1),e.displayLabel?((0,m.openBlock)(),(0,m.createElementBlock)('span',_g,'('+(0,m.toDisplayString)(e.displayLabel)+')',1)):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' å³ä¾§ï¼šæŒ‰é’®åŒº '),(0,m.createElementVNode)('div',Mg,[(0,m.createCommentVNode)(' åå­—é…ç½®æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-avatar-name-btn',title:'é…ç½®å¤´åƒæ˜¾ç¤ºåç§°',onClick:(0,m.withModifiers)(t=>G(e),['stop'])},' å§“åæ˜¾ç¤º ',8,Ug),(0,m.createCommentVNode)(' å¯¼å…¥ä¸‹æ‹‰ '),(0,m.createElementVNode)('div',$g,[(0,m.createElementVNode)('button',{class:'acu-avatar-import-btn',title:'å¯¼å…¥å¤´åƒ',onClick:(0,m.withModifiers)(t=>{return a=e.id,void(y.value=y.value===a?null:a);var a},['stop'])},[...a[10]||(a[10]=[(0,m.createTextVNode)(' å¯¼å…¥ ',-1),(0,m.createElementVNode)('i',{class:'fas fa-caret-down'},null,-1)])],8,Lg),y.value===e.id?((0,m.openBlock)(),(0,m.createElementBlock)('div',Pg,[(0,m.createElementVNode)('div',{class:'acu-dropdown-item',onClick:(0,m.withModifiers)(t=>function(e){O(),C.value=e,w.value?.click()}(e),['stop'])},[...a[11]||(a[11]=[(0,m.createElementVNode)('i',{class:'fas fa-upload'},null,-1),(0,m.createTextVNode)(' æœ¬åœ°å¯¼å…¥ ',-1)])],8,Fg),(0,m.createCommentVNode)(' ä»…äººç‰©å¤´åƒæ˜¾ç¤ºé…’é¦†å¯¼å…¥é€‰é¡¹ '),'character'===s.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-dropdown-item',{disabled:!D.value}]),onClick:(0,m.withModifiers)(t=>function(e){O();const t=l.getSillyTavernCharacterAvatar();t?(Z(e.name,{url:t}),ee(e.id,{url:t,avatarUrl:t,source:'url'})):alert('æœªæ‰¾åˆ°è§’è‰²å¡å¤´åƒ')}(e),['stop'])},[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-user-circle'},null,-1),(0,m.createTextVNode)(' è§’è‰²å¡å¤´åƒ ',-1)])],10,jg),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-dropdown-item',{disabled:!A.value}]),onClick:(0,m.withModifiers)(t=>function(e){O();const t=l.getSillyTavernUserAvatar();t?(Z(e.name,{url:t}),ee(e.id,{url:t,avatarUrl:t,source:'url'})):alert('æœªæ‰¾åˆ°ç”¨æˆ·å¤´åƒ')}(e),['stop'])},[...a[13]||(a[13]=[(0,m.createElementVNode)('i',{class:'fas fa-user'},null,-1),(0,m.createTextVNode)(' ç”¨æˆ·å¤´åƒ ',-1)])],10,Og)],64)):(0,m.createCommentVNode)('v-if',!0)])):(0,m.createCommentVNode)('v-if',!0)])])]),(0,m.createCommentVNode)(' URL è¾“å…¥ '),(0,m.createElementVNode)('div',Rg,[a[14]||(a[14]=(0,m.createElementVNode)('span',{class:'acu-url-label'},'URL:',-1)),(0,m.createElementVNode)('input',{type:'text',class:'acu-avatar-url-input',placeholder:'ç²˜è´´å›¾ç‰‡URL...',value:e.url||'',onChange:t=>H(e,t.target.value),onBlur:t=>H(e,t.target.value)},null,40,Hg)]),(0,m.createCommentVNode)(' åˆ«åè¾“å…¥ '),(0,m.createElementVNode)('div',Wg,[a[15]||(a[15]=(0,m.createElementVNode)('span',{class:'acu-alias-label'},'åˆ«å:',-1)),(0,m.createElementVNode)('input',{type:'text',class:'acu-avatar-alias-input',placeholder:'è¾“å…¥åˆ«åï¼Œç”¨é€—å·åˆ†éš”...',value:e.aliasesText||'',onChange:t=>W(e,t.target.value),onBlur:t=>W(e,t.target.value)},null,40,Gg)])])],2))),128))])],2112))]),(0,m.createCommentVNode)(' åº•éƒ¨å›ºå®šæ  '),(0,m.createElementVNode)('div',Yg,[(0,m.createElementVNode)('div',Xg,[h.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(J,['stop'])},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-modal-btn danger',disabled:0===x.value.size,onClick:(0,m.withModifiers)(Q,['stop'])},' åˆ é™¤ ('+(0,m.toDisplayString)(x.value.size)+') ',9,qg)],64)):((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(K,['stop'])},[...a[16]||(a[16]=[(0,m.createElementVNode)('i',{class:'fas fa-trash-alt'},null,-1),(0,m.createTextVNode)(' æ‰¹é‡åˆ é™¤ ',-1)])]))]),(0,m.createElementVNode)('div',Kg,[(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',disabled:!g.value,onClick:(0,m.withModifiers)(te,['stop'])},[...a[17]||(a[17]=[(0,m.createElementVNode)('i',{class:'fas fa-save'},null,-1),(0,m.createTextVNode)(' ä¿å­˜ ',-1)])],8,Jg)])])]),(0,m.createCommentVNode)(' éšè—çš„æ–‡ä»¶è¾“å…¥ '),(0,m.createElementVNode)('input',{ref_key:'fileInputRef',ref:w,type:'file',accept:'image/*',style:{display:'none'},onChange:R},null,544),(0,m.createCommentVNode)(' è£å‰ªå¼¹çª— '),V.value?((0,m.openBlock)(),(0,m.createBlock)(gg,{key:0,visible:V.value,'image-url':E.value?.avatarUrl||'',name:E.value?.name||'','initial-offset-x':E.value?.offsetX??50,'initial-offset-y':E.value?.offsetY??50,'initial-scale':E.value?.scale??150,onClose:Y,onApply:X,onUpload:q},null,8,['visible','image-url','name','initial-offset-x','initial-offset-y','initial-scale'])):(0,m.createCommentVNode)('v-if',!0)])):(0,m.createCommentVNode)('v-if',!0)}}),ev=Zg;var tv=d(6314);const av={class:'acu-modal acu-faction-settings-modal'},ov={class:'acu-modal-header'},nv={class:'acu-modal-title'},rv={class:'acu-modal-body'},lv={class:'acu-settings-section'},iv={class:'acu-settings-group'},cv={class:'acu-settings-row'},sv={class:'acu-settings-control'},uv={class:'acu-settings-row'},dv={class:'acu-settings-control'},pv={class:'acu-settings-row'},mv={class:'acu-settings-label'},fv={class:'hint'},gv={class:'acu-settings-control'},vv={class:'acu-settings-section'},bv={class:'acu-settings-group'},hv={class:'acu-settings-row'},xv={class:'acu-settings-control'},yv={class:'acu-settings-row'},wv={class:'acu-settings-label'},kv={class:'hint'},Cv={class:'acu-settings-control'},Nv={class:'acu-settings-section'},Vv={class:'acu-settings-group'},Ev={class:'acu-settings-row acu-action-row'},Bv=(0,m.defineComponent)({__name:'FactionSettingsDialog',props:{visible:{type:Boolean,default:!1},factionId:{default:''},factionName:{default:''}},emits:['close','save'],setup(e,{emit:t}){const a=e,o=t,n=(0,tv.zI)(),r=(0,m.reactive)({borderColor:tv.X8.border,backgroundColor:l(tv.X8.background),backgroundOpacity:tv.X8.opacity??10,labelPosition:'top',labelFontSize:14});function l(e){if(e.startsWith('#'))return e;const t=e.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/);if(t){const e=parseInt(t[1],10),a=parseInt(t[2],10),o=parseInt(t[3],10);return`#${e.toString(16).padStart(2,'0')}${a.toString(16).padStart(2,'0')}${o.toString(16).padStart(2,'0')}`}return'#808080'}function i(){const e=n.getFactionOverride(a.factionId);e?(r.borderColor=e.border||tv.X8.border,r.backgroundColor=l(e.background||tv.X8.background),r.backgroundOpacity=e.opacity??tv.X8.opacity??10,r.labelPosition=e.labelPosition??'top',r.labelFontSize=e.labelFontSize??n.config.factionLabelFontSize):(r.borderColor=tv.X8.border,r.backgroundColor=l(tv.X8.background),r.backgroundOpacity=tv.X8.opacity??10,r.labelPosition='top',r.labelFontSize=n.config.factionLabelFontSize)}function c(){o('close')}function s(){n.removeFactionOverride(a.factionId),r.borderColor=tv.X8.border,r.backgroundColor=l(tv.X8.background),r.backgroundOpacity=tv.X8.opacity??10,r.labelPosition='top',r.labelFontSize=n.config.factionLabelFontSize}return(0,m.watch)(()=>a.visible,e=>{e&&a.factionId&&i()}),(0,m.watch)(()=>a.factionId,e=>{e&&a.visible&&i()}),(0,m.watchEffect)(()=>{var e,t;a.visible&&a.factionId&&(n.setFactionOverride(a.factionId,{border:r.borderColor,background:(e=r.backgroundColor,t=r.backgroundOpacity,`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${t/100})`),opacity:r.backgroundOpacity,labelPosition:r.labelPosition,labelFontSize:r.labelFontSize}),o('save'))}),(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'modal'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,m.withModifiers)(c,['self'])},[(0,m.createElementVNode)('div',av,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',ov,[(0,m.createElementVNode)('span',nv,'åŠ¿åŠ›è®¾ç½® - '+(0,m.toDisplayString)(e.factionName),1),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(c,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',rv,[(0,m.createCommentVNode)(' é¢œè‰²è®¾ç½® '),(0,m.createElementVNode)('div',lv,[a[8]||(a[8]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-palette'}),(0,m.createTextVNode)(' é¢œè‰²è®¾ç½® ')],-1)),(0,m.createElementVNode)('div',iv,[(0,m.createCommentVNode)(' è¾¹æ¡†&tagé¢œè‰² '),(0,m.createElementVNode)('div',cv,[a[5]||(a[5]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è¾¹æ¡†&tagé¢œè‰² '),(0,m.createElementVNode)('span',{class:'hint'},'è™šçº¿æ¡†é¢œè‰²')],-1)),(0,m.createElementVNode)('div',sv,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>r.borderColor=e),type:'color',class:'acu-dashed',title:'è¾¹æ¡†é¢œè‰²'},null,512),[[m.vModelText,r.borderColor]])])]),(0,m.createCommentVNode)(' èƒŒæ™¯é¢œè‰² '),(0,m.createElementVNode)('div',uv,[a[6]||(a[6]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' èƒŒæ™¯é¢œè‰² '),(0,m.createElementVNode)('span',{class:'hint'},'å®¹å™¨å¡«å……è‰²')],-1)),(0,m.createElementVNode)('div',dv,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>r.backgroundColor=e),type:'color',title:'èƒŒæ™¯é¢œè‰²'},null,512),[[m.vModelText,r.backgroundColor]])])]),(0,m.createCommentVNode)(' èƒŒæ™¯é€æ˜åº¦ '),(0,m.createElementVNode)('div',pv,[(0,m.createElementVNode)('div',mv,[a[7]||(a[7]=(0,m.createTextVNode)(' èƒŒæ™¯é€æ˜åº¦ ',-1)),(0,m.createElementVNode)('span',fv,(0,m.toDisplayString)(r.backgroundOpacity)+'%',1)]),(0,m.createElementVNode)('div',gv,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>r.backgroundOpacity=e),type:'range',min:'0',max:'100',step:'5'},null,512),[[m.vModelText,r.backgroundOpacity,void 0,{number:!0}]])])])])]),(0,m.createCommentVNode)(' æ ‡ç­¾è®¾ç½® '),(0,m.createElementVNode)('div',vv,[a[12]||(a[12]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-tag'}),(0,m.createTextVNode)(' æ ‡ç­¾è®¾ç½® ')],-1)),(0,m.createElementVNode)('div',bv,[(0,m.createCommentVNode)(' æ ‡ç­¾ä½ç½® '),(0,m.createElementVNode)('div',hv,[a[10]||(a[10]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ ‡ç­¾ä½ç½® '),(0,m.createElementVNode)('span',{class:'hint'},'åŠ¿åŠ›åç§°æ˜¾ç¤ºä½ç½®')],-1)),(0,m.createElementVNode)('div',xv,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[3]||(a[3]=e=>r.labelPosition=e)},[...a[9]||(a[9]=[(0,m.createElementVNode)('option',{value:'top'},'é¡¶éƒ¨',-1),(0,m.createElementVNode)('option',{value:'bottom'},'åº•éƒ¨',-1),(0,m.createElementVNode)('option',{value:'top-left'},'å†…éƒ¨å·¦ä¸Š',-1),(0,m.createElementVNode)('option',{value:'top-right'},'å†…éƒ¨å³ä¸Š',-1),(0,m.createElementVNode)('option',{value:'bottom-left'},'å†…éƒ¨å·¦ä¸‹',-1),(0,m.createElementVNode)('option',{value:'bottom-right'},'å†…éƒ¨å³ä¸‹',-1),(0,m.createElementVNode)('option',{value:'none'},'ä¸æ˜¾ç¤º',-1)])],512),[[m.vModelSelect,r.labelPosition]])])]),(0,m.createCommentVNode)(' æ ‡ç­¾å­—ä½“å¤§å° '),(0,m.createElementVNode)('div',yv,[(0,m.createElementVNode)('div',wv,[a[11]||(a[11]=(0,m.createTextVNode)(' æ ‡ç­¾å­—ä½“ ',-1)),(0,m.createElementVNode)('span',kv,(0,m.toDisplayString)(r.labelFontSize)+'px',1)]),(0,m.createElementVNode)('div',Cv,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>r.labelFontSize=e),type:'range',min:'10',max:'24',step:'1'},null,512),[[m.vModelText,r.labelFontSize,void 0,{number:!0}]])])])])]),(0,m.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,m.createElementVNode)('div',Nv,[(0,m.createElementVNode)('div',Vv,[(0,m.createElementVNode)('div',Ev,[(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-secondary',onClick:(0,m.withModifiers)(s,['stop'])},[...a[13]||(a[13]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' é‡ç½®ä¸ºé»˜è®¤ ',-1)])])])])])])])])):(0,m.createCommentVNode)('v-if',!0)]),_:1}))}});d(6390);const Sv=Bv,Tv={class:'acu-modal acu-graph-settings-modal'},Dv={class:'acu-modal-header'},Av={class:'acu-modal-body'},zv={class:'acu-settings-section'},Iv={class:'acu-settings-group'},_v={class:'acu-settings-row'},Mv={class:'acu-settings-label'},Uv={class:'hint'},$v={class:'acu-settings-control'},Lv={class:'acu-settings-row'},Pv={class:'acu-settings-label'},Fv={class:'hint'},jv={class:'acu-settings-control'},Ov={class:'acu-settings-row'},Rv={class:'acu-settings-control'},Hv={class:'acu-switch'},Wv={class:'acu-settings-section'},Gv={class:'acu-settings-group'},Yv={class:'acu-settings-row'},Xv={class:'acu-settings-label'},qv={class:'hint'},Kv={class:'acu-settings-control'},Jv={class:'acu-settings-row'},Qv={class:'acu-settings-label'},Zv={class:'hint'},eb={class:'acu-settings-control'},tb={class:'acu-settings-row'},ab={class:'acu-settings-label'},ob={class:'hint'},nb={class:'acu-settings-control'},rb={key:0,class:'acu-settings-section'},lb={class:'acu-settings-title'},ib={style:{'font-weight':'400','font-size':'11px',color:'var(--acu-text-sub)','margin-left':'auto'}},cb={class:'acu-faction-color-group acu-faction-color-scrollable'},sb={class:'acu-settings-label'},ub={class:'acu-settings-control acu-faction-color-control'},db=['value','onInput'],pb=['value','onInput'],mb=['value','title','onInput'],fb={class:'acu-opacity-value'},gb={class:'acu-settings-section'},vb={class:'acu-settings-group'},bb={class:'acu-settings-row'},hb={class:'acu-settings-control'},xb={class:'acu-switch'},yb=['checked'],wb={class:'acu-settings-section'},kb={class:'acu-settings-group'},Cb={class:'acu-settings-row'},Nb={class:'acu-settings-control'},Vb={class:'acu-switch'},Eb={key:0,class:'acu-legend-items-section'},Bb={class:'acu-legend-items-header'},Sb={class:'acu-legend-items-list'},Tb={key:0,class:'acu-legend-item-edit'},Db={class:'acu-legend-edit-row'},Ab={class:'acu-legend-edit-row'},zb={class:'acu-legend-edit-actions'},Ib={class:'acu-legend-item-display'},_b={class:'acu-legend-emoji'},Mb={class:'acu-legend-label'},Ub={class:'acu-legend-keywords'},$b={key:0,class:'acu-legend-keyword-more'},Lb={class:'acu-legend-item-actions'},Pb=['onClick'],Fb=['onClick'],jb={key:0,class:'acu-legend-empty'},Ob={class:'acu-legend-reset-wrapper'},Rb={class:'acu-settings-section'},Hb={class:'acu-settings-group'},Wb={class:'acu-settings-row acu-action-row'},Gb=(0,m.defineComponent)({__name:'GraphSettingsDialog',props:{visible:{type:Boolean},factions:{}},emits:['close','open-avatar-manager'],setup(e,{emit:t}){const a=e,o=t,n=(0,tv.zI)(),r=((0,k.j_)(),(0,m.computed)(()=>n.config)),l=(0,m.computed)(()=>a.factions||[]),i=(0,m.computed)(()=>n.getLegendConfig()),c=(0,m.ref)(null),s=(0,m.reactive)({label:'',color:'#888888',emoji:'',keywordsStr:''});function u(e){const t=n.config.factionColors[e];if(t)return t.border;const a=l.value.indexOf(e);return a>=0&&a<tv.TY.length?tv.TY[a].border:tv.X8.border}function d(e){const t=n.config.factionColors[e];if(t){const e=t.background.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(e){const t=parseInt(e[1]),a=parseInt(e[2]),o=parseInt(e[3]);return`#${t.toString(16).padStart(2,'0')}${a.toString(16).padStart(2,'0')}${o.toString(16).padStart(2,'0')}`}return t.background}const a=l.value.indexOf(e);let o;o=a>=0&&a<tv.TY.length?tv.TY[a].background:tv.X8.background;const r=o.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(r){const e=parseInt(r[1]),t=parseInt(r[2]),a=parseInt(r[3]);return`#${e.toString(16).padStart(2,'0')}${t.toString(16).padStart(2,'0')}${a.toString(16).padStart(2,'0')}`}return'#808080'}function p(e){const t=n.config.factionColors[e];if(t&&void 0!==t.opacity)return t.opacity;const a=l.value.indexOf(e);return a>=0&&a<tv.TY.length?tv.TY[a].opacity:tv.X8.opacity??10}function f(e,t){return`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${t})`}function g(){o('close'),o('open-avatar-manager')}function v(){o('close')}function b(){n.resetToDefault()}function h(){n.setLegendEnabled(i.value.enabled)}function x(){n.addLegendItem({label:'æ–°å›¾ä¾‹',color:'#888888',emoji:'âšª',keywords:[]});const e=n.getLegendConfig().items,t=e[e.length-1];t&&y(t)}function y(e){c.value=e.id,s.label=e.label,s.color=e.color,s.emoji=e.emoji||'',s.keywordsStr=e.keywords.join(', ')}function w(){if(!c.value)return;const e=s.keywordsStr.split(/[,ï¼Œ]/).map(e=>e.trim()).filter(e=>e.length>0);n.updateLegendItem(c.value,{label:s.label,color:s.color,emoji:s.emoji||void 0,keywords:e}),c.value=null}function C(){c.value=null}function N(){n.resetLegendConfig()}return(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'modal'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,m.withModifiers)(v,['self'])},[(0,m.createElementVNode)('div',Tv,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Dv,[a[12]||(a[12]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'å…³ç³»å›¾è®¾ç½®',-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(v,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Av,[(0,m.createCommentVNode)(' æ˜¾ç¤ºè®¾ç½® '),(0,m.createElementVNode)('div',zv,[a[18]||(a[18]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-eye'}),(0,m.createTextVNode)(' æ˜¾ç¤ºè®¾ç½® ')],-1)),(0,m.createElementVNode)('div',Iv,[(0,m.createCommentVNode)(' èŠ‚ç‚¹å¤§å° '),(0,m.createElementVNode)('div',_v,[(0,m.createElementVNode)('div',Mv,[a[13]||(a[13]=(0,m.createTextVNode)(' èŠ‚ç‚¹å¤§å° ',-1)),(0,m.createElementVNode)('span',Uv,(0,m.toDisplayString)(r.value.nodeSize)+'px',1)]),(0,m.createElementVNode)('div',$v,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>r.value.nodeSize=e),type:'range',min:'30',max:'80',step:'5'},null,512),[[m.vModelText,r.value.nodeSize,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' è¾¹å®½åº¦ '),(0,m.createElementVNode)('div',Lv,[(0,m.createElementVNode)('div',Pv,[a[14]||(a[14]=(0,m.createTextVNode)(' è¾¹å®½åº¦ ',-1)),(0,m.createElementVNode)('span',Fv,(0,m.toDisplayString)(r.value.edgeWidth.toFixed(1))+'px',1)]),(0,m.createElementVNode)('div',jv,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>r.value.edgeWidth=e),type:'range',min:'1',max:'5',step:'0.5'},null,512),[[m.vModelText,r.value.edgeWidth,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' æ˜¾ç¤ºå›¾ä¾‹ '),(0,m.createElementVNode)('div',Ov,[a[16]||(a[16]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ˜¾ç¤ºå›¾ä¾‹ '),(0,m.createElementVNode)('span',{class:'hint'},'å…³ç³»é¢œè‰²å›¾ä¾‹')],-1)),(0,m.createElementVNode)('div',Rv,[(0,m.createElementVNode)('label',Hv,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>r.value.showLegend=e),type:'checkbox'},null,512),[[m.vModelCheckbox,r.value.showLegend]]),a[15]||(a[15]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])]),(0,m.createCommentVNode)(' å¤´åƒç®¡ç†å…¥å£ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:(0,m.withModifiers)(g,['stop'])},[...a[17]||(a[17]=[(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¤´åƒç®¡ç† '),(0,m.createElementVNode)('span',{class:'hint'},'ç®¡ç†èŠ‚ç‚¹å¤´åƒ')],-1),(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])])])]),(0,m.createCommentVNode)(' å­—ä½“è®¾ç½® '),(0,m.createElementVNode)('div',Wv,[a[22]||(a[22]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-font'}),(0,m.createTextVNode)(' å­—ä½“è®¾ç½® ')],-1)),(0,m.createElementVNode)('div',Gv,[(0,m.createCommentVNode)(' å…³ç³»æ ‡ç­¾å­—ä½“ '),(0,m.createElementVNode)('div',Yv,[(0,m.createElementVNode)('div',Xv,[a[19]||(a[19]=(0,m.createTextVNode)(' å…³ç³»æ ‡ç­¾ ',-1)),(0,m.createElementVNode)('span',qv,(0,m.toDisplayString)(r.value.relationLabelFontSize)+'px',1)]),(0,m.createElementVNode)('div',Kv,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>r.value.relationLabelFontSize=e),type:'range',min:'8',max:'16',step:'1'},null,512),[[m.vModelText,r.value.relationLabelFontSize,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' äººåæ ‡ç­¾å­—ä½“ '),(0,m.createElementVNode)('div',Jv,[(0,m.createElementVNode)('div',Qv,[a[20]||(a[20]=(0,m.createTextVNode)(' äººåæ ‡ç­¾ ',-1)),(0,m.createElementVNode)('span',Zv,(0,m.toDisplayString)(r.value.nameLabelFontSize)+'px',1)]),(0,m.createElementVNode)('div',eb,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>r.value.nameLabelFontSize=e),type:'range',min:'8',max:'18',step:'1'},null,512),[[m.vModelText,r.value.nameLabelFontSize,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' åŠ¿åŠ›åæ ‡ç­¾å­—ä½“ '),(0,m.createElementVNode)('div',tb,[(0,m.createElementVNode)('div',ab,[a[21]||(a[21]=(0,m.createTextVNode)(' åŠ¿åŠ›åæ ‡ç­¾ ',-1)),(0,m.createElementVNode)('span',ob,(0,m.toDisplayString)(r.value.factionLabelFontSize)+'px',1)]),(0,m.createElementVNode)('div',nb,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>r.value.factionLabelFontSize=e),type:'range',min:'10',max:'20',step:'1'},null,512),[[m.vModelText,r.value.factionLabelFontSize,void 0,{number:!0}]])])])])]),(0,m.createCommentVNode)(' åŠ¿åŠ›é¢œè‰²è®¾ç½® '),l.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',rb,[(0,m.createElementVNode)('div',lb,[a[23]||(a[23]=(0,m.createElementVNode)('i',{class:'fas fa-palette'},null,-1)),a[24]||(a[24]=(0,m.createTextVNode)(' åŠ¿åŠ›é¢œè‰² ',-1)),(0,m.createElementVNode)('span',ib,(0,m.toDisplayString)(l.value.length)+' ä¸ªåŠ¿åŠ› ',1)]),(0,m.createCommentVNode)(' é¢œè‰²æç¤º '),a[25]||(a[25]=(0,m.createElementVNode)('div',{class:'acu-faction-color-hint'},[(0,m.createElementVNode)('span',{class:'hint-item'},[(0,m.createElementVNode)('span',{class:'hint-box dashed'}),(0,m.createTextVNode)(' è¾¹æ¡†è‰² ')]),(0,m.createElementVNode)('span',{class:'hint-item'},[(0,m.createElementVNode)('span',{class:'hint-box solid'}),(0,m.createTextVNode)(' èƒŒæ™¯è‰² ')]),(0,m.createElementVNode)('span',{class:'hint-item'},[(0,m.createElementVNode)('i',{class:'fas fa-adjust',style:{'font-size':'12px','margin-right':'2px'}}),(0,m.createTextVNode)(' é€æ˜åº¦ ')])],-1)),(0,m.createCommentVNode)(' å¯æ»šåŠ¨çš„åŠ¿åŠ›åˆ—è¡¨ '),(0,m.createElementVNode)('div',cb,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(l.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e,class:'acu-settings-row acu-faction-color-row'},[(0,m.createElementVNode)('div',sb,(0,m.toDisplayString)(e),1),(0,m.createElementVNode)('div',ub,[(0,m.createElementVNode)('input',{type:'color',class:'acu-dashed',value:u(e),title:'è¾¹æ¡†é¢œè‰²ï¼ˆè™šçº¿æ¡†ï¼‰',onInput:t=>function(e,t){const a=t.target.value,o=n.config.factionColors[e]||{border:u(e),background:f(d(e),.1)};n.setFactionColor(e,{...o,border:a})}(e,t)},null,40,db),(0,m.createElementVNode)('input',{type:'color',value:d(e),title:'èƒŒæ™¯é¢œè‰²',onInput:t=>function(e,t){const a=t.target.value,o=p(e),r=n.config.factionColors[e]||{border:u(e),background:f(a,o/100),opacity:o};n.setFactionColor(e,{...r,background:f(a,o/100)})}(e,t)},null,40,pb),(0,m.createElementVNode)('input',{type:'range',class:'acu-opacity-slider',value:p(e),min:'0',max:'100',step:'5',title:`é€æ˜åº¦: ${p(e)}%`,onInput:t=>function(e,t){const a=t.target,o=parseInt(a.value,10),r=d(e),l=n.config.factionColors[e]||{border:u(e),background:f(r,o/100),opacity:o};n.setFactionColor(e,{...l,background:f(r,o/100),opacity:o})}(e,t)},null,40,mb),(0,m.createElementVNode)('span',fb,(0,m.toDisplayString)(p(e))+'%',1)])]))),128))])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' èƒŒæ™¯é…ç½® '),(0,m.createElementVNode)('div',gb,[a[29]||(a[29]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-image'}),(0,m.createTextVNode)(' èƒŒæ™¯é…ç½® ')],-1)),(0,m.createElementVNode)('div',vb,[(0,m.createElementVNode)('div',bb,[a[27]||(a[27]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ˜¾ç¤ºèƒŒæ™¯å›¾ç‰‡ '),(0,m.createElementVNode)('span',{class:'hint'},'ä½¿ç”¨å…¨å±€ä¸»é¢˜èƒŒæ™¯')],-1)),(0,m.createElementVNode)('div',hb,[(0,m.createElementVNode)('label',xb,[(0,m.createElementVNode)('input',{checked:r.value.showBackground,type:'checkbox',onChange:a[6]||(a[6]=e=>(0,m.unref)(n).setShowBackground(e.target.checked))},null,40,yb),a[26]||(a[26]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])]),a[28]||(a[28]=(0,m.createElementVNode)('div',{class:'acu-settings-row',style:{'justify-content':'flex-start','padding-top':'0','padding-bottom':'8px'}},[(0,m.createElementVNode)('span',{style:{'font-size':'11px',color:'var(--acu-text-sub)'}},[(0,m.createElementVNode)('i',{class:'fas fa-info-circle',style:{'margin-right':'4px'}}),(0,m.createTextVNode)(' å¦‚éœ€æ›´æ¢èƒŒæ™¯å›¾ç‰‡ï¼Œè¯·å‰å¾€"è®¾ç½® > ä¸»é¢˜é…ç½®" ')])],-1))])]),(0,m.createCommentVNode)(' å›¾ä¾‹é…ç½® '),(0,m.createElementVNode)('div',wb,[a[40]||(a[40]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-th-list'}),(0,m.createTextVNode)(' å›¾ä¾‹é…ç½® '),(0,m.createElementVNode)('span',{style:{'font-weight':'400','font-size':'11px',color:'var(--acu-text-sub)','margin-left':'auto'}},' è‡ªå®šä¹‰å…³ç³»é¢œè‰² ')],-1)),(0,m.createElementVNode)('div',kb,[(0,m.createCommentVNode)(' å¯ç”¨è‡ªå®šä¹‰å›¾ä¾‹ '),(0,m.createElementVNode)('div',Cb,[a[31]||(a[31]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¯ç”¨è‡ªå®šä¹‰å›¾ä¾‹ '),(0,m.createElementVNode)('span',{class:'hint'},'è¦†ç›–é»˜è®¤é¢œè‰²è§„åˆ™')],-1)),(0,m.createElementVNode)('div',Nb,[(0,m.createElementVNode)('label',Vb,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[7]||(a[7]=e=>i.value.enabled=e),type:'checkbox',onChange:h},null,544),[[m.vModelCheckbox,i.value.enabled]]),a[30]||(a[30]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])])]),(0,m.createCommentVNode)(' å›¾ä¾‹é¡¹åˆ—è¡¨ '),i.value.enabled?((0,m.openBlock)(),(0,m.createElementBlock)('div',Eb,[(0,m.createElementVNode)('div',Bb,[a[33]||(a[33]=(0,m.createElementVNode)('span',null,'å›¾ä¾‹é¡¹',-1)),(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-small',onClick:(0,m.withModifiers)(x,['stop'])},[...a[32]||(a[32]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1),(0,m.createTextVNode)(' æ·»åŠ  ',-1)])])]),(0,m.createElementVNode)('div',Sb,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(i.value.items,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-legend-item-row'},[(0,m.createCommentVNode)(' ç¼–è¾‘æ¨¡å¼ '),c.value===e.id?((0,m.openBlock)(),(0,m.createElementBlock)('div',Tb,[(0,m.createElementVNode)('div',Db,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[8]||(a[8]=e=>s.label=e),type:'text',placeholder:'åç§°',class:'acu-legend-input'},null,512),[[m.vModelText,s.label]]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[9]||(a[9]=e=>s.color=e),type:'color',class:'acu-legend-color-input',title:'é¢œè‰²'},null,512),[[m.vModelText,s.color]]),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[10]||(a[10]=e=>s.emoji=e),type:'text',placeholder:'Emoji',class:'acu-legend-emoji-input',maxlength:'4'},null,512),[[m.vModelText,s.emoji]])]),(0,m.createElementVNode)('div',Ab,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[11]||(a[11]=e=>s.keywordsStr=e),type:'text',placeholder:'å…³é”®è¯ï¼ˆé€—å·åˆ†éš”ï¼‰',class:'acu-legend-keywords-input'},null,512),[[m.vModelText,s.keywordsStr]])]),(0,m.createElementVNode)('div',zb,[(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-small acu-action-btn-primary',onClick:(0,m.withModifiers)(w,['stop'])},[...a[34]||(a[34]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-small',onClick:(0,m.withModifiers)(C,['stop'])},[...a[35]||(a[35]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])])])):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ˜¾ç¤ºæ¨¡å¼ '),(0,m.createElementVNode)('div',Ib,[(0,m.createElementVNode)('span',{class:'acu-legend-color-dot',style:(0,m.normalizeStyle)({backgroundColor:e.color})},null,4),(0,m.createElementVNode)('span',_b,(0,m.toDisplayString)(e.emoji||''),1),(0,m.createElementVNode)('span',Mb,(0,m.toDisplayString)(e.label),1),(0,m.createElementVNode)('div',Ub,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.keywords.slice(0,3),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e,class:'acu-legend-keyword-tag'},(0,m.toDisplayString)(e),1))),128)),e.keywords.length>3?((0,m.openBlock)(),(0,m.createElementBlock)('span',$b,' +'+(0,m.toDisplayString)(e.keywords.length-3),1)):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createElementVNode)('div',Lb,[(0,m.createElementVNode)('button',{class:'acu-legend-action-btn',title:'ç¼–è¾‘',onClick:(0,m.withModifiers)(t=>y(e),['stop'])},[...a[36]||(a[36]=[(0,m.createElementVNode)('i',{class:'fas fa-edit'},null,-1)])],8,Pb),(0,m.createElementVNode)('button',{class:'acu-legend-action-btn acu-legend-action-btn-danger',title:'åˆ é™¤',onClick:(0,m.withModifiers)(t=>{return a=e.id,void n.removeLegendItem(a);var a},['stop'])},[...a[37]||(a[37]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1)])],8,Fb)])],64))]))),128)),0===i.value.items.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',jb,[...a[38]||(a[38]=[(0,m.createElementVNode)('span',null,'æš‚æ— å›¾ä¾‹é¡¹ï¼Œç‚¹å‡»ä¸Šæ–¹"æ·»åŠ "æŒ‰é’®åˆ›å»º',-1)])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' é‡ç½®ä¸ºé»˜è®¤å›¾ä¾‹ '),(0,m.createElementVNode)('div',Ob,[(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-secondary acu-action-btn-small',onClick:(0,m.withModifiers)(N,['stop'])},[...a[39]||(a[39]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' é‡ç½®ä¸ºé»˜è®¤å›¾ä¾‹ ',-1)])])])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,m.createElementVNode)('div',Rb,[(0,m.createElementVNode)('div',Hb,[(0,m.createElementVNode)('div',Wb,[(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-secondary',onClick:(0,m.withModifiers)(b,['stop'])},[...a[41]||(a[41]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' æ¢å¤é»˜è®¤ ',-1)])])])])])])])])):(0,m.createCommentVNode)('v-if',!0)]),_:1}))}}),Yb={class:'acu-modal acu-node-config-modal'},Xb={class:'acu-modal-header'},qb={class:'acu-modal-title'},Kb={class:'acu-modal-body'},Jb={class:'acu-settings-section'},Qb={class:'acu-settings-group'},Zb={class:'acu-char-selector'},eh=['onClick'],th={class:'acu-node-preview'},ah={class:'acu-node-config-actions'},oh={class:'acu-settings-section'},nh={class:'acu-settings-group'},rh={class:'acu-settings-row'},lh={class:'acu-settings-label'},ih={class:'hint'},ch={class:'acu-settings-control'},sh={class:'acu-settings-row'},uh={class:'acu-settings-control'},dh={class:'acu-settings-row'},ph={class:'acu-settings-label'},mh={class:'hint'},fh={class:'acu-settings-control'},gh={class:'acu-settings-row'},vh={class:'acu-settings-control'},bh={class:'acu-settings-section'},hh={class:'acu-settings-group'},xh={class:'acu-settings-row acu-action-row'},yh=(0,m.defineComponent)({__name:'NodeConfigDialog',props:{visible:{type:Boolean,default:!1},nodeId:{default:''},fullName:{default:''},currentLabel:{default:''},selectedIndices:{default:()=>[]}},emits:['close','confirm','reset-to-full-name','style-update'],setup(e,{emit:t}){const a=e,o=t,n=(0,tv.zI)(),r=(0,m.ref)(new Set);function l(){try{const e=(window.parent?.document||document).querySelector('.acu-wrapper');if(e){const t=getComputedStyle(e).getPropertyValue('--acu-text-main').trim();if(t)return t}return'#333333'}catch{return'#333333'}}const i=(0,m.reactive)({size:tv.nD.size??60,borderColor:l(),borderWidth:tv.nD.borderWidth??2,shape:tv.nD.shape??'ellipse'});function c(){const e=n.getNodeStyleOverride(a.nodeId),t=l();e?(i.size=e.size??tv.nD.size??60,i.borderColor=e.borderColor??t,i.borderWidth=e.borderWidth??tv.nD.borderWidth??2,i.shape=e.shape??tv.nD.shape??'ellipse'):(i.size=tv.nD.size??60,i.borderColor=t,i.borderWidth=tv.nD.borderWidth??2,i.shape=tv.nD.shape??'ellipse')}function s(e){return/^[A-Za-z\s'-]+$/.test(e)&&e.includes(' ')}function u(e){return s(e)?e.split(' ').filter(Boolean):e.split('')}(0,m.watch)(()=>a.selectedIndices,e=>{r.value=new Set(e)},{immediate:!0}),(0,m.watch)(()=>a.visible,e=>{e&&(a.selectedIndices.length>0?r.value=new Set(a.selectedIndices):r.value=new Set(function(e){const t=u(e);if(s(e))return[0];return t.length>0?[t.length-1]:[]}(a.fullName)),c())}),(0,m.watch)(()=>a.nodeId,e=>{e&&a.visible&&c()});const d=(0,m.computed)(()=>u(a.fullName)),p=(0,m.computed)(()=>{if(!a.fullName)return'';const e=d.value,t=Array.from(r.value).sort((e,t)=>e-t).map(t=>e[t]).filter(Boolean);return 0===t.length?function(e){if(s(e)){const t=e.split(' ')[0];return t.length>6?t.slice(0,6):t}return e.length>0?e[e.length-1]:e}(a.fullName):s(a.fullName)?t.join(' '):t.join('')});function f(){const e=Array.from(r.value);o('confirm',a.nodeId,p.value,e),o('close')}function g(){o('reset-to-full-name',a.nodeId,a.fullName)}function v(){n.removeNodeStyleOverride(a.nodeId),i.size=tv.nD.size??60,i.borderColor=l(),i.borderWidth=tv.nD.borderWidth??2,i.shape=tv.nD.shape??'ellipse',o('style-update',a.nodeId)}return(0,m.watchEffect)(()=>{a.visible&&a.nodeId&&(n.setNodeStyleOverride(a.nodeId,{size:i.size,borderColor:i.borderColor,borderWidth:i.borderWidth,shape:i.shape}),o('style-update',a.nodeId))}),(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'modal'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,m.withModifiers)(f,['self'])},[(0,m.createElementVNode)('div',Yb,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Xb,[(0,m.createElementVNode)('span',qb,'èŠ‚ç‚¹é…ç½® - '+(0,m.toDisplayString)(e.fullName),1),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(f,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Kb,[(0,m.createCommentVNode)(' æ˜¾ç¤ºåç§°è®¾ç½® '),(0,m.createElementVNode)('div',Jb,[a[5]||(a[5]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-font'}),(0,m.createTextVNode)(' æ˜¾ç¤ºåç§° ')],-1)),(0,m.createElementVNode)('div',Qb,[a[4]||(a[4]=(0,m.createElementVNode)('p',{class:'acu-node-hint'},'ç‚¹å‡»é€‰æ‹©è¦æ˜¾ç¤ºçš„å­—ç¬¦ï¼ˆå¯å¤šé€‰ï¼‰',-1)),(0,m.createElementVNode)('div',Zb,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(d.value,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:t,class:(0,m.normalizeClass)(['acu-char-btn',{active:r.value.has(t)}]),onClick:(0,m.withModifiers)(e=>function(e){const t=new Set(r.value);t.has(e)?t.delete(e):t.add(e),r.value=t}(t),['stop'])},(0,m.toDisplayString)(e),11,eh))),128))]),(0,m.createElementVNode)('p',th,'é¢„è§ˆï¼š'+(0,m.toDisplayString)(p.value),1),(0,m.createElementVNode)('div',ah,[(0,m.createElementVNode)('button',{class:'acu-action-btn secondary',onClick:(0,m.withModifiers)(g,['stop'])},'æ˜¾ç¤ºå…¨å')])])]),(0,m.createCommentVNode)(' æ ·å¼è®¾ç½® '),(0,m.createElementVNode)('div',oh,[a[11]||(a[11]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-palette'}),(0,m.createTextVNode)(' èŠ‚ç‚¹æ ·å¼ ')],-1)),(0,m.createElementVNode)('div',nh,[(0,m.createCommentVNode)(' èŠ‚ç‚¹å¤§å° '),(0,m.createElementVNode)('div',rh,[(0,m.createElementVNode)('div',lh,[a[6]||(a[6]=(0,m.createTextVNode)(' èŠ‚ç‚¹å¤§å° ',-1)),(0,m.createElementVNode)('span',ih,(0,m.toDisplayString)(i.size)+'px',1)]),(0,m.createElementVNode)('div',ch,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>i.size=e),type:'range',min:'30',max:'120',step:'5'},null,512),[[m.vModelText,i.size,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' è¾¹æ¡†é¢œè‰² '),(0,m.createElementVNode)('div',sh,[a[7]||(a[7]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è¾¹æ¡†é¢œè‰² '),(0,m.createElementVNode)('span',{class:'hint'},'å¤´åƒè¾¹æ¡†è‰²')],-1)),(0,m.createElementVNode)('div',uh,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.borderColor=e),type:'color',class:'acu-dashed',title:'è¾¹æ¡†é¢œè‰²'},null,512),[[m.vModelText,i.borderColor]])])]),(0,m.createCommentVNode)(' è¾¹æ¡†å®½åº¦ '),(0,m.createElementVNode)('div',dh,[(0,m.createElementVNode)('div',ph,[a[8]||(a[8]=(0,m.createTextVNode)(' è¾¹æ¡†å®½åº¦ ',-1)),(0,m.createElementVNode)('span',mh,(0,m.toDisplayString)(i.borderWidth)+'px',1)]),(0,m.createElementVNode)('div',fh,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.borderWidth=e),type:'range',min:'0',max:'10',step:'0.5'},null,512),[[m.vModelText,i.borderWidth,void 0,{number:!0}]])])]),(0,m.createCommentVNode)(' èŠ‚ç‚¹å½¢çŠ¶ '),(0,m.createElementVNode)('div',gh,[a[10]||(a[10]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' å¤´åƒå½¢çŠ¶ '),(0,m.createElementVNode)('span',{class:'hint'},'åœ†è§’æ ·å¼')],-1)),(0,m.createElementVNode)('div',vh,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[3]||(a[3]=e=>i.shape=e)},[...a[9]||(a[9]=[(0,m.createElementVNode)('option',{value:'ellipse'},'åœ†å½¢',-1),(0,m.createElementVNode)('option',{value:'round-rectangle'},'åœ†è§’çŸ©å½¢',-1),(0,m.createElementVNode)('option',{value:'rectangle'},'çŸ©å½¢',-1),(0,m.createElementVNode)('option',{value:'hexagon'},'å…­è¾¹å½¢',-1)])],512),[[m.vModelSelect,i.shape]])])])])]),(0,m.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,m.createElementVNode)('div',bh,[(0,m.createElementVNode)('div',hh,[(0,m.createElementVNode)('div',xh,[(0,m.createElementVNode)('button',{class:'acu-action-btn acu-action-btn-secondary',onClick:(0,m.withModifiers)(v,['stop'])},[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,m.createTextVNode)(' é‡ç½®æ ·å¼ ',-1)])])])])])])])])):(0,m.createCommentVNode)('v-if',!0)]),_:1}))}});d(2717);const wh=yh,kh={class:'acu-modal acu-node-config-modal'},Ch={class:'acu-modal-header'},Nh={class:'acu-modal-body'},Vh={class:'acu-node-fullname',style:{'margin-bottom':'8px','font-weight':'600'}},Eh={class:'acu-char-selector'},Bh=['onClick'],Sh={class:'acu-node-preview'},Th={class:'acu-node-config-actions'},Dh=(0,m.defineComponent)({__name:'NodeLabelDialog',props:{visible:{type:Boolean,default:!1},fullName:{default:''},initialIndices:{default:()=>[]}},emits:['close','apply','reset'],setup(e,{expose:t,emit:a}){const o=e,n=a,r=(0,m.ref)(new Set);function l(e){return/^[A-Za-z\s'-]+$/.test(e)&&e.includes(' ')}function i(e){return e?l(e)?e.split(' ').filter(Boolean):e.split(''):[]}function c(e){const t=i(e);return l(e)?[0]:t.length>0?[t.length-1]:[]}function s(e){if(l(e)){const t=e.split(' ')[0];return t.length>6?t.slice(0,6):t}return e.length>0?e[e.length-1]:e}const u=(0,m.computed)(()=>i(o.fullName)),d=(0,m.computed)(()=>{if(!o.fullName)return'';const e=u.value,t=Array.from(r.value).sort((e,t)=>e-t).map(t=>e[t]).filter(Boolean);return 0===t.length?s(o.fullName):l(o.fullName)?t.join(' '):t.join('')});function p(){n('apply',{displayLabel:d.value,selectedIndices:Array.from(r.value)}),n('close')}function f(){n('reset'),n('close')}function g(){n('close')}return(0,m.watch)(()=>[o.visible,o.fullName,o.initialIndices],([e])=>{e&&(o.initialIndices&&o.initialIndices.length>0?r.value=new Set(o.initialIndices):r.value=new Set(c(o.fullName)))},{immediate:!0}),t({isEnglishName:l,getDisplayChars:i,getDefaultIndices:c,getDefaultLabel:s}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',style:{'z-index':'2147483647'},onClick:(0,m.withModifiers)(g,['self'])},[(0,m.createElementVNode)('div',kh,[(0,m.createElementVNode)('div',Ch,[a[0]||(a[0]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},'é€‰æ‹©æ˜¾ç¤ºçš„å­—ç¬¦',-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(g,['stop'])},'å–æ¶ˆ')]),(0,m.createElementVNode)('div',Nh,[(0,m.createElementVNode)('p',Vh,'å…¨åï¼š'+(0,m.toDisplayString)(e.fullName),1),a[1]||(a[1]=(0,m.createElementVNode)('p',{class:'acu-node-hint'},'ç‚¹å‡»é€‰æ‹©è¦æ˜¾ç¤ºçš„å­—ç¬¦ï¼ˆå¯å¤šé€‰ï¼‰',-1)),(0,m.createElementVNode)('div',Eh,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(u.value,(e,t)=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:t,class:(0,m.normalizeClass)(['acu-char-btn',{active:r.value.has(t)}]),onClick:(0,m.withModifiers)(e=>function(e){const t=new Set(r.value);t.has(e)?t.delete(e):t.add(e),r.value=t}(t),['stop'])},(0,m.toDisplayString)(e),11,Bh))),128))]),(0,m.createElementVNode)('p',Sh,'é¢„è§ˆï¼š'+(0,m.toDisplayString)(d.value),1),(0,m.createElementVNode)('div',Th,[(0,m.createElementVNode)('button',{class:'acu-action-btn secondary',onClick:(0,m.withModifiers)(f,['stop'])},'æ˜¾ç¤ºå…¨å'),(0,m.createElementVNode)('button',{class:'acu-action-btn primary',onClick:(0,m.withModifiers)(p,['stop'])},'ç¡®å®š')])])])])):(0,m.createCommentVNode)('v-if',!0)}}),Ah={class:'acu-modal acu-row-edit-modal'},zh={class:'acu-modal-header'},Ih={class:'acu-modal-title'},_h={class:'acu-modal-body'},Mh={class:'acu-row-edit-content'},Uh=(0,m.defineComponent)({__name:'RowEditDialog',props:{visible:{type:Boolean,default:!1},tableName:{},tableId:{},rowIndex:{},currentRowData:{default:null},titleColIndex:{default:1}},emits:['update:visible','close','showHistory'],setup(e,{emit:t}){const a=e,o=(0,f.JH)(),n=(0,m.computed)(()=>`acu-theme-${o.theme}`),r=t,l=(0,m.computed)(()=>{if(!a.currentRowData)return a.tableName;const e=a.titleColIndex;if(e>=0&&a.currentRowData.cells.length>e){const t=a.currentRowData.cells[e]?.value;if(t)return`${a.tableName} - ${t}`}return`${a.tableName} - ç¬¬ ${a.rowIndex+1} è¡Œ`});function i(){r('update:visible',!1),r('close')}function c(){i()}function s(){r('showHistory')}return(0,m.watch)(()=>a.visible,e=>{}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:(0,m.normalizeClass)(['acu-modal-container acu-row-edit-modal-container',n.value]),onClick:(0,m.withModifiers)(i,['self'])},[(0,m.createElementVNode)('div',Ah,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',zh,[(0,m.createCommentVNode)(' ç§»åŠ¨ç«¯æ‹–åŠ¨æŠŠæ‰‹ '),a[1]||(a[1]=(0,m.createElementVNode)('div',{class:'acu-drag-handle acu-mobile-only'},null,-1)),(0,m.createElementVNode)('span',Ih,[a[0]||(a[0]=(0,m.createElementVNode)('i',{class:'fas fa-edit'},null,-1)),(0,m.createTextVNode)(' ç¼–è¾‘ - '+(0,m.toDisplayString)(l.value),1)]),(0,m.createCommentVNode)(' PCç«¯åœ¨å¤´éƒ¨æ˜¾ç¤ºå®ŒæˆæŒ‰é’® '),(0,m.createElementVNode)('button',{class:'acu-close-pill acu-pc-only',onClick:(0,m.withModifiers)(c,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',_h,[(0,m.createElementVNode)('div',Mh,[(0,m.createCommentVNode)(' ä½¿ç”¨ DataCard å±•ç¤ºå’Œç¼–è¾‘è¡Œæ•°æ® '),e.currentRowData?((0,m.openBlock)(),(0,m.createBlock)(zt,{key:0,data:e.currentRowData,'table-name':e.tableName,'table-id':e.tableId,'view-mode':'list','show-header':!0,'show-index':!0,'show-history-button':!0,'title-col-index':e.titleColIndex,onShowHistory:s},null,8,['data','table-name','table-id','title-col-index'])):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createCommentVNode)(' åº•éƒ¨ç•™ç™½é€‚é…ç§»åŠ¨ç«¯å®‰å…¨åŒº '),a[2]||(a[2]=(0,m.createElementVNode)('div',{class:'acu-bottom-spacer'},null,-1))])],2)):(0,m.createCommentVNode)('v-if',!0)}}),$h={class:'acu-modal acu-widget-actions-modal'},Lh={class:'acu-modal-header'},Ph={class:'acu-modal-body'},Fh={class:'acu-settings-section'},jh={class:'acu-settings-group'},Oh={class:'acu-settings-label'},Rh={class:'hint'},Hh={class:'acu-settings-control'},Wh={class:'acu-switch'},Gh=['checked','onChange'],Yh={class:'acu-settings-section'},Xh={class:'acu-settings-title'},qh={class:'acu-settings-group'},Kh={key:0,class:'acu-empty-hint'},Jh={key:1,class:'acu-selected-actions-list'},Qh={class:'acu-settings-label'},Zh={class:'acu-settings-control'},ex=['onClick'],tx=(0,m.defineComponent)({__name:'WidgetActionsDialog',props:{visible:{type:Boolean},widgetId:{},currentActions:{default:()=>[]}},emits:['update:visible','close'],setup(e,{emit:t}){const a=e,o=t,n=(0,It.f)(),r=(0,m.ref)([]),l=(0,m.computed)(()=>Object.values(_t.bT).filter(e=>'settings'!==e.id&&'goToTable'!==e.id));function i(e){return _t.bT[e]?.icon||'fa-question'}function c(e){return _t.bT[e]?.label||e}function s(){a.widgetId&&n.updateWidget(a.widgetId,{actions:r.value}),o('update:visible',!1),o('close')}return(0,m.watch)(()=>a.visible,e=>{e&&(r.value=a.currentActions.filter(e=>'settings'!==e&&'goToTable'!==e))},{immediate:!0}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(s,['self'])},[(0,m.createElementVNode)('div',$h,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Lh,[a[0]||(a[0]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},[(0,m.createElementVNode)('i',{class:'fas fa-plus'}),(0,m.createTextVNode)(' é…ç½®å¿«æ·æŒ‰é’® ')],-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(s,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Ph,[(0,m.createElementVNode)('div',Fh,[a[2]||(a[2]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-bolt'}),(0,m.createTextVNode)(' å¯ç”¨çš„å¿«æ·æŒ‰é’® ')],-1)),(0,m.createElementVNode)('div',jh,[(0,m.createCommentVNode)(' æŒ‰é’®é€‰æ‹©åˆ—è¡¨ - ä½¿ç”¨æ ‡å‡†è®¾ç½®è¡Œå¸ƒå±€ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(l.value,e=>{return(0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'acu-settings-row'},[(0,m.createElementVNode)('div',Oh,[(0,m.createElementVNode)('span',null,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',e.icon]),style:{'margin-right':'8px',color:'var(--acu-title-color)'}},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(e.label),1)]),(0,m.createElementVNode)('span',Rh,(0,m.toDisplayString)(e.tooltip),1)]),(0,m.createElementVNode)('div',Hh,[(0,m.createCommentVNode)(' ä½¿ç”¨æ ‡å‡† acu-switch å¼€å…³ '),(0,m.createElementVNode)('label',Wh,[(0,m.createElementVNode)('input',{type:'checkbox',checked:(t=e.id,r.value.includes(t)),onChange:t=>function(e){const t=r.value.indexOf(e);t>-1?r.value.splice(t,1):r.value.push(e)}(e.id)},null,40,Gh),a[1]||(a[1]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])]);var t}),128))])]),(0,m.createCommentVNode)(' å·²é€‰æŒ‰é’®é¢„è§ˆ '),(0,m.createElementVNode)('div',Yh,[(0,m.createElementVNode)('div',Xh,[a[3]||(a[3]=(0,m.createElementVNode)('i',{class:'fas fa-eye'},null,-1)),(0,m.createTextVNode)(' å·²é€‰æŒ‰é’® ('+(0,m.toDisplayString)(r.value.length)+') ',1)]),(0,m.createElementVNode)('div',qh,[0===r.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Kh,'æš‚æœªé€‰æ‹©ä»»ä½•å¿«æ·æŒ‰é’®')):((0,m.openBlock)(),(0,m.createElementBlock)('div',Jh,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(r.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e,class:'acu-settings-row'},[(0,m.createElementVNode)('div',Qh,[(0,m.createElementVNode)('span',null,[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',i(e)]),style:{'margin-right':'8px',color:'var(--acu-title-color)'}},null,2),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(c(e)),1)])]),(0,m.createElementVNode)('div',Zh,[(0,m.createElementVNode)('button',{class:'acu-tool-btn acu-btn-danger',title:'ç§»é™¤',onClick:(0,m.withModifiers)(t=>function(e){const t=r.value.indexOf(e);t>-1&&r.value.splice(t,1)}(e),['stop'])},[...a[4]||(a[4]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])],8,ex)])]))),128))]))])])])])])):(0,m.createCommentVNode)('v-if',!0)}}),ax={ref:'dialogRef',class:'acu-modal acu-widget-settings-modal'},ox={class:'acu-modal-header'},nx={class:'acu-modal-body'},rx={class:'acu-settings-section'},lx={class:'acu-settings-group'},ix={class:'acu-settings-row'},cx={class:'acu-settings-control'},sx=['value'],ux={class:'acu-settings-section'},dx={class:'acu-settings-group'},px={class:'acu-settings-row'},mx={class:'acu-settings-control'},fx=['value'],gx={class:'acu-settings-section'},vx={class:'acu-settings-group'},bx={class:'acu-settings-row'},hx={class:'acu-settings-control'},xx=['value'],yx={key:0,class:'acu-selected-tags'},wx=['onClick'],kx={class:'acu-settings-section'},Cx={class:'acu-settings-group'},Nx={class:'acu-settings-label'},Vx={key:0,class:'hint'},Ex={key:1,class:'hint'},Bx={class:'acu-settings-row'},Sx={class:'acu-settings-control'},Tx=(0,m.defineComponent)({__name:'WidgetSettingsDialog',props:{visible:{type:Boolean},widgetId:{},widgetConfig:{default:null},tableHeaders:{default:()=>[]}},emits:['update:visible','close'],setup(e,{emit:t}){const a=e,o=t,n=(0,f.JH)(),r=(0,It.f)(),l=(0,k.j_)(),i=(0,m.computed)(()=>g.widgetTagConfig?.displayedTagIds?.length||0),c=(0,m.computed)(()=>g.widgetTagConfig?.displayedCategoryIds?.length||0);function s(){l.openTagManagerDialog({widgetId:a.widgetId,displayedTagIds:g.widgetTagConfig?.displayedTagIds||[],displayedCategoryIds:g.widgetTagConfig?.displayedCategoryIds||[]},(e,t)=>{g.widgetTagConfig={displayedTagIds:e,displayedCategoryIds:t}})}const u=(0,m.ref)(''),d=(0,m.computed)(()=>a.tableHeaders.filter(e=>!g.displayTagColumns.includes(e)));function p(){u.value&&(g.displayTagColumns.push(u.value),u.value='')}const g=(0,m.reactive)({titleColumn:'',displayTagColumns:[],widgetTagConfig:{displayedTagIds:[],displayedCategoryIds:[]},displayStyle:'list'});function v(){o('update:visible',!1),o('close')}return(0,m.watch)(()=>a.visible,e=>{e&&(a.widgetConfig?(g.titleColumn=a.widgetConfig.titleColumn||'',g.displayTagColumns=[...a.widgetConfig.displayTagColumns||[]],g.displayStyle=a.widgetConfig.displayStyle||'list',g.widgetTagConfig={displayedTagIds:[...a.widgetConfig.widgetTagConfig?.displayedTagIds||[]],displayedCategoryIds:[...a.widgetConfig.widgetTagConfig?.displayedCategoryIds||[]]}):(g.titleColumn='',g.displayTagColumns=[],g.displayStyle='list',g.widgetTagConfig={displayedTagIds:[],displayedCategoryIds:[]}))},{immediate:!0}),(0,m.watch)(g,()=>{a.visible&&a.widgetId&&function(){if(!a.widgetId)return;const e=(g.widgetTagConfig.displayedTagIds?.length||0)>0||(g.widgetTagConfig.displayedCategoryIds?.length||0)>0;r.updateWidget(a.widgetId,{titleColumn:g.titleColumn||void 0,displayTagColumns:g.displayTagColumns.length>0?g.displayTagColumns:void 0,widgetTagConfig:e?g.widgetTagConfig:void 0,displayStyle:g.displayStyle})}()},{deep:!0}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(v,['self'])},[(0,m.createElementVNode)('div',ax,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',ox,[a[4]||(a[4]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},[(0,m.createElementVNode)('i',{class:'fas fa-cog'}),(0,m.createTextVNode)(' ç»„ä»¶è®¾ç½® ')],-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(v,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',nx,[(0,m.createCommentVNode)(' æ˜¾ç¤ºé£æ ¼é…ç½® '),(0,m.createElementVNode)('div',rx,[a[6]||(a[6]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-paint-brush'}),(0,m.createTextVNode)(' æ˜¾ç¤ºé£æ ¼ ')],-1)),(0,m.createElementVNode)('div',lx,[(0,m.createElementVNode)('div',ix,[a[5]||(a[5]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ç»„ä»¶æ¨¡æ¿ '),(0,m.createElementVNode)('span',{class:'hint'},'é€‰æ‹©ç»„ä»¶çš„å±•ç¤ºæ–¹å¼')],-1)),(0,m.createElementVNode)('div',cx,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[0]||(a[0]=e=>g.displayStyle=e),class:'acu-select'},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)((0,m.unref)(_t.Qo),e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e.value,value:e.value},(0,m.toDisplayString)(e.label),9,sx))),128))],512),[[m.vModelSelect,g.displayStyle]])])])])]),(0,m.createCommentVNode)(' è¡Œæ ‡é¢˜é…ç½® '),(0,m.createElementVNode)('div',ux,[a[9]||(a[9]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-heading'}),(0,m.createTextVNode)(' è¡Œæ ‡é¢˜åˆ— ')],-1)),(0,m.createElementVNode)('div',dx,[(0,m.createElementVNode)('div',px,[a[8]||(a[8]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ ‡é¢˜æ¥æºåˆ— '),(0,m.createElementVNode)('span',{class:'hint'},'æ¯è¡Œæ˜¾ç¤ºçš„ä¸»æ ‡é¢˜å–è‡ªå“ªä¸€åˆ—')],-1)),(0,m.createElementVNode)('div',mx,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[1]||(a[1]=e=>g.titleColumn=e),class:'acu-select'},[a[7]||(a[7]=(0,m.createElementVNode)('option',{value:''},'é»˜è®¤ï¼ˆç¬¬ä¸€åˆ—ï¼‰',-1)),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(e.tableHeaders,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e,value:e},(0,m.toDisplayString)(e),9,fx))),128))],512),[[m.vModelSelect,g.titleColumn]])])])])]),(0,m.createCommentVNode)(' å±•ç¤ºæ ‡ç­¾é…ç½® '),(0,m.createElementVNode)('div',gx,[a[13]||(a[13]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-tags'}),(0,m.createTextVNode)(' å±•ç¤ºæ ‡ç­¾ ')],-1)),(0,m.createElementVNode)('div',vx,[(0,m.createElementVNode)('div',bx,[a[11]||(a[11]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ ‡ç­¾æ¥æºåˆ— '),(0,m.createElementVNode)('span',{class:'hint'},'é€‰ä¸­çš„åˆ—å€¼å°†ä½œä¸ºå¾½ç« æ˜¾ç¤ºåœ¨è¡Œä¸Šï¼ˆçº¯å±•ç¤ºï¼‰')],-1)),(0,m.createElementVNode)('div',hx,[(0,m.withDirectives)((0,m.createElementVNode)('select',{'onUpdate:modelValue':a[2]||(a[2]=e=>u.value=e),class:'acu-select',onChange:p},[a[10]||(a[10]=(0,m.createElementVNode)('option',{value:''},'é€‰æ‹©è¦æ·»åŠ çš„åˆ—...',-1)),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(d.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('option',{key:e,value:e},(0,m.toDisplayString)(e),9,xx))),128))],544),[[m.vModelSelect,u.value]])])]),(0,m.createCommentVNode)(' å·²é€‰æ‹©çš„åˆ—æ ‡ç­¾ '),g.displayTagColumns.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',yx,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(g.displayTagColumns,e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e,class:'acu-selected-tag'},[(0,m.createTextVNode)((0,m.toDisplayString)(e)+' ',1),(0,m.createElementVNode)('button',{class:'acu-tag-remove',onClick:(0,m.withModifiers)(t=>function(e){const t=g.displayTagColumns.indexOf(e);t>-1&&g.displayTagColumns.splice(t,1)}(e),['stop'])},[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])],8,wx)]))),128))])):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createCommentVNode)(' äº’åŠ¨æ ‡ç­¾é…ç½®å…¥å£ '),(0,m.createElementVNode)('div',kx,[a[17]||(a[17]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-bolt'}),(0,m.createTextVNode)(' äº’åŠ¨æ ‡ç­¾ ')],-1)),(0,m.createElementVNode)('div',Cx,[(0,m.createCommentVNode)(' å¯¼èˆªè¡Œï¼šç‚¹å‡»æ‰“å¼€æ ‡ç­¾ç®¡ç†å™¨ï¼ˆå«å·²é…ç½®é¢„è§ˆï¼‰ '),(0,m.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:(0,m.withModifiers)(s,['stop'])},[(0,m.createElementVNode)('div',Nx,[a[14]||(a[14]=(0,m.createTextVNode)(' ç®¡ç†äº’åŠ¨æ ‡ç­¾ ',-1)),i.value>0||c.value>0?((0,m.openBlock)(),(0,m.createElementBlock)('span',Vx,' å·²é…ç½® '+(0,m.toDisplayString)(i.value)+' ä¸ªæ ‡ç­¾ï¼Œ'+(0,m.toDisplayString)(c.value)+' ä¸ªåˆ†ç±» ',1)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Ex,'ç‚¹å‡»é…ç½®å¯ç‚¹å‡»çš„äº’åŠ¨æ ‡ç­¾'))]),a[15]||(a[15]=(0,m.createElementVNode)('div',{class:'acu-settings-control'},[(0,m.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1))]),(0,m.createCommentVNode)(' è‡ªåŠ¨å­˜å…¥äº’åŠ¨æ ‡ç­¾ (å…¨å±€è®¾ç½®) '),(0,m.createElementVNode)('div',Bx,[a[16]||(a[16]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è‡ªåŠ¨å­˜å…¥äº’åŠ¨æ ‡ç­¾ '),(0,m.createElementVNode)('span',{class:'hint'},'AI ç”Ÿæˆäº¤äº’è¡¨æ ¼åè‡ªåŠ¨å­˜å…¥æ ‡ç­¾åº“ (å…¨å±€ç”Ÿæ•ˆ)')],-1)),(0,m.createElementVNode)('div',Sx,[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-switch',{active:(0,m.unref)(n).config.autoImportInteractions}]),onClick:a[3]||(a[3]=e=>(0,m.unref)(n).config.autoImportInteractions=!(0,m.unref)(n).config.autoImportInteractions)},null,2)])])])])])],512)])):(0,m.createCommentVNode)('v-if',!0)}}),Dx={class:'tarot-card__inner'},Ax={class:'tarot-card__face tarot-card__back'},zx={class:'tarot-card__face tarot-card__front'},Ix=(0,m.defineComponent)({__name:'TarotCard',props:{themeId:{default:'wafuku'},isFlipped:{type:Boolean},result:{},cardBackImage:{default:''},peepMode:{type:Boolean,default:!1}},emits:['flip','confirm'],setup(e,{emit:t}){const a=e,o=t,n=(0,m.computed)(()=>{return e=a.themeId,Hp[e]||Hp.wafuku;var e}),r=(0,m.computed)(()=>a.cardBackImage||n.value.defaultBackImage||''),l=(0,m.ref)(220/385),i=(0,m.computed)(()=>({aspectRatio:`${l.value}`}));function c(e){const t=Math.max(.5,Math.min(1,e));l.value=t}const s=(0,m.computed)(()=>a.result?{luckName:a.result.luck.name,luckColor:a.result.luck.color,dimensions:a.result.dimensions.map(e=>e.value),words:a.result.words,peepMode:a.peepMode}:null);function u(){a.isFlipped?o('confirm'):o('flip')}return(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:(0,m.normalizeClass)(['tarot-card',[`tarot-card--theme-${e.themeId}`,{'tarot-card--flipped':e.isFlipped}]]),style:(0,m.normalizeStyle)(i.value),onClick:(0,m.withModifiers)(u,['stop'])},[(0,m.createElementVNode)('div',Dx,[(0,m.createCommentVNode)(' å¡èƒŒï¼ˆåˆå§‹æ˜¾ç¤ºï¼‰ '),(0,m.createElementVNode)('div',Ax,[((0,m.openBlock)(),(0,m.createBlock)((0,m.resolveDynamicComponent)(n.value.CardBack),{'image-url':r.value,onLoad:c},null,40,['image-url']))]),(0,m.createCommentVNode)(' å¡é¢ï¼ˆç¿»è½¬åæ˜¾ç¤ºï¼‰ '),(0,m.createElementVNode)('div',zx,[s.value?((0,m.openBlock)(),(0,m.createBlock)((0,m.resolveDynamicComponent)(n.value.CardFront),{key:0,'luck-name':s.value.luckName,'luck-color':s.value.luckColor,dimensions:s.value.dimensions,words:s.value.words,'peep-mode':s.value.peepMode},null,8,['luck-name','luck-color','dimensions','words','peep-mode'])):(0,m.createCommentVNode)('v-if',!0)])])],6))}}),_x={class:'divination-starfield'},Mx={class:'divination-content'},Ux={class:'divination-stage'},$x={class:'divination-footer'},Lx={key:0,class:'divination-hint'},Px=(0,m.defineComponent)({__name:'DivinationOverlay',props:{visible:{type:Boolean},result:{}},emits:['close','confirm','retry'],setup(e,{emit:t}){const a=e,o=t,n=(0,Mt.E)(),r=((0,f.JH)(),(0,k.j_)()),l=window.parent.document.body,i=(0,m.ref)(!1),c=(0,m.computed)(()=>Array.from({length:50}).map((_,e)=>({id:e,left:100*Math.random()+'%',top:100*Math.random()+'%',size:2*Math.random()+1,delay:5*Math.random(),duration:3*Math.random()+2})));function s(){o('close')}function u(){i.value&&p()}function d(){i.value=!0}function p(){const e=n.config;r.divinationOverlay.isQuickRerollMode?o('confirm','reroll'):e.peepMode?o('confirm','hide'):o('confirm','reveal')}function g(){o('retry')}return(0,m.watch)(()=>a.visible,e=>{e&&('auto'===n.config.flipMode?(i.value=!1,setTimeout(()=>{i.value=!0},500)):i.value=!1)}),(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Teleport,{to:(0,m.unref)(l)},[(0,m.createVNode)(m.Transition,{'enter-active-class':'divination-overlay-enter-active','leave-active-class':'divination-overlay-leave-active'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'divination-overlay',style:{zIndex:2147483647},onClick:u},[(0,m.createCommentVNode)(' å™ªç‚¹çº¹ç†å±‚ '),a[4]||(a[4]=(0,m.createElementVNode)('div',{class:'divination-grain'},null,-1)),(0,m.createCommentVNode)(' åŠ¨æ€æ˜Ÿç©º '),(0,m.createElementVNode)('div',_x,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(c.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:'divination-star',style:(0,m.normalizeStyle)({left:e.left,top:e.top,width:`${e.size}px`,height:`${e.size}px`,'--duration':`${e.duration}s`,'--delay':`${e.delay}s`})},null,4))),128))]),(0,m.createCommentVNode)(' æµåŠ¨æ˜Ÿäº‘ '),a[5]||(a[5]=(0,m.createElementVNode)('div',{class:'divination-nebula divination-nebula--purple'},null,-1)),a[6]||(a[6]=(0,m.createElementVNode)('div',{class:'divination-nebula divination-nebula--golden'},null,-1)),(0,m.createCommentVNode)(' ä¸­å¿ƒå…‰æ™• '),a[7]||(a[7]=(0,m.createElementVNode)('div',{class:'divination-central-glow'},null,-1)),(0,m.createCommentVNode)(' ç¥åœ£å‡ ä½•èƒŒæ™¯ '),a[8]||(a[8]=(0,m.createElementVNode)('div',{class:'divination-geometry divination-geometry--outer'},[(0,m.createElementVNode)('svg',{viewBox:'0 0 100 100',fill:'none',stroke:'#D4AF37','stroke-width':'0.05'},[(0,m.createElementVNode)('circle',{cx:'50',cy:'50',r:'48'}),(0,m.createElementVNode)('path',{d:'M50 0 L93 75 L6 75 Z',opacity:'0.5'}),(0,m.createElementVNode)('path',{d:'M50 100 L93 25 L6 25 Z',opacity:'0.5'})])],-1)),a[9]||(a[9]=(0,m.createElementVNode)('div',{class:'divination-geometry divination-geometry--inner'},[(0,m.createElementVNode)('svg',{viewBox:'0 0 100 100',fill:'none',stroke:'#C6A664','stroke-width':'0.1'},[(0,m.createElementVNode)('circle',{cx:'50',cy:'50',r:'45','stroke-dasharray':'2 1'}),(0,m.createElementVNode)('circle',{cx:'50',cy:'50',r:'30'}),(0,m.createElementVNode)('rect',{x:'29',y:'29',width:'42',height:'42',transform:'rotate(45 50 50)'}),(0,m.createElementVNode)('rect',{x:'29',y:'29',width:'42',height:'42',transform:'rotate(0 50 50)'})])],-1)),(0,m.createCommentVNode)(' è£…é¥°è¾¹æ¡† '),a[10]||(a[10]=(0,m.createElementVNode)('div',{class:'divination-frame'},[(0,m.createElementVNode)('div',{class:'divination-frame__corner divination-frame__corner--tl'}),(0,m.createElementVNode)('div',{class:'divination-frame__corner divination-frame__corner--tr'}),(0,m.createElementVNode)('div',{class:'divination-frame__corner divination-frame__corner--bl'}),(0,m.createElementVNode)('div',{class:'divination-frame__corner divination-frame__corner--br'}),(0,m.createElementVNode)('div',{class:'divination-frame__top-line'}),(0,m.createElementVNode)('div',{class:'divination-frame__bottom-line'})],-1)),(0,m.createCommentVNode)(' å…³é—­æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'divination-close',onClick:(0,m.withModifiers)(s,['stop'])},[...a[1]||(a[1]=[(0,m.createElementVNode)('svg',{xmlns:'http://www.w3.org/2000/svg',width:'20',height:'20',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2','stroke-linecap':'round','stroke-linejoin':'round'},[(0,m.createElementVNode)('path',{d:'M18 6 6 18'}),(0,m.createElementVNode)('path',{d:'m6 6 12 12'})],-1)])]),(0,m.createCommentVNode)(' å†…å®¹åŒºåŸŸ '),(0,m.createElementVNode)('div',Mx,[(0,m.createCommentVNode)(' é¡¶éƒ¨è£…é¥°ï¼ˆç§»é™¤æ–‡å­—ï¼Œä¿ç•™è£…é¥°å…ƒç´ ï¼‰ '),a[3]||(a[3]=(0,m.createElementVNode)('div',{class:'divination-header'},[(0,m.createElementVNode)('div',{class:'divination-header__title'},[(0,m.createElementVNode)('span',{class:'divination-header__sparkle divination-header__sparkle--static'},[(0,m.createElementVNode)('svg',{xmlns:'http://www.w3.org/2000/svg',width:'32',height:'32',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'1.5','stroke-linecap':'round','stroke-linejoin':'round'},[(0,m.createElementVNode)('path',{d:'M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z'})])]),(0,m.createElementVNode)('div',{class:'divination-header__divider'})])],-1)),(0,m.createCommentVNode)(' å¡ç‰‡èˆå° '),(0,m.createElementVNode)('div',Ux,[(0,m.createVNode)(Ix,{'is-flipped':i.value,result:e.result,'card-back-image':(0,m.unref)(n).config.cardBackImage,'theme-id':(0,m.unref)(n).config.themeId,'peep-mode':(0,m.unref)(n).config.peepMode,onFlip:d,onConfirm:a[0]||(a[0]=e=>p())},null,8,['is-flipped','result','card-back-image','theme-id','peep-mode'])]),(0,m.createCommentVNode)(' åº•éƒ¨æ§åˆ¶åŒºï¼šæç¤ºæ–‡å­—å’Œå†æŠ½ä¸€æ¬¡æŒ‰é’®å…±ç”¨åŒä¸€ä½ç½® '),(0,m.createElementVNode)('div',$x,[(0,m.createCommentVNode)(' ç¿»ç‰Œå‰æç¤º '),i.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' ç¿»ç‰Œåæ˜¾ç¤ºå†æŠ½ä¸€æ¬¡æŒ‰é’® '),(0,m.createElementVNode)('button',{class:'divination-btn divination-btn--retry',onClick:(0,m.withModifiers)(g,['stop'])},'å†æŠ½ä¸€æ¬¡')],2112)):((0,m.openBlock)(),(0,m.createElementBlock)('div',Lx,[...a[2]||(a[2]=[(0,m.createElementVNode)('p',{class:'divination-hint__text'},'ç‚¹å‡»ç‰Œé¢ æ­æ™“å‘½è¿',-1)])]))])])])):(0,m.createCommentVNode)('v-if',!0)]),_:1})],8,['to']))}}),Fx={class:'acu-action-bar'},jx=['title','onClick','onMousedown','onTouchstartPassive'],Ox={key:0,class:'secondary-indicator'},Rx=['title','onClick'];Boolean,Boolean;d(590);const Hx={key:0,class:'acu-toast'},Wx={class:'acu-toast-message'},Gx=(0,m.defineComponent)({__name:'Toast',props:{visible:{type:Boolean},message:{}},setup:e=>(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'toast'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',Hx,[a[0]||(a[0]=(0,m.createElementVNode)('i',{class:'fas fa-info-circle'},null,-1)),(0,m.createElementVNode)('span',Wx,(0,m.toDisplayString)(e.message),1)])):(0,m.createCommentVNode)('v-if',!0)]),_:1}))});d(7141);const Yx=['title','onClick'],Xx=(0,m.defineComponent)({__name:'TabsPopup',props:{visible:{type:Boolean},tabs:{},activeTab:{},gridColumns:{default:'repeat(auto-fill, minmax(90px, 1fr))'},showDashboard:{type:Boolean,default:!0},showRelationshipGraph:{type:Boolean,default:!1},showOptionsPanel:{type:Boolean,default:!1}},emits:['close','tab-click'],setup(e,{emit:t}){const a=e,o=t,n=(0,w.D)(),r=(0,k.j_)();function l(e){return e===k.H6||e===k.$9||e===k.SC}const i=(0,m.computed)(()=>{const e=r.visibleTabs;if(!e||0===e.length){const e=[];return a.showDashboard&&e.push({id:k.H6,name:'ä»ªè¡¨ç›˜',icon:'fas fa-home'}),e.push(...a.tabs),a.showRelationshipGraph&&e.push({id:k.SC,name:'å…³ç³»å›¾',icon:'fas fa-project-diagram'}),a.showOptionsPanel&&e.push({id:k.$9,name:'é€‰é¡¹',icon:'fas fa-sliders-h'}),e}return e.map(e=>function(e){return e===k.H6?{id:k.H6,name:'ä»ªè¡¨ç›˜',icon:'fas fa-home'}:e===k.SC?{id:k.SC,name:'å…³ç³»å›¾',icon:'fas fa-project-diagram'}:e===k.$9?{id:k.$9,name:'é€‰é¡¹',icon:'fas fa-sliders-h'}:a.tabs.find(t=>t.id===e)}(e)).filter(e=>!!e&&(!(e.id===k.H6&&!a.showDashboard)&&(!(e.id===k.SC&&!a.showRelationshipGraph)&&!(e.id===k.$9&&!a.showOptionsPanel))))});function c(e){return n.hasTableIssues(e)}return(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Transition,{name:'hidden-popup'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-tabs-popup',onClick:a[0]||(a[0]=(0,m.withModifiers)(()=>{},['stop']))},[(0,m.createElementVNode)('div',{class:'popup-tabs-grid',style:(0,m.normalizeStyle)({'--acu-nav-cols':e.gridColumns})},[(0,m.createCommentVNode)(' ç»Ÿä¸€ Tab åˆ—è¡¨ï¼ˆå·²è¿‡æ»¤å’Œæ’åºï¼‰ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(i.value,t=>{return(0,m.openBlock)(),(0,m.createElementBlock)('button',{key:t.id,class:(0,m.normalizeClass)(['acu-nav-btn',{active:e.activeTab===t.id,'has-issues':!l(t.id)&&c(t.name),'has-ai-changes':!l(t.id)&&!c(t.name)&&(a=t.name,n.hasTableAiChanges(a))}]),title:t.name,onClick:(0,m.withModifiers)(e=>{return a=t.id,o('tab-click',a),void o('close');var a},['stop'])},[t.icon?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(t.icon)},null,2)):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(t.name),1)],10,Yx);var a}),128))],4)])):(0,m.createCommentVNode)('v-if',!0)]),_:1}))}});d(3651);const qx=(0,Ye.A)(Xx,[['__scopeId','data-v-53ac0e66']]),Kx={class:'acu-modal acu-prompt-editor-modal'},Jx={class:'acu-modal-header'},Qx={class:'acu-modal-body'},Zx={class:'acu-settings-section'},ey={class:'acu-settings-group'},ty={class:'acu-settings-row',style:{'flex-direction':'column','align-items':'flex-start'}},ay={class:'acu-modal-footer'},oy=(0,m.defineComponent)({__name:'PromptEditorDialog',props:{visible:{type:Boolean},prompt:{}},emits:['close','save'],setup(e,{emit:t}){const a=e,o=t,n=(0,k.j_)(),r=(0,S.d)(),l=(0,m.ref)(''),i=window.parent.document.body;function c(){o('close')}function s(){l.value='',r.info('æç¤ºè¯å·²æ¸…ç©ºï¼ˆéœ€ç‚¹å‡»ä¿å­˜ç”Ÿæ•ˆï¼‰')}function u(){o('save',l.value),r.success('éšè—æç¤ºè¯å·²ä¿å­˜'),c()}return(0,m.watch)(()=>[a.visible,a.prompt],([e,t])=>{e&&(l.value=t||'')},{immediate:!0}),(t,a)=>((0,m.openBlock)(),(0,m.createBlock)(m.Teleport,{to:(0,m.unref)(i)},[(0,m.createVNode)(m.Transition,{name:'modal'},{default:(0,m.withCtx)(()=>[e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:(0,m.normalizeClass)(['acu-modal-container',{'acu-center-modal':(0,m.unref)(n).isMobile}]),onClick:(0,m.withModifiers)(c,['self'])},[(0,m.createElementVNode)('div',Kx,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Jx,[a[1]||(a[1]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},[(0,m.createElementVNode)('i',{class:'fas fa-eye-slash'}),(0,m.createTextVNode)(' éšè—æç¤ºè¯ ')],-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(c,['stop'])},'å…³é—­')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Qx,[(0,m.createElementVNode)('div',Zx,[a[3]||(a[3]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-edit'}),(0,m.createTextVNode)(' ç¼–è¾‘æç¤ºè¯ ')],-1)),(0,m.createElementVNode)('div',ey,[(0,m.createElementVNode)('div',ty,[a[2]||(a[2]=(0,m.createElementVNode)('div',{class:'acu-settings-label',style:{'margin-bottom':'8px'}},[(0,m.createTextVNode)(' æç¤ºè¯å†…å®¹ '),(0,m.createElementVNode)('span',{class:'hint'},'å‘é€æ¶ˆæ¯æ—¶ä¼šè‡ªåŠ¨æ³¨å…¥åˆ°ç”¨æˆ·è¾“å…¥ä¹‹å‰')],-1)),(0,m.withDirectives)((0,m.createElementVNode)('textarea',{'onUpdate:modelValue':a[0]||(a[0]=e=>l.value=e),class:'acu-textarea-scrollable',style:{width:'100%',height:'150px'},placeholder:'è¾“å…¥è¦éšè—çš„æç¤ºè¯...'},null,512),[[m.vModelText,l.value]])])])])]),(0,m.createCommentVNode)(' åº•éƒ¨æŒ‰é’® '),(0,m.createElementVNode)('div',ay,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(s,['stop'])},'æ¸…ç©º'),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary',onClick:(0,m.withModifiers)(u,['stop'])},'ä¿å­˜')])])],2)):(0,m.createCommentVNode)('v-if',!0)]),_:1})],8,['to']))}}),ny=['onClick'],ry={class:'acu-badge-label'},ly={key:0,class:'acu-badge-icon'},iy={key:0,class:'fas fa-check added-icon'},cy={key:1,class:'fas fa-plus add-icon'},sy={key:1,class:'acu-badge-icon tap-icon'},uy={key:2,class:'acu-badge-delete'},dy={key:0,class:'acu-grid-empty'},py=(0,m.defineComponent)({__name:'TagBadgeGrid',props:{mode:{},displayedTagIds:{default:()=>[]}},emits:['tagClick','createTag','deleteTag','addTag'],setup(e,{emit:t}){const a=e,o=t,n=(0,$t.A)(),r=(0,m.computed)(()=>n.filteredTags),l=(0,m.computed)(()=>n.selectedTagIds),i=(0,m.computed)(()=>new Set(a.displayedTagIds)),c=(0,m.computed)(()=>n.searchKeyword?'æœªæ‰¾åˆ°åŒ¹é…çš„æ ‡ç­¾':'æœªåˆ†ç±»'===n.selectedLevel1?'æš‚æ— æœªåˆ†ç±»çš„æ ‡ç­¾':n.selectedLevel1?`"${n.selectedLevel1}" åˆ†ç±»ä¸‹æš‚æ— æ ‡ç­¾`:'æš‚æ— æ ‡ç­¾ï¼Œç‚¹å‡»æ–°å»ºæŒ‰é’®åˆ›å»º');function s(e){switch(a.mode){case'normal':case'create':o('tagClick',e);break;case'add':o('addTag',e.id);break;case'delete':o('deleteTag',e.id);break;case'migrate':case'export':t=e.id,n.toggleTagSelection(t)}var t}function u(){'create'===a.mode&&o('createTag')}return(t,a)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:'acu-tag-grid',onClick:u},[(0,m.createCommentVNode)(' æ ‡ç­¾åˆ—è¡¨ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(r.value,t=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t.id,class:(0,m.normalizeClass)(['acu-tag-badge',{selected:l.value.has(t.id),added:i.value.has(t.id),'mode-add':'add'===e.mode,'mode-delete':'delete'===e.mode}]),onClick:(0,m.withModifiers)(e=>s(t),['stop'])},[(0,m.createCommentVNode)(' æ ‡ç­¾æ–‡æœ¬ '),(0,m.createElementVNode)('span',ry,(0,m.toDisplayString)(t.label),1),(0,m.createCommentVNode)(' æ·»åŠ æ¨¡å¼ï¼šå·²æ·»åŠ æ˜¾ç¤ºâœ“ï¼Œæœªæ·»åŠ æ˜¾ç¤º+ '),'add'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('span',ly,[i.value.has(t.id)?((0,m.openBlock)(),(0,m.createElementBlock)('i',iy)):((0,m.openBlock)(),(0,m.createElementBlock)('i',cy))])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è¿ç§»/å¯¼å‡ºæ¨¡å¼ï¼šæ‰‹æŒ‡ç‚¹å‡»å›¾æ ‡ '),'migrate'===e.mode||'export'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('span',sy,[...a[0]||(a[0]=[(0,m.createElementVNode)('i',{class:'fas fa-hand-pointer'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' åˆ é™¤æ¨¡å¼ï¼šåˆ é™¤å›¾æ ‡ï¼ˆå¸¸é©»ï¼‰ '),'delete'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('span',uy,[...a[1]||(a[1]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0)],10,ny))),128)),(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===r.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',dy,[a[2]||(a[2]=(0,m.createElementVNode)('i',{class:'fas fa-tag'},null,-1)),(0,m.createElementVNode)('span',null,(0,m.toDisplayString)(c.value),1)])):(0,m.createCommentVNode)('v-if',!0)]))}}),my={class:'acu-tree-icon'},fy={key:1},gy={class:'acu-tree-count'},vy={key:0,class:'acu-root-icon-editor'},by={class:'acu-tree-count'},hy={key:1,class:'acu-tree-divider'},xy=['data-category-id','onClick'],yy=['onClick'],wy={key:1,class:'acu-tree-toggle-placeholder'},ky={key:2,class:'acu-tree-icon'},Cy={key:1},Ny={class:'acu-tree-label'},Vy={class:'acu-tree-count'},Ey=['onClick'],By=['onClick'],Sy=['onClick'],Ty=['onClick'],Dy={key:2,class:'acu-tree-empty'},Ay='acu_tag_library_root_icon',zy=(0,m.defineComponent)({__name:'TagCategoryTree',props:{mode:{}},emits:['categoryClick','addCategory','migrateToCategory','deleteCategory'],setup(e,{emit:t}){const a=e,o=t,n=(0,$t.A)(),r=((0,k.j_)(),(0,m.ref)(null)),l=(0,m.ref)(new Set),i=(0,m.ref)(null),c=(0,m.ref)(!1),s=(0,m.ref)(''),u=(0,m.ref)(localStorage.getItem(Ay)||'ğŸ“‚'),d=(0,m.computed)(()=>n.selectedLevel1),p=(0,m.computed)(()=>{if(!n.selectedLevel1||'å…¨éƒ¨'===n.selectedLevel1||'æœªåˆ†ç±»'===n.selectedLevel1)return null;const e=n.selectedLevel2?`${n.selectedLevel1}/${n.selectedLevel2}`:n.selectedLevel1;return n.getCategoryByPath(e)?.id||null}),f=(0,m.computed)(()=>n.totalTags),g=(0,m.computed)(()=>n.uncategorizedCount),v=(0,m.computed)(()=>n.selectedCategoryIds),b=(0,m.computed)(()=>n.selectionType),h=(0,m.computed)(()=>{const e=[],t=n.library.categories,a=new Map;t.forEach(e=>{a.set(e.path,e)});function o(r,i,c){const s=a.get(r);if(!s)return;const u=t.filter(e=>{if(!e.path.startsWith(r+'/'))return!1;return!e.path.slice(r.length+1).includes('/')}),d=r.split('/');e.push({id:s.id,name:d[d.length-1],level1:d[0],path:s.path,icon:s.icon,depth:i,hasChildren:u.length>0,tagCount:n.getCategoryTagCount(s.id),parentId:c}),l.value.has(s.id)&&u.sort((e,t)=>e.path.localeCompare(t.path,'zh-CN')).forEach(e=>{o(e.path,i+1,s.id)})}return t.filter(e=>!e.path.includes('/')).sort((e,t)=>e.path.localeCompare(t.path,'zh-CN')).forEach(e=>{o(e.path,0)}),e});function x(e){return e.startsWith('fa')||e.includes(' fa-')}function y(){s.value&&(u.value=s.value,localStorage.setItem(Ay,s.value),s.value='',c.value=!1)}function w(){n.selectLevel1(''),o('categoryClick',null)}function C(e){o('migrateToCategory',e)}function N(e){const t=e.target,a=t.querySelectorAll('.acu-tag-tree-item'),o=t.getBoundingClientRect().top;let n=null;for(let e=0;e<a.length;e++){const t=a[e];if(!(t.getBoundingClientRect().top<o+10))break;n=t}if(!n)return void(i.value=null);const r=n.dataset.categoryId;if(!r)return void(i.value=null);const c=h.value.find(e=>e.id===r);c?c.hasChildren&&l.value.has(c.id)?i.value=c.id:c.parentId&&l.value.has(c.parentId)?i.value=c.parentId:i.value=null:i.value=null}return(0,m.watch)(()=>a.mode,e=>{'migrate'!==e&&n.clearSelection()}),(t,k)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{ref_key:'treeContainer',ref:r,class:'acu-tag-tree',onScroll:N},[(0,m.createCommentVNode)(' æ ¹ç›®å½•ï¼ˆåŸ"å…¨éƒ¨"ï¼‰ '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-tag-tree-item acu-root-item',{active:'å…¨éƒ¨'===d.value||''===d.value,'migrate-target':'migrate'===e.mode}]),onClick:w},[(0,m.createElementVNode)('span',my,[x(u.value)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(u.value)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',fy,(0,m.toDisplayString)(u.value),1))]),k[12]||(k[12]=(0,m.createElementVNode)('span',{class:'acu-tree-label'},'æ ¹ç›®å½•',-1)),(0,m.createElementVNode)('span',gy,'('+(0,m.toDisplayString)(f.value)+')',1),(0,m.createCommentVNode)(' æ·»åŠ æ¨¡å¼ï¼šæ·»åŠ æŒ‰é’® '),'add'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-add-btn',title:'æ·»åŠ æ ¹ç›®å½•åˆ°å±•ç¤ºåŒº',onClick:k[0]||(k[0]=(0,m.withModifiers)(e=>o('addCategory','root'),['stop']))},[...k[8]||(k[8]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è¿ç§»æ¨¡å¼ï¼šè¿å…¥æŒ‰é’®ï¼ˆå°†åˆ†ç±»è¿ç§»åˆ°æ ¹çº§=å˜æˆä¸€çº§åˆ†ç±»ï¼‰ '),'migrate'===e.mode&&'category'===b.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:1,class:'acu-migrate-btn',title:'è¿å…¥åˆ°æ ¹ç›®å½•ï¼ˆå˜æˆä¸€çº§åˆ†ç±»ï¼‰',onClick:k[1]||(k[1]=(0,m.withModifiers)(e=>C('root'),['stop']))},[...k[9]||(k[9]=[(0,m.createElementVNode)('i',{class:'fas fa-sign-in-alt'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' åˆ é™¤æ¨¡å¼ï¼šæ¸…ç©ºæŒ‰é’® '),'delete'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:2,class:'acu-delete-btn',title:'æ¸…ç©ºæ‰€æœ‰æ ‡ç­¾å’Œåˆ†ç±»',onClick:k[2]||(k[2]=(0,m.withModifiers)(e=>o('deleteCategory','root'),['stop']))},[...k[10]||(k[10]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' ç¼–è¾‘å›¾æ ‡æŒ‰é’®ï¼ˆæ™®é€šæ¨¡å¼ï¼‰ '),'normal'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:3,class:'acu-edit-icon-btn',title:'ä¿®æ”¹å›¾æ ‡',onClick:k[3]||(k[3]=(0,m.withModifiers)(e=>c.value=!c.value,['stop']))},[...k[11]||(k[11]=[(0,m.createElementVNode)('i',{class:'fas fa-palette'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0)],2),(0,m.createCommentVNode)(' æ ¹ç›®å½•å›¾æ ‡ç¼–è¾‘å™¨ '),c.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',vy,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':k[4]||(k[4]=e=>s.value=e),type:'text',class:'acu-icon-input',placeholder:'è¾“å…¥emoji',maxlength:'2',onKeyup:(0,m.withKeys)(y,['enter'])},null,544),[[m.vModelText,s.value]]),(0,m.createElementVNode)('button',{class:'acu-btn-small',onClick:(0,m.withModifiers)(y,['stop'])},[...k[13]||(k[13]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-btn-small',onClick:k[5]||(k[5]=(0,m.withModifiers)(e=>c.value=!1,['stop']))},[...k[14]||(k[14]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' æœªåˆ†ç±» '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-tag-tree-item',{active:'æœªåˆ†ç±»'===d.value,'migrate-target':'migrate'===e.mode&&'tag'===b.value}]),onClick:k[7]||(k[7]=e=>function(e){if('add'===a.mode){if('å…¨éƒ¨'!==e&&'æœªåˆ†ç±»'!==e){const t=n.library.categories.find(t=>t.path===e);t&&o('categoryClick',t)}}else n.selectLevel1('å…¨éƒ¨'===e?'':e),o('categoryClick',null)}('æœªåˆ†ç±»'))},[k[16]||(k[16]=(0,m.createElementVNode)('span',{class:'acu-tree-icon'},'ğŸ“¦',-1)),k[17]||(k[17]=(0,m.createElementVNode)('span',{class:'acu-tree-label'},'æœªåˆ†ç±»',-1)),(0,m.createElementVNode)('span',by,'('+(0,m.toDisplayString)(g.value)+')',1),(0,m.createCommentVNode)(' è¿ç§»æ¨¡å¼ï¼šè¿å…¥æŒ‰é’® '),'migrate'===e.mode&&'tag'===b.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-migrate-btn',title:'è¿å…¥æ­¤åˆ†ç±»',onClick:k[6]||(k[6]=(0,m.withModifiers)(e=>C(''),['stop']))},[...k[15]||(k[15]=[(0,m.createElementVNode)('i',{class:'fas fa-sign-in-alt'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0)],2),(0,m.createCommentVNode)(' åˆ†éš”çº¿ '),h.value.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',hy)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è‡ªå®šä¹‰åˆ†ç±» '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(h.value,t=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:t.id,class:(0,m.normalizeClass)(['acu-tag-tree-item',{active:p.value===t.id||d.value===t.level1,expanded:l.value.has(t.id),sticky:i.value===t.id,selected:v.value.has(t.id),'migrate-target':'migrate'===e.mode}]),'data-category-id':t.id,onClick:e=>function(e){if('migrate'===a.mode&&'category'===n.selectionType)return void n.toggleCategorySelection(e.id);if('add'===a.mode)return n.selectLevel1(e.level1),void(e.depth>0?n.selectLevel2(e.name):n.selectLevel2(''));const t=p.value===e.id;if(n.selectLevel1(e.level1),e.depth>0?n.selectLevel2(e.name):n.selectLevel2(''),e.hasChildren){let a=!1;l.value.has(e.id)?t&&(l.value.delete(e.id),a=!0):(l.value.add(e.id),a=!0),a&&(l.value=new Set(l.value))}o('categoryClick',n.getCategoryById(e.id)||null)}(t)},[(0,m.createCommentVNode)(' å±•å¼€/æŠ˜å æŒ‰é’® '),t.hasChildren?((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:0,class:'acu-tree-toggle',onClick:(0,m.withModifiers)(e=>{return a=t.id,l.value.has(a)?l.value.delete(a):l.value.add(a),void(l.value=new Set(l.value));var a},['stop'])},(0,m.toDisplayString)(l.value.has(t.id)?'â–¼':'â–¶'),9,yy)):((0,m.openBlock)(),(0,m.createElementBlock)('span',wy)),(0,m.createCommentVNode)(' å›¾æ ‡ '),t.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',ky,[x(t.icon)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(t.icon)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Cy,(0,m.toDisplayString)(t.icon),1))])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' åç§° '),(0,m.createElementVNode)('span',Ny,(0,m.toDisplayString)(t.name),1),(0,m.createCommentVNode)(' è®¡æ•° '),(0,m.createElementVNode)('span',Vy,'('+(0,m.toDisplayString)(t.tagCount)+')',1),(0,m.createCommentVNode)(' æ·»åŠ æ¨¡å¼ï¼šæ·»åŠ æŒ‰é’®ï¼ˆå¸¸é©»ï¼‰ '),'add'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:3,class:'acu-add-btn',title:'æ·»åŠ åˆ°å±•ç¤ºåŒº',onClick:(0,m.withModifiers)(e=>{return a=t.id,void o('addCategory',a);var a},['stop'])},[...k[18]||(k[18]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])],8,Ey)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' è¿ç§»æ¨¡å¼ï¼šé€‰ä¸­æŒ‰é’® + è¿å…¥æŒ‰é’® '),'migrate'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:4},[(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-select-btn',{active:v.value.has(t.id)}]),title:'é€‰ä¸­æ­¤åˆ†ç±»',onClick:(0,m.withModifiers)(e=>{return a=t.id,void n.toggleCategorySelection(a);var a},['stop'])},[(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(v.value.has(t.id)?'fas fa-check-square':'far fa-square')},null,2)],10,By),(0,m.createElementVNode)('button',{class:'acu-migrate-btn',title:'è¿å…¥åˆ°æ­¤åˆ†ç±»',onClick:(0,m.withModifiers)(e=>C(t.id),['stop'])},[...k[19]||(k[19]=[(0,m.createElementVNode)('i',{class:'fas fa-sign-in-alt'},null,-1)])],8,Sy)],64)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' åˆ é™¤æ¨¡å¼ï¼šåˆ é™¤æŒ‰é’® '),'delete'===e.mode?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:5,class:'acu-delete-btn',title:'åˆ é™¤åˆ†ç±»',onClick:(0,m.withModifiers)(e=>{return a=t.id,void o('deleteCategory',a);var a},['stop'])},[...k[20]||(k[20]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])],8,Ty)):(0,m.createCommentVNode)('v-if',!0)],10,xy))),128)),(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===h.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Dy,[...k[21]||(k[21]=[(0,m.createElementVNode)('i',{class:'fas fa-folder-open'},null,-1),(0,m.createElementVNode)('span',null,'æš‚æ— è‡ªå®šä¹‰åˆ†ç±»',-1)])])):(0,m.createCommentVNode)('v-if',!0)],544))}}),Iy={class:'acu-modal acu-tag-edit-modal'},_y={class:'acu-modal-header'},My={class:'acu-modal-title'},Uy={class:'acu-header-actions'},$y=['disabled'],Ly={class:'acu-modal-body'},Py={class:'acu-settings-section'},Fy={class:'acu-settings-group'},jy={class:'acu-settings-row'},Oy={class:'acu-settings-control'},Ry={class:'acu-settings-row acu-category-row'},Hy={class:'acu-settings-control acu-category-control'},Wy={class:'selected-value'},Gy={key:1},Yy={class:'text'},Xy={key:1,class:'placeholder'},qy={key:0,class:'acu-custom-dropdown-menu'},Ky=['onClick'],Jy={key:1},Qy={class:'text'},Zy={class:'acu-settings-row'},ew={class:'acu-settings-control'},tw={class:'selected-value'},aw={key:1},ow={class:'text'},nw={key:1,class:'placeholder'},rw={key:0,class:'acu-custom-dropdown-menu'},lw=['onClick'],iw={key:1},cw={class:'text'},sw={class:'acu-settings-row acu-new-category-row'},uw={class:'acu-settings-control acu-new-category-control'},dw={key:1},pw={class:'acu-settings-row'},mw={class:'acu-settings-control'},fw={class:'acu-switch'},gw={class:'acu-settings-section'},vw={class:'acu-settings-group'},bw={class:'acu-settings-row column'},hw={class:'acu-settings-control'},xw={class:'acu-wildcard-shortcuts'},yw=['textContent'],ww=['textContent'],kw=['textContent'],Cw={class:'acu-wildcard-help'},Nw={key:0},Vw=['textContent'],Ew=['textContent'],Bw=['textContent'],Sw=(0,m.defineComponent)({__name:'TagEditDialog',props:{visible:{type:Boolean},tag:{},defaultCategoryId:{default:''}},emits:['update:visible','saved','close'],setup(e,{emit:t}){const a=e,o=t,n=(0,$t.A)(),r=(0,k.j_)(),l=(0,m.ref)(null),i=(0,m.ref)(null),c=(0,m.ref)({label:'',categoryId:'',promptTemplate:'',allowPreEdit:!1}),s=(0,m.ref)(!1),u=(0,m.ref)(''),d=(0,m.ref)(''),p=(0,m.ref)(!0),f=(0,m.ref)(!1),g=(0,m.ref)(!1),v=(0,m.ref)(''),b='{{value}}',h='{{rowTitle}}',x='{{user}}',y=(0,m.computed)(()=>!a.tag),w=(0,m.computed)(()=>n.library.categories),C=(0,m.computed)(()=>c.value.label.trim().length>0),N=(0,m.computed)(()=>c.value.categoryId&&w.value.find(e=>e.id===c.value.categoryId)||null),V=(0,m.computed)(()=>v.value&&w.value.find(e=>e.id===v.value)||null);function E(){o('update:visible',!1),o('close')}function B(){if(!C.value)return;const e={id:a.tag?.id||`tag_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,label:c.value.label.trim(),categoryId:c.value.categoryId,promptTemplate:c.value.promptTemplate,createdAt:a.tag?.createdAt||(new Date).toISOString(),allowPreEdit:c.value.allowPreEdit};n.upsertTag(e),o('saved',e),E()}function S(e){if(!i.value)return;const t=i.value,a=t.selectionStart,o=t.selectionEnd,n=c.value.promptTemplate;c.value.promptTemplate=n.slice(0,a)+e+n.slice(o),(0,m.nextTick)(()=>{t.focus(),t.setSelectionRange(a+e.length,a+e.length)})}function T(){let e=u.value.trim();if(!e)return;V.value&&(e=V.value.path+'/'+e);const t=n.addCategory(e,d.value||void 0);c.value.categoryId=t.id,s.value=!1,u.value='',d.value='',v.value=''}function D(){r.openIconSelectDialog({currentIcon:d.value},{onSelect:e=>{d.value=e}})}function A(e){return e.startsWith('fa')||e.includes(' fa-')}function I(){f.value=!f.value}function M(e){c.value.categoryId=e,f.value=!1}function U(){g.value=!g.value}function L(e){v.value=e,g.value=!1}function P(){f.value=!1,g.value=!1}return(0,m.watch)(()=>a.visible,e=>{e&&(a.tag?c.value={label:a.tag.label,categoryId:a.tag.categoryId,promptTemplate:a.tag.promptTemplate,allowPreEdit:a.tag.allowPreEdit||!1}:c.value={label:'',categoryId:a.defaultCategoryId,promptTemplate:'',allowPreEdit:!1},s.value=!1,u.value='',d.value='',f.value=!1,g.value=!1,v.value='')}),(0,m.watch)([f,g],([e,t])=>{e||t?setTimeout(()=>window.addEventListener('click',P),0):window.removeEventListener('click',P)}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(E,['self'])},[(0,m.createElementVNode)('div',Iy,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',_y,[(0,m.createElementVNode)('span',My,(0,m.toDisplayString)(y.value?'æ–°å»ºæ ‡ç­¾':'ç¼–è¾‘æ ‡ç­¾'),1),(0,m.createElementVNode)('div',Uy,[(0,m.createElementVNode)('button',{class:'acu-close-pill',disabled:!C.value,onClick:(0,m.withModifiers)(B,['stop'])},'ä¿å­˜',8,$y),(0,m.createElementVNode)('button',{class:'acu-icon-btn',title:'å…³é—­',onClick:(0,m.withModifiers)(E,['stop'])},[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])])]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Ly,[(0,m.createCommentVNode)(' æ ‡ç­¾æ–‡æœ¬ '),(0,m.createElementVNode)('div',Py,[a[26]||(a[26]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-tag'}),(0,m.createTextVNode)(' åŸºæœ¬ä¿¡æ¯ ')],-1)),(0,m.createElementVNode)('div',Fy,[(0,m.createCommentVNode)(' æ ‡ç­¾æ–‡æœ¬ '),(0,m.createElementVNode)('div',jy,[a[13]||(a[13]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ ‡ç­¾æ–‡æœ¬ '),(0,m.createElementVNode)('span',{class:'hint'},'æ ‡ç­¾æ˜¾ç¤ºçš„æ–‡å­—å†…å®¹')],-1)),(0,m.createElementVNode)('div',Oy,[(0,m.withDirectives)((0,m.createElementVNode)('input',{ref_key:'labelInput',ref:l,'onUpdate:modelValue':a[0]||(a[0]=e=>c.value.label=e),type:'text',placeholder:'è¾“å…¥æ ‡ç­¾æ–‡æœ¬'},null,512),[[m.vModelText,c.value.label]])])]),(0,m.createCommentVNode)(' åˆ†ç±»é€‰æ‹© '),(0,m.createElementVNode)('div',Ry,[a[17]||(a[17]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ‰€å±åˆ†ç±» '),(0,m.createElementVNode)('span',{class:'hint'},'é€‰æ‹©æˆ–åˆ›å»ºåˆ†ç±»')],-1)),(0,m.createElementVNode)('div',Hy,[(0,m.createCommentVNode)(' è‡ªå®šä¹‰ä¸‹æ‹‰æ¡† '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-custom-select',{active:f.value}]),onClick:(0,m.withModifiers)(I,['stop'])},[(0,m.createElementVNode)('div',Wy,[N.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[A(N.value.icon||'')?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(N.value.icon)},null,2)):N.value.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',Gy,(0,m.toDisplayString)(N.value.icon),1)):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',Yy,(0,m.toDisplayString)(N.value.path),1)],64)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Xy,'æœªåˆ†ç±»'))]),a[15]||(a[15]=(0,m.createElementVNode)('i',{class:'fas fa-chevron-down arrow'},null,-1)),(0,m.createCommentVNode)(' ä¸‹æ‹‰èœå• '),f.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',qy,[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['dropdown-item',{selected:''===c.value.categoryId}]),onClick:a[1]||(a[1]=(0,m.withModifiers)(e=>M(''),['stop']))},[...a[14]||(a[14]=[(0,m.createElementVNode)('span',{class:'text'},'æœªåˆ†ç±»',-1)])],2),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(w.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['dropdown-item',{selected:c.value.categoryId===e.id}]),onClick:(0,m.withModifiers)(t=>M(e.id),['stop'])},[A(e.icon||'')?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(e.icon)},null,2)):e.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',Jy,(0,m.toDisplayString)(e.icon),1)):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',Qy,(0,m.toDisplayString)(e.path),1)],10,Ky))),128))])):(0,m.createCommentVNode)('v-if',!0)],2),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'æ–°å¢åˆ†ç±»',onClick:a[2]||(a[2]=(0,m.withModifiers)(e=>s.value=!0,['stop']))},[...a[16]||(a[16]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1)])])])]),(0,m.createCommentVNode)(' æ–°å¢åˆ†ç±»è¾“å…¥ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰ '),s.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createCommentVNode)(' ä¸Šçº§åˆ†ç±»é€‰æ‹© '),(0,m.createElementVNode)('div',Zy,[a[20]||(a[20]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' ä¸Šçº§åˆ†ç±» '),(0,m.createElementVNode)('span',{class:'hint'},'å¯é€‰ï¼šåœ¨æ­¤åˆ†ç±»ä¸‹åˆ›å»ºå­åˆ†ç±»')],-1)),(0,m.createElementVNode)('div',ew,[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-custom-select',{active:g.value}]),onClick:(0,m.withModifiers)(U,['stop'])},[(0,m.createElementVNode)('div',tw,[V.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[A(V.value.icon||'')?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(V.value.icon)},null,2)):V.value.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',aw,(0,m.toDisplayString)(V.value.icon),1)):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',ow,(0,m.toDisplayString)(V.value.path),1)],64)):((0,m.openBlock)(),(0,m.createElementBlock)('span',nw,'æ— '))]),a[19]||(a[19]=(0,m.createElementVNode)('i',{class:'fas fa-chevron-down arrow'},null,-1)),g.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',rw,[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['dropdown-item',{selected:''===v.value}]),onClick:a[3]||(a[3]=(0,m.withModifiers)(e=>L(''),['stop']))},[...a[18]||(a[18]=[(0,m.createElementVNode)('span',{class:'text'},'æ— ',-1)])],2),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(w.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['dropdown-item',{selected:v.value===e.id}]),onClick:(0,m.withModifiers)(t=>L(e.id),['stop'])},[A(e.icon||'')?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(e.icon)},null,2)):e.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',iw,(0,m.toDisplayString)(e.icon),1)):(0,m.createCommentVNode)('v-if',!0),(0,m.createElementVNode)('span',cw,(0,m.toDisplayString)(e.path),1)],10,lw))),128))])):(0,m.createCommentVNode)('v-if',!0)],2)])]),(0,m.createElementVNode)('div',sw,[a[23]||(a[23]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ–°åˆ†ç±» '),(0,m.createElementVNode)('span',{class:'hint'},'è·¯å¾„æ ¼å¼å¦‚ï¼šäº’åŠ¨/æ—¥å¸¸')],-1)),(0,m.createElementVNode)('div',uw,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>u.value=e),type:'text',placeholder:'åˆ†ç±»è·¯å¾„',onKeyup:(0,m.withKeys)(T,['enter'])},null,544),[[m.vModelText,u.value]]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'é€‰æ‹©å›¾æ ‡',onClick:(0,m.withModifiers)(D,['stop'])},[A(d.value)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(d.value)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',dw,(0,m.toDisplayString)(d.value||'å›¾æ ‡'),1))]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'ç¡®è®¤',onClick:(0,m.withModifiers)(T,['stop'])},[...a[21]||(a[21]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1)])]),(0,m.createElementVNode)('button',{class:'acu-tool-btn',title:'å–æ¶ˆ',onClick:a[5]||(a[5]=(0,m.withModifiers)(e=>s.value=!1,['stop']))},[...a[22]||(a[22]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])])])],64)):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' äºŒæ¬¡ç¼–è¾‘å¼€å…³ '),(0,m.createElementVNode)('div',pw,[a[25]||(a[25]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' è¿½åŠ å‰äºŒæ¬¡ç¼–è¾‘ '),(0,m.createElementVNode)('span',{class:'hint'},'ç‚¹å‡»æ ‡ç­¾æ—¶å¼¹å‡ºç¼–è¾‘å™¨ï¼Œå¯ä¿®æ”¹åå†è¿½åŠ ')],-1)),(0,m.createElementVNode)('div',mw,[(0,m.createElementVNode)('label',fw,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[6]||(a[6]=e=>c.value.allowPreEdit=e),type:'checkbox'},null,512),[[m.vModelCheckbox,c.value.allowPreEdit]]),a[24]||(a[24]=(0,m.createElementVNode)('span',{class:'slider'},null,-1))])])])])]),(0,m.createCommentVNode)(' æç¤ºè¯æ¨¡æ¿ '),(0,m.createElementVNode)('div',gw,[a[34]||(a[34]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-file-alt'}),(0,m.createTextVNode)(' æç¤ºè¯æ¨¡æ¿ ')],-1)),(0,m.createElementVNode)('div',vw,[(0,m.createElementVNode)('div',bw,[a[27]||(a[27]=(0,m.createElementVNode)('div',{class:'acu-settings-label'},[(0,m.createTextVNode)(' æ¨¡æ¿å†…å®¹ '),(0,m.createElementVNode)('span',{class:'hint'},'æ”¯æŒé€šé…ç¬¦æ›¿æ¢')],-1)),(0,m.createElementVNode)('div',hw,[(0,m.withDirectives)((0,m.createElementVNode)('textarea',{ref_key:'promptInput',ref:i,'onUpdate:modelValue':a[7]||(a[7]=e=>c.value.promptTemplate=e),class:'acu-textarea',placeholder:'è¾“å…¥æç¤ºè¯æ¨¡æ¿ï¼Œæ”¯æŒé€šé…ç¬¦',rows:'4'},null,512),[[m.vModelText,c.value.promptTemplate]])])]),(0,m.createCommentVNode)(' é€šé…ç¬¦å¿«æ·æŒ‰é’® '),(0,m.createElementVNode)('div',xw,[a[28]||(a[28]=(0,m.createElementVNode)('span',{class:'hint'},'ç‚¹å‡»æ’å…¥:',-1)),(0,m.createElementVNode)('button',{class:'acu-wildcard-btn',onClick:a[8]||(a[8]=(0,m.withModifiers)(e=>S(b),['stop']))},[(0,m.createElementVNode)('code',{textContent:(0,m.toDisplayString)(b)},null,8,yw)]),(0,m.createElementVNode)('button',{class:'acu-wildcard-btn',onClick:a[9]||(a[9]=(0,m.withModifiers)(e=>S(h),['stop']))},[(0,m.createElementVNode)('code',{textContent:(0,m.toDisplayString)(h)},null,8,ww)]),(0,m.createElementVNode)('button',{class:'acu-wildcard-btn',onClick:a[10]||(a[10]=(0,m.withModifiers)(e=>S(x),['stop']))},[(0,m.createElementVNode)('code',{textContent:(0,m.toDisplayString)(x)},null,8,kw)])]),(0,m.createCommentVNode)(' é€šé…ç¬¦è¯´æ˜ '),(0,m.createElementVNode)('div',Cw,[(0,m.createElementVNode)('div',{class:'acu-help-header',onClick:a[11]||(a[11]=e=>p.value=!p.value)},[a[29]||(a[29]=(0,m.createElementVNode)('i',{class:'fas fa-lightbulb'},null,-1)),a[30]||(a[30]=(0,m.createElementVNode)('strong',null,'é€šé…ç¬¦è¯´æ˜',-1)),(0,m.createElementVNode)('i',{class:(0,m.normalizeClass)(['fas',p.value?'fa-chevron-up':'fa-chevron-down'])},null,2)]),p.value?((0,m.openBlock)(),(0,m.createElementBlock)('ul',Nw,[(0,m.createElementVNode)('li',null,[(0,m.createElementVNode)('code',{textContent:(0,m.toDisplayString)(b)},null,8,Vw),a[31]||(a[31]=(0,m.createTextVNode)(' - æ ‡ç­¾æœ¬èº«çš„å€¼ï¼ˆlabelï¼‰',-1))]),(0,m.createElementVNode)('li',null,[(0,m.createElementVNode)('code',{textContent:(0,m.toDisplayString)(h)},null,8,Ew),a[32]||(a[32]=(0,m.createTextVNode)(' - å½“å‰è¡Œæ ‡é¢˜',-1))]),(0,m.createElementVNode)('li',null,[(0,m.createElementVNode)('code',{textContent:(0,m.toDisplayString)(x)},null,8,Bw),a[33]||(a[33]=(0,m.createTextVNode)(' - ä¸»è§’åï¼ˆé…’é¦†å®ï¼‰',-1))])])):(0,m.createCommentVNode)('v-if',!0)])])])])])])):(0,m.createCommentVNode)('v-if',!0)}}),Tw={class:'acu-modal acu-import-modal'},Dw={class:'acu-modal-header'},Aw={class:'acu-modal-body'},zw={key:0,class:'acu-import-upload'},Iw={class:'acu-import-preview'},_w={class:'acu-import-stats'},Mw={class:'acu-stat-item'},Uw={class:'acu-stat-value'},$w={class:'acu-stat-item'},Lw={class:'acu-stat-value'},Pw={key:0,class:'acu-stat-item acu-stat-conflict'},Fw={class:'acu-stat-value'},jw={key:0,class:'acu-conflict-options'},Ow={class:'acu-settings-group'},Rw={class:'acu-radio-option'},Hw={class:'acu-radio-option'},Ww={class:'acu-import-list'},Gw={class:'acu-preview-scroll'},Yw={key:0,class:'acu-preview-section'},Xw={class:'acu-preview-header'},qw={class:'acu-preview-items'},Kw={key:0,class:'acu-preview-more'},Jw={key:1,class:'acu-preview-section'},Qw={class:'acu-preview-header'},Zw={class:'acu-preview-items'},ek={key:0,class:'acu-preview-more'},tk={class:'acu-import-actions'},ak={key:2,class:'acu-import-error'},ok=(0,m.defineComponent)({__name:'TagImportDialog',props:{visible:{type:Boolean}},emits:['update:visible','imported'],setup(e,{emit:t}){const a=t,o=(0,$t.A)(),n=(0,m.ref)(null),r=(0,m.ref)(null),l=(0,m.ref)('rename'),i=(0,m.ref)(''),c=(0,m.computed)(()=>{if(!r.value)return{categories:0,tags:0,conflicts:0};let e=0;return r.value.tags.forEach(t=>{g(t)&&e++}),{categories:r.value.categories.length,tags:r.value.tags.length,conflicts:e}});function s(){v(),a('update:visible',!1)}function u(){n.value?.click()}function d(e){const t=e.target,a=t.files?.[0];a&&f(a)}function p(e){const t=e.dataTransfer?.files?.[0];t&&'application/json'===t.type?f(t):i.value='è¯·é€‰æ‹© JSON æ–‡ä»¶'}async function f(e){i.value='';try{const t=await e.text(),a=JSON.parse(t);if(!a.version||!Array.isArray(a.categories)||!Array.isArray(a.tags))throw new Error('æ— æ•ˆçš„æ ‡ç­¾åº“æ–‡ä»¶æ ¼å¼');r.value=a}catch(e){i.value=e instanceof Error?e.message:'è§£ææ–‡ä»¶å¤±è´¥',r.value=null}}function g(e){const t=o.getCategoryByPath(e.category)?.id||'';return o.library.tags.some(a=>a.label===e.label&&a.categoryId===t)}function v(){r.value=null,i.value='',l.value='rename',n.value&&(n.value.value='')}function b(){if(!r.value)return;const e=o.importLibrary(r.value,{conflictStrategy:l.value});e.success?(a('imported',{addedTags:e.addedTags+e.renamedTags,addedCategories:e.addedCategories}),s()):i.value=e.error||'å¯¼å…¥å¤±è´¥'}return(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(s,['self'])},[(0,m.createElementVNode)('div',Tw,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',Dw,[a[3]||(a[3]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},[(0,m.createElementVNode)('i',{class:'fas fa-file-import'}),(0,m.createTextVNode)(' å¯¼å…¥æ ‡ç­¾åº“ ')],-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(s,['stop'])},'å…³é—­')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Aw,[(0,m.createCommentVNode)(' æ–‡ä»¶é€‰æ‹© '),r.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' å¯¼å…¥é¢„è§ˆ '),(0,m.createElementVNode)('div',Iw,[(0,m.createCommentVNode)(' ç»Ÿè®¡ä¿¡æ¯ '),(0,m.createElementVNode)('div',_w,[(0,m.createElementVNode)('div',Mw,[a[5]||(a[5]=(0,m.createElementVNode)('i',{class:'fas fa-folder'},null,-1)),(0,m.createElementVNode)('span',Uw,(0,m.toDisplayString)(c.value.categories),1),a[6]||(a[6]=(0,m.createElementVNode)('span',{class:'acu-stat-label'},'åˆ†ç±»',-1))]),(0,m.createElementVNode)('div',$w,[a[7]||(a[7]=(0,m.createElementVNode)('i',{class:'fas fa-tag'},null,-1)),(0,m.createElementVNode)('span',Lw,(0,m.toDisplayString)(c.value.tags),1),a[8]||(a[8]=(0,m.createElementVNode)('span',{class:'acu-stat-label'},'æ ‡ç­¾',-1))]),c.value.conflicts>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Pw,[a[9]||(a[9]=(0,m.createElementVNode)('i',{class:'fas fa-exclamation-triangle'},null,-1)),(0,m.createElementVNode)('span',Fw,(0,m.toDisplayString)(c.value.conflicts),1),a[10]||(a[10]=(0,m.createElementVNode)('span',{class:'acu-stat-label'},'å†²çª',-1))])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' å†²çªå¤„ç†é€‰é¡¹ '),c.value.conflicts>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',jw,[a[15]||(a[15]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-cog'}),(0,m.createTextVNode)(' å†²çªå¤„ç† ')],-1)),(0,m.createElementVNode)('div',Ow,[(0,m.createElementVNode)('label',Rw,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>l.value=e),type:'radio',value:'overwrite'},null,512),[[m.vModelRadio,l.value]]),a[11]||(a[11]=(0,m.createElementVNode)('span',null,'è¦†ç›–ç°æœ‰æ ‡ç­¾',-1)),a[12]||(a[12]=(0,m.createElementVNode)('span',{class:'hint'},'ç”¨å¯¼å…¥çš„å†…å®¹æ›¿æ¢åŒåæ ‡ç­¾',-1))]),(0,m.createElementVNode)('label',Hw,[(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>l.value=e),type:'radio',value:'rename'},null,512),[[m.vModelRadio,l.value]]),a[13]||(a[13]=(0,m.createElementVNode)('span',null,'é‡å‘½åå¯¼å…¥æ ‡ç­¾',-1)),a[14]||(a[14]=(0,m.createElementVNode)('span',{class:'hint'},'ä¸ºå†²çªçš„æ ‡ç­¾æ·»åŠ åºå·åç¼€',-1))])])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' é¢„è§ˆåˆ—è¡¨ '),(0,m.createElementVNode)('div',Ww,[a[16]||(a[16]=(0,m.createElementVNode)('div',{class:'acu-settings-title'},[(0,m.createElementVNode)('i',{class:'fas fa-list'}),(0,m.createTextVNode)(' å¯¼å…¥å†…å®¹é¢„è§ˆ ')],-1)),(0,m.createElementVNode)('div',Gw,[(0,m.createCommentVNode)(' åˆ†ç±» '),r.value.categories.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Yw,[(0,m.createElementVNode)('div',Xw,'åˆ†ç±» ('+(0,m.toDisplayString)(r.value.categories.length)+')',1),(0,m.createElementVNode)('div',qw,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(r.value.categories.slice(0,10),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-preview-item'},(0,m.toDisplayString)(e.icon?e.icon+' ':'')+(0,m.toDisplayString)(e.path),1))),128)),r.value.categories.length>10?((0,m.openBlock)(),(0,m.createElementBlock)('span',Kw,' è¿˜æœ‰ '+(0,m.toDisplayString)(r.value.categories.length-10)+' ä¸ª... ',1)):(0,m.createCommentVNode)('v-if',!0)])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' æ ‡ç­¾ '),r.value.tags.length>0?((0,m.openBlock)(),(0,m.createElementBlock)('div',Jw,[(0,m.createElementVNode)('div',Qw,'æ ‡ç­¾ ('+(0,m.toDisplayString)(r.value.tags.length)+')',1),(0,m.createElementVNode)('div',Zw,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(r.value.tags.slice(0,20),e=>((0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:(0,m.normalizeClass)(['acu-preview-item',{conflict:g(e)}])},(0,m.toDisplayString)(e.label),3))),128)),r.value.tags.length>20?((0,m.openBlock)(),(0,m.createElementBlock)('span',ek,' è¿˜æœ‰ '+(0,m.toDisplayString)(r.value.tags.length-20)+' ä¸ª... ',1)):(0,m.createCommentVNode)('v-if',!0)])])):(0,m.createCommentVNode)('v-if',!0)])]),(0,m.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,m.createElementVNode)('div',tk,[(0,m.createElementVNode)('button',{class:'acu-btn-secondary',onClick:(0,m.withModifiers)(v,['stop'])},[...a[17]||(a[17]=[(0,m.createElementVNode)('i',{class:'fas fa-redo'},null,-1),(0,m.createTextVNode)(' é‡æ–°é€‰æ‹©',-1)])]),(0,m.createElementVNode)('button',{class:'acu-btn-primary',onClick:(0,m.withModifiers)(b,['stop'])},[...a[18]||(a[18]=[(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1),(0,m.createTextVNode)(' ç¡®è®¤å¯¼å…¥',-1)])])])])],2112)):((0,m.openBlock)(),(0,m.createElementBlock)('div',zw,[(0,m.createElementVNode)('div',{class:'acu-upload-area',onClick:u,onDragover:a[0]||(a[0]=(0,m.withModifiers)(()=>{},['prevent'])),onDrop:(0,m.withModifiers)(p,['prevent'])},[...a[4]||(a[4]=[(0,m.createElementVNode)('i',{class:'fas fa-cloud-upload-alt'},null,-1),(0,m.createElementVNode)('p',null,'ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½ JSON æ–‡ä»¶åˆ°æ­¤å¤„',-1),(0,m.createElementVNode)('span',{class:'hint'},'æ”¯æŒä»å…¶ä»–è®¾å¤‡å¯¼å‡ºçš„æ ‡ç­¾åº“æ–‡ä»¶',-1)])],32),(0,m.createElementVNode)('input',{ref_key:'fileInput',ref:n,type:'file',accept:'.json',style:{display:'none'},onChange:d},null,544)])),(0,m.createCommentVNode)(' é”™è¯¯æç¤º '),i.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',ak,[a[19]||(a[19]=(0,m.createElementVNode)('i',{class:'fas fa-exclamation-circle'},null,-1)),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(i.value),1)])):(0,m.createCommentVNode)('v-if',!0)])])])):(0,m.createCommentVNode)('v-if',!0)}}),nk={class:'acu-modal-header'},rk={class:'acu-modal-body acu-tag-manager-body'},lk={class:'acu-displayed-area'},ik=['onClick'],ck={key:0,class:'acu-tag-icon'},sk={key:1},uk={key:1,class:'acu-empty-hint'},dk={class:'acu-tag-search'},pk={class:'acu-tag-toolbar'},mk={key:0,class:'mode-actions'},fk=['disabled'],gk={class:'acu-tag-manager'},vk=(0,m.defineComponent)({__name:'TagManagerDialog',props:{visible:{type:Boolean},displayedTagIds:{},displayedCategoryIds:{default:()=>[]}},emits:['update:visible','save','close'],setup(e,{emit:t}){const a=e,o=t,n=(0,$t.A)(),r=(0,f.JH)(),l=(0,m.ref)(''),i=(0,m.ref)(!1),c=(0,m.ref)(!1),s=(0,m.ref)(null),u=(0,m.ref)(''),d=(0,m.ref)([]),p=(0,m.ref)([]),g=(0,m.computed)(()=>n.currentMode),v=(0,m.computed)(()=>n.selectedTagIds),b=(0,m.computed)(()=>n.filteredTags),h=(0,m.computed)(()=>0!==b.value.length&&b.value.every(e=>v.value.has(e.id))),x=(0,m.computed)(()=>{const e=[];return p.value.forEach(t=>{const a=n.getCategoryById(t);a&&e.push({id:t,type:'category',label:a.path,icon:a.icon})}),d.value.forEach(t=>{const a=n.getTagById(t);a&&e.push({id:t,type:'tag',label:a.label})}),e}),y=(0,m.computed)(()=>d.value);function w(){n.setMode('normal'),o('save',[...d.value],[...p.value]),o('update:visible',!1),o('close')}function k(e){g.value===e?(n.setMode('normal'),N('å·²é€€å‡º'+C(e)+'æ¨¡å¼')):(n.setMode(e),N(C(e)+'æ¨¡å¼å·²å¯ç”¨'))}function C(e){return{normal:'æ™®é€š',create:'æ–°å»º',add:'å±•ç¤º',delete:'åˆ é™¤',migrate:'è¿ç§»',export:'å¯¼å‡º'}[e]||e}function N(e){'undefined'!=typeof toastr&&toastr.info(e,'',{timeOut:2e3})}function V(){n.searchKeyword=l.value}function E(){l.value='',n.searchKeyword=''}function B(e){'add'===g.value&&e&&L(e.id)}function S(e){const t=n.selectedCategoryIds,a=v.value.size,o=t.size;if(0===a&&0===o)return void N('è¯·å…ˆé€‰ä¸­è¦è¿ç§»çš„æ ‡ç­¾æˆ–åˆ†ç±»');'root'===e?n.migrateSelectedItems(''):n.migrateSelectedItems(e);const r=[];a>0&&r.push(`${a} ä¸ªæ ‡ç­¾`),o>0&&r.push(`${o} ä¸ªåˆ†ç±»`);const l='root'===e?'æ ¹ç›®å½•':'ç›®æ ‡åˆ†ç±»';N('å·²è¿ç§» '+r.join(' å’Œ ')+' åˆ°'+l),n.setMode('normal')}function T(e){if('root'===e)return void(confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ ‡ç­¾å’Œåˆ†ç±»å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')&&(n.clearAll(),d.value=[],p.value=[],N('å·²æ¸…ç©ºæ‰€æœ‰æ ‡ç­¾å’Œåˆ†ç±»')));const t=n.getCategoryById(e);t&&(n.deleteCategory(e),N('å·²åˆ é™¤åˆ†ç±»ï¼š'+t.path),F(e))}function D(e){'add'===g.value?M(e.id):'normal'!==g.value&&'create'!==g.value||(s.value=e,i.value=!0)}function A(){s.value=null;const e=n.selectedLevel1;if(e&&'å…¨éƒ¨'!==e&&'æœªåˆ†ç±»'!==e){const t=n.getCategoryByPath(e);u.value=t?.id||''}else u.value='';i.value=!0}function I(e){const t=n.getTagById(e);t&&(n.deleteTag(e),N('å·²åˆ é™¤æ ‡ç­¾ï¼š'+t.label),P(e))}function M(e){if(d.value.includes(e))N('è¯¥æ ‡ç­¾å·²åœ¨å±•ç¤ºåŒº');else{d.value=[...d.value,e];const t=n.getTagById(e);t&&N('å·²æ·»åŠ ï¼š'+t.label)}}function U(e){'root'!==e?L(e):p.value.includes('root')?N('æ ¹ç›®å½•å·²åœ¨å±•ç¤ºåŒº'):(p.value=[...p.value,'root'],N('å·²æ·»åŠ ï¼šæ ¹ç›®å½•'))}function L(e){if(p.value.includes(e))N('è¯¥åˆ†ç±»å·²åœ¨å±•ç¤ºåŒº');else{p.value=[...p.value,e];const t=n.getCategoryById(e);t&&N('å·²æ·»åŠ åˆ†ç±»ï¼š'+t.path)}}function P(e){d.value=d.value.filter(t=>t!==e)}function F(e){p.value=p.value.filter(t=>t!==e)}function j(e){N('å·²ä¿å­˜ï¼š'+e.label)}function O(){s.value=null}function R(){c.value=!0}function H(e){N(`å·²å¯¼å…¥ ${e.addedCategories} ä¸ªåˆ†ç±»ï¼Œ${e.addedTags} ä¸ªæ ‡ç­¾`)}function W(){h.value?b.value.forEach(e=>{v.value.has(e.id)&&n.toggleTagSelection(e.id)}):b.value.forEach(e=>{v.value.has(e.id)||n.toggleTagSelection(e.id)})}function G(){X(n.exportLibrary('all'),'tag-library-all.json'),n.setMode('normal')}function Y(){X(n.exportLibrary('selected'),'tag-library-selected.json'),n.setMode('normal')}function X(e,t){const a=new Blob([JSON.stringify(e,null,2)],{type:'application/json'}),o=URL.createObjectURL(a),n=document.createElement('a');n.href=o,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o),N('å¯¼å‡ºæˆåŠŸ')}return(0,m.onMounted)(async()=>{await n.loadLibrary()}),(0,m.watch)(()=>a.visible,e=>{e&&(n.setMode('normal'),n.resetSelection(),l.value='',d.value=[...a.displayedTagIds],p.value=[...a.displayedCategoryIds])}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(w,['self'])},[(0,m.createElementVNode)('div',{class:'acu-modal acu-tag-manager-modal',style:(0,m.normalizeStyle)({paddingBottom:`${(0,m.unref)(r).config.mobileSafeAreaBottom??0}px`})},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',nk,[a[7]||(a[7]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},[(0,m.createElementVNode)('i',{class:'fas fa-tags'}),(0,m.createTextVNode)(' æ ‡ç­¾ç®¡ç†å™¨ ')],-1)),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(w,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',rk,[(0,m.createCommentVNode)(' å·²å±•ç¤ºåŒºï¼ˆé¡¶éƒ¨ï¼‰ '),(0,m.createElementVNode)('div',lk,[a[9]||(a[9]=(0,m.createElementVNode)('span',{class:'acu-displayed-label'},'å·²å±•ç¤ºï¼š',-1)),x.value.length>0?((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,{key:0},(0,m.renderList)(x.value,e=>{return(0,m.openBlock)(),(0,m.createElementBlock)('span',{key:e.id,class:'acu-displayed-tag',onClick:(0,m.withModifiers)(t=>function(e){'tag'===e.type?P(e.id):F(e.id)}(e),['stop'])},[e.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',ck,[(t=e.icon,t.startsWith('fa')||t.includes(' fa-')?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(e.icon)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',sk,(0,m.toDisplayString)(e.icon),1)))])):(0,m.createCommentVNode)('v-if',!0),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(e.label)+' ',1),a[8]||(a[8]=(0,m.createElementVNode)('i',{class:'fas fa-times acu-remove-icon'},null,-1))],8,ik);var t}),128)):((0,m.openBlock)(),(0,m.createElementBlock)('span',uk,'ç‚¹å‡»ä¸‹æ–¹æ ‡ç­¾æˆ–åˆ†ç±»æ·»åŠ åˆ°å±•ç¤ºåŒº'))]),(0,m.createCommentVNode)(' æœç´¢æ  '),(0,m.createElementVNode)('div',dk,[a[11]||(a[11]=(0,m.createElementVNode)('i',{class:'fas fa-search'},null,-1)),(0,m.withDirectives)((0,m.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>l.value=e),type:'text',placeholder:'æœç´¢æ ‡ç­¾...',onInput:V},null,544),[[m.vModelText,l.value]]),l.value?((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:0,class:'acu-clear-search',onClick:(0,m.withModifiers)(E,['stop'])},[...a[10]||(a[10]=[(0,m.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' å·¥å…·æ  '),(0,m.createElementVNode)('div',pk,[(0,m.createCommentVNode)(' æ¨¡å¼æŒ‰é’® '),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-mode-btn',{active:'add'===g.value}]),title:'å±•ç¤ºæ¨¡å¼ï¼šç‚¹å‡»æ ‡ç­¾/åˆ†ç±»æ·»åŠ åˆ°å±•ç¤ºåŒº',onClick:a[1]||(a[1]=(0,m.withModifiers)(e=>k('add'),['stop']))},[...a[12]||(a[12]=[(0,m.createElementVNode)('i',{class:'fas fa-eye'},null,-1),(0,m.createElementVNode)('span',{class:'btn-label'},'å±•ç¤º',-1)])],2),(0,m.createElementVNode)('button',{class:'acu-mode-btn',title:'æ–°å»ºæ ‡ç­¾',onClick:(0,m.withModifiers)(A,['stop'])},[...a[13]||(a[13]=[(0,m.createElementVNode)('i',{class:'fas fa-plus'},null,-1),(0,m.createElementVNode)('span',{class:'btn-label'},'æ–°å»º',-1)])]),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-mode-btn',{active:'delete'===g.value}]),title:'åˆ é™¤æ¨¡å¼ï¼šç‚¹å‡»æ ‡ç­¾/åˆ†ç±»ç«‹å³åˆ é™¤',onClick:a[2]||(a[2]=(0,m.withModifiers)(e=>k('delete'),['stop']))},[...a[14]||(a[14]=[(0,m.createElementVNode)('i',{class:'fas fa-trash'},null,-1),(0,m.createElementVNode)('span',{class:'btn-label'},'åˆ é™¤',-1)])],2),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-mode-btn',{active:'migrate'===g.value}]),title:'è¿ç§»æ¨¡å¼ï¼šé€‰ä¸­æ ‡ç­¾åç‚¹å‡»ç›®æ ‡åˆ†ç±»è¿å…¥',onClick:a[3]||(a[3]=(0,m.withModifiers)(e=>k('migrate'),['stop']))},[...a[15]||(a[15]=[(0,m.createElementVNode)('i',{class:'fas fa-arrows-alt'},null,-1),(0,m.createElementVNode)('span',{class:'btn-label'},'è¿ç§»',-1)])],2),(0,m.createElementVNode)('button',{class:'acu-mode-btn',title:'å¯¼å…¥æ ‡ç­¾åº“',onClick:(0,m.withModifiers)(R,['stop'])},[...a[16]||(a[16]=[(0,m.createElementVNode)('i',{class:'fas fa-file-import'},null,-1),(0,m.createElementVNode)('span',{class:'btn-label'},'å¯¼å…¥',-1)])]),(0,m.createElementVNode)('button',{class:(0,m.normalizeClass)(['acu-mode-btn',{active:'export'===g.value}]),title:'å¯¼å‡ºæ¨¡å¼ï¼šé€‰æ‹©è¦å¯¼å‡ºçš„æ ‡ç­¾',onClick:a[4]||(a[4]=(0,m.withModifiers)(e=>k('export'),['stop']))},[...a[17]||(a[17]=[(0,m.createElementVNode)('i',{class:'fas fa-file-export'},null,-1),(0,m.createElementVNode)('span',{class:'btn-label'},'å¯¼å‡º',-1)])],2),(0,m.createCommentVNode)(' è¿ç§»/å¯¼å‡ºæ¨¡å¼é¢å¤–æŒ‰é’® '),'migrate'===g.value||'export'===g.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',mk,[(0,m.createElementVNode)('button',{class:'acu-mode-btn',onClick:(0,m.withModifiers)(W,['stop'])},[a[18]||(a[18]=(0,m.createElementVNode)('i',{class:'fas fa-check-double'},null,-1)),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(h.value?'å–æ¶ˆå…¨é€‰':'å…¨é€‰å½“å‰'),1)]),'export'===g.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:0},[(0,m.createElementVNode)('button',{class:'acu-mode-btn',onClick:(0,m.withModifiers)(G,['stop'])},[...a[19]||(a[19]=[(0,m.createElementVNode)('i',{class:'fas fa-download'},null,-1),(0,m.createTextVNode)(' å…¨éƒ¨å¯¼å‡º ',-1)])]),(0,m.createElementVNode)('button',{class:'acu-mode-btn',disabled:0===v.value.size,onClick:(0,m.withModifiers)(Y,['stop'])},[a[20]||(a[20]=(0,m.createElementVNode)('i',{class:'fas fa-check'},null,-1)),(0,m.createTextVNode)(' å¯¼å‡ºé€‰ä¸­ ('+(0,m.toDisplayString)(v.value.size)+') ',1)],8,fk)],64)):(0,m.createCommentVNode)('v-if',!0)])):(0,m.createCommentVNode)('v-if',!0)]),(0,m.createCommentVNode)(' åŒæ å¸ƒå±€ '),(0,m.createElementVNode)('div',gk,[(0,m.createCommentVNode)(' å·¦ä¾§ï¼šç›®å½•æ ‘ '),(0,m.createVNode)(zy,{mode:g.value,onCategoryClick:B,onAddCategory:U,onMigrateToCategory:S,onDeleteCategory:T},null,8,['mode']),(0,m.createCommentVNode)(' å³ä¾§ï¼šæ ‡ç­¾ç½‘æ ¼ '),(0,m.createVNode)(py,{mode:g.value,'displayed-tag-ids':y.value,onTagClick:D,onCreateTag:A,onDeleteTag:I,onAddTag:M},null,8,['mode','displayed-tag-ids'])])])],4),(0,m.createCommentVNode)(' ç¼–è¾‘å¼¹çª— '),(0,m.createVNode)(Sw,{visible:i.value,'onUpdate:visible':a[5]||(a[5]=e=>i.value=e),tag:s.value,'default-category-id':u.value,onSaved:j,onClose:O},null,8,['visible','tag','default-category-id']),(0,m.createCommentVNode)(' å¯¼å…¥å¼¹çª— '),c.value?((0,m.openBlock)(),(0,m.createBlock)(ok,{key:0,visible:c.value,'onUpdate:visible':a[6]||(a[6]=e=>c.value=e),onImported:H},null,8,['visible'])):(0,m.createCommentVNode)('v-if',!0)])):(0,m.createCommentVNode)('v-if',!0)}}),bk={class:'acu-modal-header'},hk={class:'acu-modal-title'},xk={key:0,class:'acu-category-icon'},yk={key:1},wk={class:'acu-modal-body'},kk={key:0,class:'acu-category-select-dual'},Ck={class:'acu-category-tree'},Nk={class:'acu-tree-count'},Vk=['onClick'],Ek={key:0,class:'acu-tree-icon'},Bk={key:1},Sk={key:1,class:'acu-tree-icon'},Tk={class:'acu-tree-label'},Dk={class:'acu-tree-count'},Ak={class:'acu-category-tags-grid'},zk=['onClick'],Ik={key:0,class:'acu-tags-empty'},_k={class:'acu-category-tags-only'},Mk={class:'acu-tags-scroll'},Uk=['onClick'],$k={key:0,class:'acu-tags-empty'},Lk={class:'acu-modal-footer',style:{'justify-content':'flex-start','margin-top':'0','padding-top':'12px','border-top':'1px solid var(--acu-border)'}},Pk=(0,m.defineComponent)({__name:'CategorySelectPopup',props:{visible:{type:Boolean},categoryId:{},rowContext:{default:()=>({title:'',value:''})},widgetId:{default:''}},emits:['update:visible','select','close'],setup(e,{emit:t}){const a=e,o=t,n=(0,$t.A)(),r=(0,k.j_)(),l=(0,It.f)(),i=(0,m.ref)(null),c=(0,m.computed)(()=>n.getCategoryById(a.categoryId)),s=(0,m.computed)(()=>{if(!c.value)return'æœªçŸ¥åˆ†ç±»';const e=c.value.path.split('/');return e[e.length-1]}),u=(0,m.computed)(()=>{if(!c.value)return[];const e=c.value.path;return n.library.categories.filter(t=>{if(!t.path.startsWith(e+'/'))return!1;return!t.path.slice(e.length+1).includes('/')})}),d=(0,m.computed)(()=>u.value.length>0),p=(0,m.computed)(()=>{if(!c.value)return[];const e=new Set;return n.library.categories.forEach(t=>{(t.path===c.value.path||t.path.startsWith(c.value.path+'/'))&&e.add(t.id)}),n.library.tags.filter(t=>e.has(t.categoryId))}),f=(0,m.computed)(()=>p.value.length),g=(0,m.computed)(()=>{if(null===i.value)return p.value;const e=n.getCategoryById(i.value);if(!e)return[];const t=new Set;return n.library.categories.forEach(a=>{(a.path===e.path||a.path.startsWith(e.path+'/'))&&t.add(a.id)}),n.library.tags.filter(e=>t.has(e.categoryId))});function v(e){const t=e.path.split('/');return t[t.length-1]}function b(e){const t=n.getCategoryById(e);if(!t)return 0;const a=new Set;return n.library.categories.forEach(e=>{(e.path===t.path||e.path.startsWith(t.path+'/'))&&a.add(e.id)}),n.library.tags.filter(e=>a.has(e.categoryId)).length}function h(e){i.value=e}function x(){o('update:visible',!1),o('close')}function y(e){o('select',e,a.rowContext)}function w(){x();let e=[],t=[];if(a.widgetId){const o=l.getWidgetById(a.widgetId);o&&o.widgetTagConfig&&(e=o.widgetTagConfig.displayedTagIds||[],t=o.widgetTagConfig.displayedCategoryIds||[])}0===t.length&&a.categoryId&&(t=[a.categoryId]),r.openTagManagerDialog({widgetId:a.widgetId||'',displayedTagIds:e,displayedCategoryIds:t},(e,t)=>{if(a.widgetId){const o=l.getWidgetById(a.widgetId);o&&l.updateWidget(a.widgetId,{widgetTagConfig:{...o.widgetTagConfig,displayedTagIds:e,displayedCategoryIds:t}})}})}function C(e){return e.startsWith('fa')||e.includes(' fa-')}return(0,m.watch)(()=>a.visible,e=>{e&&(i.value=null)}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(x,['self'])},[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-modal acu-category-select-modal',{'has-subcategories':d.value}])},[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',bk,[(0,m.createElementVNode)('span',hk,[c.value?.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',xk,[C(c.value.icon)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(c.value.icon)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',yk,(0,m.toDisplayString)(c.value.icon),1))])):(0,m.createCommentVNode)('v-if',!0),(0,m.createTextVNode)(' '+(0,m.toDisplayString)(s.value),1)]),(0,m.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,m.withModifiers)(x,['stop'])},'å®Œæˆ')]),(0,m.createCommentVNode)(' å†…å®¹åŒº '),(0,m.createElementVNode)('div',wk,[(0,m.createCommentVNode)(' æœ‰å­åˆ†ç±»ï¼šå·¦å³å¸ƒå±€ '),d.value?((0,m.openBlock)(),(0,m.createElementBlock)('div',kk,[(0,m.createCommentVNode)(' å·¦ä¾§ï¼šå­åˆ†ç±»ç›®å½•æ ‘ '),(0,m.createElementVNode)('div',Ck,[(0,m.createCommentVNode)(' å…¨éƒ¨ï¼ˆæ˜¾ç¤ºæ‰€æœ‰æ ‡ç­¾ï¼‰ '),(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-tree-item',{active:null===i.value}]),onClick:a[0]||(a[0]=(0,m.withModifiers)(e=>h(null),['stop']))},[a[1]||(a[1]=(0,m.createElementVNode)('span',{class:'acu-tree-icon'},'ğŸ“¦',-1)),a[2]||(a[2]=(0,m.createElementVNode)('span',{class:'acu-tree-label'},'å…¨éƒ¨',-1)),(0,m.createElementVNode)('span',Nk,(0,m.toDisplayString)(f.value),1)],2),(0,m.createCommentVNode)(' å­åˆ†ç±»åˆ—è¡¨ '),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(u.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.id,class:(0,m.normalizeClass)(['acu-tree-item',{active:i.value===e.id}]),onClick:(0,m.withModifiers)(t=>h(e.id),['stop'])},[e.icon?((0,m.openBlock)(),(0,m.createElementBlock)('span',Ek,[C(e.icon)?((0,m.openBlock)(),(0,m.createElementBlock)('i',{key:0,class:(0,m.normalizeClass)(e.icon)},null,2)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Bk,(0,m.toDisplayString)(e.icon),1))])):((0,m.openBlock)(),(0,m.createElementBlock)('span',Sk,[...a[3]||(a[3]=[(0,m.createElementVNode)('i',{class:'fas fa-folder'},null,-1)])])),(0,m.createElementVNode)('span',Tk,(0,m.toDisplayString)(v(e)),1),(0,m.createElementVNode)('span',Dk,(0,m.toDisplayString)(b(e.id)),1)],10,Vk))),128))]),(0,m.createCommentVNode)(' å³ä¾§ï¼šæ ‡ç­¾ç½‘æ ¼ '),(0,m.createElementVNode)('div',Ak,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(g.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e.id,class:'acu-tag-btn',onClick:(0,m.withModifiers)(t=>y(e),['stop'])},(0,m.toDisplayString)(e.label),9,zk))),128)),(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===g.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',Ik,[...a[4]||(a[4]=[(0,m.createElementVNode)('i',{class:'fas fa-tag'},null,-1),(0,m.createElementVNode)('span',null,'æš‚æ— æ ‡ç­¾',-1)])])):(0,m.createCommentVNode)('v-if',!0)])])):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' æ— å­åˆ†ç±»ï¼šåªæ˜¾ç¤ºæ ‡ç­¾æ»šåŠ¨æ¡† '),(0,m.createElementVNode)('div',_k,[(0,m.createElementVNode)('div',Mk,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(p.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('button',{key:e.id,class:'acu-tag-btn',onClick:(0,m.withModifiers)(t=>y(e),['stop'])},(0,m.toDisplayString)(e.label),9,Uk))),128))]),(0,m.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===p.value.length?((0,m.openBlock)(),(0,m.createElementBlock)('div',$k,[...a[5]||(a[5]=[(0,m.createElementVNode)('i',{class:'fas fa-tag'},null,-1),(0,m.createElementVNode)('span',null,'è¯¥åˆ†ç±»ä¸‹æš‚æ— æ ‡ç­¾',-1)])])):(0,m.createCommentVNode)('v-if',!0)])],2112))]),(0,m.createCommentVNode)(' åº•éƒ¨ï¼šç®¡ç†å…¥å£ '),(0,m.createElementVNode)('div',Lk,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:(0,m.withModifiers)(w,['stop'])},[...a[6]||(a[6]=[(0,m.createElementVNode)('i',{class:'fas fa-tags'},null,-1),(0,m.createTextVNode)(' ç®¡ç†æ ‡ç­¾ ',-1)])])])],2)])):(0,m.createCommentVNode)('v-if',!0)}}),Fk={class:'acu-modal acu-pre-edit-modal'},jk={class:'acu-modal-header'},Ok={class:'acu-header-actions'},Rk=['disabled'],Hk={class:'acu-modal-body'},Wk={class:'acu-pre-edit-content'},Gk={class:'acu-pre-edit-info-row'},Yk={class:'acu-pre-edit-label'},Xk=['onKeydown'],qk={key:0,class:'acu-companion-selector'},Kk={class:'acu-avatar-list'},Jk=['onClick'],Qk=['src','alt'],Zk={key:1,class:'acu-avatar-text-icon'},eC={class:'acu-avatar-name'},tC={key:0,class:'acu-avatar-empty'},aC=(0,m.defineComponent)({__name:'TagPreEditDialog',props:{visible:{type:Boolean},tagLabel:{default:''},resolvedPrompt:{default:''},showCompanions:{type:Boolean,default:!1},widgetId:{default:''}},emits:['update:visible','confirm','close'],setup(e,{emit:t}){const a=e,o=t,{setInput:n}=ue(),{getAvatarUrl:r}=(0,ye.o)(),l=((0,k.j_)(),(0,m.inject)('allTables')),i=(0,m.ref)(null),c=(0,m.ref)(''),s=(0,m.ref)([]),u=(0,m.ref)(!1);function d(){o('update:visible',!1),o('close')}function p(){const e=c.value.trim();e&&(n(e),o('confirm',e),d())}return(0,m.watch)(()=>a.visible,async e=>{e&&(c.value=a.resolvedPrompt,a.showCompanions&&async function(){u.value=!0;try{const e=new Set,t=l?l():[];l||console.warn('[TagPreEditDialog] getAllTables injection failed'),console.log('[TagPreEditDialog] Loading avatars. Tables:',t.length),t.length>0&&t.forEach(t=>{if((0,v._C)(t.name,t.id)){console.log('[TagPreEditDialog] Found character table:',t.name);let a=t.headers.findIndex(e=>['name','åç§°','å§“å','è§’è‰²'].includes(e.toLowerCase()));-1===a&&(a=t.headers.length>1?1:0),t.rows.forEach(t=>{const o=t.cells.find(e=>e.colIndex===a);o&&o.value&&String(o.value).trim()&&e.add(String(o.value).trim())})}});const a='undefined'!=typeof getVariables?getVariables({type:'chat'}):{},o=(a.acu_graph_config||{}).labels||{},n=await Promise.all(Array.from(e).map(async e=>{const t=await r(e),a=o[e];let n='';if(a?.selectedIndices&&a.selectedIndices.length>0)n=a.selectedIndices.map(t=>e[t]).join('');else{n=(a?.displayLabel||e).charAt(0)}return{name:e,displayUrl:t||'',textAvatar:n}}));s.value=n}catch(e){console.error('Failed to load avatars:',e)}finally{u.value=!1}}(),await(0,m.nextTick)(),i.value?.focus(),i.value?.setSelectionRange(c.value.length,c.value.length))}),(t,a)=>e.visible?((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:0,class:'acu-modal-container acu-center-modal',onClick:(0,m.withModifiers)(d,['self'])},[(0,m.createElementVNode)('div',Fk,[(0,m.createCommentVNode)(' å¤´éƒ¨ '),(0,m.createElementVNode)('div',jk,[a[2]||(a[2]=(0,m.createElementVNode)('span',{class:'acu-modal-title'},[(0,m.createElementVNode)('i',{class:'fas fa-edit'}),(0,m.createTextVNode)(' ç¼–è¾‘æç¤ºè¯ ')],-1)),(0,m.createElementVNode)('div',Ok,[(0,m.createElementVNode)('button',{class:'acu-modal-btn secondary small',onClick:(0,m.withModifiers)(d,['stop'])},'å–æ¶ˆ'),(0,m.createElementVNode)('button',{class:'acu-modal-btn primary small',disabled:!c.value.trim(),onClick:(0,m.withModifiers)(p,['stop'])},[...a[1]||(a[1]=[(0,m.createElementVNode)('i',{class:'fas fa-paper-plane'},null,-1),(0,m.createTextVNode)(' è¿½åŠ  ',-1)])],8,Rk)])]),(0,m.createCommentVNode)(' å†…å®¹ '),(0,m.createElementVNode)('div',Hk,[(0,m.createElementVNode)('div',Wk,[(0,m.createCommentVNode)(' æ ‡ç­¾ä¿¡æ¯ '),(0,m.createElementVNode)('div',Gk,[(0,m.createElementVNode)('div',Yk,'æ ‡ç­¾ï¼š'+(0,m.toDisplayString)(e.tagLabel),1)]),(0,m.createCommentVNode)(' ç¼–è¾‘åŒº '),(0,m.withDirectives)((0,m.createElementVNode)('textarea',{ref_key:'textareaRef',ref:i,'onUpdate:modelValue':a[0]||(a[0]=e=>c.value=e),class:'acu-pre-edit-textarea',placeholder:'è¾“å…¥è¦è¿½åŠ çš„å†…å®¹...',onKeydown:[(0,m.withKeys)((0,m.withModifiers)(p,['ctrl']),['enter']),(0,m.withKeys)((0,m.withModifiers)(p,['meta']),['enter'])]},null,40,Xk),[[m.vModelText,c.value]]),(0,m.createCommentVNode)(' åŒä¼´é€‰æ‹©å™¨ '),e.showCompanions?((0,m.openBlock)(),(0,m.createElementBlock)('div',qk,[a[3]||(a[3]=(0,m.createElementVNode)('div',{class:'acu-companion-header'},[(0,m.createElementVNode)('i',{class:'fas fa-user-friends'}),(0,m.createTextVNode)(' é€‰æ‹©åŒä¼´ (ç‚¹å‡»æ’å…¥) ')],-1)),(0,m.createElementVNode)('div',Kk,[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(s.value,e=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{key:e.name,class:'acu-avatar-item',onClick:t=>function(e){const t=`å’Œ${e.name}`,a=c.value;if(a.includes('{{user}}')){const e=a.lastIndexOf('{{user}}')+8;c.value=a.slice(0,e)+t+a.slice(e)}else c.value=t+a;(0,m.nextTick)(()=>{i.value?.focus()})}(e)},[(0,m.createElementVNode)('div',{class:(0,m.normalizeClass)(['acu-avatar-img-wrapper',{'no-img':!e.displayUrl}])},[e.displayUrl?((0,m.openBlock)(),(0,m.createElementBlock)('img',{key:0,src:e.displayUrl,alt:e.name,loading:'lazy'},null,8,Qk)):((0,m.openBlock)(),(0,m.createElementBlock)('span',Zk,(0,m.toDisplayString)(e.textAvatar),1))],2),(0,m.createElementVNode)('span',eC,(0,m.toDisplayString)(e.name),1)],8,Jk))),128)),0!==s.value.length||u.value?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createElementBlock)('div',tC,'æš‚æ— å¤´åƒæ•°æ®'))])])):(0,m.createCommentVNode)('v-if',!0),(0,m.createCommentVNode)(' æç¤º '),a[4]||(a[4]=(0,m.createElementVNode)('div',{class:'acu-pre-edit-hint'},[(0,m.createElementVNode)('i',{class:'fas fa-lightbulb'}),(0,m.createElementVNode)('span',null,'æŒ‰ Ctrl+Enter å¿«é€Ÿè¿½åŠ ')],-1))])])])])):(0,m.createCommentVNode)('v-if',!0)}}),oC=(0,m.defineComponent)({__name:'App',setup(e){const t=(0,m.defineAsyncComponent)({loader:()=>Promise.resolve().then(d.bind(d,7141)),loadingComponent:{template:'\n      <div class="acu-graph-loading">\n        <i class="fas fa-spinner fa-spin"></i>\n        <span>æ­£åœ¨åŠ è½½å…³ç³»å›¾...</span>\n      </div>\n    '},delay:200}),a=(0,k.j_)(),o=(0,w.D)(),n=(0,It.f)(),r=(0,f.JH)(),l=(0,$t.A)(),i=(0,Mt.E)(),{init:c,cleanup:s}=y(),{saveToDatabase:u,getTableData:p,purgeFloorRange:g,stopAutoSave:b}=te(),{refresh:h}=Ae(),{state:x}=(0,S.d)(),{setInput:C}=ue(),{setHiddenPrompt:N,setupSendIntercept:V,cleanupSendIntercept:E}=se(),{performDivination:T,confirmDivination:D,triggerQuickReroll:A}=Ut();!function(){const e=(0,m.ref)(0),t=(0,m.ref)(0);let a=null,o=null;function n(a){const o=a.target;if(!o.closest?.('.acu-layout-horizontal .acu-panel-content'))return;const n=a.touches[0];e.value=n.clientX,t.value=n.clientY}function r(a){const o=a.target;if(!o.closest?.('.acu-layout-horizontal .acu-panel-content'))return;if('INPUT'===o.tagName||'TEXTAREA'===o.tagName||o.isContentEditable)return;let n=o,r=!1;for(;n&&n.classList&&!n.classList.contains('acu-panel-content');){if(n.scrollHeight>n.clientHeight){const e=window.getComputedStyle(n);if(['auto','scroll'].includes(e.overflowY)){r=!0;break}}n=n.parentElement}if(r)return;const l=a.touches[0],i=l.clientX-e.value,c=l.clientY-t.value;Math.abs(c)>Math.abs(i)&&a.cancelable&&a.preventDefault()}function l(){const e=window.parent?.document;e?(a=n,o=r,e.addEventListener('touchstart',a,{capture:!0,passive:!1}),e.addEventListener('touchmove',o,{capture:!0,passive:!1}),console.info('[ACU] è§¦æ‘¸æ»šåŠ¨ä¿®å¤å·²å®‰è£…ï¼ˆcomposable ç®¡ç†ï¼‰')):console.warn('[ACU] æ— æ³•è®¿é—®çˆ¶çª—å£ documentï¼Œè§¦æ‘¸æ»šåŠ¨ä¿®å¤æœªå®‰è£…')}function i(){const e=window.parent?.document;e&&(a&&(e.removeEventListener('touchstart',a,{capture:!0}),a=null),o&&(e.removeEventListener('touchmove',o,{capture:!0}),o=null),console.info('[ACU] è§¦æ‘¸æ»šåŠ¨ä¿®å¤å·²å¸è½½'))}(0,m.onMounted)(()=>{l()}),(0,m.onUnmounted)(()=>{i()})}(),Y(),Le();const I=he(),M=(0,m.ref)(),U=(0,m.ref)(),L=(0,m.ref)();(0,m.provide)('allTables',()=>H.value);const P=(0,m.ref)(''),F=(0,m.ref)(!1),j=(0,m.reactive)({visible:!1,x:0,y:0,tableId:'',tableName:'',rowIndex:0,isDeleting:!1}),O=(0,m.computed)(()=>[`acu-theme-${r.config.theme}`,`acu-font-${r.config.fontFamily.replace(/\s+/g,'-').toLowerCase()}`,{'acu-mobile':a.isMobile,'acu-layout-horizontal':'horizontal'===r.config.layout,'acu-layout-vertical':'vertical'===r.config.layout}]),R=(0,m.computed)(()=>a.activeTab===k.H6?'ACU ä»ªè¡¨ç›˜':a.activeTab===k.$9?'ACU é€‰é¡¹é¢æ¿':`ACU - ${a.activeTab||'å¯è§†åŒ–è¡¨æ ¼'}`),H=(0,m.computed)(()=>{const e=o.stagedData;if(!e)return[];const t=(0,v.tE)(e);return t?Object.entries(t).map(([e,t])=>{const{key:a,headers:o,rows:n}=t,r=n.map((t,a)=>{const n=t.map((e,t)=>({colIndex:t,key:o[t]||`col_${t}`,value:String(e??'')}));return{index:a,key:`${e}-row-${a}`,cells:n}});return{id:a,name:e,headers:o.map(e=>String(e)),rows:r}}):[]}),W=(0,m.computed)(()=>H.value.map(e=>({id:e.id,name:e.name,icon:ne(e.name)}))),G=(0,m.computed)(()=>H.value.some(e=>e.name.includes('é€‰é¡¹')||e.name.toLowerCase().includes('option'))),X=(0,m.computed)(()=>!0===r.config.collapseTabBar),q=(0,m.computed)(()=>H.value.filter(e=>e.name.includes('é€‰é¡¹')||e.name.toLowerCase().includes('option'))),K=(0,m.computed)(()=>H.value.some(e=>(0,v._C)(e.name,e.id))),J=(0,m.computed)(()=>H.value.find(e=>{const t=e.name.toLowerCase(),a=e.id.toLowerCase();return t.includes('å…³ç³»')||a.includes('relationship')||a.includes('relation')})||null),Q=(0,m.computed)(()=>H.value.filter(e=>(0,v._C)(e.name,e.id))),Z=(0,m.computed)(()=>{const e=['åŠ¿åŠ›','faction','ç»„ç»‡','organization','é˜µè¥','å¸®æ´¾','å®—é—¨','é—¨æ´¾','æ´¾ç³»'];return H.value.find(t=>{const a=t.name.toLowerCase(),o=t.id.toLowerCase();return e.some(e=>a.includes(e)||o.includes(e))})||null}),ee=((0,m.computed)(()=>{const e=new Set;for(const t of Q.value){const a=t.headers.findIndex(e=>{const t=e.toLowerCase();return t.includes('åŠ¿åŠ›')||t.includes('é˜µè¥')||t.includes('faction')});if(a>=0)for(const o of t.rows){const t=o.cells.find(e=>e.colIndex===a);t&&t.value&&String(t.value).trim()&&e.add(String(t.value).trim())}}return Array.from(e)}),(0,m.computed)(()=>a.activeTab&&H.value.find(e=>e.id===a.activeTab)||null)),ae=(0,m.computed)(()=>0),oe=(0,m.computed)(()=>{const e=window.SillyTavern?.chat;return Array.isArray(e)?e.length-1:0});function ne(e){const t=e.toLowerCase();if(t.includes('ä¸»è§’')||t.includes('player'))return'fas fa-user';if(t.includes('ä»»åŠ¡')||t.includes('quest'))return'fas fa-tasks';if(t.includes('ç‰©å“')||t.includes('item'))return'fas fa-box-open';if(t.includes('è£…å¤‡')||t.includes('equip'))return'fas fa-shield-alt';if(t.includes('çŠ¶æ€')||t.includes('status'))return'fas fa-heart';if(t.includes('äº‹ä»¶')||t.includes('event'))return'fas fa-calendar-alt';if(t.includes('é€‰é¡¹')||t.includes('option'))return'fas fa-sliders-h';const a=(0,k.Sj)(e);return'fas fa-table'!==a?a:'fas fa-table'}function re(){a.closePanel(),console.info('[ACU] é¢æ¿å·²å…³é—­')}function le(){F.value=!F.value}function ie(){a.isCollapsed=!0,console.info('[ACU] é¢æ¿å·²æ”¶èµ·ä¸ºæ‚¬æµ®çƒ')}function ce(e){e&&U.value&&U.value.exitCenteredMode();const t=U.value?.getDataAreaElement();t&&(t.style.height='',t.style.minHeight='',t.style.maxHeight=''),a.setActiveTab(e),P.value='',F.value=!1,console.info(`[ACU] åˆ‡æ¢åˆ° Tab: ${e}`),(0,m.nextTick)(()=>{setTimeout(()=>{requestAnimationFrame(()=>{de(e)})},50)})}function de(e){const t=U.value?.getDataAreaElement();if(!t)return;const o=a.getTableHeight(e);o?(t.style.height=`${o}px`,console.info(`[ACU] æ¢å¤é«˜åº¦: ${e} = ${o}px`)):U.value?.resetHeight()}function pe(e){a.setTableOrder(e),console.info('[ACU] Tab é¡ºåºå·²æ›´æ–°')}function me(){a.toggleTabsPopup(),console.info('[ACU] Tabæµ®çª—: '+(a.tabsPopup?'æ˜¾ç¤º':'éšè—'))}function fe(e){a.closeTabsPopup(),ce(e)}function ge(e){const t=U.value?.getDataAreaElement();t&&(t.style.height='',t.style.minHeight='',t.style.maxHeight=''),a.setActiveTab(e),console.info(`[ACU] å¯¼èˆªåˆ°è¡¨æ ¼: ${e}`),(0,m.nextTick)(()=>{setTimeout(()=>{requestAnimationFrame(()=>{de(e)})},50)})}function ve(){K.value?(a.setActiveTab(k.SC),console.info('[ACU] å¯¼èˆªåˆ°å…³ç³»å›¾ Tab')):S.toast.warning('æœªæ‰¾åˆ°äººç‰©å…³ç³»æ•°æ®')}function be(){L.value&&L.value.openAvatarManager()}function xe(){a.openInputFloorDialog(ae.value)}function ye(){a.openPurgeRangeDialog(oe.value)}function we(e,t){switch(e){case'clear':ye();break;case'undo':Te();break;case'manualUpdate':Ye();break;case'console':a.openDirectorDialog();break;case'quickReroll':A();break;default:console.log('[ACU Dashboard] æœªå¤„ç†çš„åŠ¨ä½œ:',e,t)}}function ke(){ce(k.H6),console.info('[ACU] è¿”å›ä»ªè¡¨ç›˜')}function Ce(e,t){let o=String(e.promptTemplate||'');o=o.replace(/\{\{value\}\}/gi,e.label),o=t?.title?o.replace(/\{\{rowTitle\}\}/gi,t.title):o.replace(/\{\{rowTitle\}\}/gi,'');const n=function(){const e=window.parent||window;try{const t=e.SillyTavern?.getContext?.();if(t?.name1)return t.name1}catch(e){console.warn('[ACU] è·å–ä¸»è§’åå¤±è´¥',e)}return'{{user}}'}();o=o.replace(/\{\{playerName\}\}/gi,n),o=o.replace(/\{\{tableName\}\}/gi,'');const r=o.trim(),i=l.getCategoryById(e.categoryId),c=!!i&&(i.path.includes('åœ°ç‚¹')||i.path.includes('Location'));e.allowPreEdit||c?a.openTagPreEditDialog({tagLabel:e.label,resolvedPrompt:r,showCompanions:c}):r&&C(r)}function Ne(e,t){const o=U.value?.getDataAreaElement();if(!o||!t)return;if(0!==e.button)return;e.preventDefault(),e.stopPropagation(),t.setPointerCapture(e.pointerId);const n=e.clientY,r=o.offsetHeight,l=e=>{const t=n-e.clientY;let a=r+t;a=Math.max(200,a),o.style.height=`${a}px`},i=e=>{t.releasePointerCapture(e.pointerId),t.removeEventListener('pointermove',l),t.removeEventListener('pointerup',i);const n=a.activeTab;if(n&&o){const e=o.offsetHeight;a.setTableHeight(n,e),console.info(`[ACU] ä¿å­˜é«˜åº¦: ${n} = ${e}px`)}};t.addEventListener('pointermove',l),t.addEventListener('pointerup',i)}function Ve(){const e=a.activeTab;e&&(a.resetTableHeight(e),console.info(`[ACU] æ¸…é™¤é«˜åº¦è®°å¿†: ${e}`)),U.value?.resetHeight(),console.info('[ACU] é«˜åº¦å·²é‡ç½®ä¸ºè‡ªé€‚åº”')}async function Ee(){const e=p();if(e){const t=o.setStagedData(e);o.saveSnapshot(t);const r=Object.keys(e).filter(e=>e.startsWith('sheet_'));a.syncNewTablesToVisibleTabs(r),o.clearChanges(!0),n.ensureDefaultWidgets().catch(e=>{console.warn('[ACU] è¡¥å……é»˜è®¤ç»„ä»¶å¤±è´¥ï¼ˆéé˜»å¡ï¼‰:',e)}),h().catch(e=>{console.warn('[ACU] åˆ·æ–°è¡¨æ ¼æ›´æ–°çŠ¶æ€å¤±è´¥ï¼ˆéé˜»å¡ï¼‰:',e)})}}async function Be(){try{await Ee(),console.info('[ACU] æ•°æ®å·²åˆ·æ–°')}catch(e){console.error('[ACU] åˆ·æ–°å¤±è´¥:',e)}}async function Se(){try{o.saveLastState();await u(null,!1,!0)&&(console.info('[ACU] æ•°æ®å·²ä¿å­˜'),await Ee())}catch(e){console.error('[ACU] ä¿å­˜å¤±è´¥:',e)}}function Te(){if(!o.hasUndoData)return void S.toast.warning('æ²¡æœ‰å¯æ’¤å›çš„æ•°æ®');o.undoToLastSave()?(S.toast.success('å·²æ’¤å›åˆ°ä¸Šæ¬¡ä¿å­˜å‰çš„çŠ¶æ€ï¼ˆéœ€æ‰‹åŠ¨ä¿å­˜ï¼‰'),console.info('[ACU] å·²æ’¤å›åˆ°ä¸Šæ¬¡ä¿å­˜å‰çš„çŠ¶æ€, hasUnsavedChanges:',o.hasUnsavedChanges)):S.toast.error('æ’¤å›å¤±è´¥')}function De(e,t,a){console.info(`[ACU] å•å…ƒæ ¼ç‚¹å‡»: ${e}[${t}][${a}]`)}function ze(e,t){console.info(`[ACU] è¡Œç‚¹å‡»: ${e}[${t.index}]`)}async function Ie(e,t){console.info(`[ACU] æ’å…¥è¡Œ: ${e} åœ¨ç´¢å¼• ${t} ä¹‹å`);if(!H.value.find(t=>t.id===e))return void console.warn('[ACU] æœªæ‰¾åˆ°è¡¨æ ¼:',e);const{insertRow:a}=ue();await a(e,t),await Ee()}function _e(e,t){const a=H.value.find(t=>t.id===e),n=`${a?.name||e}-row-${t}`;o.toggleDelete(n),console.info(`[ACU] åˆ‡æ¢åˆ é™¤çŠ¶æ€: ${n}`)}function Me(e,t,a){const n=H.value.find(e=>e.id===t),r=n?.name||t,l=`${r}-row-${a}`;j.visible=!0,j.x=e.clientX,j.y=e.clientY,j.tableId=t,j.tableName=r,j.rowIndex=a,j.isDeleting=o.pendingDeletes.has(l)}function Ue(){Ie(j.tableId,j.rowIndex),j.visible=!1}function $e(){const e=H.value.find(e=>e.id===j.tableId),t=e?.rows[j.rowIndex];if(t){const e=t.cells.map(e=>`${e.key}: ${e.value}`).join('\n');navigator.clipboard.writeText(e).then(()=>{console.info('[ACU] å†…å®¹å·²å¤åˆ¶')})}j.visible=!1}function Pe(){_e(j.tableId,j.rowIndex),j.visible=!1}function Fe(){_e(j.tableId,j.rowIndex),j.visible=!1}function je(e,t,o,n){const r=H.value.find(t=>t.id===e);let l=1;if(r&&(t.includes('æ€»ç»“')||t.includes('å¤§çº²'))){const e=r.headers.findIndex(e=>e&&(e.includes('ç´¢å¼•')||e.includes('ç¼–å·')||e.includes('ä»£ç ')));l=e>0?e:1}a.openHistoryDialog({tableId:e,tableName:t,rowIndex:o,currentRowData:n,titleColIndex:l}),console.info(`[ACU] æ‰“å¼€å†å²è®°å½•: ${t}[${o}], titleColIndex=${l}`)}async function Oe(e){const{tableId:t,tableName:n,rowIndex:r,currentRowData:l}=a.historyDialog.props;if(!l||0===e.size)return void a.closeHistoryDialog();const{saveSnapshot:i,getCurrentChatId:c}=(0,B.m)();c()&&(await i(n,r,function(e){const t={};return e.cells.forEach((e,a)=>{t[a]=String(e.value)}),t}(l),'manual'),console.info('[ACU] å·²ä¿å­˜å†å²è®°å½•ï¼ˆæ‰¹é‡æ“ä½œå‰ï¼‰'));for(const[t,a]of e)o.updateCell(n,r,t,a,{skipHistory:!0});console.info(`[ACU] åº”ç”¨å†å²æ›´æ”¹: ${e.size} ä¸ªå•å…ƒæ ¼`),a.closeHistoryDialog()}function He(e='reveal'){const t=a.divinationOverlay.result;t?D(t,e):console.error('[ACU] Confirm divination failed: No result found')}function We(e){N(e),V()}function Ge(){console.info('[ACU] è®¾ç½®å·²ä¿å­˜')}function Ye(){a.openManualUpdateDialog()}function Xe(){try{const e=(window.parent||window).AutoCardUpdaterAPI||window.AutoCardUpdaterAPI;e&&'function'==typeof e.openVisualizer?(e.openVisualizer(),console.info('[ACU] å·²æ‰“å¼€åŸç”Ÿç¼–è¾‘å™¨')):console.warn('[ACU] AutoCardUpdaterAPI.openVisualizer ä¸å¯ç”¨')}catch(e){console.error('[ACU] æ‰“å¼€åŸç”Ÿç¼–è¾‘å™¨å¤±è´¥:',e)}}async function qe(e){try{await u(null,!1,!1,e)&&(console.info(`[ACU] æ•°æ®å·²ä¿å­˜åˆ°ç¬¬ ${e} æ¥¼`),await Ee())}catch(e){console.error('[ACU] ä¿å­˜åˆ°æŒ‡å®šæ¥¼å±‚å¤±è´¥:',e)}}async function Ke(e,t){try{await g(e,t),console.info(`[ACU] å·²æ¸…é™¤ç¬¬ ${e} åˆ° ${t} æ¥¼çš„æ•°æ®`),await Ee()}catch(e){console.error('[ACU] æ¸…é™¤èŒƒå›´å¤±è´¥:',e)}}async function Je(e){console.info(`[ACU] é«˜çº§æ¸…é™¤å®Œæˆï¼Œå½±å“ ${e.changedCount} æ¥¼å±‚ï¼Œè¡¨æ ¼:`,e.tables),await Ee()}return(0,m.onMounted)(async()=>{console.info('[ACU] App ç»„ä»¶å·²æŒ‚è½½'),c();try{I.init(),console.info('[ACU] Swipe å¢å¼ºåŠŸèƒ½åˆå§‹åŒ–æˆåŠŸ')}catch(e){console.error('[ACU] Swipe å¢å¼ºåŠŸèƒ½åˆå§‹åŒ–å¤±è´¥:',e)}a.setMobile(window.innerWidth<=768),window.addEventListener('resize',()=>{a.setMobile(window.innerWidth<=768)});try{await Ee(),await n.loadConfig(),i.loadConfig(),await i.loadFromWorldbook(),a.setInitialized(!0);let e=!1;try{const t=localStorage.getItem('acu_win_config'),o=t?JSON.parse(t):null;!0===o?.isCentered&&(e=!0,a.setActiveTab(null),a.isCollapsed=!1,console.info('[ACU] å±…ä¸­æ¨¡å¼ï¼ˆé¦–æ¬¡åŠ è½½ï¼‰ï¼šå¼ºåˆ¶æ¸…é™¤ Tabï¼Œå±•å¼€é¢æ¿ï¼Œåªæ˜¾ç¤ºå¯¼èˆªæ '))}catch(e){}!e&&!a.activeTab&&H.value.length>0&&a.setActiveTab(k.H6)}catch(e){console.error('[ACU] åˆå§‹åŒ–æ•°æ®åŠ è½½å¤±è´¥:',e)}}),(0,m.onUnmounted)(()=>{console.info('[ACU] App ç»„ä»¶å·²å¸è½½'),b(),E(),s()}),(0,m.onMounted)(()=>{const e=window.parent?.document||document,t=e=>{if(!a.isPanelVisible||a.isPinned)return;(function(e){const t=window.parent?.document||document;if(t.querySelector('.acu-inline-editor'))return console.info('[ACU] æ£€æµ‹åˆ° InlineEditor å­˜åœ¨ï¼Œé˜»æ­¢æ”¶èµ·é¢æ¿'),!0;if(t.querySelector('.acu-editing-lock'))return console.info('[ACU] æ£€æµ‹åˆ°ç¼–è¾‘é”å®šçŠ¶æ€ï¼Œé˜»æ­¢æ”¶èµ·é¢æ¿'),!0;const o=t.activeElement;return!o||'TEXTAREA'!==o.tagName&&'INPUT'!==o.tagName||!o.closest('.acu-wrapper')&&!o.closest('.acu-inline-editor')?!!(a.settingsDialog||a.inputFloorDialog.visible||a.purgeRangeDialog.visible||a.manualUpdateDialog||a.historyDialog.visible||a.presetSaveDialog.visible)||!!(e.closest('.acu-wrapper')||e.closest('.acu-floating-ball-vue')||e.closest('.acu-context-menu')||e.closest('.acu-modal-overlay')||e.closest('.acu-modal')||e.closest('.acu-modal-container')||e.closest('.acu-history-modal')||e.closest('.acu-dialog')||e.closest('[class*="acu-settings"]')||e.closest('#acu_visualizer_vue-root')||e.closest('.acu-inline-editor')||e.closest('.acu-editing-lock')||e.closest('.acu-edit-textarea')):(console.info('[ACU] æ£€æµ‹åˆ° ACU å†…çš„è¾“å…¥æ¡†æ´»åŠ¨ï¼Œé˜»æ­¢æ”¶èµ·é¢æ¿'),!0)})(e.target)||(a.closePanel(),console.info('[ACU] ç‚¹å‡»å¤–éƒ¨ï¼Œé¢æ¿å·²æ”¶èµ·'))};e.addEventListener('click',t),(0,m.onUnmounted)(()=>{e.removeEventListener('click',t)})}),(0,m.watchEffect)(()=>{const e=r.config.mobileSafeAreaBottom??50;window.parent?.document?.documentElement&&window.parent.document.documentElement.style.setProperty('--acu-safe-area-bottom',`${e}px`)}),(0,m.watch)(()=>o.stagedData,e=>{e&&o.generateDiffMap(e)},{deep:!0}),(e,n)=>((0,m.openBlock)(),(0,m.createElementBlock)('div',{class:(0,m.normalizeClass)(['acu-app',O.value])},[(0,m.createCommentVNode)(' æ‚¬æµ®çƒ (é¢æ¿éšè—æ—¶æ˜¾ç¤º) '),(0,m.createVNode)((0,m.unref)(Re),{ref_key:'floatingBallRef',ref:M,style:(0,m.normalizeStyle)({display:(0,m.unref)(a).isPanelVisible?'none':'block'})},null,8,['style']),(0,m.createCommentVNode)(' ä¸»é¢æ¿ '),(0,m.createVNode)((0,m.unref)(at),{ref_key:'mainPanelRef',ref:U,style:(0,m.normalizeStyle)({display:(0,m.unref)(a).isPanelVisible?'flex':'none'}),title:R.value,theme:(0,m.unref)(r).config.theme,layout:(0,m.unref)(r).config.layout,'is-collapsed':(0,m.unref)(a).isCollapsed,'is-pinned':(0,m.unref)(a).isPinned,'is-content-hidden':F.value,'lock-panel':(0,m.unref)(r).config.lockPanel,'has-changes':(0,m.unref)(o).hasUnsavedChanges,onRefresh:Be,onSave:Se,onSaveAs:xe,onUndo:Te,onManualUpdate:Ye,onPurge:ye,onOpenNative:Xe,onSettings:(0,m.unref)(a).openSettingsDialog,onTogglePin:(0,m.unref)(a).togglePin,onToggle:ie,onClose:re,onHideContent:le,onCollapseTab:me},{tabs:(0,m.withCtx)(()=>[X.value?(0,m.createCommentVNode)('v-if',!0):((0,m.openBlock)(),(0,m.createBlock)((0,m.unref)(rt),{key:0,tabs:W.value,'active-tab':(0,m.unref)(a).activeTab,'show-dashboard':!0,'has-options-tabs':G.value,'has-relationship-graph':K.value,'is-editing-order':(0,m.unref)(a).isEditingOrder,'grid-columns':(0,m.unref)(r).gridColumnsCss,onTabChange:ce,onOrderChange:pe,onExitEditing:n[0]||(n[0]=e=>(0,m.unref)(a).setEditingOrder(!1))},null,8,['tabs','active-tab','has-options-tabs','has-relationship-graph','is-editing-order','grid-columns']))]),'tabs-popup':(0,m.withCtx)(()=>[(0,m.createVNode)((0,m.unref)(qx),{visible:(0,m.unref)(a).tabsPopup,tabs:W.value,'active-tab':(0,m.unref)(a).activeTab,'grid-columns':(0,m.unref)(r).gridColumnsCss,'show-dashboard':!0,'show-options-panel':G.value,'show-relationship-graph':K.value,onTabClick:fe,onClose:(0,m.unref)(a).closeTabsPopup},null,8,['visible','tabs','active-tab','grid-columns','show-options-panel','show-relationship-graph','onClose'])]),default:(0,m.withCtx)(()=>[(0,m.createCommentVNode)(' ä»ªè¡¨ç›˜è§†å›¾ '),(0,m.unref)(a).activeTab===(0,m.unref)(k.H6)?((0,m.openBlock)(),(0,m.createBlock)((0,m.unref)(cr),{key:0,tables:H.value,onNavigate:ge,onRowClick:ze,onShowRelationshipGraph:ve,onAction:we,onHeightDragStart:Ne,onHeightReset:Ve},null,8,['tables'])):(0,m.unref)(a).activeTab===(0,m.unref)(k.$9)?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:1},[(0,m.createCommentVNode)(' é€‰é¡¹é¢æ¿è§†å›¾ '),(0,m.createVNode)((0,m.unref)(Mr),{tables:q.value,onCellClick:De,onToggleDelete:_e},null,8,['tables'])],2112)):(0,m.unref)(a).activeTab===(0,m.unref)(k.SC)?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:2},[(0,m.createCommentVNode)(' å…³ç³»å›¾è§†å›¾ '),(0,m.createVNode)((0,m.unref)(t),{ref_key:'relationshipGraphRef',ref:L,'relationship-table':J.value,'character-tables':Q.value,'faction-table':Z.value,'all-tables':H.value,'show-legend':!0},null,8,['relationship-table','character-tables','faction-table','all-tables'])],2112)):ee.value?((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:3},[(0,m.createCommentVNode)(' æ™®é€šè¡¨æ ¼è§†å›¾ '),((0,m.openBlock)(),(0,m.createBlock)((0,m.unref)(kr),{key:ee.value.id,'table-id':ee.value.id,'table-name':ee.value.name,rows:ee.value.rows,headers:ee.value.headers,'search-term':P.value,onCellClick:De,onInsertRow:Ie,onToggleDelete:_e,onContextMenu:Me,onSearchChange:n[1]||(n[1]=e=>P.value=e),onClose:ke,onHeightDragStart:Ne,onHeightReset:Ve,onShowHistory:je},null,8,['table-id','table-name','rows','headers','search-term']))],2112)):((0,m.openBlock)(),(0,m.createElementBlock)(m.Fragment,{key:4},[(0,m.createCommentVNode)(' æ— æ•°æ®çŠ¶æ€ '),n[14]||(n[14]=(0,m.createElementVNode)('div',{class:'acu-no-data'},[(0,m.createElementVNode)('i',{class:'fas fa-inbox'}),(0,m.createElementVNode)('p',null,'è¯·é€‰æ‹©ä¸€ä¸ªè¡¨æ ¼')],-1))],2112))]),_:1},8,['style','title','theme','layout','is-collapsed','is-pinned','is-content-hidden','lock-panel','has-changes','onSettings','onTogglePin']),(0,m.createCommentVNode)(' å³é”®èœå• '),(0,m.createVNode)((0,m.unref)(Ur),{visible:j.visible,'onUpdate:visible':n[2]||(n[2]=e=>j.visible=e),x:j.x,y:j.y,'table-id':j.tableId,'table-name':j.tableName,'row-index':j.rowIndex,onInsertRow:Ue,onCopy:$e,onDelete:Pe,onUndoDelete:Fe},null,8,['visible','x','y','table-id','table-name','row-index']),(0,m.createCommentVNode)(' è®¾ç½®å¼¹çª— '),(0,m.createVNode)((0,m.unref)(Gf),{visible:(0,m.unref)(a).settingsDialog,'onUpdate:visible':n[3]||(n[3]=e=>(0,m.unref)(a).settingsDialog=e),onSave:Ge},null,8,['visible']),(0,m.createCommentVNode)(' å¯¼æ¼”æ§åˆ¶å°å¼¹çª— '),(0,m.createVNode)((0,m.unref)(hl),{visible:(0,m.unref)(a).directorDialog,'onUpdate:visible':n[4]||(n[4]=e=>(0,m.unref)(a).directorDialog=e)},null,8,['visible']),(0,m.createCommentVNode)(' è¾“å…¥æ¥¼å±‚å¼¹çª— '),(0,m.createVNode)((0,m.unref)(Pi),{visible:(0,m.unref)(a).inputFloorDialog.visible,'onUpdate:visible':n[5]||(n[5]=e=>(0,m.unref)(a).inputFloorDialog.visible=e),'current-floor':(0,m.unref)(a).inputFloorDialog.props.currentFloor,onConfirm:qe},null,8,['visible','current-floor']),(0,m.createCommentVNode)(' æ¸…é™¤èŒƒå›´å¼¹çª— '),(0,m.createVNode)((0,m.unref)(jc),{visible:(0,m.unref)(a).purgeRangeDialog.visible,'onUpdate:visible':n[6]||(n[6]=e=>(0,m.unref)(a).purgeRangeDialog.visible=e),'max-floor':(0,m.unref)(a).purgeRangeDialog.props.maxFloor,onConfirm:Ke,onAdvancedConfirm:Je},null,8,['visible','max-floor']),(0,m.createCommentVNode)(' é«˜çº§æ¸…é™¤å¼¹çª— (å…¨å±€) '),(0,m.createVNode)((0,m.unref)(ll),{visible:(0,m.unref)(a).advancedPurgeDialog.visible,'onUpdate:visible':n[7]||(n[7]=e=>(0,m.unref)(a).advancedPurgeDialog.visible=e),'initial-start-floor':(0,m.unref)(a).advancedPurgeDialog.props.initialStartFloor,'initial-end-floor':(0,m.unref)(a).advancedPurgeDialog.props.initialEndFloor,'initial-selected-tables':(0,m.unref)(a).advancedPurgeDialog.state.selectedTableKeys,onConfirm:(0,m.unref)(a).handleAdvancedPurgeConfirm},null,8,['visible','initial-start-floor','initial-end-floor','initial-selected-tables','onConfirm']),(0,m.createCommentVNode)(' æ‰‹åŠ¨æ›´æ–°é…ç½®å¼¹çª— '),(0,m.createVNode)((0,m.unref)(Nc),{visible:(0,m.unref)(a).manualUpdateDialog,'onUpdate:visible':n[8]||(n[8]=e=>(0,m.unref)(a).manualUpdateDialog=e)},null,8,['visible']),(0,m.createCommentVNode)(' å†å²è®°å½•å¼¹çª— (DataTable ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(mi),{visible:(0,m.unref)(a).historyDialog.visible,'onUpdate:visible':n[9]||(n[9]=e=>(0,m.unref)(a).historyDialog.visible=e),'table-name':(0,m.unref)(a).historyDialog.props.tableName,'table-id':(0,m.unref)(a).historyDialog.props.tableId,'row-index':(0,m.unref)(a).historyDialog.props.rowIndex,'current-row-data':(0,m.unref)(a).historyDialog.props.currentRowData,'title-col-index':(0,m.unref)(a).historyDialog.props.titleColIndex,onApply:Oe},null,8,['visible','table-name','table-id','row-index','current-row-data','title-col-index']),(0,m.createCommentVNode)(' è¡Œç¼–è¾‘å¼¹çª— (Dashboard ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(Uh),{visible:(0,m.unref)(a).rowEditDialog.visible,'onUpdate:visible':n[10]||(n[10]=e=>(0,m.unref)(a).rowEditDialog.visible=e),'table-name':(0,m.unref)(a).rowEditDialog.props.tableName,'table-id':(0,m.unref)(a).rowEditDialog.props.tableId,'row-index':(0,m.unref)(a).rowEditDialog.props.rowIndex,'current-row-data':(0,m.unref)(a).rowEditDialog.props.currentRowData,onClose:(0,m.unref)(a).closeRowEditDialog,onShowHistory:(0,m.unref)(a).switchFromRowEditToHistory},null,8,['visible','table-name','table-id','row-index','current-row-data','onClose','onShowHistory']),(0,m.createCommentVNode)(' å†å²è®°å½•å¼¹çª— (Dashboard ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(mi),{visible:(0,m.unref)(a).dashboardHistoryDialog.visible,'onUpdate:visible':n[11]||(n[11]=e=>(0,m.unref)(a).dashboardHistoryDialog.visible=e),'table-name':(0,m.unref)(a).dashboardHistoryDialog.props.tableName,'table-id':(0,m.unref)(a).dashboardHistoryDialog.props.tableId,'row-index':(0,m.unref)(a).dashboardHistoryDialog.props.rowIndex,'current-row-data':(0,m.unref)(a).dashboardHistoryDialog.props.currentRowData,'title-col-index':(0,m.unref)(a).dashboardHistoryDialog.props.titleColIndex,onClose:(0,m.unref)(a).closeDashboardHistoryDialog},null,8,['visible','table-name','table-id','row-index','current-row-data','title-col-index','onClose']),(0,m.createCommentVNode)(' ç»„ä»¶è®¾ç½®å¼¹çª— (Dashboard ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(Tx),{visible:(0,m.unref)(a).widgetSettingsDialog.visible,'onUpdate:visible':n[12]||(n[12]=e=>(0,m.unref)(a).widgetSettingsDialog.visible=e),'widget-id':(0,m.unref)(a).widgetSettingsDialog.props.widgetId,'widget-config':(0,m.unref)(a).widgetSettingsDialog.props.widgetConfig,'table-headers':(0,m.unref)(a).widgetSettingsDialog.props.tableHeaders,onClose:(0,m.unref)(a).closeWidgetSettingsDialog},null,8,['visible','widget-id','widget-config','table-headers','onClose']),(0,m.createCommentVNode)(' å¤´åƒè£å‰ªå¼¹çª— (å…¨å±€) '),(0,m.createVNode)((0,m.unref)(gg),{visible:(0,m.unref)(a).avatarCropDialog.visible,'image-url':(0,m.unref)(a).avatarCropDialog.props.imageUrl,name:(0,m.unref)(a).avatarCropDialog.props.name,'initial-offset-x':(0,m.unref)(a).avatarCropDialog.props.initialOffsetX,'initial-offset-y':(0,m.unref)(a).avatarCropDialog.props.initialOffsetY,'initial-scale':(0,m.unref)(a).avatarCropDialog.props.initialScale,'initial-invert':(0,m.unref)(a).avatarCropDialog.props.initialInvert,'show-invert-option':(0,m.unref)(a).avatarCropDialog.props.showInvertOption,onClose:(0,m.unref)(a).closeAvatarCropDialog,onApply:(0,m.unref)(a).handleAvatarCropApply,onUpload:(0,m.unref)(a).handleAvatarCropUpload},null,8,['visible','image-url','name','initial-offset-x','initial-offset-y','initial-scale','initial-invert','show-invert-option','onClose','onApply','onUpload']),(0,m.createCommentVNode)(' å¿«æ·æŒ‰é’®é…ç½®å¼¹çª— (Dashboard ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(tx),{visible:(0,m.unref)(a).widgetActionsDialog.visible,'onUpdate:visible':n[13]||(n[13]=e=>(0,m.unref)(a).widgetActionsDialog.visible=e),'widget-id':(0,m.unref)(a).widgetActionsDialog.props.widgetId,'current-actions':(0,m.unref)(a).widgetActionsDialog.props.currentActions,onClose:(0,m.unref)(a).closeWidgetActionsDialog},null,8,['visible','widget-id','current-actions','onClose']),(0,m.createCommentVNode)(' å¤´åƒç®¡ç†å¼¹çª— (RelationshipGraph ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(ev),{visible:(0,m.unref)(a).avatarManagerDialog.visible,nodes:(0,m.unref)(a).avatarManagerDialog.props.nodes,factions:(0,m.unref)(a).avatarManagerDialog.props.factions,onClose:(0,m.unref)(a).closeAvatarManagerDialog,onUpdate:(0,m.unref)(a).handleAvatarManagerUpdate,onLabelChange:(0,m.unref)(a).handleAvatarManagerLabelChange},null,8,['visible','nodes','factions','onClose','onUpdate','onLabelChange']),(0,m.createCommentVNode)(' èŠ‚ç‚¹é…ç½®å¼¹çª— (RelationshipGraph ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(wh),{visible:(0,m.unref)(a).nodeConfigDialog.visible,'node-id':(0,m.unref)(a).nodeConfigDialog.props.nodeId,'full-name':(0,m.unref)(a).nodeConfigDialog.props.fullName,'current-label':(0,m.unref)(a).nodeConfigDialog.props.currentLabel,'selected-indices':(0,m.unref)(a).nodeConfigDialog.props.selectedIndices,onClose:(0,m.unref)(a).closeNodeConfigDialog,onConfirm:(0,m.unref)(a).handleNodeConfigConfirm,onResetToFullName:(0,m.unref)(a).handleNodeConfigResetToFullName,onStyleUpdate:(0,m.unref)(a).handleNodeConfigStyleUpdate},null,8,['visible','node-id','full-name','current-label','selected-indices','onClose','onConfirm','onResetToFullName','onStyleUpdate']),(0,m.createCommentVNode)(' å§“åé€‰æ‹©å¼¹çª— (AvatarManagerDialog ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(Dh),{visible:(0,m.unref)(a).nodeLabelDialog.visible,'full-name':(0,m.unref)(a).nodeLabelDialog.props.fullName,'initial-indices':(0,m.unref)(a).nodeLabelDialog.props.initialIndices,onClose:(0,m.unref)(a).closeNodeLabelDialog,onApply:(0,m.unref)(a).handleNodeLabelApply,onReset:(0,m.unref)(a).handleNodeLabelReset},null,8,['visible','full-name','initial-indices','onClose','onApply','onReset']),(0,m.createCommentVNode)(' å…³ç³»å›¾è®¾ç½®å¼¹çª— (RelationshipGraph ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(Gb),{visible:(0,m.unref)(a).graphSettingsDialog.visible,factions:(0,m.unref)(a).graphSettingsDialog.props.factions,onClose:(0,m.unref)(a).closeGraphSettingsDialog,onOpenAvatarManager:be},null,8,['visible','factions','onClose']),(0,m.createCommentVNode)(' åŠ¿åŠ›è®¾ç½®å¼¹çª— (RelationshipGraph ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(Sv),{visible:(0,m.unref)(a).factionSettingsDialog.visible,'faction-id':(0,m.unref)(a).factionSettingsDialog.props.factionId,'faction-name':(0,m.unref)(a).factionSettingsDialog.props.factionName,onClose:(0,m.unref)(a).closeFactionSettingsDialog},null,8,['visible','faction-id','faction-name','onClose']),(0,m.createCommentVNode)(' æ ‡ç­¾ç®¡ç†å™¨å¼¹çª— (WidgetSettingsDialog ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(vk),{visible:(0,m.unref)(a).tagManagerDialog.visible,'widget-id':(0,m.unref)(a).tagManagerDialog.props.widgetId,'displayed-tag-ids':(0,m.unref)(a).tagManagerDialog.props.displayedTagIds,'displayed-category-ids':(0,m.unref)(a).tagManagerDialog.props.displayedCategoryIds,onClose:(0,m.unref)(a).closeTagManagerDialog,onSave:(0,m.unref)(a).handleTagManagerSave},null,8,['visible','widget-id','displayed-tag-ids','displayed-category-ids','onClose','onSave']),(0,m.createCommentVNode)(' åˆ†ç±»é€‰æ‹©å¼¹çª— (DashboardWidget ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(Pk),{visible:(0,m.unref)(a).categorySelectDialog.visible,'category-id':(0,m.unref)(a).categorySelectDialog.props.categoryId,'row-context':(0,m.unref)(a).categorySelectDialog.props.rowContext,'widget-id':(0,m.unref)(a).categorySelectDialog.props.widgetId,onClose:(0,m.unref)(a).closeCategorySelectDialog,onSelect:Ce},null,8,['visible','category-id','row-context','widget-id','onClose']),(0,m.createCommentVNode)(' æ ‡ç­¾äºŒæ¬¡ç¼–è¾‘å¼¹çª— (DashboardWidget ä½¿ç”¨) '),(0,m.createVNode)((0,m.unref)(aC),{visible:(0,m.unref)(a).tagPreEditDialog.visible,'tag-label':(0,m.unref)(a).tagPreEditDialog.props.tagLabel,'resolved-prompt':(0,m.unref)(a).tagPreEditDialog.props.resolvedPrompt,'show-companions':(0,m.unref)(a).tagPreEditDialog.props.showCompanions,'widget-id':(0,m.unref)(a).tagPreEditDialog.props.widgetId,onClose:(0,m.unref)(a).closeTagPreEditDialog},null,8,['visible','tag-label','resolved-prompt','show-companions','widget-id','onClose']),(0,m.createCommentVNode)(' é¢„è®¾ä¿å­˜å¼¹çª— (å…¨å±€) '),(0,m.createVNode)((0,m.unref)(Mc),{visible:(0,m.unref)(a).presetSaveDialog.visible,'preset-type':(0,m.unref)(a).presetSaveDialog.props.presetType,'summary-items':(0,m.unref)(a).presetSaveDialog.props.summaryItems,'initial-name':(0,m.unref)(a).presetSaveDialog.props.initialName,'check-duplicate':(0,m.unref)(a).presetSaveDialog.props.checkDuplicate,'onUpdate:visible':(0,m.unref)(a).closePresetSaveDialog,onSave:(0,m.unref)(a).handlePresetSave},null,8,['visible','preset-type','summary-items','initial-name','check-duplicate','onUpdate:visible','onSave']),(0,m.createCommentVNode)(' æŠ½ç­¾è¦†ç›–å±‚ '),(0,m.createVNode)((0,m.unref)(Px),{visible:(0,m.unref)(a).divinationOverlay.visible,result:(0,m.unref)(a).divinationOverlay.result,onClose:(0,m.unref)(a).closeDivinationOverlay,onRetry:(0,m.unref)(T),onConfirm:He},null,8,['visible','result','onClose','onRetry']),(0,m.createCommentVNode)(' éšè—æç¤ºè¯ç¼–è¾‘å¼¹çª— '),(0,m.createVNode)((0,m.unref)(oy),{visible:(0,m.unref)(a).promptEditorDialog.visible,prompt:(0,m.unref)(a).promptEditorDialog.props.prompt,onClose:(0,m.unref)(a).closePromptEditorDialog,onSave:We},null,8,['visible','prompt','onClose']),(0,m.createCommentVNode)(' å…¨å±€å›¾æ ‡é€‰æ‹©å¼¹çª— '),(0,m.createVNode)((0,m.unref)(zi),{visible:(0,m.unref)(a).iconSelectDialog.visible,'current-icon':(0,m.unref)(a).iconSelectDialog.props.currentIcon,'onUpdate:visible':(0,m.unref)(a).closeIconSelectDialog,onSelect:(0,m.unref)(a).handleIconSelect},null,8,['visible','current-icon','onUpdate:visible','onSelect']),(0,m.createCommentVNode)(' å…¨å±€ Toast é€šçŸ¥ '),(0,m.createVNode)((0,m.unref)(Gx),{visible:(0,m.unref)(x).visible,message:(0,m.unref)(x).message,type:(0,m.unref)(x).type},null,8,['visible','message','type'])],2))}}),nC=oC;l({holdToDrag:300,dragImageTranslateOverride:i}),window.$=window.parent.$;const rC='acu-parent-container',lC='acu_win_config',iC='acu_active_tab',cC='acu_ui_collapse_state';let sC=null,uC=null,dC=null,pC=!1;function mC(){!function(){try{const e=localStorage.getItem(lC);if(!e){const e={width:400,left:'50%',bottom:'50%',isCentered:!0};return localStorage.setItem(lC,JSON.stringify(e)),localStorage.removeItem(iC),localStorage.setItem(cC,'false'),void console.info('[ACU] é¦–æ¬¡åŠ è½½ï¼šè®¾ç½®å±…ä¸­æ¨¡å¼ï¼Œæ¸…é™¤ activeTab')}const t=JSON.parse(e);!0===t?.isCentered&&(localStorage.removeItem(iC),localStorage.setItem(cC,'false'),console.info('[ACU] å±…ä¸­æ¨¡å¼ï¼šæ¸…é™¤ activeTabï¼Œç¡®ä¿é¢æ¿å±•å¼€'))}catch(e){const t={width:400,left:'50%',bottom:'50%',isCentered:!0};localStorage.setItem(lC,JSON.stringify(t)),localStorage.removeItem(iC),localStorage.setItem(cC,'false'),console.warn('[ACU] è§£æ win_config å¤±è´¥ï¼Œé‡ç½®ä¸ºå±…ä¸­æ¨¡å¼:',e)}}();let e=0;const t=()=>{if(pC)return void console.info('[ACU] è„šæœ¬æ­£åœ¨å¸è½½ï¼Œåœæ­¢ API æ£€æŸ¥');const{$,getDB:a}=(0,v.M1)(),o=a();if(o&&'function'==typeof o.exportTableAsJson&&$){const a=o.exportTableAsJson();if(!(a&&Object.keys(a).length>0)&&e<10)return e++,console.info(`[ACU] API å°±ç»ªä½†æ— æ•°æ®ï¼Œç­‰å¾…ä¸­... (${e}/10)`),void(dC=setTimeout(t,1e3));dC=null,function(){const e=window.parent.document;if(e.getElementById(rC))return void console.warn('[ACU] Vue åº”ç”¨å·²å­˜åœ¨ï¼Œè·³è¿‡é‡å¤åˆå§‹åŒ–');uC=e.createElement('div'),uC.id=rC,e.body.appendChild(uC);const t=(0,p.createPinia)();sC=(0,m.createApp)(nC),sC.use(t),sC.mount(uC),console.info(`[ACU] Vue åº”ç”¨å·²æŒ‚è½½åˆ°çˆ¶çª—å£ (${rC})`)}()}else dC=setTimeout(t,1e3)};t()}$(()=>{console.info(`[ACU] v${Oc} è„šæœ¬åŠ è½½`),replaceScriptButtons([{name:'ğŸ´ éšè—æç¤ºè¯',visible:!0}]),eventOn(getButtonEvent('ğŸ´ éšè—æç¤ºè¯'),()=>{if(!sC)return void console.warn('[ACU] Vue åº”ç”¨å°šæœªåˆå§‹åŒ–');const e=(0,k.j_)(),t=window.__acu_hidden_prompt||'';e.openPromptEditorDialog(t)}),eventOn('generation_started',()=>{if(!sC)return;const e=(0,Mt.E)();e.config.enableWordPool&&e.config.autoSync&&(console.info('[ACU] é…’é¦† AI ç”Ÿæˆå¼€å§‹ï¼Œè§¦å‘éšæœºè¯åº“åŒæ­¥...'),e.syncFromACU())}),setTimeout(()=>{le()},500),mC(),$(window).on('pagehide',()=>{console.info('[ACU] é¡µé¢å¸è½½ï¼Œæ‰§è¡Œæ¸…ç†'),ie(),console.info('[ACU] å¼€å§‹æ¸…ç†èµ„æº...'),pC=!0,null!==dC&&(clearTimeout(dC),dC=null,console.info('[ACU] åˆå§‹åŒ–å®šæ—¶å™¨å·²æ¸…é™¤')),sC&&(sC.unmount(),sC=null,console.info('[ACU] Vue åº”ç”¨å·²å¸è½½')),uC&&(uC.remove(),uC=null,console.info('[ACU] æŒ‚è½½ç‚¹å·²ç§»é™¤')),console.info('[ACU] èµ„æºæ¸…ç†å®Œæˆ')})});
//# sourceMappingURL=index.js.map