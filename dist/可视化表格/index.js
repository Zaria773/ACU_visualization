import{createPinia as e,defineStore as a}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';import{klona as t}from'https://testingcf.jsdelivr.net/npm/klona/+esm';var o={38(e,a,t){t.r(a),t.d(a,{default:()=>c});var o=t(492),n=t.n(o),r=t(748),i=t.n(r)()(n());i.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const c=i},61(e){e.exports=Vue},97(e,a,t){t.r(a),t.d(a,{default:()=>c});var o=t(492),n=t.n(o),r=t(748),i=t.n(r)()(n());i.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const c=i},99(e,a,t){t.d(a,{d:()=>d,toast:()=>p});var o=t(61);const n=(0,o.ref)({visible:!1,message:'',type:'info',timer:null});function r(e,a='info',t=3e3){n.value.timer&&clearTimeout(n.value.timer),n.value.visible=!0,n.value.message=e,n.value.type=a,n.value.timer=setTimeout(()=>{n.value.visible=!1,n.value.timer=null},t)}function i(){n.value.timer&&clearTimeout(n.value.timer),n.value.visible=!1,n.value.timer=null}function c(e,a=3e3){r(e,'success',a)}function l(e,a=4e3){r(e,'error',a)}function s(e,a=3500){r(e,'warning',a)}function u(e,a=3e3){r(e,'info',a)}function d(){return{state:n,show:r,hide:i,success:c,error:l,warning:s,info:u}}const p={show:r,hide:i,success:c,error:l,warning:s,info:u}},202(e,a,t){var o=t(97);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,t(424).A)('17acf212',o,!1,{ssrId:!0})},263(e,a,t){t.r(a),t.d(a,{default:()=>c});var o=t(492),n=t.n(o),r=t(748),i=t.n(r)()(n());i.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const c=i},395(e,a,t){t.r(a),t.d(a,{default:()=>c});var o=t(492),n=t.n(o),r=t(748),i=t.n(r)()(n());i.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const c=i},424(e,a,t){function o(e,a){for(var t=[],o={},n=0;n<a.length;n++){var r=a[n],i=r[0],c={id:e+':'+n,css:r[1],media:r[2],sourceMap:r[3]};o[i]?o[i].parts.push(c):t.push(o[i]={id:i,parts:[c]})}return t}t.d(a,{A:()=>m});var n='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!n)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var r={},i=n&&(document.head||document.getElementsByTagName('head')[0]),c=null,l=0,s=!1,u=function(){},d=null,p='data-vue-ssr-id',g='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(e,a,t,n){s=t,d=n||{};var i=o(e,a);return f(i),function(a){for(var t=[],n=0;n<i.length;n++){var c=i[n];(l=r[c.id]).refs--,t.push(l)}a?f(i=o(e,a)):i=[];for(n=0;n<t.length;n++){var l;if(0===(l=t[n]).refs){for(var s=0;s<l.parts.length;s++)l.parts[s]();delete r[l.id]}}}}function f(e){for(var a=0;a<e.length;a++){var t=e[a],o=r[t.id];if(o){o.refs++;for(var n=0;n<o.parts.length;n++)o.parts[n](t.parts[n]);for(;n<t.parts.length;n++)o.parts.push(v(t.parts[n]));o.parts.length>t.parts.length&&(o.parts.length=t.parts.length)}else{var i=[];for(n=0;n<t.parts.length;n++)i.push(v(t.parts[n]));r[t.id]={id:t.id,refs:1,parts:i}}}}function b(){var e=document.createElement('style');return e.type='text/css',i.appendChild(e),e}function v(e){var a,t,o=document.querySelector('style['+p+'~="'+e.id+'"]');if(o){if(s)return u;o.parentNode.removeChild(o)}if(g){var n=l++;o=c||(c=b()),a=w.bind(null,o,n,!1),t=w.bind(null,o,n,!0)}else o=b(),a=y.bind(null,o),t=function(){o.parentNode.removeChild(o)};return a(e),function(o){if(o){if(o.css===e.css&&o.media===e.media&&o.sourceMap===e.sourceMap)return;a(e=o)}else t()}}var h,x=(h=[],function(e,a){return h[e]=a,h.filter(Boolean).join('\n')});function w(e,a,t,o){var n=t?'':o.css;if(e.styleSheet)e.styleSheet.cssText=x(a,n);else{var r=document.createTextNode(n),i=e.childNodes;i[a]&&e.removeChild(i[a]),i.length?e.insertBefore(r,i[a]):e.appendChild(r)}}function y(e,a){var t=a.css,o=a.media,n=a.sourceMap;if(o&&e.setAttribute('media',o),d.ssrId&&e.setAttribute(p,a.id),n&&(t+='\n/*# sourceURL='+n.sources[0]+' */',t+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+' */'),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},453(e,a,t){var o=t(38);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,t(424).A)('113e25b8',o,!1,{ssrId:!0})},455(e,a){a.A=(e,a)=>{const t=e.__vccOpts||e;for(const[e,o]of a)t[e]=o;return t}},492(e){e.exports=function(e){var a=e[1],t=e[3];if(!t)return a;if('function'==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),n='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(o),r='/*# '.concat(n,' */');return[a].concat([r]).join('\n')}return[a].join('\n')}},514(e,a,t){var o=t(913);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,t(424).A)('76d524d6',o,!1,{ssrId:!0})},538(e,a,t){var o=t(263);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,t(424).A)('a3205dd2',o,!1,{ssrId:!0})},655(e,a,t){var o=t(742);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,t(424).A)('3f905f62',o,!1,{ssrId:!0})},742(e,a,t){t.r(a),t.d(a,{default:()=>c});var o=t(492),n=t.n(o),r=t(748),i=t.n(r)()(n());i.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const c=i},748(e){e.exports=function(e){var a=[];return a.toString=function(){return this.map(function(a){var t='',o=void 0!==a[5];return a[4]&&(t+='@supports ('.concat(a[4],') {')),a[2]&&(t+='@media '.concat(a[2],' {')),o&&(t+='@layer'.concat(a[5].length>0?' '.concat(a[5]):'',' {')),t+=e(a),o&&(t+='}'),a[2]&&(t+='}'),a[4]&&(t+='}'),t}).join('')},a.i=function(e,t,o,n,r){'string'==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(i[l]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);o&&i[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]='@layer'.concat(u[5].length>0?' '.concat(u[5]):'',' {').concat(u[1],'}')),u[5]=r),t&&(u[2]?(u[1]='@media '.concat(u[2],' {').concat(u[1],'}'),u[2]=t):u[2]=t),n&&(u[4]?(u[1]='@supports ('.concat(u[4],') {').concat(u[1],'}'),u[4]=n):u[4]=''.concat(n)),a.push(u))}},a}},913(e,a,t){t.r(a),t.d(a,{default:()=>c});var o=t(492),n=t.n(o),r=t(748),i=t.n(r)()(n());i.push([e.id,'','',{version:3,sources:[],names:[],mappings:'',sourceRoot:''}]);const c=i},952(e,a,t){var o=t(395);o.__esModule&&(o=o.default),'string'==typeof o&&(o=[[e.id,o,'']]),o.locals&&(e.exports=o.locals);(0,t(424).A)('2dff1386',o,!1,{ssrId:!0})}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var t=n[e]={id:e,exports:{}};return o[e](t,t.exports,r),t.exports}r.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return r.d(a,{a}),a},r.d=(e,a)=>{for(var t in a)r.o(a,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},r.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),r.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};var i=r(61);function c(e){return!!(0,i.getCurrentScope)()&&((0,i.onScopeDispose)(e),!0)}const l='undefined'!=typeof window&&'undefined'!=typeof document,s=('undefined'!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),u=e=>'[object Object]'===s.call(e),d=()=>{},p=g();function g(){var e,a;return l&&(null==(e=null==window?void 0:window.navigator)?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||(null==(a=null==window?void 0:window.navigator)?void 0:a.maxTouchPoints)>2&&/iPad|Macintosh/.test(null==window?void 0:window.navigator.userAgent))}function m(...e){if(1!==e.length)return(0,i.toRef)(...e);const a=e[0];return'function'==typeof a?(0,i.readonly)((0,i.customRef)(()=>({get:a,set:d}))):(0,i.ref)(a)}function f(e,a){return function(...t){return new Promise((o,n)=>{Promise.resolve(e(()=>a.apply(this,t),{fn:a,thisArg:this,args:t})).then(o).catch(n)})}}const b=e=>e();function v(e,a={}){let t,o,n=d;const r=e=>{clearTimeout(e),n(),n=d};let c;return l=>{const s=(0,i.toValue)(e),u=(0,i.toValue)(a.maxWait);return t&&r(t),s<=0||void 0!==u&&u<=0?(o&&(r(o),o=void 0),Promise.resolve(l())):new Promise((e,i)=>{n=a.rejectOnCancel?i:e,c=l,u&&!o&&(o=setTimeout(()=>{t&&r(t),o=void 0,e(c())},u)),t=setTimeout(()=>{o&&r(o),o=void 0,e(l())},s)})}}function h(e){return Array.isArray(e)?e:[e]}function x(e){const a=Object.create(null);return t=>a[t]||(a[t]=e(t))}const w=/\B([A-Z])/g,y=(x(e=>e.replace(w,'-$1').toLowerCase()),/-(\w)/g);x(e=>e.replace(y,(_,e)=>e?e.toUpperCase():''));function k(e){return e||(0,i.getCurrentInstance)()}function C(e,a=200,t={}){return f(v(a,t),e)}function N(e,a,t={}){const{eventFilter:o=b,...n}=t;return(0,i.watch)(e,f(o,a),n)}function V(e,a,t={}){const{eventFilter:o,initialState:n='active',...r}=t,{eventFilter:c,pause:l,resume:s,isActive:u}=function(e=b,a={}){const{initialState:t='active'}=a,o=m('active'===t);return{isActive:(0,i.readonly)(o),pause:function(){o.value=!1},resume:function(){o.value=!0},eventFilter:(...a)=>{o.value&&e(...a)}}}(o,{initialState:n});return{stop:N(e,a,{...r,eventFilter:c}),pause:l,resume:s,isActive:u}}function E(e,a,t={}){const{immediate:o=!0,immediateCallback:n=!1}=t,r=(0,i.shallowRef)(!1);let s;function u(){s&&(clearTimeout(s),s=void 0)}function d(){r.value=!1,u()}function p(...t){n&&e(),u(),r.value=!0,s=setTimeout(()=>{r.value=!1,s=void 0,e(...t)},(0,i.toValue)(a))}return o&&(r.value=!0,l&&p()),c(d),{isPending:(0,i.shallowReadonly)(r),start:p,stop:d}}const B=l?window:void 0,S=(l&&window.document,l?window.navigator:void 0);l&&window.location;function T(e){var a;const t=(0,i.toValue)(e);return null!=(a=null==t?void 0:t.$el)?a:t}function A(...e){const a=[],t=()=>{a.forEach(e=>e()),a.length=0},o=(0,i.computed)(()=>{const a=h((0,i.toValue)(e[0])).filter(e=>null!=e);return a.every(e=>'string'!=typeof e)?a:void 0}),n=(r=()=>{var a,t;return[null!=(t=null==(a=o.value)?void 0:a.map(e=>T(e)))?t:[B].filter(e=>null!=e),h((0,i.toValue)(o.value?e[1]:e[0])),h((0,i.unref)(o.value?e[2]:e[1])),(0,i.toValue)(o.value?e[3]:e[2])]},l=([e,o,n,r])=>{if(t(),!(null==e?void 0:e.length)||!(null==o?void 0:o.length)||!(null==n?void 0:n.length))return;const i=u(r)?{...r}:r;a.push(...e.flatMap(e=>o.flatMap(a=>n.map(t=>((e,a,t,o)=>(e.addEventListener(a,t,o),()=>e.removeEventListener(a,t,o)))(e,a,t,i)))))},s={flush:'post'},(0,i.watch)(r,l,{...s,immediate:!0}));var r,l,s;return c(t),()=>{n(),t()}}let U=!1;function D(e,a,t={}){const{window:o=B,ignore:n=[],capture:r=!0,detectIframe:c=!1,controls:l=!1}=t;if(!o)return l?{stop:d,cancel:d,trigger:d}:d;if(p&&!U){U=!0;const e={passive:!0};Array.from(o.document.body.children).forEach(a=>a.addEventListener('click',d,e)),o.document.documentElement.addEventListener('click',d,e)}let s=!0;const u=e=>(0,i.toValue)(n).some(a=>{if('string'==typeof a)return Array.from(o.document.querySelectorAll(a)).some(a=>a===e.target||e.composedPath().includes(a));{const t=T(a);return t&&(e.target===t||e.composedPath().includes(t))}});const g=t=>{const o=T(e);null!=t.target&&(o instanceof Element||!function(e){const a=(0,i.toValue)(e);return a&&16===a.$.subTree.shapeFlag}(e)||!function(e,a){const t=(0,i.toValue)(e),o=t.$.subTree&&t.$.subTree.children;return!(null==o||!Array.isArray(o))&&o.some(e=>e.el===a.target||a.composedPath().includes(e.el))}(e,t))&&o&&o!==t.target&&!t.composedPath().includes(o)&&('detail'in t&&0===t.detail&&(s=!u(t)),s?a(t):s=!0)};let m=!1;const f=[A(o,'click',e=>{m||(m=!0,setTimeout(()=>{m=!1},0),g(e))},{passive:!0,capture:r}),A(o,'pointerdown',a=>{const t=T(e);s=!u(a)&&!(!t||a.composedPath().includes(t))},{passive:!0}),c&&A(o,'blur',t=>{setTimeout(()=>{var n;const r=T(e);'IFRAME'!==(null==(n=o.document.activeElement)?void 0:n.tagName)||(null==r?void 0:r.contains(o.document.activeElement))||a(t)},0)},{passive:!0})].filter(Boolean),b=()=>f.forEach(e=>e());return l?{stop:b,cancel:()=>{s=!1},trigger:e=>{s=!0,g(e),s=!1}}:b}function M(e){const a=function(){const e=(0,i.shallowRef)(!1),a=(0,i.getCurrentInstance)();return a&&(0,i.onMounted)(()=>{e.value=!0},a),e}();return(0,i.computed)(()=>(a.value,Boolean(e())))}Symbol('vueuse-ssr-width');function I(e,a={}){const{controls:t=!1,navigator:o=S}=a,n=M(()=>o&&'permissions'in o),r=(0,i.shallowRef)(),c='string'==typeof e?{name:e}:e,l=(0,i.shallowRef)(),s=()=>{var e,a;l.value=null!=(a=null==(e=r.value)?void 0:e.state)?a:'prompt'};A(r,'change',s,{passive:!0});const u=function(e){let a;function t(){return a||(a=e()),a}return t.reset=async()=>{const e=a;a=void 0,e&&await e},t}(async()=>{if(n.value){if(!r.value)try{r.value=await o.permissions.query(c)}catch(e){r.value=void 0}finally{s()}return t?(0,i.toRaw)(r.value):void 0}});return u(),t?{state:l,isSupported:n,query:u}:l}function P(e={}){const{navigator:a=S,read:t=!1,source:o,copiedDuring:n=1500,legacy:r=!1}=e,c=M(()=>a&&'clipboard'in a),l=I('clipboard-read'),s=I('clipboard-write'),u=(0,i.computed)(()=>c.value||r),d=(0,i.shallowRef)(''),p=(0,i.shallowRef)(!1),g=E(()=>p.value=!1,n,{immediate:!1});function m(e){return'granted'===e||'prompt'===e}return u.value&&t&&A(['copy','cut'],async function(){let e=!(c.value&&m(l.value));if(!e)try{d.value=await a.clipboard.readText()}catch(a){e=!0}var t,o,n;e&&(d.value=null!=(n=null==(o=null==(t=null==document?void 0:document.getSelection)?void 0:t.call(document))?void 0:o.toString())?n:'')},{passive:!0}),{isSupported:u,text:d,copied:p,copy:async function(e=(0,i.toValue)(o)){if(u.value&&null!=e){let t=!(c.value&&m(s.value));if(!t)try{await a.clipboard.writeText(e)}catch(e){t=!0}t&&function(e){const a=document.createElement('textarea');a.value=null!=e?e:'',a.style.position='absolute',a.style.opacity='0',document.body.appendChild(a),a.select(),document.execCommand('copy'),a.remove()}(e),d.value=e,p.value=!0,g.start()}}}}const F='undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof self?self:{},j='__vueuse_ssr_handlers__',L=R();function R(){return j in F||(F[j]=F[j]||{}),F[j]}function O(e,a){return L[e]||a}function H(e){return null==e?'any':e instanceof Set?'set':e instanceof Map?'map':e instanceof Date?'date':'boolean'==typeof e?'boolean':'string'==typeof e?'string':'object'==typeof e?'object':Number.isNaN(e)?'any':'number'}const q={boolean:{read:e=>'true'===e,write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Y='vueuse-storage';function X(e,a,t,o={}){var n;const{flush:r='pre',deep:c=!0,listenToStorageChanges:l=!0,writeDefaults:s=!0,mergeDefaults:u=!1,shallow:d,window:p=B,eventFilter:g,onError:m=e=>{console.error(e)},initOnMounted:f}=o,b=(d?i.shallowRef:i.ref)('function'==typeof a?a():a),v=(0,i.computed)(()=>(0,i.toValue)(e));if(!t)try{t=O('getDefaultStorage',()=>{var e;return null==(e=B)?void 0:e.localStorage})()}catch(e){m(e)}if(!t)return b;const h=(0,i.toValue)(a),x=H(h),w=null!=(n=o.serializer)?n:q[x],{pause:y,resume:C}=V(b,e=>function(e){try{const a=t.getItem(v.value);if(null==e)S(a,null),t.removeItem(v.value);else{const o=w.write(e);a!==o&&(t.setItem(v.value,o),S(a,o))}}catch(e){m(e)}}(e),{flush:r,deep:c,eventFilter:g});(0,i.watch)(v,()=>T(),{flush:r});let N=!1;const E=e=>{f&&!N||T(e.detail)};function S(e,a){if(p){const o={key:v.value,oldValue:e,newValue:a,storageArea:t};p.dispatchEvent(t instanceof Storage?new StorageEvent('storage',o):new CustomEvent(Y,{detail:o}))}}function T(e){if(!e||e.storageArea===t)if(e&&null==e.key)b.value=h;else if(!e||e.key===v.value){y();try{const a=w.write(b.value);void 0!==e&&(null==e?void 0:e.newValue)===a||(b.value=function(e){const a=e?e.newValue:t.getItem(v.value);if(null==a)return s&&null!=h&&t.setItem(v.value,w.write(h)),h;if(!e&&u){const e=w.read(a);return'function'==typeof u?u(e,h):'object'!==x||Array.isArray(e)?e:{...h,...e}}return'string'!=typeof a?a:w.read(a)}(e))}catch(e){m(e)}finally{e?(0,i.nextTick)(C):C()}}}return p&&l&&(t instanceof Storage?A(p,'storage',e=>{f&&!N||T(e)},{passive:!0}):A(p,Y,E)),f?function(e,a=!0,t){k(t)?(0,i.onMounted)(e,t):a?e():(0,i.nextTick)(e)}(()=>{N=!0,T()}):T(),b}function W(e,a,t={}){const{window:o=B,...n}=t;let r;const l=M(()=>o&&'ResizeObserver'in o),s=()=>{r&&(r.disconnect(),r=void 0)},u=(0,i.computed)(()=>{const a=(0,i.toValue)(e);return Array.isArray(a)?a.map(e=>T(e)):[T(a)]}),d=(0,i.watch)(u,e=>{if(s(),l.value&&o){r=new ResizeObserver(a);for(const a of e)a&&r.observe(a,n)}},{immediate:!0,flush:'post'}),p=()=>{s(),d()};return c(p),{isSupported:l,stop:p}}function K(e={}){const{window:a=B}=e,t=(0,i.ref)(null),o=(0,i.computed)(()=>{var e,a;return null!=(a=null==(e=t.value)?void 0:e.toString())?a:''}),n=(0,i.computed)(()=>t.value?function(e){var a;const t=null!=(a=e.rangeCount)?a:0;return Array.from({length:t},(_,a)=>e.getRangeAt(a))}(t.value):[]),r=(0,i.computed)(()=>n.value.map(e=>e.getBoundingClientRect()));return a&&A(a.document,'selectionchange',function(){t.value=null,a&&(t.value=a.getSelection())},{passive:!0}),{text:o,rects:r,ranges:n,selection:t}}Number.POSITIVE_INFINITY;const J=[{id:'save',icon:'fa-save',label:'保存',longPress:'saveAs'},{id:'saveAs',icon:'fa-file-export',label:'另存为'},{id:'refresh',icon:'fa-sync-alt',label:'刷新'},{id:'manualUpdate',icon:'fa-hand-sparkles',label:'手动更新'},{id:'purge',icon:'fa-eraser',label:'清除范围'},{id:'pin',icon:'fa-thumbtack',label:'固定面板'},{id:'toggle',icon:'fa-compress',label:'收起面板'},{id:'openNative',icon:'fa-external-link-alt',label:'原生编辑器'},{id:'settings',icon:'fa-cog',label:'设置',longPress:'openNative'}],G={theme:'retro',fontFamily:'default',cardWidth:280,fontSize:13,itemsPerPage:20,highlightNew:!0,highlightColor:'orange',highlightManualColor:'orange',highlightAiColor:'blue',customTitleColor:!1,titleColor:'orange',layout:'vertical',limitLongText:!0,showDashboard:!0,showPagination:!0,lockPanel:!1,purgeConfirmation:!0,gridColumns:0,autoSave:!1,autoSaveDelay:5e3,visibleButtons:['save','refresh','manualUpdate','settings','pin','toggle'],buttonOrder:['save','saveAs','refresh','manualUpdate','purge','pin','toggle','settings']},Q=[{id:'retro',name:'复古羊皮',icon:'fa-scroll'},{id:'dark',name:'极夜深空',icon:'fa-moon'},{id:'modern',name:'现代清爽',icon:'fa-sun'},{id:'forest',name:'森之物语',icon:'fa-tree'},{id:'ocean',name:'深海幽蓝',icon:'fa-water'},{id:'cyber',name:'赛博霓虹',icon:'fa-bolt'},{id:'purple',name:'梦幻浅紫',icon:'fa-magic'}],Z=[{id:'default',name:'系统默认 (Modern)',val:'\'Segoe UI\', \'Microsoft YaHei\', sans-serif'},{id:'hanchan',name:'寒蝉全圆体',val:'"寒蝉全圆体", sans-serif'},{id:'maple',name:'Maple Mono (代码风)',val:'"Maple Mono NF CN", monospace'},{id:'huiwen',name:'汇文明朝体 (Huiwen)',val:'"Huiwen-mincho", serif'},{id:'cooper',name:'Cooper正楷',val:'"CooperZhengKai", serif'},{id:'yffyt',name:'YFFYT (艺术体)',val:'"YFFYT", sans-serif'},{id:'fusion',name:'Fusion Pixel (像素风)',val:'"Fusion Pixel 12px M latin", monospace'},{id:'wenkai',name:'霞鹜文楷 (WenKai)',val:'"LXGW WenKai", serif'},{id:'notosans',name:'思源黑体 (Noto Sans)',val:'"Noto Sans CJK", sans-serif'},{id:'zhuque',name:'朱雀仿宋 (Zhuque)',val:'"Zhuque Fangsong (technical preview)", serif'}],ee={orange:{main:'#d35400',bg:'rgba(211, 84, 0, 0.1)',name:'活力橙'},red:{main:'#e74c3c',bg:'rgba(231, 76, 60, 0.1)',name:'警示红'},blue:{main:'#3498db',bg:'rgba(52, 152, 219, 0.1)',name:'天空蓝'},green:{main:'#27ae60',bg:'rgba(39, 174, 96, 0.1)',name:'自然绿'},purple:{main:'#9b59b6',bg:'rgba(155, 89, 182, 0.1)',name:'罗兰紫'},teal:{main:'#1abc9c',bg:'rgba(26, 188, 156, 0.1)',name:'青绿'},pink:{main:'#e91e63',bg:'rgba(233, 30, 99, 0.1)',name:'少女粉'},lime:{main:'#82c91e',bg:'rgba(130, 201, 30, 0.1)',name:'酸橙'},indigo:{main:'#3f51b5',bg:'rgba(63, 81, 181, 0.1)',name:'靛蓝'},cyan:{main:'#00bcd4',bg:'rgba(0, 188, 212, 0.1)',name:'青色'},brown:{main:'#795548',bg:'rgba(121, 85, 72, 0.1)',name:'咖啡'},grey:{main:'#607d8b',bg:'rgba(96, 125, 139, 0.1)',name:'蓝灰'}},ae=a('acu-config',()=>{const e=X('acu_ui_config_v18',G,localStorage,{mergeDefaults:!0}),a=(0,i.computed)(()=>e.value.theme),t=(0,i.computed)(()=>e.value.fontFamily),o=(0,i.computed)(()=>{const a=Z.find(a=>a.id===e.value.fontFamily);return a?.val||Z[0].val}),n=(0,i.computed)(()=>ee[e.value.highlightColor]||ee.orange),r=(0,i.computed)(()=>{const a=e.value.highlightManualColor||e.value.highlightColor;return ee[a]||ee.orange}),c=(0,i.computed)(()=>{const a=e.value.highlightAiColor||'blue';return ee[a]||ee.blue}),l=(0,i.computed)(()=>e.value.customTitleColor?ee[e.value.titleColor]||ee.orange:r.value),s=(0,i.computed)(()=>e.value.gridColumns&&e.value.gridColumns>0?`repeat(${e.value.gridColumns}, 1fr)`:'repeat(auto-fill, minmax(110px, 1fr))');function u(a){e.value={...e.value,...a}}const d=(0,i.computed)(()=>{const a=e.value.buttonOrder,t=e.value.visibleButtons;return a.filter(e=>t.includes(e))});return{config:e,theme:a,fontFamily:t,fontFamilyValue:o,highlightColorObj:n,highlightManualColorObj:r,highlightAiColorObj:c,titleColorObj:l,gridColumnsCss:s,updateConfig:u,resetConfig:function(){e.value={...G}},setTheme:function(e){u({theme:e})},setFontFamily:function(e){u({fontFamily:e})},setLayout:function(e){u({layout:e})},setHighlightColor:function(e){u({highlightColor:e,highlightManualColor:e})},setHighlightManualColor:function(e){u({highlightManualColor:e,highlightColor:e})},setHighlightAiColor:function(e){u({highlightAiColor:e})},setTitleColor:function(e){u({titleColor:e})},toggleHighlightNew:function(){u({highlightNew:!e.value.highlightNew})},toggleCustomTitleColor:function(){u({customTitleColor:!e.value.customTitleColor})},toggleShowDashboard:function(){u({showDashboard:!e.value.showDashboard})},toggleShowPagination:function(){u({showPagination:!e.value.showPagination})},toggleLockPanel:function(){u({lockPanel:!e.value.lockPanel})},toggleLimitLongText:function(){u({limitLongText:!e.value.limitLongText})},setVisibleButtons:function(a){e.value.visibleButtons=a},setButtonOrder:function(a){e.value.buttonOrder=a},isButtonVisible:function(a){return e.value.visibleButtons.includes(a)},toggleButtonVisibility:function(a){const t=[...e.value.visibleButtons],o=t.indexOf(a);o>-1?t.splice(o,1):t.push(a),e.value.visibleButtons=t},sortedVisibleButtons:d,getButtonConfig:function(e){return J.find(a=>a.id===e)}}});function te(){const e=window.parent||window;return{$:window.jQuery||e.jQuery,getDB:()=>e.AutoCardUpdaterAPI||window.AutoCardUpdaterAPI}}function oe(){const e=te().getDB();try{return e&&e.exportTableAsJson?e.exportTableAsJson():null}catch(e){return console.warn('[ACU] getTableData error:',e),null}}const ne='acu_data_snapshot_v18_5',re='shujuku_v34_allSettings_v2',ie=a('acu-data',()=>{const e=(0,i.ref)(null),a=(0,i.ref)({}),o=(0,i.ref)(null),n=(0,i.reactive)(new Set),r=(0,i.reactive)(new Set),c=(0,i.computed)(()=>{const e=new Set;return n.forEach(a=>e.add(a)),r.forEach(a=>e.add(a)),e}),l=(0,i.reactive)(new Set),s=(0,i.ref)(!1),u=(0,i.ref)(!1),d=(0,i.ref)(null),p=(0,i.computed)(()=>l.size>0),g=(0,i.computed)(()=>n.size>0||r.size>0||l.size>0);function m(e){try{localStorage.setItem(ne,JSON.stringify(e))}catch(e){console.error('[ACU] Save snapshot failed:',e)}}function f(){try{localStorage.removeItem(ne)}catch{}}function b(e,a){return`${e}-row-${a}`}function v(e,a,t){return`${e}-${a}-${t}`}function h(){let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);return!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern),e}function x(e,a,t){if(!o.value)return'';for(const n in o.value){const r=o.value[n];if(r&&r.name===e&&r.content){const e=r.content[a+1];if(e&&void 0!==e[t])return String(e[t])}}return''}function w(){if(!e.value)return;const o=t(e.value);for(const e in o){const t=o[e];if(!t||!t.name||!t.content)continue;const n=a.value[t.name];if(!n)continue;const r=t.content[0]||[],i=[r];for(const e of n){const a=[];for(let t=0;t<r.length;t++){const o=e.cells[t];a.push(o?o.value:'')}i.push(a)}t.content=i}e.value=o}function y(e=!1){n.clear(),r.clear(),e&&l.clear()}function k(e){const a={};for(const t in e){const o=e[t];if(!o?.name)continue;if(!o.content||!Array.isArray(o.content))continue;const n=o.name,r=o.content[0]||[],i=[];for(let e=1;e<o.content.length;e++){const a=o.content[e],t=[];for(let e=0;e<r.length;e++)t.push({key:String(r[e]||`col_${e}`),value:String(a[e]??'')});i.push({index:e-1,cells:t})}a[n]=i}return a}function C(e){if(0===l.size)return e;const a=t(e);for(const e in a){if('mate'===e)continue;const t=a[e];if(!t||!t.name||!t.content)continue;const o=[t.content[0]];for(let e=1;e<t.content.length;e++){const a=e-1,n=b(t.name,a);l.has(n)||o.push(t.content[e])}t.content=o}return a}async function N(e,a){const o=h();if(!o||!o.chat||!o.chat[e])throw new Error(`楼层 ${e} 不存在`);const n=o.chat[e];let r=function(){let e='';try{let a=window.localStorage;if(!a.getItem(re)&&window.parent)try{a=window.parent.localStorage}catch{}const t=a.getItem(re);if(t){const a=JSON.parse(t);a.dataIsolationEnabled&&a.dataIsolationCode&&(e=a.dataIsolationCode)}}catch{}return e}();if(n.TavernDB_ACU_IsolatedData){const e=Object.keys(n.TavernDB_ACU_IsolatedData);e.length>0&&(r=e[0])}else n.TavernDB_ACU_IsolatedData={};n.TavernDB_ACU_IsolatedData[r]||(n.TavernDB_ACU_IsolatedData[r]={independentData:{},modifiedKeys:[],updateGroupKeys:[]});const i=n.TavernDB_ACU_IsolatedData[r];i.independentData||(i.independentData={});const c=Object.keys(a).filter(e=>e.startsWith('sheet_'));c.forEach(e=>{i.independentData[e]=t(a[e])});const l=i.modifiedKeys||[];i.modifiedKeys=[...new Set([...l,...c])]}async function V(){const e=te().getDB();if(e&&e.syncWorldbookEntries)try{await e.syncWorldbookEntries({createIfNeeded:!0})}catch(e){console.warn('[ACU] Worldbook sync failed:',e)}}async function E(){const e=h();e?.saveChatDebounced?await e.saveChatDebounced():e?.saveChat&&await e.saveChat()}function B(e){l.has(e)?(l.delete(e),console.info(`[ACU] 取消删除标记: ${e}`)):(l.add(e),console.info(`[ACU] 添加删除标记: ${e}`))}function S(e){return r.has(e)?'manual':n.has(e)?'ai':null}function T(e,t,o){const i=b(e,t);if(r.has(i))return'manual';if(n.has(i))return'ai';if(l.has(i))return'manual';const c=a.value[e],s=o??(c?.[t]?.cells.length||0);let u=!1,d=!1;for(let a=0;a<s;a++){const o=v(e,t,a);r.has(o)&&(u=!0),n.has(o)&&(d=!0)}return u?'manual':d?'ai':null}return{stagedData:e,tables:a,snapshot:o,aiDiffMap:n,manualDiffMap:r,diffMap:c,pendingDeletes:l,isSaving:s,isLoading:u,targetFloorInfo:d,hasPendingDeletes:p,hasUnsavedChanges:g,hasChanges:g,getStagedData:function(){return e.value},loadFromDatabase:async function(){if(u.value)console.warn('[ACU] 加载进行中，跳过重复请求');else try{u.value=!0,console.info('[ACU] 开始加载数据...');const i=oe();if(!i)return void console.warn('[ACU] 未获取到表格数据');e.value=t(i);const c=k(i);a.value=c,o.value=t(i),n.clear(),r.clear(),l.clear(),m(i),console.info('[ACU] 数据加载完成，表格数量:',Object.keys(c).length)}catch(e){throw console.error('[ACU] 加载数据失败:',e),e}finally{u.value=!1}},processToTableData:k,setStagedData:function(o){e.value=t(o);const n=k(o);a.value=n,console.info('[ACU] 暂存数据已设置')},generateDiffMap:function(e){if(n.clear(),!o.value)return;const a=o.value;for(const t in e){if('mate'===t||'updated'===t||'created'===t||t.startsWith('_'))continue;const o=e[t],i=a[t];if(!o||!o.content)continue;const c=o.name||t.replace('sheet_','');if(!i||!i.content){for(let e=1;e<o.content.length;e++){const a=b(c,e-1);r.has(a)||n.add(a)}continue}const l=Math.max(o.content.length,i.content.length);for(let e=1;e<l;e++){const a=o.content[e],t=i.content[e],l=e-1;if(!a||!t){const e=b(c,l);r.has(e)||n.add(e);continue}const s=Math.max(a.length,t.length);for(let e=0;e<s;e++){if(String(a[e]??'')!==String(t[e]??'')){const a=v(c,l,e);r.has(a)||n.add(a)}}}}console.info(`[ACU] AI差异映射已生成，AI变更: ${n.size}, 手动变更: ${r.size}`)},saveToDatabase:async function(){if(s.value)return console.warn('[ACU] 保存进行中，跳过重复请求'),{success:!1,savedToFloor:-1,error:'保存进行中'};try{s.value=!0,console.info('[ACU] 开始保存数据...');let a=e.value;if(a||(a=oe()),!a)throw new Error('无数据可保存');const n=C(t(a)),r=function(){const e=h();if(!e||!e.chat||0===e.chat.length)return-1;for(let a=e.chat.length-1;a>=0;a--){const t=e.chat[a];if(!t.is_user&&t.TavernDB_ACU_IsolatedData)return d.value={index:a,isAuto:!0,reason:'已存在数据'},a}for(let a=e.chat.length-1;a>=0;a--)if(!e.chat[a].is_user)return d.value={index:a,isAuto:!0,reason:'新建数据位置'},a;return-1}();if(-1===r)throw new Error('未找到合适的目标楼层');return await N(r,n),await V(),await E(),o.value=t(n),e.value=t(n),y(!0),m(n),console.info(`[ACU] 数据保存完成，目标楼层: ${r}`),{success:!0,savedToFloor:r}}catch(e){const a=e.message;return console.error('[ACU] 保存数据失败:',e),{success:!1,savedToFloor:-1,error:a}}finally{s.value=!1}},saveToFloor:async function(a){if(s.value)return console.warn('[ACU] 保存进行中，跳过重复请求'),{success:!1,savedToFloor:-1,error:'保存进行中'};try{s.value=!0,console.info(`[ACU] 保存到第 ${a} 楼...`);let n=e.value;if(n||(n=oe()),!n)throw new Error('无数据可保存');const r=C(t(n));return await N(a,r),await V(),await E(),o.value=t(r),e.value=t(r),y(!0),m(r),console.info(`[ACU] 已保存到第 ${a} 楼`),{success:!0,savedToFloor:a}}catch(e){const a=e.message;return console.error('[ACU] 保存到指定楼层失败:',e),{success:!1,savedToFloor:-1,error:a}}finally{s.value=!1}},purgeFloorRange:async function(e,a){if(s.value)console.warn('[ACU] 操作进行中，跳过重复请求');else try{s.value=!0,console.info(`[ACU] 清除第 ${e} 到 ${a} 楼的数据...`);const t=h();if(!t||!t.chat)throw new Error('无法访问聊天记录');const o=t.chat.length-1,n=Math.max(0,e),r=Math.min(o,a);if(isNaN(n)||isNaN(r)||n>r)throw new Error('无效的楼层范围');const i=['TavernDB_ACU_Data','TavernDB_ACU_SummaryData','TavernDB_ACU_IndependentData','TavernDB_ACU_Identity','TavernDB_ACU_IsolatedData','TavernDB_ACU_ModifiedKeys','TavernDB_ACU_UpdateGroupKeys'];let c=0;for(let e=n;e<=r;e++){const a=t.chat[e];if(!a)continue;let o=!1;for(const e of i)Object.prototype.hasOwnProperty.call(a,e)&&(delete a[e],o=!0);o&&c++}c>0&&(await E(),f(),y(!0),await V()),console.info(`[ACU] 已清除 ${c} 个楼层的数据`)}catch(e){throw console.error('[ACU] 清除楼层数据失败:',e),e}finally{s.value=!1}},insertRow:function(e,t){const o=a.value[e];if(!o||0===o.length)return void console.warn(`[ACU] 表格 ${e} 不存在或为空`);const n=o[0],i={index:o.length,cells:n.cells.map(e=>({key:e.key,value:''}))};o.splice(t+1,0,i),o.forEach((e,a)=>{e.index=a});const c=b(e,t+1);r.add(c),w(),console.info(`[ACU] 在 ${e} 第 ${t} 行后插入新行`)},updateCell:function(e,t,o,i){const c=a.value[e];if(!c||!c[t])return void console.warn(`[ACU] 无效的单元格位置: ${e}[${t}][${o}]`);const l=c[t];if(l.cells[o]){const a=l.cells[o].value;l.cells[o].value=i;const c=v(e,t,o);if(i!==x(e,t,o))r.add(c),n.delete(c);else{r.delete(c),n.delete(c);l.cells.every((a,o)=>a.value===x(e,t,o))&&l.cells.forEach((_,a)=>{const o=v(e,t,a);r.delete(o),n.delete(o)})}w(),console.info(`[ACU] 更新 ${e}[${t}][${o}]: "${a}" -> "${i}"`)}},toggleDelete:B,toggleDeleteRow:function(e,a){B(b(e,a))},markForDelete:function(e,a){const t=b(e,a);l.add(t)},unmarkForDelete:function(e,a){const t=b(e,a);l.delete(t)},getCellChangeType:S,getRowChangeType:T,isRowChanged:function(e,a,t){return null!==T(e,a,t)},isRowPendingDelete:function(e,a){return l.has(b(e,a))},isPendingDelete:function(e){return l.has(e)},isCellChanged:function(e){return null!==S(e)},getRowKey:b,getCellKey:v,clearChanges:y,syncToStagedData:w,loadSnapshot:function(){try{const e=localStorage.getItem(ne);return e?JSON.parse(e):null}catch{return null}},saveSnapshot:m,clearSnapshot:f}}),ce='acu_ui_collapse_state',le='acu_pin_state',se='acu_active_tab',ue='acu_table_order',de='acu_table_heights',pe='acu_table_styles',ge='acu_reverse_tables',me='acu_float_ball_pos',fe='acu_layout',be='acu_visible_tabs',ve='acu_tab_dashboard_home',he='acu_tab_options_panel',xe=a('acu-ui',()=>{const e=X(ce,!1),a=X(le,!1),t=X(se,null),o=X(ue,[]),n=X(de,{}),r=X(pe,{}),c=X(ge,[]),l=X(me,{x:20,y:'undefined'!=typeof window?window.innerHeight-150:500}),s=X(fe,'horizontal'),u=X(be,[]),d=(0,i.ref)(1),p=(0,i.ref)(''),g=(0,i.ref)(0),m=(0,i.ref)(!1),f=(0,i.ref)(!1),b=(0,i.ref)(!1),v=(0,i.ref)(!1),h=(0,i.computed)(()=>!e.value&&null!==t.value),x=(0,i.computed)(()=>t.value===ve),w=(0,i.computed)(()=>t.value===he);const y=(0,i.computed)(()=>p.value);const k=(0,i.computed)(()=>'horizontal'===s.value);return{isCollapsed:e,isPinned:a,activeTab:t,tableOrder:o,tableHeights:n,tableStyles:r,reverseTables:c,ballPosition:l,layout:s,visibleTabs:u,currentPage:d,searchTerm:p,currentSearchTerm:y,scrollTop:g,isEditingOrder:m,isInitialized:f,isContentHidden:b,isMobile:v,isPanelVisible:h,isDashboardActive:x,isOptionsActive:w,reverseOrderTables:c,isHorizontalLayout:k,toggleCollapse:function(){e.value=!e.value},togglePin:function(){a.value=!a.value},setActiveTab:function(e){t.value=e,d.value=1,p.value=''},setTableOrder:function(e){o.value=e},setTableHeight:function(e,a){n.value={...n.value,[e]:a}},resetTableHeight:function(e){const a={...n.value};delete a[e],n.value=a},getTableHeight:function(e){return n.value[e]},setTableStyle:function(e,a){r.value={...r.value,[e]:a}},getTableStyle:function(e){return r.value[e]||'list'},toggleTableReverse:function(e){const a=[...c.value],t=a.indexOf(e);t>-1?a.splice(t,1):a.push(e),c.value=a},isTableReversed:function(e){return c.value.includes(e)},setCurrentPage:function(e){d.value=Math.max(1,e)},setSearchTerm:function(e){p.value=e.toLowerCase(),d.value=1},saveScrollTop:function(e){g.value=e},enterEditingOrder:function(){m.value=!0},exitEditingOrder:function(){m.value=!1},setEditingOrder:function(e){m.value=e},setMobile:function(e){v.value=e},setLayout:function(e){s.value=e},toggleLayout:function(){s.value='horizontal'===s.value?'vertical':'horizontal'},closePanel:function(){e.value=!0,b.value=!1},openPanel:function(){b.value=!1,e.value=!1,null===t.value&&(t.value=ve)},setInitialized:function(e){f.value=e},updateSaveBtnState:function(){const{$}=window.jQuery?{$:window.jQuery}:{$:window.parent.$};if(!$)return;const e=ie().hasUnsavedChanges,a=$(window.parent.document).find('#acu-btn-save-global');a.length&&(e?(a.addClass('acu-has-changes'),a.find('i').addClass('fa-beat-fade'),a.css('color','#e67e22')):(a.removeClass('acu-has-changes'),a.find('i').removeClass('fa-beat-fade'),a.css('color','')))},autoFitPanelHeight:function(e=!1){const{$}=window.jQuery?{$:window.jQuery}:{$:window.parent.$};if(!$)return;const a=$(window.parent.document).find('#acu-data-area');if(!a.length)return;const o=t.value;!e&&o&&n.value[o]||setTimeout(()=>{const e=a[0].scrollHeight,t=($(window.parent).height()||800)-200;let o=Math.min(e+20,t);o<200&&(o=200),a.css('height',o+'px')},100)},saveBallPosition:function(e){l.value=e},getBallPosition:function(){return l.value},resetBallPosition:function(){const e='undefined'!=typeof window?window.parent?.innerHeight??window.innerHeight:500;l.value={x:20,y:Math.max(100,e-150)}},setVisibleTabs:function(e){u.value=e},isTabVisible:function(e){return 0===u.value.length||u.value.includes(e)},toggleTabVisibility:function(e){const a=[...u.value],t=a.indexOf(e);t>-1?a.splice(t,1):a.push(e),u.value=a},resetVisibleTabs:function(){u.value=[]}}}),we={key:0,class:'fa-solid fa-layer-group'},ye=(0,i.defineComponent)({__name:'FloatingBall',setup(e,{expose:a}){const t=xe();function o(){const e=window.parent&&window.parent!==window?window.parent:window;return{width:e.innerWidth,height:e.innerHeight}}function n(e){const{width:a,height:t}=o();let{x:n,y:r}=e;return n>a-50&&(n=a-50-10),r>t-50&&(r=t-50-10),n<0&&(n=10),r<0&&(r=10),{x:n,y:r}}const r=(0,i.ref)(),c=X('acu_float_ball_pos',function(){const{height:e}=o();return{x:20,y:e-150}}()),l=(0,i.ref)(c.value.x),s=(0,i.ref)(c.value.y),u=(0,i.ref)(!1),d=(0,i.ref)(!1),p=(0,i.ref)(!1);let g=null;function m(e){if(0!==e.button)return;e.preventDefault(),e.stopPropagation();if(!r.value)return;const a=e.clientX,t=e.clientY,n=l.value,i=s.value;u.value=!0,d.value=!1;let p=!1;const g=e=>{const r=e.originalEvent,c=r.clientX-a,u=r.clientY-t;if(!p&&(Math.abs(c)>3||Math.abs(u)>3)&&(p=!0,d.value=!0),p){e.preventDefault();let a=n+c,t=i+u;const{width:r,height:d}=o(),p=50,g=10;a<g&&(a=g),a>r-p-g&&(a=r-p-g),t<g&&(t=g),t>d-p-g&&(t=d-p-g),l.value=a,s.value=t}},m=()=>{u.value=!1,$('body').off('pointermove',g),$('body').off('pointerup',m),d.value&&(c.value={x:l.value,y:s.value},console.info('[ACU FloatingBall] 位置已保存:',l.value,s.value))};$('body').on('pointermove',g),$('body').on('pointerup',m)}function f(e){return d.value?(d.value=!1,void e.stopPropagation()):p.value?(p.value=!1,void e.stopPropagation()):void(g?(clearTimeout(g),g=null,p.value=!0,console.info('[ACU FloatingBall] 双击 - 进入停靠模式')):g=setTimeout(()=>{g=null,t.openPanel(),console.info('[ACU FloatingBall] 单击 - 打开面板')},250))}(0,i.watchEffect)(()=>{r.value&&(r.value.style.left=`${l.value}px`,r.value.style.top=`${s.value}px`,r.value.style.cursor=u.value?'grabbing':'grab')}),(0,i.onMounted)(()=>{const e=r.value;if(!e)return void console.error('[ACU FloatingBall] ballRef 未绑定到 DOM');const a=n(c.value);a.x===c.value.x&&a.y===c.value.y||(console.info('[ACU FloatingBall] 位置越界，已自动修正:',c.value,'->',a),c.value=a),l.value=a.x,s.value=a.y,e.addEventListener('pointerdown',m),e.addEventListener('click',f),console.info('[ACU FloatingBall] 事件已绑定')});const b=()=>{const e=n({x:l.value,y:s.value});e.x===l.value&&e.y===s.value||(l.value=e.x,s.value=e.y,c.value=e,console.info('[ACU FloatingBall] 窗口大小变化，位置已调整'))};return(0,i.onMounted)(()=>{(window.parent??window).addEventListener('resize',b)}),(0,i.onUnmounted)(()=>{g&&clearTimeout(g);const e=r.value;e&&(e.removeEventListener('pointerdown',m),e.removeEventListener('click',f));(window.parent??window).removeEventListener('resize',b)}),a({resetPosition:()=>{const e=(window.parent?.innerHeight??window.innerHeight)-150;l.value=20,s.value=e,c.value={x:l.value,y:s.value}},setDocked:e=>{p.value=e}}),(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{ref_key:'ballRef',ref:r,class:(0,i.normalizeClass)(['acu-floating-ball-vue',{docked:p.value}])},[p.value?(0,i.createCommentVNode)('v-if',!0):((0,i.openBlock)(),(0,i.createElementBlock)('i',we))],2))}}),ke='acu-styles',Ce='acu-dynamic-font';function Ne(){const e=ae(),{$}=te(),a=()=>{try{return window.parent?.document||document}catch{return document}},t=(0,i.computed)(()=>{try{return getScriptId()}catch{return'acu-visualizer'}}),o=(0,i.ref)(null),n=(0,i.ref)(null),r=(0,i.ref)(null),c=(0,i.ref)(!1),l=()=>{const o=a(),n=`${Ce}-${t.value}`;o.getElementById(n)?.remove();const i=o.createElement('style');i.id=n,i.setAttribute('data-source','acu-visualizer');const c=(()=>{const a=e.config.fontFamily||'default',t=Z.find(e=>e.id===a);return t?.val||Z[0].val})();i.textContent=`\n      \n      @import url("https://fontsapi.zeoseven.com/3/main/result.css");   /* 寒蝉全圆体 */\n      @import url("https://fontsapi.zeoseven.com/442/main/result.css"); /* Maple Mono */\n      @import url("https://fontsapi.zeoseven.com/256/main/result.css"); /* 汇文明朝 */\n      @import url("https://fontsapi.zeoseven.com/482/main/result.css"); /* Cooper正楷 */\n      @import url("https://fontsapi.zeoseven.com/446/main/result.css"); /* YFFYT */\n      @import url("https://fontsapi.zeoseven.com/570/main/result.css"); /* Fusion Pixel */\n      @import url("https://fontsapi.zeoseven.com/292/main/result.css"); /* 霞鹜文楷 */\n      @import url("https://fontsapi.zeoseven.com/69/main/result.css");  /* 思源黑体 */\n      @import url("https://fontsapi.zeoseven.com/7/main/result.css");   /* 朱雀仿宋 */\n    \n\n      .acu-wrapper,\n      .acu-edit-dialog,\n      .acu-cell-menu,\n      .acu-nav-container,\n      .acu-data-card,\n      .acu-panel-title,\n      .acu-settings-label,\n      .acu-btn-block,\n      .acu-nav-btn,\n      .acu-edit-textarea,\n      #acu-ghost-preview {\n        font-family: ${c} !important;\n      }\n    `,o.head.appendChild(i),r.value=i,console.info('[ACU Styles] Font styles injected')},s=()=>{if(!n.value)return;const a=e.config,t=e.highlightColorObj,o=e.highlightManualColorObj,r=e.highlightAiColorObj,i=e.titleColorObj,c=a.gridColumns&&a.gridColumns>0?`repeat(${a.gridColumns}, 1fr)`:'repeat(auto-fill, minmax(110px, 1fr))',l=`\n      .acu-wrapper {\n        /* 卡片配置 */\n        --acu-card-width: ${a.cardWidth||280}px;\n        --acu-font-size: ${a.fontSize||13}px;\n\n        /* 高亮色 (兼容旧样式) */\n        --acu-highlight: ${t.main};\n        --acu-highlight-bg: ${t.bg};\n        --acu-accent: ${t.main};\n\n        /* 手动修改高亮色 */\n        --acu-highlight-manual: ${o.main};\n        --acu-highlight-manual-bg: ${o.bg};\n\n        /* AI填表高亮色 */\n        --acu-highlight-ai: ${r.main};\n        --acu-highlight-ai-bg: ${r.bg};\n\n        /* 标题色 */\n        --acu-title-color: ${i.main};\n\n        /* 导航栏 */\n        --acu-nav-cols: ${c};\n\n        /* 文本限制 */\n        --acu-text-max-height: ${!1!==a.limitLongText?'80px':'none'};\n        --acu-text-overflow: ${!1!==a.limitLongText?'auto':'visible'};\n      }\n\n      /* ============================================================\n       * 双色高亮样式 (已移除背景色和动画效果)\n       * ============================================================ */\n\n      /* 手动修改高亮 (橙色系) - 仅保留文字颜色 */\n      .acu-cell-changed-manual,\n      .acu-row-changed-manual .acu-editable-title {\n        color: var(--acu-highlight-manual) !important;\n        font-weight: bold;\n      }\n\n      /* AI填表高亮 (蓝色系) - 仅保留文字颜色 */\n      .acu-cell-changed-ai,\n      .acu-row-changed-ai .acu-editable-title {\n        color: var(--acu-highlight-ai) !important;\n        font-weight: bold;\n      }\n\n      /* 通用变更高亮 (兼容旧样式) - 仅保留文字颜色 */\n      .acu-cell-changed:not(.acu-cell-changed-manual):not(.acu-cell-changed-ai),\n      .acu-highlight-changed {\n        color: var(--acu-highlight) !important;\n        font-weight: bold;\n      }\n    `;n.value.textContent=l},u=t=>{const o=a().querySelector('.acu-wrapper');if(!o)return;const n=t||e.config.theme||'retro';Q.forEach(e=>{o.classList.remove(`acu-theme-${e.id}`)}),o.classList.add(`acu-theme-${n}`),console.info(`[ACU Styles] Theme applied: ${n}`)},d=t=>{const o=a().querySelector('.acu-data-display');if(!o)return;const n=t||e.config.layout||'vertical';o.classList.remove('acu-layout-vertical','acu-layout-horizontal'),o.classList.add(`acu-layout-${n}`),console.info(`[ACU Styles] Layout applied: ${n}`)},p=a=>{l(),console.info(`[ACU Styles] Font applied: ${a||e.config.fontFamily}`)},g=()=>{const e=a(),i=t.value;e.getElementById(`${ke}-base-${i}`)?.remove(),e.getElementById(`${ke}-dynamic-${i}`)?.remove(),e.getElementById(`${Ce}-${i}`)?.remove(),o.value=null,n.value=null,r.value=null,c.value=!1,console.info('[ACU Styles] Styles cleaned up')},m=()=>{c.value?console.info('[ACU Styles] Already initialized'):((()=>{const e=a(),n=`${ke}-base-${t.value}`;if(e.getElementById(n))return console.info('[ACU Styles] Base styles already injected'),void(o.value=e.getElementById(n));const r=e.createElement('style');r.id=n,r.setAttribute('data-source','acu-visualizer'),r.textContent='/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */@import "https://fontsapi.zeoseven.com/69/main/result.css";@import "https://fontsapi.zeoseven.com/3/main/result.css";@import "https://fontsapi.zeoseven.com/442/main/result.css";@import "https://fontsapi.zeoseven.com/256/main/result.css";@import "https://fontsapi.zeoseven.com/482/main/result.css";@import "https://fontsapi.zeoseven.com/446/main/result.css";@import "https://fontsapi.zeoseven.com/570/main/result.css";@import "https://fontsapi.zeoseven.com/292/main/result.css";@import "https://fontsapi.zeoseven.com/7/main/result.css";:root{--acu-neutral-50:#fafafa;--acu-neutral-100:#f5f5f5;--acu-neutral-200:#eeeeee;--acu-neutral-300:#e0e0e0;--acu-neutral-400:#bdbdbd;--acu-neutral-500:#9e9e9e;--acu-neutral-600:#757575;--acu-neutral-700:#616161;--acu-neutral-800:#424242;--acu-neutral-900:#212121;--acu-success:#27ae60;--acu-warning:#f39c12;--acu-danger:#e74c3c;--acu-info:#3498db;--acu-z-ball:2147483646;--acu-z-overlay:2147483647;--acu-z-menu:2147483648;--acu-radius-sm:6px;--acu-radius-md:12px;--acu-radius-lg:16px;--acu-shadow-sm:0 2px 8px rgba(0,0,0,0.1);--acu-shadow-md:0 4px 16px rgba(0,0,0,0.15);--acu-shadow-lg:0 15px 50px rgba(0,0,0,0.3);--acu-transition-fast:0.15s;--acu-transition-normal:0.3s;--acu-transition-slow:0.5s}.acu-wrapper,.acu-theme-retro{--acu-bg-nav:#e6e2d3;--acu-bg-panel:#e6e2d3;--acu-card-bg:#fffef9;--acu-table-head:#efebe4;--acu-table-hover:#f0ebe0;--acu-badge-bg:#efebe4;--acu-input-bg:rgba(255,255,255,0.5);--acu-menu-bg:#fff;--acu-overlay-bg:rgba(94,75,53,0.4);--acu-text-main:#5e4b35;--acu-text-sub:#999;--acu-menu-text:#333;--acu-border:#dcd0c0;--acu-btn-bg:#dcd0c0;--acu-btn-hover:#cbbba8;--acu-btn-active-bg:#8d7b6f;--acu-btn-active-text:#fdfaf5;--acu-shadow:rgba(0,0,0,0.1);--acu-card-width:280px;--acu-font-size:13px;--acu-highlight:#d35400;--acu-highlight-bg:rgba(211,84,0,0.08);--acu-title-color:#d35400;--acu-accent:#d35400;--acu-nav-cols:repeat(auto-fill,minmax(90px,1fr));--acu-text-max-height:80px;--acu-text-overflow:auto;--acu-win-width:400px;--acu-win-left:100px;--acu-win-bottom:100px}.acu-theme-dark{--acu-bg-nav:rgba(43,43,43,0.95);--acu-bg-panel:rgba(37,37,37,0.95);--acu-border:#444;--acu-text-main:#eee;--acu-text-sub:#aaa;--acu-btn-bg:rgba(58,58,58,0.5);--acu-btn-hover:#4a4a4a;--acu-btn-active-bg:#6a5acd;--acu-btn-active-text:#fff;--acu-table-head:rgba(51,51,51,0.8);--acu-table-hover:rgba(58,58,58,0.5);--acu-shadow:rgba(0,0,0,0.6);--acu-card-bg:rgba(45,48,53,0.8);--acu-badge-bg:#3a3f4b;--acu-menu-bg:#333;--acu-menu-text:#eee;--acu-input-bg:rgba(0,0,0,0.3);--acu-overlay-bg:rgba(0,0,0,0.75)}.acu-theme-modern{--acu-bg-nav:#ffffff;--acu-bg-panel:#f8f9fa;--acu-border:#e0e0e0;--acu-text-main:#333;--acu-text-sub:#888;--acu-btn-bg:#f1f3f5;--acu-btn-hover:#e9ecef;--acu-btn-active-bg:#007bff;--acu-btn-active-text:#fff;--acu-table-head:#f8f9fa;--acu-table-hover:#f1f3f5;--acu-shadow:rgba(0,0,0,0.08);--acu-card-bg:#ffffff;--acu-badge-bg:#f1f3f5;--acu-menu-bg:#fff;--acu-menu-text:#333;--acu-input-bg:#ffffff;--acu-overlay-bg:rgba(0,0,0,0.3)}.acu-theme-forest{--acu-bg-nav:#e8f5e9;--acu-bg-panel:#e8f5e9;--acu-border:#c8e6c9;--acu-text-main:#2e7d32;--acu-text-sub:#81c784;--acu-btn-bg:#c8e6c9;--acu-btn-hover:#a5d6a7;--acu-btn-active-bg:#43a047;--acu-btn-active-text:#fff;--acu-table-head:#dcedc8;--acu-table-hover:#f1f8e9;--acu-shadow:rgba(0,0,0,0.1);--acu-card-bg:#ffffff;--acu-badge-bg:#dcedc8;--acu-menu-bg:#fff;--acu-menu-text:#2e7d32;--acu-input-bg:rgba(255,255,255,0.7);--acu-overlay-bg:rgba(46,125,50,0.2)}.acu-theme-ocean{--acu-bg-nav:#e3f2fd;--acu-bg-panel:#e3f2fd;--acu-border:#bbdefb;--acu-text-main:#1565c0;--acu-text-sub:#64b5f6;--acu-btn-bg:#bbdefb;--acu-btn-hover:#90caf9;--acu-btn-active-bg:#1976d2;--acu-btn-active-text:#fff;--acu-table-head:#bbdefb;--acu-table-hover:#e1f5fe;--acu-shadow:rgba(0,0,0,0.15);--acu-card-bg:#ffffff;--acu-badge-bg:#e3f2fd;--acu-menu-bg:#fff;--acu-menu-text:#1565c0;--acu-input-bg:rgba(255,255,255,0.7);--acu-overlay-bg:rgba(21,101,192,0.2)}.acu-theme-cyber{--acu-bg-nav:#000000;--acu-bg-panel:#0a0a0a;--acu-border:#333;--acu-text-main:#00ffcc;--acu-text-sub:#ff00ff;--acu-btn-bg:#1a1a1a;--acu-btn-hover:#333;--acu-btn-active-bg:#ff00ff;--acu-btn-active-text:#fff;--acu-table-head:#111;--acu-table-hover:#1a1a1a;--acu-shadow:0 0 10px rgba(0,255,204,0.3);--acu-card-bg:#050505;--acu-badge-bg:#222;--acu-menu-bg:#111;--acu-menu-text:#00ffcc;--acu-input-bg:#111;--acu-overlay-bg:rgba(0,0,0,0.85)}.acu-theme-purple{--acu-bg-nav:#f3e5f5;--acu-bg-panel:#f3e5f5;--acu-border:#e1bee7;--acu-text-main:#4a148c;--acu-text-sub:#8e24aa;--acu-btn-bg:#e1bee7;--acu-btn-hover:#d1c4e9;--acu-btn-active-bg:#7b1fa2;--acu-btn-active-text:#fff;--acu-table-head:#f3e5f5;--acu-table-hover:#ede7f6;--acu-shadow:rgba(0,0,0,0.1);--acu-card-bg:#ffffff;--acu-badge-bg:#f3e5f5;--acu-menu-bg:#fff;--acu-menu-text:#4a148c;--acu-input-bg:rgba(255,255,255,0.6);--acu-overlay-bg:rgba(74,20,140,0.25)}.acu-wrapper{--acu-font-family:Source Han Sans SC,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif}.acu-wrapper[data-font=hanchan]{--acu-font-family:\'HanChanQuanYuan\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=maple]{--acu-font-family:\'Maple Mono\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=huiwen]{--acu-font-family:\'HuiWenMingChao\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=cooper]{--acu-font-family:\'Cooper Zhengkai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=yffyt]{--acu-font-family:\'YFFYT\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=fusion]{--acu-font-family:\'Fusion Pixel\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=lxgw]{--acu-font-family:\'LXGW WenKai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=siyuan]{--acu-font-family:\'Source Han Sans SC\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-wrapper[data-font=zhuque]{--acu-font-family:\'Zhuque Fangsong\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif}.acu-font-hanchan{--acu-font-family:\'HanChanQuanYuan\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-maple{--acu-font-family:\'Maple Mono\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-huiwen{--acu-font-family:\'HuiWenMingChao\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-cooper{--acu-font-family:\'Cooper Zhengkai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-yffyt{--acu-font-family:\'YFFYT\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-fusion{--acu-font-family:\'Fusion Pixel\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-lxgw{--acu-font-family:\'LXGW WenKai\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-siyuan{--acu-font-family:\'Source Han Sans SC\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-font-zhuque{--acu-font-family:\'Zhuque Fangsong\',-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif !important}.acu-wrapper,.acu-edit-dialog,.acu-cell-menu,.acu-nav-container,.acu-data-card,.acu-panel-title,.acu-settings-label,.acu-btn-block,.acu-nav-btn,.acu-edit-textarea,#acu-ghost-preview{font-family:var(--acu-font-family)}.acu-text-xs{font-size:11px}.acu-text-sm{font-size:12px}.acu-text-base{font-size:13px}.acu-text-md{font-size:14px}.acu-text-lg{font-size:15px}.acu-text-xl{font-size:16px}.acu-text-2xl{font-size:18px}.acu-text-3xl{font-size:20px}.acu-font-normal{font-weight:400}.acu-font-medium{font-weight:500}.acu-font-semibold{font-weight:600}.acu-font-bold{font-weight:700}.acu-font-extrabold{font-weight:800}.acu-leading-none{line-height:1}.acu-leading-tight{line-height:1.25}.acu-leading-snug{line-height:1.35}.acu-leading-normal{line-height:1.5}.acu-leading-relaxed{line-height:1.625}.acu-leading-loose{line-height:2}.acu-title{font-weight:700;color:var(--acu-title-color);line-height:1.35}.acu-subtitle{font-weight:500;color:var(--acu-text-sub);font-size:.9em}.acu-label{font-size:11px;font-weight:600;color:var(--acu-title-color);text-transform:uppercase;letter-spacing:.5px}.acu-value{font-weight:500;color:var(--acu-text-main)}.acu-mono{font-family:"Maple Mono","Consolas","Monaco","Courier New",monospace}.acu-wrapper[data-font=fusion],.acu-font-fusion{-webkit-font-smoothing:none;-moz-osx-font-smoothing:unset;font-smooth:never;text-rendering:optimizeSpeed}.acu-wrapper,.acu-wrapper *,.acu-wrapper *::before,.acu-wrapper *::after{box-sizing:border-box}.acu-wrapper{font-family:var(--acu-font-family,Source Han Sans SC,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif);font-size:var(--acu-font-size,13px);color:var(--acu-text-main);line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.acu-wrapper ::-webkit-scrollbar{width:6px;height:6px}.acu-wrapper ::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-wrapper ::-webkit-scrollbar-thumb{background:var(--acu-border);border-radius:3px}.acu-wrapper ::-webkit-scrollbar-thumb:hover{background:var(--acu-text-sub)}.acu-wrapper{scrollbar-width:thin;scrollbar-color:var(--acu-highlight,var(--acu-border)) rgba(0,0,0,0)}.acu-panel-content{scrollbar-width:thin;scrollbar-color:var(--acu-highlight) rgba(0,0,0,0)}.acu-panel-content::-webkit-scrollbar{width:6px;height:6px}.acu-panel-content::-webkit-scrollbar-thumb{background-color:var(--acu-highlight);border-radius:3px}.acu-wrapper ::selection{background:var(--acu-highlight);color:#fff}.acu-wrapper ::-moz-selection{background:var(--acu-highlight);color:#fff}.acu-no-select{user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.acu-selectable{user-select:text !important;-webkit-user-select:text !important;cursor:text}.acu-clickable{cursor:pointer;transition:opacity var(--acu-transition-fast)}.acu-clickable:hover{opacity:.8}.acu-clickable:active{opacity:.6}.acu-flex-center{display:flex;align-items:center;justify-content:center}.acu-flex-between{display:flex;align-items:center;justify-content:space-between}#acu-parent-container{position:fixed !important;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;z-index:var(--acu-z-overlay);pointer-events:none !important;display:flex;flex-direction:column-reverse;justify-content:flex-start}#acu-parent-container .acu-wrapper{position:absolute !important;width:var(--acu-win-width,600px) !important;left:var(--acu-win-left,50%) !important;bottom:var(--acu-win-bottom,50%) !important;max-width:98vw;pointer-events:none;display:flex;flex-direction:column-reverse;transform-origin:bottom center;will-change:transform;transition:none !important;touch-action:none}body.acu-dragging #acu-parent-container,body.acu-resizing #acu-parent-container{pointer-events:auto !important;cursor:grabbing}body.acu-resizing *{cursor:ew-resize !important;-webkit-user-select:none !important;user-select:none !important}.acu-text-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-text-wrap{white-space:pre-wrap;word-break:break-word}.acu-hidden{display:none !important}.acu-invisible{visibility:hidden}.acu-grid-value,.acu-full-value,.acu-card-value,.acu-editable-title,.acu-grid-label,.acu-full-label,.acu-card-label{user-select:text !important;-webkit-user-select:text !important;cursor:text}.acu-app{font-family:var(--acu-font-family,"Microsoft YaHei",sans-serif);font-size:var(--acu-font-size,13px);color:var(--acu-text-main,#333);position:relative;z-index:2147483640}.acu-no-data{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 24px;color:var(--acu-text-muted,#999);text-align:center}.acu-no-data i{font-size:48px;margin-bottom:16px;opacity:.5}.acu-no-data p{margin:0;font-size:var(--acu-font-size,13px)}@keyframes acu-shake{0%,100%{transform:rotate(0deg)}25%{transform:rotate(10deg)}50%{transform:rotate(0deg)}75%{transform:rotate(-10deg)}}@keyframes acu-shake-x{0%,100%{transform:translateX(0)}10%,30%,50%,70%,90%{transform:translateX(-4px)}20%,40%,60%,80%{transform:translateX(4px)}}@keyframes acu-fade-in{from{opacity:0}to{opacity:1}}@keyframes acu-fade-out{from{opacity:1}to{opacity:0}}@keyframes acu-pop-up{from{opacity:0;transform:scale(0.9) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}@keyframes acu-pop-down{from{opacity:1;transform:scale(1) translateY(0)}to{opacity:0;transform:scale(0.9) translateY(10px)}}@keyframes acu-slide-in-right{from{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}@keyframes acu-slide-in-left{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}@keyframes acu-slide-in-up{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes acu-slide-in-down{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}@keyframes acu-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@keyframes acu-bounce{0%,20%,50%,80%,100%{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}.acu-animate-shake{animation:acu-shake .4s ease-in-out infinite}.acu-animate-shake-x{animation:acu-shake-x .5s ease-in-out}.acu-animate-fade-in{animation:acu-fade-in var(--acu-transition-normal,0.3s) ease-out}.acu-animate-fade-out{animation:acu-fade-out var(--acu-transition-normal,0.3s) ease-out}.acu-animate-pop-up{animation:acu-pop-up var(--acu-transition-normal,0.3s) cubic-bezier(0.34,1.56,0.64,1)}.acu-animate-slide-right{animation:acu-slide-in-right var(--acu-transition-normal,0.3s) ease-out}.acu-animate-slide-up{animation:acu-slide-in-up var(--acu-transition-normal,0.3s) ease-out}.acu-animate-spin{animation:acu-spin 1s linear infinite}.acu-animate-bounce{animation:acu-bounce 1s ease}.acu-highlight-changed:not(.acu-data-card){color:var(--acu-highlight) !important;font-weight:bold}.acu-save-alert{animation:acu-shake .4s ease-in-out infinite;color:#fff !important;background-color:#e74c3c !important;text-shadow:0 0 5px rgba(231,76,60,.5);border-color:#c0392b !important}.acu-row-deleted{opacity:.6;filter:grayscale(0.8);transition:all var(--acu-transition-normal)}.acu-row-deleted .acu-card-body,.acu-row-deleted .acu-card-header{text-decoration:line-through}.acu-row-deleted .acu-card-body{pointer-events:none}.acu-badge-pending{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-15deg);width:80px;height:80px;border:4px solid #e74c3c;border-radius:50%;color:#e74c3c;font-size:20px;font-weight:900;display:flex;align-items:center;justify-content:center;z-index:50;pointer-events:none;opacity:.6;box-shadow:inset 0 0 10px rgba(231,76,60,.2);background:hsla(0,0%,100%,.1)}.acu-transition-fast{transition:all var(--acu-transition-fast,0.15s) ease}.acu-transition-normal{transition:all var(--acu-transition-normal,0.3s) ease}.acu-transition-slow{transition:all var(--acu-transition-slow,0.5s) ease}.acu-transition-transform{transition:transform var(--acu-transition-normal,0.3s) ease}.acu-transition-opacity{transition:opacity var(--acu-transition-normal,0.3s) ease}.acu-transition-color{transition:color var(--acu-transition-fast,0.15s) ease,background-color var(--acu-transition-fast,0.15s) ease}.acu-wrapper{position:fixed;left:var(--acu-win-left,100px);bottom:var(--acu-win-bottom,100px);width:var(--acu-win-width,400px);display:flex;flex-direction:column-reverse;z-index:2147483645;pointer-events:auto !important}.acu-wrapper.collapsed{display:none}#acu-parent-container{position:fixed !important;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;z-index:2147483647;pointer-events:none !important;display:flex;flex-direction:column-reverse;justify-content:flex-start}#acu-parent-container .acu-wrapper{position:relative;max-width:98vw;pointer-events:auto !important;display:flex;flex-direction:column-reverse;transform-origin:bottom center;will-change:transform;transition:none !important}#acu-parent-container .acu-wrapper{position:absolute !important;width:min(var(--acu-win-width,600px),100vw - 20px) !important;left:min(var(--acu-win-left,50%),100vw - 100px) !important;bottom:var(--acu-win-bottom,50%) !important;touch-action:none;max-width:calc(100vw - 10px)}body.acu-dragging #acu-parent-container,body.acu-resizing #acu-parent-container{pointer-events:auto !important;cursor:grabbing}body.acu-resizing *{cursor:ew-resize !important;-webkit-user-select:none !important;user-select:none !important}.acu-data-display{order:2;flex:0 1 auto;max-height:80vh;margin-bottom:3px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:12px;display:none;flex-direction:column;backdrop-filter:blur(8px);box-shadow:0 -5px 25px rgba(0,0,0,.3);width:100%;overscroll-behavior:contain;isolation:isolate;pointer-events:auto !important;overflow:hidden}.acu-data-display.visible{display:flex}.acu-data-display.acu-layout-horizontal{touch-action:pan-x pan-y !important;overflow:hidden}.acu-data-display.acu-layout-vertical{touch-action:pan-y !important;overflow:hidden}.acu-panel-content{flex:1;display:flex;flex-direction:column;min-height:0;overflow:hidden;padding:0;scrollbar-width:thin;scrollbar-color:var(--acu-highlight) rgba(0,0,0,0)}.acu-panel-content::-webkit-scrollbar{width:6px;height:6px}.acu-panel-content::-webkit-scrollbar-thumb{background-color:var(--acu-highlight);border-radius:3px}.acu-panel-header{flex:0 0 auto;display:flex;justify-content:space-between;align-items:center;padding:4px 12px;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border);border-radius:12px 12px 0 0}.acu-panel-title{font-weight:bold;color:var(--acu-text-main);display:flex;align-items:center;gap:8px;white-space:nowrap;font-size:15px}.acu-header-actions{display:flex;align-items:center;gap:10px}.acu-height-control{display:flex;align-items:center;gap:5px;margin-right:10px;opacity:.8;transition:opacity .2s}.acu-height-drag-handle{cursor:ns-resize;padding:5px;border-radius:4px;transition:all .2s;color:var(--acu-text-sub)}.acu-height-drag-handle:hover,.acu-height-drag-handle.active{color:var(--acu-highlight);background:var(--acu-table-hover)}.acu-resize-handle{display:block !important;pointer-events:auto !important;position:absolute;right:-12px;top:0;bottom:0;width:14px;cursor:ew-resize;z-index:2147483650;touch-action:none}.acu-resize-handle::after{content:"";position:absolute;left:0;top:0;bottom:0;width:2px;background:var(--acu-border);opacity:.3;transition:opacity .2s}.acu-resize-handle:hover::after{background:var(--acu-highlight);opacity:1;width:4px;left:0}.acu-close-btn{background:none;border:none;color:var(--acu-text-sub);cursor:pointer;font-size:16px;padding:4px;transition:color .2s}.acu-close-btn:hover{color:#e74c3c}.acu-layout-horizontal .acu-panel-content{overflow:hidden !important;min-height:150px}.acu-data-display.acu-layout-horizontal{min-height:200px}.acu-data-display.acu-layout-horizontal.visible{display:flex;flex-direction:column}.acu-scrollable-layout{display:flex;flex-direction:column;min-height:0;height:100%}.acu-scrollable-layout>.acu-fixed-top{flex-shrink:0;z-index:10}.acu-scrollable-layout>.acu-scroll-middle{flex:1;min-height:0;overflow-y:auto;overflow-x:hidden;overscroll-behavior:contain;scrollbar-width:thin;scrollbar-color:var(--acu-highlight,#667eea) rgba(0,0,0,0)}.acu-scrollable-layout>.acu-scroll-middle::-webkit-scrollbar{width:6px;height:6px}.acu-scrollable-layout>.acu-scroll-middle::-webkit-scrollbar-thumb{background-color:var(--acu-highlight,#667eea);border-radius:3px}.acu-scrollable-layout>.acu-fixed-bottom{flex-shrink:0;z-index:10}.acu-scrollable-layout.acu-scroll-horizontal>.acu-scroll-middle{overflow-x:auto;overflow-y:hidden;display:flex;flex-wrap:nowrap;white-space:nowrap}@media (max-width:768px){#acu-btn-pin{display:none !important}.acu-panel-header{padding:4px 10px !important;min-height:38px !important}.acu-panel-title{font-size:13px !important;margin-right:auto}.acu-search-wrapper{margin-right:5px !important}.acu-search-input{height:28px !important;width:80px !important;font-size:12px !important}.acu-search-input:focus{width:120px !important}.acu-nav-container{padding:8px 6px !important;gap:0 !important}.acu-nav-separator{margin:1px 0 !important;opacity:.2}.acu-nav-tabs-area{gap:1px !important}.acu-nav-btn{padding:6px 2px !important;font-size:12px !important;min-height:32px !important}.acu-nav-actions-area{padding-top:2px !important;gap:8px !important;display:flex !important;width:100% !important}.acu-action-btn{width:auto !important;flex:1 !important;height:40px !important;border-radius:8px !important;background:var(--acu-btn-bg);margin:0 !important}.acu-action-btn i{font-size:18px !important}.acu-action-btn:active{background:var(--acu-btn-active-bg);color:#fff}}@media (max-width:700px){.acu-dash-container{grid-template-columns:1fr}}.acu-floating-ball-vue{position:fixed;width:50px;height:50px;background:hsla(0,0%,100%,.25);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:1px solid hsla(0,0%,100%,.4);border-radius:50%;box-shadow:0 4px 15px rgba(0,0,0,.3);z-index:2147483647;display:flex;align-items:center;justify-content:center;cursor:pointer;touch-action:none;color:var(--acu-text-main,#333);font-size:20px;-webkit-user-select:none;user-select:none;transition:all .3s cubic-bezier(0.18,0.89,0.32,1.28);pointer-events:auto !important}.acu-floating-ball-vue:active{transform:scale(0.9);background:hsla(0,0%,100%,.4)}.acu-floating-ball-vue.docked{left:0 !important;width:20px !important;height:50px !important;border-radius:0 8px 8px 0 !important;opacity:.3;background:#000;border:1px solid #666;border-left:none;font-size:0 !important;transform:none !important}.acu-floating-ball-vue.docked::after{content:"›";color:#fff;font-size:16px;font-weight:bold;display:block}.acu-floating-ball-vue.docked:hover,.acu-floating-ball-vue.docked:active{opacity:.8;width:30px !important}.acu-tab-bar{width:100%}.acu-nav-container{order:1;flex:0 0 auto;display:flex;flex-direction:column;gap:0;padding:6px 10px;background:var(--acu-bg-nav);border-top:1px solid var(--acu-border);border-radius:14px 14px 0 0;backdrop-filter:blur(5px);box-shadow:0 -4px 20px rgba(0,0,0,.2);transition:transform .2s;touch-action:pan-y;width:100%;pointer-events:auto !important;cursor:move}.acu-nav-container.lock-mode{cursor:default !important}.acu-nav-container.editing-order .acu-nav-btn{border:1px dashed #f0ad4e;cursor:grab;opacity:.8}.acu-nav-tabs-area{display:grid;grid-template-columns:var(--acu-nav-cols,repeat(auto-fill,minmax(110px,1fr)));gap:5px;width:100%}.acu-nav-btn{width:100%;display:flex;align-items:center;justify-content:center;gap:6px;padding:5px 3px;border:1px solid rgba(0,0,0,0);border-radius:8px;background:var(--acu-btn-bg);color:var(--acu-text-main);font-weight:600;font-size:13px;cursor:pointer;transition:all .2s ease;-webkit-user-select:none;user-select:none;text-align:center;white-space:nowrap;overflow:hidden}.acu-nav-btn span{overflow:hidden;text-overflow:ellipsis}.acu-nav-btn:hover{background:var(--acu-btn-hover);transform:translateY(-2px)}.acu-nav-btn.active{background:var(--acu-btn-active-bg);color:var(--acu-btn-active-text);box-shadow:0 2px 6px rgba(0,0,0,.15)}.acu-nav-separator{width:100%;height:1px;border-top:1px dashed var(--acu-border);margin:5px 0;opacity:.6}.acu-nav-actions-area{display:flex;width:100%;justify-content:space-between;align-items:stretch;background:rgba(0,0,0,0);padding-top:0;gap:8px}.acu-order-controls{display:none;width:100%;text-align:center;background:var(--acu-table-head);padding:5px;margin-bottom:5px;border-radius:4px;border:1px dashed var(--acu-border)}.acu-order-controls.visible{display:block}.acu-order-controls{font-size:12px;color:var(--acu-text-sub)}.acu-order-done-btn{background:var(--acu-btn-active-bg);color:var(--acu-btn-active-text);border:none;border-radius:4px;padding:2px 8px;margin-left:8px;cursor:pointer;font-size:12px;transition:all .2s}.acu-order-done-btn:hover{opacity:.9;transform:scale(1.05)}.acu-nav-btn.drag-handle{border:1px dashed #f0ad4e;cursor:grab;opacity:.8}.acu-nav-btn.drag-handle:active{cursor:grabbing}.acu-nav-btn.dragging{opacity:.5;border:2px solid var(--acu-highlight)}.acu-action-btn{display:flex;align-items:center;justify-content:center;flex:1;min-width:36px;height:36px;border:1px solid var(--acu-border);border-radius:8px;background:var(--acu-btn-bg);color:var(--acu-text-main);font-size:14px;cursor:pointer;transition:all .2s ease}.acu-action-btn:hover{background:var(--acu-btn-hover);transform:translateY(-1px)}.acu-action-btn:active{transform:translateY(0)}.acu-action-btn.refreshing i{animation:acu-spin 1s linear infinite}.acu-action-btn.has-changes{animation:acu-pulse 1.5s ease-in-out infinite;border-color:var(--acu-highlight);color:var(--acu-highlight)}.acu-action-btn.acu-btn-danger{color:#e74c3c}.acu-action-btn.acu-btn-danger:hover{background:rgba(231,76,60,.1);border-color:#e74c3c}.acu-action-btn.acu-btn-toggle.active{background:var(--acu-btn-hover);color:var(--acu-highlight);border-color:var(--acu-highlight)}@keyframes acu-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@keyframes acu-pulse{0%,100%{box-shadow:0 0 0 0 rgba(var(--acu-highlight-rgb,211,84,0),0.4)}50%{box-shadow:0 0 0 8px rgba(var(--acu-highlight-rgb,211,84,0),0)}}.acu-data-card{background:var(--acu-card-bg);border:none;box-shadow:0 2px 8px var(--acu-shadow);border-radius:12px;transition:all .25s ease;display:flex;flex-direction:column;position:relative;-webkit-user-select:none;user-select:none;touch-action:pan-x pan-y;overflow-y:auto;overflow-x:hidden;overscroll-behavior:contain;scrollbar-width:thin;scrollbar-color:hsla(0,0%,100%,.2) rgba(0,0,0,0)}.acu-data-card::-webkit-scrollbar{width:4px;height:4px}.acu-data-card::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.acu-data-card::-webkit-scrollbar-thumb{background:hsla(0,0%,100%,.2);border-radius:2px;-webkit-transition:background .2s ease;transition:background .2s ease}.acu-data-card::-webkit-scrollbar-thumb:hover{background:hsla(0,0%,100%,.4)}.acu-data-card.acu-editing-lock{border-color:var(--acu-highlight) !important;box-shadow:0 0 0 1px var(--acu-highlight) !important;z-index:5;-webkit-user-select:text !important;user-select:text !important;touch-action:none !important}.acu-data-card.pending-delete{border:2px solid #f44 !important;background:rgba(255,68,68,.1);animation:acu-shake .3s ease-in-out}@keyframes acu-shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}75%{transform:translateX(4px)}}.acu-grid-value,.acu-full-value,.acu-card-value,.acu-editable-title,.acu-grid-label,.acu-full-label,.acu-card-label{user-select:text !important;-webkit-user-select:text !important;cursor:text}.acu-layout-vertical .acu-card-grid{display:flex;flex-wrap:wrap;justify-content:center;gap:14px}.acu-layout-vertical .acu-data-card{flex:0 0 var(--acu-card-width,280px);width:var(--acu-card-width,280px)}.acu-layout-vertical .acu-data-card:hover{transform:translateY(-4px);box-shadow:0 8px 25px var(--acu-shadow);z-index:5}.acu-layout-horizontal .acu-card-grid{display:inline-flex;flex-wrap:nowrap;gap:14px;height:100%;align-items:flex-start;padding-bottom:10px;min-width:100%}.acu-layout-horizontal .acu-data-card{flex:0 0 var(--acu-card-width,280px);width:var(--acu-card-width,280px);max-height:98%;overflow-y:auto;white-space:normal;touch-action:pan-x pan-y !important}.acu-card-header{padding:10px 15px;background:rgba(0,0,0,0);border-bottom:1px solid rgba(0,0,0,.05);font-weight:bold;color:var(--acu-title-color);font-size:14px;display:flex;justify-content:center;align-items:center;position:relative;flex:0 0 auto}.acu-editable-title{cursor:pointer;border-bottom:1px dashed rgba(0,0,0,0);transition:all .2s;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:15px;font-weight:800;text-align:center;width:100%;padding:2px 5px;border-radius:4px}.acu-editable-title:hover{background:var(--acu-table-hover);color:var(--acu-title-color)}.acu-title-editor{flex:1;min-width:0}.acu-title-editor .acu-inline-input,.acu-title-editor textarea{width:100%;font-size:15px;font-weight:800;text-align:center;background:hsla(0,0%,100%,.15);border:1px solid var(--acu-highlight,#667eea);border-radius:4px;padding:4px 8px;color:var(--acu-title-color)}.acu-title-editor .acu-inline-input:focus,.acu-title-editor textarea:focus{outline:none;box-shadow:0 0 0 2px var(--acu-highlight-bg,rgba(102,126,234,0.2))}.acu-card-index{position:absolute;left:10px;top:50%;transform:translateY(-50%);font-size:10px;color:var(--acu-text-sub);font-weight:normal;background:var(--acu-badge-bg);padding:1px 6px;border-radius:8px;opacity:.8}.acu-card-body{padding:0;display:flex;flex-direction:column;gap:0;font-size:var(--acu-font-size,13px)}.acu-card-main-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:12px}.acu-grid-item{display:flex;flex-direction:column;gap:2px;padding:5px;border-radius:6px;cursor:pointer;overflow:hidden}.acu-grid-item:hover{background:var(--acu-table-hover)}.acu-grid-label{font-size:11px;color:var(--acu-title-color);text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-grid-value{font-size:var(--acu-font-size,13px);color:var(--acu-text-main);font-weight:500;white-space:pre-wrap;word-break:break-word;line-height:1.35}.acu-card-full-area{display:flex;flex-direction:column;gap:8px;padding:0 12px 10px 12px}.acu-full-item{display:flex;flex-direction:column;gap:3px;padding:6px;border-radius:6px;border-top:1px dashed rgba(0,0,0,.05);cursor:pointer}.acu-full-item:hover{background:var(--acu-table-hover)}.acu-full-label{font-size:11px;color:var(--acu-title-color);font-weight:bold}.acu-full-value{font-size:var(--acu-font-size,13px);color:var(--acu-text-main);line-height:1.4;word-break:break-all;white-space:pre-wrap;max-height:var(--acu-text-max-height,80px);overflow-y:var(--acu-text-overflow,auto);scrollbar-width:none}.acu-data-card.acu-style-list .acu-card-body{padding:6px 12px;display:flex;flex-direction:column;gap:0}.acu-data-card.acu-style-list .acu-card-row{display:block !important;padding:6px 0 !important;border-bottom:1px dashed var(--acu-border);cursor:pointer;overflow:hidden}.acu-data-card.acu-style-list .acu-card-row:last-child{border-bottom:none}.acu-data-card.acu-style-list .acu-card-row:hover{background:var(--acu-table-hover)}.acu-data-card.acu-style-list .acu-card-label{float:left !important;clear:left;width:auto !important;margin-right:8px !important;color:var(--acu-title-color);font-size:.9em;font-weight:bold;line-height:1.5}.acu-data-card.acu-style-list .acu-card-value{display:block !important;width:auto !important;margin:0 !important;text-align:left !important;word-break:break-all !important;white-space:pre-wrap !important;line-height:1.5 !important;color:var(--acu-text-main);max-height:var(--acu-text-max-height,80px);overflow-y:var(--acu-text-overflow,auto);scrollbar-width:none}.acu-data-card.acu-style-list .acu-card-value::-webkit-scrollbar{display:none}.acu-data-card.acu-style-list .acu-highlight-changed{display:inline-block;width:auto;line-height:1.4}.acu-inline-input{width:100%;height:100%;box-sizing:border-box;background:hsla(0,0%,100%,.1);border:none;outline:none;font-family:inherit;font-size:inherit;line-height:1.5;color:inherit;resize:none;overflow:hidden;padding:2px;margin:0;display:block;border-radius:4px}.acu-delete-stamp,.acu-badge-pending{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-15deg);width:80px;height:80px;border:4px solid #e74c3c;border-radius:50%;color:#e74c3c;font-size:20px;font-weight:900;display:flex;align-items:center;justify-content:center;z-index:50;pointer-events:none;opacity:.6;box-shadow:inset 0 0 10px rgba(231,76,60,.2);background:hsla(0,0%,100%,.1);text-align:center;line-height:1.2}.acu-delete-stamp i,.acu-badge-pending i{display:none}.acu-cell-changed .acu-grid-value,.acu-cell-changed .acu-full-value,.acu-cell-changed .acu-card-value{font-weight:600}.acu-cell-changed-manual .acu-grid-value,.acu-cell-changed-manual .acu-full-value,.acu-cell-changed-manual .acu-card-value{color:var(--acu-highlight-manual,#d35400) !important;font-weight:600}.acu-cell-changed-ai .acu-grid-value,.acu-cell-changed-ai .acu-full-value,.acu-cell-changed-ai .acu-card-value{color:var(--acu-highlight-ai,#3498db) !important;font-weight:600}.acu-pull-overlay{display:flex;align-items:center;justify-content:center;overflow:hidden;width:100%;flex:0 0 auto;height:0;transition:height .1s linear}.acu-pull-top{background:rgba(46,204,113,.15);border-bottom:2px dashed #27ae60;color:#27ae60}.acu-pull-bottom{background:rgba(231,76,60,.15);border-top:2px dashed #c0392b;color:#c0392b}.acu-pull-restore{background:rgba(52,152,219,.15) !important;border-top:2px dashed #2980b9 !important;color:#2980b9 !important}.acu-pull-icon{display:flex;flex-direction:column;align-items:center;gap:5px;opacity:.8}.acu-pull-text{font-size:12px;opacity:.9}.acu-swipe-overlay{position:absolute;top:0;bottom:0;width:0;display:flex;align-items:center;justify-content:center;overflow:hidden;pointer-events:none;z-index:10;font-size:18px;font-weight:bold;transition:width .1s linear;white-space:nowrap}.acu-swipe-right{left:0;background:rgba(46,204,113,.2);border-right:2px dashed #27ae60;color:#27ae60}.acu-swipe-left{right:0;background:rgba(231,76,60,.2);border-left:2px dashed #c0392b;color:#c0392b}.acu-swipe-restore{background:rgba(52,152,219,.2) !important;border-left:2px dashed #2980b9 !important;color:#2980b9 !important}.acu-data-table{display:flex;flex-direction:column;flex:1;min-height:0;height:100%;gap:0}.acu-data-table.acu-table-loading{opacity:.6;pointer-events:none}.acu-table-toolbar{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:var(--acu-table-head,rgba(0,0,0,0.03));border-bottom:1px solid var(--acu-border,rgba(0,0,0,0.06));border-radius:0;gap:12px;z-index:10;flex-shrink:0}.acu-toolbar-left{display:flex;align-items:center;gap:8px;flex-shrink:0;min-width:0}.acu-table-title{font-weight:600;font-size:calc(var(--acu-font-size,13px) + 1px);color:var(--acu-title-color,var(--acu-text-main,#333));white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-table-count{font-size:calc(var(--acu-font-size,13px) - 2px);color:var(--acu-text-muted,#999);white-space:nowrap}.acu-table-badge{font-size:11px;padding:2px 6px;border-radius:10px;white-space:nowrap}.acu-table-badge.acu-badge-changed{background:rgba(102,126,234,.15);color:var(--acu-highlight,#667eea)}.acu-table-badge.acu-badge-deleting{background:rgba(231,76,60,.15);color:var(--acu-danger,#e74c3c)}.acu-toolbar-right{display:flex;align-items:center;gap:8px;flex-shrink:0}.acu-toolbar-btn{display:flex;align-items:center;justify-content:center;width:26px;height:26px;border:none;border-radius:var(--acu-radius-sm,4px);background:rgba(0,0,0,0);color:var(--acu-text-sub,#666);cursor:pointer;transition:all .15s ease}.acu-toolbar-btn:hover{background:var(--acu-btn-hover,rgba(0,0,0,0.06));color:var(--acu-text-main,#333)}.acu-toolbar-btn.active{background:var(--acu-highlight-bg,rgba(102,126,234,0.15));color:var(--acu-highlight,#667eea)}.acu-toolbar-btn i{font-size:12px}.acu-toolbar-btn.acu-height-handle{cursor:ns-resize;color:var(--acu-text-muted,#999)}.acu-toolbar-btn.acu-height-handle:hover{color:var(--acu-highlight,#667eea)}.acu-toolbar-btn.acu-close-btn:hover{background:rgba(231,76,60,.1);color:var(--acu-danger,#e74c3c)}.acu-search-box{position:relative;display:flex;align-items:center}.acu-search-icon{position:absolute;left:8px;color:var(--acu-text-muted,#999);font-size:12px;pointer-events:none}.acu-search-input{width:140px;padding:5px 28px 5px 28px;border:1px solid var(--acu-border,rgba(0,0,0,0.1));border-radius:var(--acu-radius-sm,4px);background:var(--acu-bg-panel,#fff);color:var(--acu-text-main,#333);font-size:calc(var(--acu-font-size,13px) - 1px);outline:none;transition:all .2s}.acu-search-input:focus{width:180px;border-color:var(--acu-highlight,#667eea)}.acu-search-input::placeholder{color:var(--acu-text-muted,#999)}.acu-search-clear{position:absolute;right:8px;color:var(--acu-text-muted,#999);cursor:pointer;font-size:11px}.acu-search-clear:hover{color:var(--acu-text-main,#333)}.acu-cards-container{flex:1;min-height:0;overflow-y:auto;overflow-x:hidden;overscroll-behavior:contain;padding:8px}.acu-cards-container.acu-view-card{display:grid;grid-template-columns:repeat(auto-fill,minmax(var(--acu-card-width,280px),var(--acu-card-width,280px)));gap:10px;justify-content:center;align-content:start;grid-auto-rows:min-content}.acu-cards-container.acu-view-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,280px));gap:10px;justify-content:center;align-content:start;grid-auto-rows:min-content}.acu-layout-horizontal .acu-cards-container{flex:1;min-height:0;display:flex !important;flex-wrap:nowrap !important;gap:14px;align-items:flex-start;justify-content:flex-start;white-space:nowrap;overflow-x:auto !important;overflow-y:hidden !important;touch-action:pan-x pan-y !important;padding:12px;padding-bottom:8px;overscroll-behavior-x:contain}.acu-layout-horizontal .acu-cards-container.acu-view-card,.acu-layout-horizontal .acu-cards-container.acu-view-list{display:flex !important;flex-wrap:nowrap !important}.acu-layout-horizontal .acu-data-card{flex:0 0 var(--acu-card-width,280px) !important;width:var(--acu-card-width,280px) !important;min-width:var(--acu-card-width,280px);max-height:calc(100% - 20px);overflow-y:auto;white-space:normal;touch-action:pan-x pan-y !important;display:flex !important}.acu-layout-horizontal .acu-data-table{height:100%;min-height:200px;display:flex;flex-direction:column;overflow:hidden}.acu-layout-horizontal .acu-table-toolbar{flex-shrink:0;position:relative;z-index:10}.acu-layout-horizontal .acu-pagination-container{flex-shrink:0;position:relative;z-index:10}.acu-layout-horizontal .acu-panel-content{overflow:hidden !important;min-height:150px}.acu-empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 24px;color:var(--acu-text-muted,#999);grid-column:1/-1}.acu-empty-state i{font-size:48px;margin-bottom:16px;opacity:.5}.acu-empty-state p{margin:0;font-size:var(--acu-font-size,13px)}.acu-pagination{display:flex;justify-content:center;align-items:center;gap:4px;padding:12px;flex-wrap:wrap}.acu-btn-page{min-width:32px;padding:4px 8px;font-size:calc(var(--acu-font-size,13px) - 1px)}.acu-btn-page.active{font-weight:600}.acu-page-ellipsis{padding:4px 8px;color:var(--acu-text-muted,#999)}.acu-page-info{margin-left:12px;color:var(--acu-text-muted,#666);font-size:calc(var(--acu-font-size,13px) - 1px)}.acu-action-btn{flex:1;height:36px;display:flex;align-items:center;justify-content:center;background:var(--acu-btn-bg);border-radius:8px;color:var(--acu-text-sub);cursor:pointer;border:1px solid rgba(0,0,0,0);transition:all .2s;font-size:16px;-webkit-user-select:none;user-select:none}.acu-action-btn:hover{background:var(--acu-btn-hover);color:var(--acu-text-main);transform:translateY(-2px);border-color:var(--acu-border)}#acu-btn-save-global{color:var(--acu-title-color)}#acu-btn-save-global:hover{background:var(--acu-btn-active-bg);color:var(--acu-btn-active-text)}#acu-btn-save-specific{color:#9b59b6;display:none}.acu-dialog-btn{background:none;border:none;cursor:pointer;font-size:14px;font-weight:bold;display:flex;align-items:center;gap:6px;color:var(--acu-text-sub);transition:color .2s}.acu-page-btn{padding:0;border:1px solid var(--acu-border);background:var(--acu-btn-bg);color:var(--acu-title-color);border-radius:6px;cursor:pointer;font-size:12px;min-width:32px;height:32px;display:flex;align-items:center;justify-content:center;transition:all .2s;-webkit-user-select:none;user-select:none;font-weight:500;flex-shrink:0}.acu-page-btn:not(.disabled):not(.active):hover{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);transform:translateY(-2px);box-shadow:0 2px 5px rgba(0,0,0,.1)}.acu-page-btn.active{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);font-weight:bold;cursor:default}.acu-page-btn.disabled{opacity:.5;cursor:not-allowed;background:var(--acu-text-sub)}.acu-page-arrow{width:36px;font-size:14px}.acu-tab-btn{padding:6px 12px;cursor:pointer;font-size:13px;font-weight:bold;color:var(--acu-text-sub);border-bottom:2px solid rgba(0,0,0,0);transition:all .2s}.acu-tab-btn:hover{color:var(--acu-text-main);background:var(--acu-table-hover);border-radius:4px 4px 0 0}.acu-tab-btn.active{color:var(--acu-highlight);border-bottom-color:var(--acu-highlight)}.acu-action-bar{display:flex;align-items:center;gap:4px;padding:4px}.acu-action-bar .acu-action-btn{flex:none;width:32px;height:32px;padding:0;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);cursor:pointer;border-radius:6px;transition:all .2s ease}.acu-action-bar .acu-action-btn:hover{background:var(--acu-hover-bg,rgba(255,255,255,0.1));color:var(--acu-text-main);transform:none;border-color:rgba(0,0,0,0)}.acu-action-bar .acu-action-btn:active{transform:scale(0.95)}.acu-action-bar .acu-action-btn i{font-size:14px}.acu-btn-danger{color:#e74c3c}.acu-btn-danger:hover{background:rgba(231,76,60,.2)}.acu-btn-toggle.active{color:var(--acu-primary-color,#3498db);background:rgba(52,152,219,.2)}.has-changes{color:#f39c12;animation:pulse 1.5s infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}.acu-search-wrapper{position:relative;display:flex;align-items:center}.acu-search-input{background:var(--acu-btn-bg);border:1px solid var(--acu-border);color:var(--acu-text-main);padding:2px 2px 3px 22px;border-radius:16px;font-size:12px;width:100px;transition:all .2s}.acu-search-input:focus{width:140px;outline:none;border-color:var(--acu-highlight);background:var(--acu-input-bg)}.acu-search-icon{position:absolute;left:10px;font-size:10px;color:var(--acu-text-sub);pointer-events:none}.acu-inline-editor{width:100%;position:relative;touch-action:manipulation}.acu-edit-textarea{width:100%;min-height:24px;padding:6px 8px;border:2px solid var(--acu-highlight,#667eea);border-radius:var(--acu-radius-sm,4px);background:var(--acu-input-bg,#fff);color:var(--acu-text-main,#333);font-size:var(--acu-font-size,13px);font-family:inherit;line-height:1.5;resize:none;outline:none;box-sizing:border-box;overflow:hidden;user-select:text !important;-webkit-user-select:text !important;touch-action:manipulation}.acu-edit-textarea:focus{box-shadow:0 0 0 3px var(--acu-highlight-bg,rgba(102,126,234,0.2))}.acu-editing-lock .acu-inline-editor{touch-action:manipulation}.acu-edit-textarea-legacy{width:100%;min-height:100px;background:var(--acu-input-bg);border:1px solid var(--acu-border);border-radius:8px;padding:12px;font-size:inherit;font-family:inherit;color:var(--acu-text-main);resize:vertical;transition:border-color .2s}.acu-edit-textarea-legacy:focus{outline:none;border-color:var(--acu-highlight)}.acu-settings-input{background:var(--acu-input-bg);border:1px solid var(--acu-border);border-radius:6px;padding:8px 12px;color:var(--acu-text-main);font-size:14px;transition:border-color .2s}.acu-settings-input:focus{outline:none;border-color:var(--acu-highlight)}.acu-range-input{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:var(--acu-border);border-radius:3px;outline:none;cursor:pointer}.acu-range-input::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;background:var(--acu-highlight);border-radius:50%;cursor:pointer;-webkit-transition:transform .2s;transition:transform .2s}.acu-range-input::-webkit-slider-thumb:hover{transform:scale(1.2)}.acu-range-input::-moz-range-thumb{width:16px;height:16px;background:var(--acu-highlight);border-radius:50%;border:none;cursor:pointer}.acu-select{background:var(--acu-input-bg);border:1px solid var(--acu-border);border-radius:6px;padding:8px 12px;color:var(--acu-text-main);font-size:14px;cursor:pointer;transition:border-color .2s}.acu-select:focus{outline:none;border-color:var(--acu-highlight)}.acu-select option{background:var(--acu-bg-panel);color:var(--acu-text-main)}.acu-checkbox{display:flex;align-items:center;gap:8px;cursor:pointer;-webkit-user-select:none;user-select:none}.acu-checkbox input[type=checkbox]{width:18px;height:18px;accent-color:var(--acu-highlight);cursor:pointer}.acu-checkbox label{color:var(--acu-text-main);font-size:14px;cursor:pointer}.acu-search-box{display:flex;align-items:center;gap:12px}.acu-search-input-wrapper{position:relative;display:flex;align-items:center;flex:1;max-width:300px;min-width:180px}.acu-search-box .acu-search-icon{position:absolute;left:12px;color:var(--acu-text-sub,#999);font-size:14px;pointer-events:none;transition:color var(--acu-transition-fast,0.15s)}.focused .acu-search-box .acu-search-icon{color:var(--acu-highlight,#d35400)}.acu-search-box .acu-search-input{width:100%;height:36px;padding:0 36px;border:1px solid var(--acu-border,#dcd0c0);border-radius:var(--acu-radius-md,12px);background:var(--acu-input-bg,rgba(255,255,255,0.5));color:var(--acu-text-main,#5e4b35);font-size:var(--acu-font-size,13px);outline:none;transition:border-color var(--acu-transition-fast,0.15s),box-shadow var(--acu-transition-fast,0.15s),background var(--acu-transition-fast,0.15s)}.acu-search-box .acu-search-input::placeholder{color:var(--acu-text-sub,#999);opacity:.7}.acu-search-box .acu-search-input:focus{border-color:var(--acu-highlight,#d35400);box-shadow:0 0 0 3px var(--acu-highlight-bg,rgba(211,84,0,0.08));background:var(--acu-card-bg,#fffef9)}.has-value .acu-search-box .acu-search-input{padding-right:40px}.acu-search-clear{position:absolute;right:8px;display:flex;align-items:center;justify-content:center;width:24px;height:24px;border:none;border-radius:50%;background:var(--acu-badge-bg,#efebe4);color:var(--acu-text-sub,#999);cursor:pointer;transition:background var(--acu-transition-fast,0.15s),color var(--acu-transition-fast,0.15s),transform var(--acu-transition-fast,0.15s)}.acu-search-clear i{font-size:12px}.acu-search-clear:hover{background:var(--acu-danger,#e74c3c);color:#fff;transform:scale(1.1)}.acu-search-clear:active{transform:scale(0.95)}.acu-search-result{font-size:.85em;color:var(--acu-text-sub,#999);white-space:nowrap}.acu-search-result strong{color:var(--acu-highlight,#d35400);font-weight:600}.acu-search-result .no-result{color:var(--acu-warning,#f39c12)}.acu-fade-enter-active,.acu-fade-leave-active{transition:opacity .15s ease,transform .15s ease}.acu-fade-enter-from,.acu-fade-leave-to{opacity:0;transform:scale(0.8)}.acu-fade-enter-to,.acu-fade-leave-from{opacity:1;transform:scale(1)}@media (max-width:480px){.acu-search-box{flex-direction:column;align-items:stretch;gap:8px}.acu-search-input-wrapper{max-width:none;min-width:auto}.acu-search-box .acu-search-input{height:40px}.acu-search-result{text-align:center;font-size:.8em}}.acu-badge{display:inline-block;padding:2px 8px;border-radius:var(--acu-radius-sm,4px);font-size:calc(var(--acu-font-size,13px) - 1px);background:var(--acu-badge-bg,rgba(0,0,0,0.05));color:var(--acu-text-main,#333);line-height:1.4;word-break:break-word;white-space:pre-wrap}.acu-badge-default{background:rgba(0,0,0,0);padding:0;color:inherit}.acu-badge-pending{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-15deg);width:80px;height:80px;border:4px solid #e74c3c;border-radius:50%;color:#e74c3c;font-size:20px;font-weight:900;display:flex;align-items:center;justify-content:center;z-index:50;pointer-events:none;opacity:.6;box-shadow:inset 0 0 10px rgba(231,76,60,.2);background:hsla(0,0%,100%,.1)}.acu-badge-success{background:rgba(46,204,113,.15);color:#27ae60;border:1px solid rgba(46,204,113,.3)}.acu-badge-warning{background:rgba(241,196,15,.15);color:#f39c12;border:1px solid rgba(241,196,15,.3)}.acu-badge-danger{background:rgba(231,76,60,.15);color:#e74c3c;border:1px solid rgba(231,76,60,.3)}.acu-badge-info{background:rgba(52,152,219,.15);color:#3498db;border:1px solid rgba(52,152,219,.3)}.acu-badge-level{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;font-weight:bold;text-shadow:0 1px 2px rgba(0,0,0,.2)}.acu-badge-percent{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:#fff;font-weight:500}.acu-badge-male{background:rgba(0,0,0,0);color:inherit;padding:0}.acu-badge-female{background:rgba(0,0,0,0);color:inherit;padding:0}.acu-badge-number{background:var(--acu-highlight-bg,rgba(102,126,234,0.1));color:var(--acu-highlight,#667eea);font-weight:500;font-variant-numeric:tabular-nums}.acu-badge-count{min-width:20px;height:20px;padding:0 6px;border-radius:10px;font-size:11px;font-weight:bold;background:var(--acu-highlight);color:#fff}.acu-badge-tag{padding:4px 10px;border-radius:4px;font-size:11px;background:var(--acu-btn-bg);color:var(--acu-text-sub);border:1px solid var(--acu-border)}.acu-badge-tag:hover{background:var(--acu-btn-hover);color:var(--acu-text-main)}.acu-pagination-container{flex:0 0 auto;flex-shrink:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:6px 8px;background:var(--acu-bg-panel);border-top:1px solid var(--acu-border);z-index:10;box-sizing:border-box}.acu-pagination-container.hidden{display:none !important}.acu-pagination-numbers{display:flex;justify-content:center;align-items:center;gap:4px;flex:1;overflow:hidden}.acu-page-btn{padding:0;border:1px solid var(--acu-border);background:var(--acu-btn-bg);color:var(--acu-title-color);border-radius:5px;cursor:pointer;font-size:11px;min-width:26px;height:26px;display:flex;align-items:center;justify-content:center;transition:all .2s;-webkit-user-select:none;user-select:none;font-weight:500;flex-shrink:0}.acu-page-btn:not(.disabled):not(.active):hover{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);transform:translateY(-1px);box-shadow:0 2px 4px rgba(0,0,0,.1)}.acu-page-btn.active{background:var(--acu-title-color);color:#fff;border-color:var(--acu-title-color);font-weight:bold;cursor:default}.acu-page-btn.disabled{opacity:.5;cursor:not-allowed;background:var(--acu-text-sub)}.acu-page-arrow{width:30px;font-size:12px}.acu-page-dots{color:var(--acu-text-sub);font-size:11px;padding:0 2px;letter-spacing:1px}.acu-pagination-info{color:var(--acu-text-sub);font-size:11px;white-space:nowrap}.acu-pagination{display:flex;align-items:center;justify-content:center;padding:8px 15px;gap:5px;flex-wrap:nowrap;font-size:var(--acu-font-size,13px);background:var(--acu-bg-panel);border-top:1px solid var(--acu-border);box-sizing:border-box;width:100%;flex:0 0 auto}.acu-pagination .acu-pagination-info{display:flex;align-items:center;gap:4px;color:var(--acu-text-sub,#999);white-space:nowrap}.acu-pagination .acu-pagination-info strong{color:var(--acu-text-main,#5e4b35);font-weight:600}.acu-pagination .acu-pagination-info .acu-pagination-total{opacity:.7;font-size:.9em}.acu-pagination-controls{display:flex;align-items:center;gap:4px}.acu-page-list{display:flex;align-items:center;gap:4px}.acu-pagination .acu-btn{display:inline-flex;align-items:center;justify-content:center;border:1px solid var(--acu-border,#dcd0c0);background:var(--acu-btn-bg,#dcd0c0);color:var(--acu-text-main,#5e4b35);cursor:pointer;transition:background var(--acu-transition-fast,0.15s),border-color var(--acu-transition-fast,0.15s),color var(--acu-transition-fast,0.15s),transform var(--acu-transition-fast,0.15s);-webkit-user-select:none;user-select:none;flex-shrink:0}.acu-pagination .acu-btn:hover:not(:disabled){background:var(--acu-title-color,#5e4b35);color:#fff;border-color:var(--acu-title-color,#5e4b35);transform:translateY(-2px);box-shadow:0 2px 5px rgba(0,0,0,.1)}.acu-pagination .acu-btn:active:not(:disabled){transform:scale(0.95)}.acu-pagination .acu-btn:disabled,.acu-pagination .acu-btn.disabled{opacity:.5;cursor:not-allowed;background:var(--acu-text-sub,#999)}.acu-pagination .acu-btn-icon{width:32px;height:32px;padding:0;border-radius:var(--acu-radius-sm,6px)}.acu-pagination .acu-btn-icon i{font-size:14px}.acu-pagination .acu-btn-page{min-width:32px;height:32px;padding:0;border-radius:6px;font-size:12px;font-weight:500;flex-shrink:0}.acu-pagination .acu-btn-page.active{background:var(--acu-title-color,#5e4b35);border-color:var(--acu-title-color,#5e4b35);color:#fff;font-weight:bold;cursor:default}.acu-pagination .acu-btn-page.active:hover{transform:none}.acu-pagination .acu-btn-page i{font-size:14px}.acu-pagination .acu-btn-sm{height:28px;padding:0 12px;font-size:12px;border-radius:var(--acu-radius-sm,6px)}.acu-page-ellipsis{display:flex;align-items:center;justify-content:center;min-width:24px;height:32px;color:var(--acu-text-sub,#999);font-size:12px;padding:0 2px;letter-spacing:1px;flex-shrink:0}.acu-page-ellipsis i{font-size:12px}.acu-page-info{display:flex;align-items:center;color:var(--acu-text-sub,#999);font-size:12px;white-space:nowrap;margin-left:8px;flex-shrink:0}.acu-pagination-jump{display:flex;align-items:center;gap:8px;color:var(--acu-text-sub,#999);white-space:nowrap}.acu-pagination-jump .acu-input-sm{width:56px;height:28px;padding:0 8px;border:1px solid var(--acu-border,#dcd0c0);border-radius:var(--acu-radius-sm,6px);background:var(--acu-input-bg,rgba(255,255,255,0.5));color:var(--acu-text-main,#5e4b35);font-size:var(--acu-font-size,13px);text-align:center;outline:none;transition:border-color var(--acu-transition-fast,0.15s),box-shadow var(--acu-transition-fast,0.15s);-moz-appearance:textfield}.acu-pagination-jump .acu-input-sm::-webkit-outer-spin-button,.acu-pagination-jump .acu-input-sm::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.acu-pagination-jump .acu-input-sm:focus{border-color:var(--acu-highlight,#d35400);box-shadow:0 0 0 3px var(--acu-highlight-bg,rgba(211,84,0,0.08))}@media (max-width:480px){.acu-pagination{flex-direction:column;gap:12px}.acu-pagination .acu-pagination-info{order:-1}.acu-pagination-jump{font-size:12px}.acu-pagination-jump .acu-input-sm{width:48px;height:26px}.acu-pagination-jump .acu-btn-sm{height:26px;padding:0 10px}}.acu-dash-container{display:flex;flex-direction:column;gap:16px;padding:8px;overflow-y:auto;max-height:100%}.acu-dash-section{background:var(--acu-bg-panel);border-radius:12px;padding:16px;border:1px solid var(--acu-border);box-shadow:0 2px 8px rgba(0,0,0,.1)}.acu-dash-title{display:flex;align-items:center;gap:8px;font-size:14px;font-weight:600;color:var(--acu-text-main);margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(--acu-border)}.acu-dash-title i{color:var(--acu-highlight);font-size:16px}.acu-dash-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:12px}.acu-dash-item{display:flex;flex-direction:column;background:var(--acu-btn-bg);border-radius:8px;padding:12px;transition:all .2s ease}.acu-dash-item:hover{background:var(--acu-btn-hover);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.15)}.acu-dash-label{font-size:11px;color:var(--acu-text-sub);margin-bottom:4px}.acu-dash-value{font-size:16px;font-weight:600;color:var(--acu-text-main);word-break:break-word}.acu-dash-stat-card{display:flex;align-items:center;gap:12px;padding:16px;background:linear-gradient(135deg,var(--acu-highlight) 0%,var(--acu-accent) 100%);border-radius:12px;color:#fff}.acu-dash-stat-card .stat-icon{width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:hsla(0,0%,100%,.2);border-radius:12px;font-size:24px}.acu-dash-stat-card .stat-content{flex:1}.acu-dash-stat-card .stat-content .stat-value{font-size:24px;font-weight:bold;line-height:1.2}.acu-dash-stat-card .stat-content .stat-label{font-size:12px;opacity:.9}.acu-dash-actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}.acu-dash-action-btn{display:flex;align-items:center;gap:6px;padding:8px 16px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);font-size:12px;cursor:pointer;transition:all .2s ease}.acu-dash-action-btn i{color:var(--acu-highlight)}.acu-dash-action-btn:hover{background:var(--acu-btn-hover);border-color:var(--acu-highlight)}.acu-dash-progress{height:8px;background:var(--acu-btn-bg);border-radius:4px;overflow:hidden;margin-top:8px}.acu-dash-progress .progress-bar{height:100%;background:linear-gradient(90deg,var(--acu-highlight),var(--acu-accent));border-radius:4px;transition:width .3s ease}.acu-dash-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:var(--acu-text-sub);text-align:center}.acu-dash-empty i{font-size:48px;margin-bottom:16px;opacity:.5}.acu-dash-empty .empty-text{font-size:14px;margin-bottom:8px}.acu-dash-empty .empty-hint{font-size:12px;opacity:.7}.acu-dashboard{padding:16px;height:100%;overflow-y:auto}.acu-dashboard-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.acu-dashboard-title{margin:0;font-size:1.4em;font-weight:600;color:var(--acu-text-main,#333);display:flex;align-items:center;gap:10px}.acu-dashboard-title i{color:var(--acu-highlight,#667eea)}.acu-dashboard-actions{display:flex;gap:8px}.acu-dashboard-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}.acu-dashboard-card{background:var(--acu-bg-elevated,#fff);border-radius:var(--acu-radius-md,8px);box-shadow:0 2px 8px rgba(0,0,0,.08);overflow:hidden;transition:box-shadow .2s}.acu-dashboard-card:hover{box-shadow:0 4px 16px rgba(0,0,0,.12)}.acu-dashboard-card.acu-card-primary{border:2px solid var(--acu-highlight,#667eea);grid-column:span 2}@media (max-width:768px){.acu-dashboard-card.acu-card-primary{grid-column:span 1}}.acu-dashboard-card.acu-card-stats{background:linear-gradient(135deg,var(--acu-highlight-bg,rgba(102,126,234,0.1)) 0%,var(--acu-bg-elevated,#fff) 100%)}.acu-dashboard-card.acu-card-quick-access{grid-column:1/-1}.acu-dashboard-card>.acu-card-header{display:flex;align-items:center;gap:8px;padding:12px 16px;background:var(--acu-bg-header,rgba(0,0,0,0.02));font-weight:600;font-size:var(--acu-font-size,13px);border-bottom:1px solid var(--acu-border,rgba(0,0,0,0.05))}.acu-dashboard-card>.acu-card-header i:first-child{color:var(--acu-highlight,#667eea)}.acu-dashboard-card>.acu-card-header span:first-of-type{flex:1}.acu-dashboard-card>.acu-card-header .acu-btn-link{padding:4px;color:var(--acu-text-muted,#999)}.acu-dashboard-card>.acu-card-header .acu-btn-link:hover{color:var(--acu-highlight,#667eea)}.acu-dashboard-card>.acu-card-body{padding:16px}.acu-dashboard-card>.acu-card-body.acu-scroll{max-height:220px;overflow-y:auto}.acu-mini-card{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--acu-bg-panel,rgba(0,0,0,0.02));border-radius:var(--acu-radius-sm,4px);margin-bottom:8px;cursor:pointer;transition:all .2s}.acu-mini-card:hover{background:var(--acu-hover-bg,rgba(0,0,0,0.05));transform:translateX(4px)}.acu-mini-card:last-of-type{margin-bottom:0}.acu-mini-name{font-weight:500;color:var(--acu-text-main,#333)}.acu-task-item{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid var(--acu-border,rgba(0,0,0,0.05));cursor:pointer;transition:background .2s}.acu-task-item:hover{background:var(--acu-hover-bg,rgba(0,0,0,0.02));padding-left:8px;margin-left:-8px;padding-right:8px;margin-right:-8px;border-radius:var(--acu-radius-sm,4px)}.acu-task-item:last-child{border-bottom:none}.acu-task-name{flex:1;font-weight:500;color:var(--acu-text-main,#333);margin-right:12px}.acu-items-grid{display:flex;flex-wrap:wrap;gap:8px}.acu-item-chip{display:inline-flex;align-items:center;gap:4px;padding:6px 12px;background:var(--acu-bg-panel,rgba(0,0,0,0.03));border-radius:16px;font-size:calc(var(--acu-font-size,13px) - 1px);cursor:pointer;transition:all .2s}.acu-item-chip:hover{background:var(--acu-highlight-bg,rgba(102,126,234,0.1));color:var(--acu-highlight,#667eea)}.acu-item-count{color:var(--acu-text-muted,#666);font-size:.9em}.acu-show-more{display:block;width:100%;margin-top:12px;text-align:center}.acu-stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}.acu-stat-item{text-align:center;padding:12px;background:var(--acu-bg-panel,rgba(0,0,0,0.02));border-radius:var(--acu-radius-sm,4px)}.acu-stat-item .acu-stat-value{display:block;font-size:1.8em;font-weight:bold;color:var(--acu-text-main,#333);line-height:1.2}.acu-stat-item .acu-stat-label{display:block;font-size:.85em;color:var(--acu-text-muted,#666);margin-top:4px}.acu-stat-item.acu-stat-highlight .acu-stat-value{color:var(--acu-highlight,#667eea)}.acu-stat-item.acu-stat-danger .acu-stat-value{color:var(--acu-danger,#e74c3c)}.acu-quick-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:12px}.acu-quick-btn{display:flex;flex-direction:column;align-items:center;gap:6px;padding:16px 12px;background:var(--acu-bg-panel,rgba(0,0,0,0.02));border:1px solid var(--acu-border,rgba(0,0,0,0.05));border-radius:var(--acu-radius-md,8px);cursor:pointer;transition:all .2s}.acu-quick-btn:hover{background:var(--acu-highlight-bg,rgba(102,126,234,0.1));border-color:var(--acu-highlight,#667eea);transform:translateY(-2px)}.acu-quick-btn i{font-size:1.5em;color:var(--acu-highlight,#667eea)}.acu-quick-btn span{font-size:calc(var(--acu-font-size,13px) - 1px);color:var(--acu-text-main,#333);text-align:center;word-break:break-all}.acu-tab-container{display:flex;flex-direction:column;height:100%;overflow:hidden}.acu-tab-header{display:flex;align-items:center;padding:0 8px;background:var(--acu-bg-panel);border-bottom:1px solid var(--acu-border);flex-shrink:0}.acu-tab-scroll{display:flex;overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none;flex:1}.acu-tab-scroll::-webkit-scrollbar{display:none}.acu-tab-btn{display:flex;align-items:center;gap:6px;padding:10px 16px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);font-size:13px;cursor:pointer;white-space:nowrap;position:relative;transition:all .2s ease}.acu-tab-btn i{font-size:14px}.acu-tab-btn:hover{color:var(--acu-text-main);background:var(--acu-btn-hover)}.acu-tab-btn.active{color:var(--acu-highlight);font-weight:600}.acu-tab-btn.active::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:60%;height:3px;background:var(--acu-highlight);border-radius:3px 3px 0 0}.acu-tab-content{flex:1;overflow-y:auto;overflow-x:hidden;padding:8px}.acu-tab-panel{display:none;height:100%}.acu-tab-panel.active{display:block}.acu-tab-sortable .acu-tab-btn{cursor:move}.acu-tab-sortable .acu-tab-btn:hover{background:var(--acu-highlight);color:#fff}.acu-tab-sortable .acu-tab-btn.sortable-ghost{opacity:.5;background:var(--acu-highlight)}.acu-tab-sortable .acu-tab-btn.sortable-chosen{background:var(--acu-highlight);color:#fff}.acu-tab-actions{display:flex;align-items:center;gap:4px;margin-left:auto;padding-left:8px;border-left:1px solid var(--acu-border)}.acu-tab-action-btn{width:28px;height:28px;display:flex;align-items:center;justify-content:center;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);border-radius:6px;cursor:pointer;transition:all .2s ease}.acu-tab-action-btn:hover{background:var(--acu-btn-hover);color:var(--acu-text-main)}.acu-tab-action-btn.active{background:var(--acu-highlight);color:#fff}.acu-tab-badge{display:inline-flex;align-items:center;justify-content:center;min-width:18px;height:18px;padding:0 5px;background:var(--acu-highlight);color:#fff;font-size:10px;font-weight:bold;border-radius:9px;margin-left:4px}.acu-tab-close{display:flex;align-items:center;justify-content:center;width:16px;height:16px;margin-left:6px;border-radius:50%;font-size:10px;opacity:0;transition:all .2s ease}.acu-tab-btn:hover .acu-tab-close{opacity:.7}.acu-tab-close:hover{opacity:1 !important;background:rgba(231,76,60,.3);color:#e74c3c}.acu-tab-add{width:32px;height:32px;display:flex;align-items:center;justify-content:center;margin-left:8px;border:1px dashed var(--acu-border);border-radius:6px;color:var(--acu-text-sub);cursor:pointer;transition:all .2s ease}.acu-tab-add:hover{border-color:var(--acu-highlight);color:var(--acu-highlight);background:rgba(var(--acu-highlight-rgb),0.1)}.acu-options-panel{display:flex;flex-direction:column;height:100%;min-height:0}.acu-options-header{flex:0 0 auto;padding:8px 12px;-webkit-user-select:none;user-select:none}.acu-options-title{font-size:1.2em;font-weight:800;color:var(--acu-title-color,#333);display:flex;align-items:center;gap:8px}.acu-options-title i{color:var(--acu-highlight,#667eea)}.acu-options-count{color:var(--acu-text-sub,#666);font-size:.9em}.acu-options-content{flex:1;overflow-y:auto !important;min-height:0;padding:10px;touch-action:pan-y;-webkit-overflow-scrolling:touch;position:relative;z-index:10}.acu-options-list{display:flex;flex-direction:column;gap:12px;padding-bottom:20px}.acu-empty-state{text-align:center;color:var(--acu-text-sub,#666);padding:30px;font-size:.9em}.acu-option-rows{display:flex;flex-direction:column;gap:6px}.acu-option-row{display:flex;align-items:flex-start;gap:10px;padding:12px;background:hsla(0,0%,100%,.05);border-radius:8px;border:1px solid var(--acu-border,rgba(255,255,255,0.1));cursor:pointer;transition:background .1s,transform .1s;-webkit-user-select:none;user-select:none;touch-action:pan-y}.acu-option-row:hover{background:var(--acu-table-hover,rgba(255,255,255,0.1));border-color:var(--acu-highlight,#667eea)}.acu-option-row:active{transform:translateY(1px)}.acu-option-tags{display:flex;flex-wrap:wrap;gap:4px;max-width:35%;flex-shrink:0;margin-top:2px}.acu-option-tag{background:var(--acu-btn-bg,rgba(255,255,255,0.1));color:var(--acu-title-color,#fff);border:1px solid rgba(0,0,0,.1);opacity:.9;font-size:.85em;padding:2px 6px;border-radius:4px;line-height:1.3;font-weight:bold}.acu-option-text{flex:1;color:var(--acu-text-main,#333);font-weight:500;font-size:var(--acu-font-size,14px);line-height:1.5;word-break:break-word;white-space:pre-wrap}.acu-options-grid{display:flex;flex-direction:column;gap:12px}.acu-option-group{background:var(--acu-bg-elevated,#fff);border-radius:var(--acu-radius-md,8px);box-shadow:0 2px 8px rgba(0,0,0,.08);overflow:hidden}.acu-option-header{display:flex;align-items:center;gap:8px;padding:12px 16px;background:var(--acu-bg-header,rgba(0,0,0,0.02));cursor:pointer;transition:background .2s;-webkit-user-select:none;user-select:none}.acu-option-header:hover{background:var(--acu-hover-bg,rgba(0,0,0,0.05))}.acu-option-header>i:first-child{color:var(--acu-text-muted,#666);transition:transform .2s}.acu-option-header .acu-option-name{flex:1;font-weight:600;color:var(--acu-text-main,#333)}.acu-option-header .acu-btn-icon{padding:4px 6px;color:var(--acu-text-muted,#999)}.acu-option-header .acu-btn-icon:hover{color:var(--acu-highlight,#667eea)}.acu-option-content{padding:16px;border-top:1px solid var(--acu-border,rgba(0,0,0,0.05))}.acu-matrix-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:8px;margin-bottom:12px}.acu-matrix-cell{display:flex;align-items:center;justify-content:space-between;gap:4px;padding:10px 12px;background:var(--acu-bg-panel,rgba(0,0,0,0.03));border-radius:var(--acu-radius-sm,4px);cursor:pointer;transition:all .2s;border:2px solid rgba(0,0,0,0)}.acu-matrix-cell:hover{background:var(--acu-hover-bg,rgba(0,0,0,0.05))}.acu-matrix-cell.active{background:var(--acu-highlight-bg,rgba(102,126,234,0.15));border-color:var(--acu-highlight,#667eea)}.acu-matrix-cell.active .acu-matrix-label{color:var(--acu-highlight,#667eea);font-weight:600}.acu-matrix-cell.active i{color:var(--acu-highlight,#667eea)}.acu-matrix-cell.changed{box-shadow:0 0 0 2px var(--acu-warning,#f39c12)}.acu-matrix-cell.deleting{opacity:.5;text-decoration:line-through}.acu-matrix-label{font-size:calc(var(--acu-font-size,13px) - 1px);color:var(--acu-text-main,#333);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-option-list{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}.acu-option-actions{display:flex;gap:8px;flex-wrap:wrap;padding-top:12px;border-top:1px solid var(--acu-border,rgba(0,0,0,0.05))}.acu-sortable-list{display:flex;flex-direction:column;gap:4px}.acu-sortable-item{display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--acu-card-bg,rgba(255,255,255,0.05));border-radius:6px;cursor:pointer;transition:all .2s ease;border:1px solid rgba(0,0,0,0)}.acu-sortable-item:hover{background:var(--acu-hover-bg,rgba(255,255,255,0.1))}.acu-sortable-item.selected{background:var(--acu-selected-bg,rgba(52,152,219,0.2));border-color:var(--acu-primary-color,#3498db)}.acu-sort-controls{display:flex;flex-direction:column;gap:2px}.acu-sort-btn{display:flex;align-items:center;justify-content:center;width:20px;height:16px;padding:0;border:none;background:rgba(0,0,0,0);color:var(--acu-text-secondary,#999);cursor:pointer;transition:color .2s}.acu-sort-btn:hover:not(:disabled){color:var(--acu-primary-color,#3498db)}.acu-sort-btn:disabled{opacity:.3;cursor:not-allowed}.acu-sort-btn i{font-size:10px}.acu-item-content{flex:1;display:flex;align-items:center;gap:8px;min-width:0}.acu-item-content i{flex-shrink:0;width:16px;text-align:center;color:var(--acu-text-secondary,#999)}.acu-item-content span{font-size:13px;color:var(--acu-text-primary,#fff);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.acu-remove-btn{flex-shrink:0;display:flex;align-items:center;justify-content:center;width:24px;height:24px;padding:0;border:none;background:rgba(0,0,0,0);color:var(--acu-text-secondary,#999);cursor:pointer;border-radius:4px;transition:all .2s}.acu-remove-btn:hover{background:rgba(231,76,60,.2);color:#e74c3c}.acu-sortable-empty{padding:20px;text-align:center;color:var(--acu-text-secondary,#999);font-size:13px}.acu-tab-config-panel,.acu-button-config-panel{display:flex;flex-direction:column;gap:16px}.acu-config-header{display:flex;justify-content:space-between;align-items:center}.acu-config-header h3{margin:0;font-size:16px;font-weight:600;color:var(--acu-text-primary,#fff)}.acu-btn-text{display:flex;align-items:center;gap:4px;padding:4px 8px;border:none;background:rgba(0,0,0,0);color:var(--acu-text-secondary,#999);cursor:pointer;font-size:12px;border-radius:4px;transition:all .2s}.acu-btn-text:hover{background:var(--acu-hover-bg,rgba(255,255,255,0.1));color:var(--acu-text-primary,#fff)}.acu-config-section{display:flex;flex-direction:column;gap:8px}.acu-config-section h4{margin:0;font-size:13px;font-weight:500;color:var(--acu-text-secondary,#999)}.acu-config-hint{display:flex;align-items:center;gap:6px;padding:8px 12px;background:rgba(var(--acu-primary-rgb,52,152,219),0.1);border-radius:6px;font-size:12px;color:var(--acu-text-secondary,#999)}.acu-config-hint i{color:var(--acu-primary-color,#3498db)}.acu-tab-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;max-height:200px;overflow-y:auto;padding:4px}@media (max-width:480px){.acu-tab-grid{grid-template-columns:repeat(2,1fr)}}.acu-tab-grid-item{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;border:1px solid var(--acu-border-color,rgba(255,255,255,0.1));border-radius:6px;background:var(--acu-card-bg,rgba(255,255,255,0.05));color:var(--acu-text-primary,#fff);cursor:pointer;transition:all .2s;font-size:12px}.acu-tab-grid-item:hover{background:var(--acu-hover-bg,rgba(255,255,255,0.1));border-color:var(--acu-primary-color,#3498db)}.acu-tab-grid-item.selected{background:rgba(var(--acu-primary-rgb,52,152,219),0.2);border-color:var(--acu-primary-color,#3498db)}.acu-tab-grid-item.selected .fa-check{color:var(--acu-primary-color,#3498db)}.acu-tab-grid-item .tab-name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-tab-grid-item i{flex-shrink:0;font-size:10px}.acu-button-list{display:flex;flex-direction:column;gap:4px;max-height:240px;overflow-y:auto}.acu-button-item{display:flex;flex-direction:column;padding:10px 12px;border:1px solid var(--acu-border-color,rgba(255,255,255,0.1));border-radius:6px;background:var(--acu-card-bg,rgba(255,255,255,0.05));cursor:pointer;transition:all .2s}.acu-button-item:hover:not(.disabled){background:var(--acu-hover-bg,rgba(255,255,255,0.1));border-color:var(--acu-primary-color,#3498db)}.acu-button-item.selected{background:rgba(var(--acu-primary-rgb,52,152,219),0.15);border-color:var(--acu-primary-color,#3498db)}.acu-button-item.disabled{opacity:.6;cursor:not-allowed}.acu-button-item.disabled .button-main::after{content:"(必选)";font-size:10px;color:var(--acu-text-secondary,#999);margin-left:8px}.acu-button-item .button-main{display:flex;align-items:center;gap:10px}.acu-button-item .button-main>i:first-child{width:20px;text-align:center;color:var(--acu-text-secondary,#999)}.acu-button-item .button-main .button-label{flex:1;font-size:13px;color:var(--acu-text-primary,#fff)}.acu-button-item .button-main .check-icon{color:var(--acu-primary-color,#3498db);font-size:12px}.acu-button-item .button-hint{margin-top:4px;padding-left:30px;font-size:11px;color:var(--acu-text-secondary,#999)}.acu-button-item .button-hint span{background:hsla(0,0%,100%,.05);padding:2px 6px;border-radius:3px}.acu-modal-container{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw !important;height:100vh !important;z-index:2147483647;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);animation:acu-fadeIn .2s ease;pointer-events:auto !important}.acu-modal{position:relative;width:90%;max-width:500px;max-height:80vh;background:var(--acu-bg-panel);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;animation:acu-slideUp .3s ease}.acu-modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--acu-border);background:var(--acu-table-head)}.acu-modal-header h3{margin:0;font-size:16px;font-weight:600;color:var(--acu-text-main);display:flex;align-items:center;gap:8px}.acu-modal-header h3 i{color:var(--acu-highlight)}.acu-modal-close{width:32px;height:32px;display:flex;align-items:center;justify-content:center;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);font-size:18px;cursor:pointer;border-radius:8px;transition:all .2s ease}.acu-modal-close:hover{background:rgba(231,76,60,.15);color:#e74c3c}.acu-modal-body{flex:1;padding:20px;overflow-y:auto;overflow-x:hidden}.acu-modal-footer{display:flex;align-items:center;justify-content:flex-end;gap:12px;padding:16px 20px;border-top:1px solid var(--acu-border);background:var(--acu-bg-panel)}.acu-modal-btn{padding:10px 24px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.acu-modal-btn.primary{background:var(--acu-highlight);color:#fff}.acu-modal-btn.primary:hover{filter:brightness(1.1);transform:translateY(-1px)}.acu-modal-btn.secondary{background:var(--acu-btn-bg);color:var(--acu-text-main);border:1px solid var(--acu-border)}.acu-modal-btn.secondary:hover{background:var(--acu-btn-hover)}.acu-modal-btn.danger{background:#e74c3c;color:#fff}.acu-modal-btn.danger:hover{background:#c0392b}.acu-modal-btn:disabled{opacity:.5;cursor:not-allowed;transform:none !important}.acu-close-pill{background-color:var(--acu-text-main,#333) !important;color:var(--acu-bg-panel,#fff) !important;border:none !important;padding:6px 20px;border-radius:20px;font-weight:bold;font-size:13px;cursor:pointer;box-shadow:0 4px 10px var(--acu-highlight-bg,rgba(74,158,255,0.2));transition:transform .2s,filter .2s;display:inline-flex;align-items:center;justify-content:center;margin-left:auto}.acu-close-pill:hover{filter:brightness(0.85);transform:scale(1.05)}.acu-settings-modal{max-width:600px}.acu-settings-modal .acu-modal-body{padding:0}.acu-settings-section{padding:12px 16px}.acu-settings-section:first-child{padding-top:16px}.acu-settings-title{font-size:13px;font-weight:600;color:var(--acu-text-main);margin-bottom:8px;padding:0 4px;display:flex;align-items:center;gap:8px}.acu-settings-title i{color:var(--acu-text-main);font-size:14px}.acu-settings-group{padding:12px 16px;background:var(--acu-table-head);border-radius:12px;border:none}.acu-settings-row{display:flex;align-items:center;justify-content:space-between;padding:10px 0}.acu-settings-row:not(:last-child){border-bottom:1px solid var(--acu-border)}.acu-settings-label{font-size:13px;color:var(--acu-text-main);display:flex;flex-direction:column;gap:2px}.acu-settings-label .hint{font-size:11px;color:var(--acu-text-sub)}.acu-settings-control{display:flex;align-items:center;gap:8px}.acu-settings-control select,.acu-settings-control input[type=number],.acu-settings-control input[type=text]{padding:8px 12px;background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:6px;color:var(--acu-text-main);font-size:13px}.acu-settings-control select:focus,.acu-settings-control input[type=number]:focus,.acu-settings-control input[type=text]:focus{outline:none;border-color:var(--acu-highlight)}.acu-settings-control input[type=range]{width:120px;accent-color:var(--acu-highlight)}.acu-settings-control input[type=color]{width:36px;height:36px;padding:2px;border:2px solid var(--acu-border);border-radius:8px;cursor:pointer}.acu-settings-control input[type=color]::-webkit-color-swatch-wrapper{padding:0}.acu-settings-control input[type=color]::-webkit-color-swatch{border:none;border-radius:4px}.acu-switch{position:relative;width:44px;height:24px;background:var(--acu-btn-bg);border:none;border-radius:12px;cursor:pointer;transition:all .2s ease}.acu-switch::after{content:"";position:absolute;top:2px;left:2px;width:20px;height:20px;background:var(--acu-text-sub);border-radius:50%;transition:all .2s ease;box-shadow:0 1px 3px rgba(0,0,0,.2)}.acu-switch.active{background:var(--acu-text-main)}.acu-switch.active::after{left:calc(100% - 22px);background:var(--acu-bg-panel)}.acu-switch:hover{opacity:.9}.acu-color-picker-row .acu-settings-control{flex-shrink:0;width:50%;justify-content:flex-end}.acu-color-row{display:flex;align-items:center;gap:6px;flex-wrap:wrap;justify-content:flex-end}.acu-color-circle{width:22px;height:22px;border-radius:50%;cursor:pointer;transition:all .2s ease;border:2px solid rgba(0,0,0,0);box-shadow:0 1px 3px rgba(0,0,0,.15);flex-shrink:0}.acu-color-circle:hover{transform:scale(1.1)}.acu-color-circle.selected{border-color:rgba(0,0,0,0);box-shadow:inset 0 0 0 3px #fff,0 2px 4px rgba(0,0,0,.2);transform:scale(1.05)}.acu-nav-row{cursor:pointer;transition:background .2s ease}.acu-nav-row:hover{background:var(--acu-table-hover)}.acu-nav-row:active{opacity:.8}.acu-nav-row .acu-settings-control i.fa-chevron-right{font-size:12px;color:var(--acu-text-sub)}.acu-input-floor-modal{max-width:400px}.acu-input-floor-modal .floor-input-group{display:flex;flex-direction:column;gap:12px}.acu-input-floor-modal .floor-input{width:100%;padding:12px 16px;font-size:16px;text-align:center;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main)}.acu-input-floor-modal .floor-input:focus{outline:none;border-color:var(--acu-highlight)}.acu-input-floor-modal .floor-hint{font-size:12px;color:var(--acu-text-sub);text-align:center}.acu-purge-range-modal{max-width:450px}.acu-purge-range-modal .range-inputs{display:flex;align-items:center;gap:12px;margin-bottom:16px}.acu-purge-range-modal .range-inputs input{flex:1;padding:12px 16px;font-size:14px;text-align:center;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main)}.acu-purge-range-modal .range-inputs input:focus{outline:none;border-color:var(--acu-highlight)}.acu-purge-range-modal .range-inputs span{color:var(--acu-text-sub);font-size:16px}.acu-purge-range-modal .warning-box{display:flex;align-items:flex-start;gap:12px;padding:12px 16px;background:rgba(231,76,60,.1);border:1px solid rgba(231,76,60,.3);border-radius:8px;color:#e74c3c}.acu-purge-range-modal .warning-box i{font-size:18px;flex-shrink:0;margin-top:2px}.acu-purge-range-modal .warning-box p{margin:0;font-size:13px;line-height:1.5}.modal-enter-active,.modal-leave-active{transition:opacity .2s ease}.modal-enter-active .acu-modal,.modal-leave-active .acu-modal{transition:transform .3s cubic-bezier(0.4,0,0.2,1)}.modal-enter-from,.modal-leave-to{opacity:0}.modal-enter-from .acu-modal,.modal-leave-to .acu-modal{transform:scale(0.95) translateY(-20px)}@media (max-width:768px){.acu-modal-container{align-items:flex-end;justify-content:stretch}.acu-modal{width:100%;max-width:none;max-height:85vh;border-radius:20px 20px 0 0;margin:0}.acu-settings-modal{max-width:none;max-height:90vh}.modal-enter-from .acu-modal,.modal-leave-to .acu-modal{transform:translateY(100%)}.acu-modal-header{position:relative;padding-top:20px}.acu-modal-header::before{content:"";position:absolute;top:8px;left:50%;transform:translateX(-50%);width:36px;height:4px;background:var(--acu-border);border-radius:2px}.acu-modal-body{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch}}.floor-info{display:flex;align-items:center;gap:8px;padding:12px;background:var(--acu-table-head);border-radius:8px;font-size:13px;color:var(--acu-text-sub)}.floor-info i{color:var(--acu-highlight)}.floor-error{display:flex;align-items:center;gap:8px;padding:10px 12px;background:rgba(231,76,60,.1);border:1px solid rgba(231,76,60,.3);border-radius:8px;font-size:13px;color:#e74c3c}.acu-purge-overlay{display:flex !important;align-items:center !important;justify-content:center !important;padding-top:0 !important}.acu-purge-range-modal{width:85%;max-width:360px;height:auto;margin:0;box-shadow:0 25px 50px rgba(0,0,0,.5);overflow:visible;border-radius:16px;background:var(--acu-bg-panel)}.acu-purge-title{text-align:center;border-bottom:none;padding:25px 20px 0 20px;font-size:18px;font-weight:600;color:var(--acu-text-main)}.acu-purge-content{padding:20px 30px;display:flex;flex-direction:column;align-items:center;gap:15px}.acu-purge-icon{width:50px;height:50px;background:rgba(231,76,60,.15);color:#e74c3c;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;margin-bottom:5px}.acu-purge-hint{font-size:13px;color:var(--acu-text-sub);margin:0;text-align:center;line-height:1.4}.acu-purge-hint-sub{opacity:.7;font-size:12px}.acu-purge-inputs{display:flex;gap:10px;align-items:center;justify-content:center;width:100%}.acu-purge-input{text-align:center;font-size:20px;font-weight:bold;height:50px;width:100px;border-radius:12px;background:var(--acu-input-bg,var(--acu-btn-bg));border:2px solid var(--acu-border);color:var(--acu-text-main);transition:border-color .2s ease}.acu-purge-input:focus{outline:none;border-color:var(--acu-highlight)}.acu-purge-input::placeholder{color:var(--acu-text-sub);opacity:.5;font-weight:normal;font-size:14px}.acu-purge-input::-webkit-outer-spin-button,.acu-purge-input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.acu-purge-input[type=number]{-moz-appearance:textfield}.acu-purge-separator{font-weight:bold;color:var(--acu-text-main);font-size:18px}.acu-purge-btns{padding:0 20px 25px 20px;border-top:none;display:flex;justify-content:space-between;gap:10px}.acu-purge-btn{flex:1;display:flex;justify-content:center;align-items:center;padding:10px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;border:none;transition:all .2s ease}.acu-purge-btn-cancel{background:var(--acu-btn-bg);color:var(--acu-text-main)}.acu-purge-btn-cancel:hover{background:var(--acu-btn-hover)}.acu-purge-btn-confirm{background:#e74c3c;color:#fff}.acu-purge-btn-confirm:hover:not(:disabled){background:#c0392b}.acu-purge-btn-confirm:disabled{opacity:.5;cursor:not-allowed}.acu-settings-nav-group{margin-bottom:16px}.acu-settings-nav-item{display:flex;align-items:center;justify-content:space-between;width:100%;padding:12px 16px;margin-bottom:8px;background:var(--acu-card-bg,rgba(255,255,255,0.05));border:1px solid var(--acu-border-color,rgba(255,255,255,0.1));border-radius:8px;cursor:pointer;transition:all .2s ease;text-align:left;color:inherit}.acu-settings-nav-item:hover{background:var(--acu-hover-bg,rgba(255,255,255,0.1));border-color:var(--acu-primary-color,#4a9eff)}.acu-settings-nav-item:last-child{margin-bottom:0}.acu-settings-nav-item .nav-item-content{display:flex;align-items:center;gap:12px}.acu-settings-nav-item .nav-item-content>i{font-size:18px;color:var(--acu-primary-color,#4a9eff);width:24px;text-align:center}.acu-settings-nav-item .nav-item-text{display:flex;flex-direction:column;gap:2px}.acu-settings-nav-item .nav-item-label{font-size:14px;font-weight:500}.acu-settings-nav-item .nav-item-hint{font-size:12px;opacity:.6}.acu-settings-nav-item>i.fa-chevron-right{opacity:.4;font-size:12px}.acu-modal-back{display:flex;align-items:center;justify-content:center;width:32px;height:32px;margin-right:8px;background:rgba(0,0,0,0);border:none;border-radius:6px;cursor:pointer;color:inherit;opacity:.7;transition:all .2s ease}.acu-modal-back:hover{opacity:1;background:var(--acu-hover-bg,rgba(255,255,255,0.1))}.acu-modal-title{font-size:16px;font-weight:bold}.acu-bottom-spacer{height:80px;padding-bottom:30px;width:100%;text-align:center;color:var(--acu-text-sub,#999);font-size:10px;display:flex;align-items:center;justify-content:center;opacity:.5;flex-shrink:0}.acu-toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);z-index:2147483647;display:flex;align-items:center;gap:10px;padding:14px 24px;border-radius:12px;font-size:14px;font-weight:500;box-shadow:0 8px 32px rgba(0,0,0,.25);backdrop-filter:blur(10px);pointer-events:none}.acu-toast i{font-size:18px;flex-shrink:0}.acu-toast .acu-toast-message{max-width:300px;line-height:1.4}.acu-toast-success{background:linear-gradient(135deg,rgba(46,204,113,0.95),rgba(39,174,96,0.95));color:#fff}.acu-toast-error{background:linear-gradient(135deg,rgba(231,76,60,0.95),rgba(192,57,43,0.95));color:#fff}.acu-toast-warning{background:linear-gradient(135deg,rgba(241,196,15,0.95),rgba(243,156,18,0.95));color:#2c3e50}.acu-toast-info{background:linear-gradient(135deg,rgba(52,152,219,0.95),rgba(41,128,185,0.95));color:#fff}.toast-enter-active,.toast-leave-active{transition:all .35s cubic-bezier(0.4,0,0.2,1)}.toast-enter-from{opacity:0;transform:translateX(-50%) translateY(-20px) scale(0.9)}.toast-leave-to{opacity:0;transform:translateX(-50%) translateY(-10px) scale(0.95)}.acu-manual-update-modal{max-width:400px;max-height:none;overflow:visible;margin-bottom:15vh}.acu-manual-update-modal .acu-modal-body{padding:0;overflow:visible}.acu-manual-update-modal .acu-settings-group{padding:12px 16px}.acu-manual-update-modal .acu-settings-row{padding:8px 0}.acu-loading-state{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;padding:48px 20px;color:var(--acu-text-sub)}.acu-loading-state i{font-size:24px;color:var(--acu-highlight)}.acu-loading-state span{font-size:14px}.acu-config-input{width:80px;padding:8px 12px;font-size:14px;text-align:center;background:var(--acu-btn-bg);border:2px solid var(--acu-border);border-radius:8px;color:var(--acu-text-main);transition:all .2s ease}.acu-config-input:focus{outline:none;border-color:var(--acu-highlight)}.acu-config-input:hover:not(:focus){border-color:var(--acu-text-sub)}.acu-config-input::-webkit-inner-spin-button,.acu-config-input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.acu-config-input{-moz-appearance:textfield}.acu-update-action-group{padding:12px 16px 16px;display:flex;flex-direction:column;align-items:center}.acu-update-btn{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;padding:14px 24px;font-size:15px;font-weight:600;color:var(--acu-text-main);background:var(--acu-btn-bg);border:1px solid var(--acu-border);border-radius:12px;cursor:pointer;transition:all .2s ease}.acu-update-btn i{font-size:18px;color:var(--acu-highlight)}.acu-update-btn:hover:not(:disabled){background:var(--acu-btn-hover);transform:translateY(-1px)}.acu-update-btn:active:not(:disabled){transform:translateY(0)}.acu-update-btn:disabled{opacity:.7;cursor:not-allowed}.acu-update-btn.is-updating{opacity:.7}.acu-update-hint{display:none;margin:0;font-size:12px;color:var(--acu-text-sub);text-align:center}@media (max-width:768px){.acu-manual-update-modal{max-width:none}.acu-manual-update-modal .acu-config-input{width:100px}.acu-update-btn{padding:16px 24px;font-size:16px}}.acu-cell-menu{position:fixed;z-index:2147483647;min-width:160px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,.25);padding:6px;animation:acu-scaleIn .15s ease;transform-origin:top left}.acu-cell-menu.from-right{transform-origin:top right}.acu-cell-menu.from-bottom{transform-origin:bottom left}.acu-cell-menu.from-right.from-bottom{transform-origin:bottom right}.acu-menu-item{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;font-size:13px;color:var(--acu-text-main);cursor:pointer;transition:all .15s ease;white-space:nowrap}.acu-menu-item i{width:16px;text-align:center;font-size:14px;color:var(--acu-text-sub);transition:color .15s ease}.acu-menu-item:hover{background:var(--acu-btn-hover)}.acu-menu-item:hover i{color:var(--acu-highlight)}.acu-menu-item:active{transform:scale(0.98)}.acu-menu-item.danger{color:#e74c3c}.acu-menu-item.danger i{color:#e74c3c}.acu-menu-item.danger:hover{background:rgba(231,76,60,.15)}.acu-menu-item.success{color:#27ae60}.acu-menu-item.success i{color:#27ae60}.acu-menu-item.success:hover{background:rgba(46,204,113,.15)}.acu-menu-item.disabled{opacity:.5;cursor:not-allowed;pointer-events:none}.acu-menu-divider{height:1px;background:var(--acu-border);margin:6px 8px}.acu-menu-group-title{padding:6px 14px;font-size:11px;font-weight:600;color:var(--acu-text-sub);text-transform:uppercase;letter-spacing:.5px}.acu-menu-arrow{margin-left:auto;font-size:10px;color:var(--acu-text-sub)}.acu-submenu{position:absolute;top:0;left:100%;margin-left:4px;min-width:140px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,.25);padding:6px;opacity:0;visibility:hidden;transform:translateX(-10px);transition:all .15s ease}.acu-submenu.from-right{left:auto;right:100%;margin-left:0;margin-right:4px;transform:translateX(10px)}.acu-menu-item.has-submenu{position:relative}.acu-menu-item.has-submenu:hover .acu-submenu{opacity:1;visibility:visible;transform:translateX(0)}.acu-menu-shortcut{margin-left:auto;font-size:11px;color:var(--acu-text-sub);opacity:.7}.acu-menu-checkbox{width:16px;height:16px;display:flex;align-items:center;justify-content:center;border:2px solid var(--acu-border);border-radius:4px;font-size:10px;color:rgba(0,0,0,0);transition:all .15s ease}.acu-menu-checkbox.checked{background:var(--acu-highlight);border-color:var(--acu-highlight);color:#fff}.acu-cell-menu.compact{padding:4px}.acu-cell-menu.compact .acu-menu-item{padding:8px 12px;font-size:12px}.acu-cell-menu.compact .acu-menu-item i{font-size:12px}.acu-context-menu{position:fixed;z-index:var(--acu-z-menu,2147483648);min-width:160px;max-width:220px;background:var(--acu-menu-bg,#fff);border:1px solid var(--acu-border,#dcd0c0);border-radius:var(--acu-radius-md,12px);box-shadow:0 4px 16px rgba(0,0,0,.15),0 0 1px rgba(0,0,0,.1);padding:6px 0;outline:none;overflow:hidden;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);pointer-events:auto !important}.acu-context-menu .acu-menu-item{display:flex;align-items:center;gap:12px;padding:10px 16px;cursor:pointer;color:var(--acu-menu-text,#333);font-size:var(--acu-font-size,13px);transition:background var(--acu-transition-fast,0.15s),color var(--acu-transition-fast,0.15s);-webkit-user-select:none;user-select:none}.acu-context-menu .acu-menu-item i{width:16px;text-align:center;color:var(--acu-text-sub,#999);font-size:14px;transition:color var(--acu-transition-fast,0.15s)}.acu-context-menu .acu-menu-item span{flex:1}.acu-context-menu .acu-menu-item:hover{background:var(--acu-table-hover,#f0ebe0)}.acu-context-menu .acu-menu-item:active{background:var(--acu-btn-hover,#cbbba8)}.acu-context-menu .acu-menu-item.acu-menu-danger{color:var(--acu-danger,#e74c3c)}.acu-context-menu .acu-menu-item.acu-menu-danger i{color:var(--acu-danger,#e74c3c)}.acu-context-menu .acu-menu-item.acu-menu-danger:hover{background:rgba(231,76,60,.1)}.acu-context-menu .acu-menu-item.acu-menu-warning{color:var(--acu-warning,#f39c12)}.acu-context-menu .acu-menu-item.acu-menu-warning i{color:var(--acu-warning,#f39c12)}.acu-context-menu .acu-menu-item.acu-menu-warning:hover{background:rgba(243,156,18,.1)}.acu-context-menu .acu-menu-divider{height:1px;background:var(--acu-border,#dcd0c0);margin:6px 12px;opacity:.6}.acu-menu-fade-enter-active,.acu-menu-fade-leave-active{transition:opacity .15s ease,transform .15s ease}.acu-menu-fade-enter-from,.acu-menu-fade-leave-to{opacity:0;transform:scale(0.95)}.acu-menu-fade-enter-to,.acu-menu-fade-leave-from{opacity:1;transform:scale(1)}.acu-quick-view{position:fixed;z-index:2147483646;min-width:280px;max-width:400px;max-height:60vh;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,.3);overflow:hidden;animation:acu-fadeIn .2s ease}.acu-quick-view::before{content:"";position:absolute;width:12px;height:12px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-right:none;border-bottom:none;transform:rotate(45deg)}.acu-quick-view.arrow-left::before{left:-7px;top:20px}.acu-quick-view.arrow-right::before{right:-7px;top:20px;transform:rotate(-135deg)}.acu-quick-view.arrow-top::before{top:-7px;left:20px}.acu-quick-view.arrow-bottom::before{bottom:-7px;left:20px;transform:rotate(-135deg)}.acu-quick-view-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:var(--acu-table-head);border-bottom:1px solid var(--acu-border)}.acu-quick-view-header .title{font-size:14px;font-weight:600;color:var(--acu-text-main);display:flex;align-items:center;gap:8px}.acu-quick-view-header .title i{color:var(--acu-highlight)}.acu-quick-view-header .close-btn{width:24px;height:24px;display:flex;align-items:center;justify-content:center;border:none;background:rgba(0,0,0,0);color:var(--acu-text-sub);font-size:14px;cursor:pointer;border-radius:6px;transition:all .15s ease}.acu-quick-view-header .close-btn:hover{background:rgba(231,76,60,.15);color:#e74c3c}.acu-quick-view-content{padding:16px;overflow-y:auto;max-height:calc(60vh - 50px)}.acu-quick-view-item{display:flex;flex-direction:column;gap:4px;padding:10px 0}.acu-quick-view-item:not(:last-child){border-bottom:1px solid var(--acu-border)}.acu-quick-view-item .label{font-size:11px;color:var(--acu-text-sub);text-transform:uppercase;letter-spacing:.5px}.acu-quick-view-item .value{font-size:14px;color:var(--acu-text-main);word-break:break-word;line-height:1.5}.acu-quick-view-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.acu-quick-view-grid .acu-quick-view-item{padding:8px 12px;background:var(--acu-btn-bg);border-radius:8px;border-bottom:none}.acu-quick-view-actions{display:flex;gap:8px;padding:12px 16px;border-top:1px solid var(--acu-border);background:var(--acu-bg-panel)}.acu-quick-view-btn{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:8px 16px;border:none;border-radius:8px;font-size:12px;cursor:pointer;transition:all .15s ease}.acu-quick-view-btn.primary{background:var(--acu-highlight);color:#fff}.acu-quick-view-btn.primary:hover{filter:brightness(1.1)}.acu-quick-view-btn.secondary{background:var(--acu-btn-bg);color:var(--acu-text-main);border:1px solid var(--acu-border)}.acu-quick-view-btn.secondary:hover{background:var(--acu-btn-hover)}.acu-quick-view-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:var(--acu-text-sub)}.acu-quick-view-loading .spinner{width:32px;height:32px;border:3px solid var(--acu-border);border-top-color:var(--acu-highlight);border-radius:50%;animation:acu-spin .8s linear infinite;margin-bottom:12px}.acu-quick-view-loading .text{font-size:13px}.acu-quick-view-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 20px;color:var(--acu-text-sub);text-align:center}.acu-quick-view-empty i{font-size:32px;margin-bottom:12px;opacity:.5}.acu-quick-view-empty .text{font-size:13px}.acu-edit-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:2147483645;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);animation:acu-fadeIn .2s ease}.acu-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:2147483640;background:rgba(0,0,0,.4);animation:acu-fadeIn .15s ease}.acu-overlay.transparent{background:rgba(0,0,0,0)}.acu-overlay.light{background:hsla(0,0%,100%,.3)}.acu-overlay.blur{backdrop-filter:blur(4px)}.acu-loading-overlay{position:absolute;top:0;left:0;right:0;bottom:0;z-index:100;display:flex;flex-direction:column;align-items:center;justify-content:center;background:rgba(var(--acu-bg-panel-rgb),0.9);backdrop-filter:blur(4px)}.acu-loading-overlay .spinner{width:40px;height:40px;border:4px solid var(--acu-border);border-top-color:var(--acu-highlight);border-radius:50%;animation:acu-spin .8s linear infinite;margin-bottom:16px}.acu-loading-overlay .text{font-size:14px;color:var(--acu-text-main)}.acu-loading-overlay .progress{width:200px;height:4px;background:var(--acu-border);border-radius:2px;margin-top:12px;overflow:hidden}.acu-loading-overlay .progress .bar{height:100%;background:var(--acu-highlight);border-radius:2px;transition:width .3s ease}.acu-saving-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:2147483648;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);backdrop-filter:blur(4px)}.acu-saving-overlay .saving-content{display:flex;flex-direction:column;align-items:center;padding:32px 48px;background:var(--acu-bg-panel);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.3)}.acu-saving-overlay .saving-content .spinner{width:48px;height:48px;border:4px solid var(--acu-border);border-top-color:var(--acu-highlight);border-radius:50%;animation:acu-spin .8s linear infinite;margin-bottom:16px}.acu-saving-overlay .saving-content .text{font-size:16px;font-weight:500;color:var(--acu-text-main)}.acu-saving-overlay .saving-content .subtext{font-size:12px;color:var(--acu-text-sub);margin-top:8px}.acu-toast-overlay{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);z-index:2147483649;display:flex;flex-direction:column;align-items:center;gap:8px;pointer-events:none}.acu-toast{display:flex;align-items:center;gap:10px;padding:12px 20px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,.25);font-size:13px;color:var(--acu-text-main);animation:acu-slideUp .3s ease;pointer-events:auto}.acu-toast i{font-size:16px}.acu-toast.success{border-color:rgba(46,204,113,.3)}.acu-toast.success i{color:#27ae60}.acu-toast.error{border-color:rgba(231,76,60,.3)}.acu-toast.error i{color:#e74c3c}.acu-toast.warning{border-color:rgba(241,196,15,.3)}.acu-toast.warning i{color:#f39c12}.acu-toast.info{border-color:rgba(52,152,219,.3)}.acu-toast.info i{color:#3498db}.acu-confirm-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:2147483647;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);animation:acu-fadeIn .2s ease}.acu-confirm-dialog{width:90%;max-width:360px;background:var(--acu-bg-panel);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.3);overflow:hidden;animation:acu-scaleIn .2s ease}.acu-confirm-dialog .confirm-header{padding:20px 20px 0;text-align:center}.acu-confirm-dialog .confirm-header i{font-size:48px;margin-bottom:12px}.acu-confirm-dialog .confirm-header i.warning{color:#f39c12}.acu-confirm-dialog .confirm-header i.danger{color:#e74c3c}.acu-confirm-dialog .confirm-header i.info{color:#3498db}.acu-confirm-dialog .confirm-header h4{margin:0;font-size:18px;font-weight:600;color:var(--acu-text-main)}.acu-confirm-dialog .confirm-body{padding:16px 20px;text-align:center}.acu-confirm-dialog .confirm-body p{margin:0;font-size:14px;color:var(--acu-text-sub);line-height:1.6}.acu-confirm-dialog .confirm-footer{display:flex;border-top:1px solid var(--acu-border)}.acu-confirm-dialog .confirm-footer button{flex:1;padding:14px;border:none;background:rgba(0,0,0,0);font-size:14px;font-weight:500;cursor:pointer;transition:all .15s ease}.acu-confirm-dialog .confirm-footer button:first-child{color:var(--acu-text-sub);border-right:1px solid var(--acu-border)}.acu-confirm-dialog .confirm-footer button:first-child:hover{background:var(--acu-btn-hover)}.acu-confirm-dialog .confirm-footer button:last-child{color:var(--acu-highlight)}.acu-confirm-dialog .confirm-footer button:last-child:hover{background:rgba(var(--acu-highlight-rgb),0.1)}.acu-confirm-dialog .confirm-footer button:last-child.danger{color:#e74c3c}.acu-confirm-dialog .confirm-footer button:last-child.danger:hover{background:rgba(231,76,60,.1)}.acu-feedback-success{animation:acu-success-flash .5s ease}@keyframes acu-success-flash{0%,100%{box-shadow:none}50%{box-shadow:0 0 0 3px rgba(46,204,113,.4)}}.acu-feedback-error{animation:acu-error-shake .4s ease}@keyframes acu-error-shake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-5px)}40%,80%{transform:translateX(5px)}}.acu-feedback-warning{animation:acu-warning-pulse .6s ease}@keyframes acu-warning-pulse{0%,100%{box-shadow:none}50%{box-shadow:0 0 0 3px rgba(241,196,15,.4)}}.acu-ripple{position:relative;overflow:hidden}.acu-ripple::after{content:"";position:absolute;top:50%;left:50%;width:0;height:0;background:hsla(0,0%,100%,.3);border-radius:50%;transform:translate(-50%,-50%);opacity:0}.acu-ripple:active::after{width:200px;height:200px;opacity:0;transition:width .3s ease,height .3s ease,opacity .3s ease}.acu-dragging{opacity:.8;transform:scale(1.02);box-shadow:0 8px 24px rgba(0,0,0,.2);cursor:grabbing !important;z-index:1000}.acu-drag-over{background:rgba(var(--acu-highlight-rgb),0.1);border:2px dashed var(--acu-highlight)}.acu-saving{position:relative;pointer-events:none}.acu-saving::after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:hsla(0,0%,100%,.5);z-index:10}.acu-changed{position:relative}.acu-changed::before{content:"";position:absolute;top:4px;right:4px;width:8px;height:8px;background:var(--acu-highlight);border-radius:50%;animation:acu-pulse 1.5s infinite}.acu-new-item{animation:acu-new-highlight 1s ease}@keyframes acu-new-highlight{0%{background:rgba(var(--acu-highlight-rgb),0.3)}100%{background:rgba(0,0,0,0)}}.acu-delete-confirm{background:rgba(231,76,60,.1) !important;border-color:rgba(231,76,60,.3) !important}.acu-selected{background:rgba(var(--acu-highlight-rgb),0.1);border-color:var(--acu-highlight);box-shadow:0 0 0 2px rgba(var(--acu-highlight-rgb),0.2)}.acu-focused{outline:none;border-color:var(--acu-highlight);box-shadow:0 0 0 3px rgba(var(--acu-highlight-rgb),0.15)}.acu-disabled{opacity:.5;pointer-events:none;cursor:not-allowed}.acu-readonly{background:var(--acu-btn-bg);cursor:default}.acu-readonly input,.acu-readonly textarea,.acu-readonly select{pointer-events:none}.acu-skeleton{background:linear-gradient(90deg,var(--acu-btn-bg) 25%,var(--acu-btn-hover) 50%,var(--acu-btn-bg) 75%);background-size:200% 100%;animation:acu-skeleton-loading 1.5s infinite}@keyframes acu-skeleton-loading{0%{background-position:200% 0}100%{background-position:-200% 0}}.acu-data-updated{animation:acu-data-flash .8s ease}@keyframes acu-data-flash{0%,100%{background:rgba(0,0,0,0)}30%{background:rgba(var(--acu-highlight-rgb),0.3)}}.acu-tooltip{position:relative}.acu-tooltip::before{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translateX(-50%) translateY(-8px);padding:6px 12px;background:var(--acu-bg-panel);border:1px solid var(--acu-border);border-radius:8px;font-size:12px;color:var(--acu-text-main);white-space:nowrap;opacity:0;visibility:hidden;transition:all .2s ease;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:1000}.acu-tooltip:hover::before{opacity:1;visibility:visible;transform:translateX(-50%) translateY(-4px)}.acu-progress-indicator{position:relative}.acu-progress-indicator::after{content:"";position:absolute;bottom:0;left:0;height:3px;background:var(--acu-highlight);width:var(--progress,0%);transition:width .3s ease}.acu-hidden{display:none !important}.acu-invisible{visibility:hidden !important}.acu-sr-only{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0,0,0,0) !important;white-space:nowrap !important;border:0 !important}.acu-text-truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.acu-text-wrap{word-wrap:break-word;word-break:break-word}.acu-text-center{text-align:center}.acu-text-left{text-align:left}.acu-text-right{text-align:right}.acu-text-uppercase{text-transform:uppercase}.acu-text-lowercase{text-transform:lowercase}.acu-text-capitalize{text-transform:capitalize}.acu-text-main{color:var(--acu-text-main)}.acu-text-sub{color:var(--acu-text-sub)}.acu-text-highlight{color:var(--acu-highlight)}.acu-text-success{color:#27ae60}.acu-text-warning{color:#f39c12}.acu-text-danger{color:#e74c3c}.acu-text-info{color:#3498db}.acu-flex{display:flex}.acu-flex-inline{display:inline-flex}.acu-flex-row{flex-direction:row}.acu-flex-col{flex-direction:column}.acu-flex-wrap{flex-wrap:wrap}.acu-flex-nowrap{flex-wrap:nowrap}.acu-flex-1{flex:1}.acu-flex-auto{flex:auto}.acu-flex-none{flex:none}.acu-items-start{align-items:flex-start}.acu-items-center{align-items:center}.acu-items-end{align-items:flex-end}.acu-items-stretch{align-items:stretch}.acu-justify-start{justify-content:flex-start}.acu-justify-center{justify-content:center}.acu-justify-end{justify-content:flex-end}.acu-justify-between{justify-content:space-between}.acu-justify-around{justify-content:space-around}.acu-gap-0{gap:0px}.acu-m-0{margin:0px}.acu-mt-0{margin-top:0px}.acu-mr-0{margin-right:0px}.acu-mb-0{margin-bottom:0px}.acu-ml-0{margin-left:0px}.acu-mx-0{margin-left:0px;margin-right:0px}.acu-my-0{margin-top:0px;margin-bottom:0px}.acu-p-0{padding:0px}.acu-pt-0{padding-top:0px}.acu-pr-0{padding-right:0px}.acu-pb-0{padding-bottom:0px}.acu-pl-0{padding-left:0px}.acu-px-0{padding-left:0px;padding-right:0px}.acu-py-0{padding-top:0px;padding-bottom:0px}.acu-gap-1{gap:4px}.acu-m-1{margin:4px}.acu-mt-1{margin-top:4px}.acu-mr-1{margin-right:4px}.acu-mb-1{margin-bottom:4px}.acu-ml-1{margin-left:4px}.acu-mx-1{margin-left:4px;margin-right:4px}.acu-my-1{margin-top:4px;margin-bottom:4px}.acu-p-1{padding:4px}.acu-pt-1{padding-top:4px}.acu-pr-1{padding-right:4px}.acu-pb-1{padding-bottom:4px}.acu-pl-1{padding-left:4px}.acu-px-1{padding-left:4px;padding-right:4px}.acu-py-1{padding-top:4px;padding-bottom:4px}.acu-gap-2{gap:8px}.acu-m-2{margin:8px}.acu-mt-2{margin-top:8px}.acu-mr-2{margin-right:8px}.acu-mb-2{margin-bottom:8px}.acu-ml-2{margin-left:8px}.acu-mx-2{margin-left:8px;margin-right:8px}.acu-my-2{margin-top:8px;margin-bottom:8px}.acu-p-2{padding:8px}.acu-pt-2{padding-top:8px}.acu-pr-2{padding-right:8px}.acu-pb-2{padding-bottom:8px}.acu-pl-2{padding-left:8px}.acu-px-2{padding-left:8px;padding-right:8px}.acu-py-2{padding-top:8px;padding-bottom:8px}.acu-gap-3{gap:12px}.acu-m-3{margin:12px}.acu-mt-3{margin-top:12px}.acu-mr-3{margin-right:12px}.acu-mb-3{margin-bottom:12px}.acu-ml-3{margin-left:12px}.acu-mx-3{margin-left:12px;margin-right:12px}.acu-my-3{margin-top:12px;margin-bottom:12px}.acu-p-3{padding:12px}.acu-pt-3{padding-top:12px}.acu-pr-3{padding-right:12px}.acu-pb-3{padding-bottom:12px}.acu-pl-3{padding-left:12px}.acu-px-3{padding-left:12px;padding-right:12px}.acu-py-3{padding-top:12px;padding-bottom:12px}.acu-gap-4{gap:16px}.acu-m-4{margin:16px}.acu-mt-4{margin-top:16px}.acu-mr-4{margin-right:16px}.acu-mb-4{margin-bottom:16px}.acu-ml-4{margin-left:16px}.acu-mx-4{margin-left:16px;margin-right:16px}.acu-my-4{margin-top:16px;margin-bottom:16px}.acu-p-4{padding:16px}.acu-pt-4{padding-top:16px}.acu-pr-4{padding-right:16px}.acu-pb-4{padding-bottom:16px}.acu-pl-4{padding-left:16px}.acu-px-4{padding-left:16px;padding-right:16px}.acu-py-4{padding-top:16px;padding-bottom:16px}.acu-gap-5{gap:20px}.acu-m-5{margin:20px}.acu-mt-5{margin-top:20px}.acu-mr-5{margin-right:20px}.acu-mb-5{margin-bottom:20px}.acu-ml-5{margin-left:20px}.acu-mx-5{margin-left:20px;margin-right:20px}.acu-my-5{margin-top:20px;margin-bottom:20px}.acu-p-5{padding:20px}.acu-pt-5{padding-top:20px}.acu-pr-5{padding-right:20px}.acu-pb-5{padding-bottom:20px}.acu-pl-5{padding-left:20px}.acu-px-5{padding-left:20px;padding-right:20px}.acu-py-5{padding-top:20px;padding-bottom:20px}.acu-gap-6{gap:24px}.acu-m-6{margin:24px}.acu-mt-6{margin-top:24px}.acu-mr-6{margin-right:24px}.acu-mb-6{margin-bottom:24px}.acu-ml-6{margin-left:24px}.acu-mx-6{margin-left:24px;margin-right:24px}.acu-my-6{margin-top:24px;margin-bottom:24px}.acu-p-6{padding:24px}.acu-pt-6{padding-top:24px}.acu-pr-6{padding-right:24px}.acu-pb-6{padding-bottom:24px}.acu-pl-6{padding-left:24px}.acu-px-6{padding-left:24px;padding-right:24px}.acu-py-6{padding-top:24px;padding-bottom:24px}.acu-gap-7{gap:28px}.acu-m-7{margin:28px}.acu-mt-7{margin-top:28px}.acu-mr-7{margin-right:28px}.acu-mb-7{margin-bottom:28px}.acu-ml-7{margin-left:28px}.acu-mx-7{margin-left:28px;margin-right:28px}.acu-my-7{margin-top:28px;margin-bottom:28px}.acu-p-7{padding:28px}.acu-pt-7{padding-top:28px}.acu-pr-7{padding-right:28px}.acu-pb-7{padding-bottom:28px}.acu-pl-7{padding-left:28px}.acu-px-7{padding-left:28px;padding-right:28px}.acu-py-7{padding-top:28px;padding-bottom:28px}.acu-gap-8{gap:32px}.acu-m-8{margin:32px}.acu-mt-8{margin-top:32px}.acu-mr-8{margin-right:32px}.acu-mb-8{margin-bottom:32px}.acu-ml-8{margin-left:32px}.acu-mx-8{margin-left:32px;margin-right:32px}.acu-my-8{margin-top:32px;margin-bottom:32px}.acu-p-8{padding:32px}.acu-pt-8{padding-top:32px}.acu-pr-8{padding-right:32px}.acu-pb-8{padding-bottom:32px}.acu-pl-8{padding-left:32px}.acu-px-8{padding-left:32px;padding-right:32px}.acu-py-8{padding-top:32px;padding-bottom:32px}.acu-w-full{width:100%}.acu-h-full{height:100%}.acu-w-auto{width:auto}.acu-h-auto{height:auto}.acu-min-w-0{min-width:0}.acu-min-h-0{min-height:0}.acu-max-w-full{max-width:100%}.acu-max-h-full{max-height:100%}.acu-relative{position:relative}.acu-absolute{position:absolute}.acu-fixed{position:fixed}.acu-sticky{position:sticky}.acu-inset-0{top:0;right:0;bottom:0;left:0}.acu-overflow-auto{overflow:auto}.acu-overflow-hidden{overflow:hidden}.acu-overflow-scroll{overflow:scroll}.acu-overflow-x-auto{overflow-x:auto}.acu-overflow-y-auto{overflow-y:auto}.acu-overflow-x-hidden{overflow-x:hidden}.acu-overflow-y-hidden{overflow-y:hidden}.acu-scrollbar{scrollbar-width:thin;scrollbar-color:var(--acu-scrollbar-thumb) var(--acu-scrollbar-track)}.acu-scrollbar::-webkit-scrollbar{width:6px;height:6px}.acu-scrollbar::-webkit-scrollbar-track{background:var(--acu-scrollbar-track);border-radius:3px}.acu-scrollbar::-webkit-scrollbar-thumb{background:var(--acu-scrollbar-thumb);border-radius:3px}.acu-scrollbar::-webkit-scrollbar-thumb:hover{background:var(--acu-scrollbar-thumb-hover)}.acu-scrollbar-hidden{scrollbar-width:none;-ms-overflow-style:none}.acu-scrollbar-hidden::-webkit-scrollbar{display:none}.acu-rounded-none{border-radius:0}.acu-rounded-sm{border-radius:4px}.acu-rounded{border-radius:8px}.acu-rounded-lg{border-radius:12px}.acu-rounded-xl{border-radius:16px}.acu-rounded-full{border-radius:9999px}.acu-border{border:1px solid var(--acu-border)}.acu-border-t{border-top:1px solid var(--acu-border)}.acu-border-r{border-right:1px solid var(--acu-border)}.acu-border-b{border-bottom:1px solid var(--acu-border)}.acu-border-l{border-left:1px solid var(--acu-border)}.acu-border-none{border:none}.acu-shadow-none{box-shadow:none}.acu-shadow-sm{box-shadow:0 1px 2px rgba(0,0,0,.1)}.acu-shadow{box-shadow:0 2px 8px rgba(0,0,0,.15)}.acu-shadow-lg{box-shadow:0 8px 24px rgba(0,0,0,.2)}.acu-shadow-xl{box-shadow:0 16px 48px rgba(0,0,0,.25)}.acu-pointer-events-none{pointer-events:none}.acu-pointer-events-auto{pointer-events:auto}.acu-cursor-pointer{cursor:pointer}.acu-cursor-default{cursor:default}.acu-cursor-move{cursor:move}.acu-cursor-not-allowed{cursor:not-allowed}.acu-select-none{-webkit-user-select:none;user-select:none}.acu-select-text{-webkit-user-select:text;user-select:text}.acu-select-all{-webkit-user-select:all;user-select:all}.acu-transition{transition:all .2s ease}.acu-transition-fast{transition:all .1s ease}.acu-transition-slow{transition:all .3s ease}.acu-transition-none{transition:none}.acu-opacity-0{opacity:0}.acu-opacity-25{opacity:.25}.acu-opacity-50{opacity:.5}.acu-opacity-75{opacity:.75}.acu-opacity-100{opacity:1}',e.head.appendChild(r),o.value=r,console.info('[ACU Styles] Base styles injected')})(),l(),(()=>{const e=a(),o=`${ke}-dynamic-${t.value}`;e.getElementById(o)?.remove();const r=e.createElement('style');r.id=o,r.setAttribute('data-source','acu-visualizer'),e.head.appendChild(r),n.value=r,console.info('[ACU Styles] Dynamic styles element created')})(),s(),c.value=!0,console.info('[ACU Styles] Style system initialized'))};return(0,i.watch)(()=>e.config,e=>{c.value&&(s(),u(e.theme),d(e.layout))},{deep:!0}),(0,i.watch)(()=>e.config.fontFamily,e=>{c.value&&p(e)}),(0,i.onMounted)(()=>{m()}),(0,i.onUnmounted)(()=>{g()}),{isInitialized:c,init:m,cleanup:g,updateDynamicVariables:s,applyTheme:u,applyLayout:d,applyFont:p,applyAllStyles:()=>{s(),u(),d(),p()},baseStyleEl:o,dynamicStyleEl:n,fontStyleEl:r}}let Ve=null,Ee=null,ze=!1;function Be(){const e=ie(),a=xe();function t(){const{getDB:t}=te(),o=t();o?(ze=!1,o.registerTableUpdateCallback&&(Ve=()=>{if(ze)return;if(a.isEditingOrder||e.isSaving)return;const t=oe();t&&e.setStagedData(t)},o.registerTableUpdateCallback(Ve),console.info('[ACU] 已注册表格更新回调')),o.registerTableFillStartCallback&&(Ee=()=>{if(ze)return;if(e.diffMap&&e.diffMap.size>0)return void console.info('[ACU] 累积高亮：保留旧快照');const a=oe();a&&Object.keys(a).length>0&&(e.saveSnapshot(a),console.info('[ACU] 快照已更新'))},o.registerTableFillStartCallback(Ee),console.info('[ACU] 已注册表格填充回调 (高亮逻辑)'))):console.warn('[ACU] 数据库 API 未就绪，跳过回调注册')}function o(){ze=!0;const{getDB:e}=te(),a=e();if(a)try{a.registerTableUpdateCallback&&Ve&&('function'==typeof a.unregisterTableUpdateCallback&&a.unregisterTableUpdateCallback(Ve),Ve=null,console.info('[ACU] 已注销表格更新回调')),a.registerTableFillStartCallback&&Ee&&('function'==typeof a.unregisterTableFillStartCallback&&a.unregisterTableFillStartCallback(Ee),Ee=null,console.info('[ACU] 已注销表格填充回调'))}catch(e){console.warn('[ACU] 注销回调时出错:',e)}}return(0,i.onMounted)(()=>{t()}),(0,i.onUnmounted)(()=>{o()}),{registerCallbacks:t,unregisterCallbacks:o}}var Se=r(99);const Te='shujuku_v34_allSettings_v2',Ae=['acu_table_order','acu_reverse_tables','acu_table_heights','acu_active_tab','acu_ui_collapse','acu_pin','acu_table_styles','acu_win_config'];function Ue(){const e=ie(),a=ae();async function o(){const e=te().getDB();if(e&&e.syncWorldbookEntries)try{await e.syncWorldbookEntries({createIfNeeded:!0})}catch(e){console.warn('[ACU] Worldbook sync failed after save:',e)}else console.warn('[ACU] syncWorldbookEntries API not found, skipping sync.')}let n=null;function r(t=5e3){n&&(n(),n=null),n=function(e,a,t={}){const{debounce:o=0,maxWait:n,...r}=t;return N(e,a,{...r,eventFilter:v(o,{maxWait:n})})}(()=>e.tables,async()=>{if(e.hasChanges&&a.config.autoSave)try{console.info('[ACU] 自动保存触发...'),await e.saveToDatabase(),console.info('[ACU] 自动保存完成')}catch(e){console.error('[ACU] 自动保存失败:',e)}},{debounce:t,deep:!0}),console.info(`[ACU] 自动保存已启用，防抖延迟: ${t}ms`)}function i(){console.info('[ACU] 检查旧版本数据...');let e=!1;Ae.forEach(a=>{try{const t=localStorage.getItem(a);if(t){console.info(`[ACU] 发现旧版本数据: ${a}`),e=!0;try{const e=JSON.parse(t),a=Array.isArray(e)?'array':typeof e;console.info(`[ACU]   - 数据类型: ${a}`)}catch{console.info('[ACU]   - 数据类型: string')}}}catch(e){console.warn(`[ACU] 读取 ${a} 失败:`,e)}});try{localStorage.getItem(Te)&&(console.info('[ACU] 发现 V5 隔离设置数据'),e=!0)}catch{}e||console.info('[ACU] 未发现旧版本数据')}return{saveToDatabase:async function(a=null,n=!1,r=!1,i=-1){if(e.isSaving)return console.warn('[ACU] Save already in progress'),!1;let c=e.getStagedData();if(c||(c=a||oe()),!c)return console.warn('[ACU] 无数据可保存'),!1;const{$}=te(),l=$?.('#acu-btn-save-global, #acu-parent-container #acu-btn-save-global');let s='';try{e.isSaving=!0,!n&&l?.length&&(s=l.html(),l.html('<i class="fa-solid fa-spinner fa-spin"></i>').prop('disabled',!0));const a=await async function(a,n,r=-1){const i=t(a);if(n&&e.pendingDeletes.size>0)for(const a in i){if('mate'===a)continue;const t=i[a];if(!t||!t.name||!t.content)continue;const o=[t.content[0]];for(let a=1;a<t.content.length;a++){const n=a-1;e.pendingDeletes.has(`${t.name}-row-${n}`)||o.push(t.content[a])}t.content=o}try{let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern);let a='';try{let e=window.localStorage;if(!e.getItem(Te)&&window.parent)try{e=window.parent.localStorage}catch{}const t=e.getItem(Te);if(t){const e=JSON.parse(t);e.dataIsolationEnabled&&e.dataIsolationCode&&(a=e.dataIsolationCode)}}catch{}if(e&&e.chat&&e.chat.length>0){let o=null,n=-1;if(r>=0&&r<e.chat.length)n=r,o=e.chat[n];else{for(let a=e.chat.length-1;a>=0;a--)if(!e.chat[a].is_user&&e.chat[a].TavernDB_ACU_IsolatedData){n=a,o=e.chat[a];break}if(!o)for(let a=e.chat.length-1;a>=0;a--)if(!e.chat[a].is_user){n=a,o=e.chat[a];break}}if(o){let r=a;if(o.TavernDB_ACU_IsolatedData){const e=Object.keys(o.TavernDB_ACU_IsolatedData);e.length>0&&(r=e[0])}else o.TavernDB_ACU_IsolatedData={};o.TavernDB_ACU_IsolatedData[r]||(o.TavernDB_ACU_IsolatedData[r]={independentData:{},modifiedKeys:[],updateGroupKeys:[]});const c=o.TavernDB_ACU_IsolatedData[r];c.independentData||(c.independentData={});const l=Object.keys(i).filter(e=>e.startsWith('sheet_'));l.forEach(e=>{c.independentData[e]=t(i[e])});const s=c.modifiedKeys||[];if(c.modifiedKeys=[...new Set([...s,...l])],e.saveChat)return await e.saveChat(),{...i,_savedToFloor:n}}}}catch(e){throw console.error('[ACU] Core save error:',e),e}return await o(),i}(c,r,i);if(!n){const t=a?._savedToFloor;void 0!==t&&Se.toast.success(`已更新至第 ${t} 层 (覆盖旧数据)`);$(window.parent?.document||document).find('.acu-highlight-changed').removeClass('acu-highlight-changed'),l?.removeClass('acu-save-alert'),e.clearChanges(r),e.stagedData=null,a&&e.saveSnapshot(a)}return await o(),!0}catch(e){return console.error('[ACU] Save failed:',e),n||Se.toast.error('保存失败: '+e.message),!1}finally{setTimeout(()=>{e.isSaving=!1,!n&&l?.length&&l.html(s||'<i class="fa-solid fa-save"></i>').prop('disabled',!1)},100)}},syncWorldbook:o,saveSnapshot:function(a){e.saveSnapshot(a)},loadSnapshot:function(){return e.loadSnapshot()},clearSnapshot:function(){e.clearSnapshot()},purgeFloorRange:async function(a,t){if(e.isSaving)return;let n=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);if(!n&&window.top&&window.top.SillyTavern&&(n=window.top.SillyTavern),!n||!n.chat)return void Se.toast.error('无法连接到 SillyTavern 核心数据');const r=n.chat.length-1;if(a=Math.max(0,a),t=Math.min(r,t),isNaN(a)||isNaN(t)||a>t)Se.toast.warning('无效的楼层范围');else{e.isSaving=!0;try{console.log(`[ACU-Purge] 开始强力清洗楼层范围: ${a} - ${t}`);let r=0;const i=['TavernDB_ACU_Data','TavernDB_ACU_SummaryData','TavernDB_ACU_IndependentData','TavernDB_ACU_Identity','TavernDB_ACU_IsolatedData','TavernDB_ACU_ModifiedKeys','TavernDB_ACU_UpdateGroupKeys'];for(let e=a;e<=t;e++){const a=n.chat[e];if(!a)continue;let t=!1;for(const e of i)Object.prototype.hasOwnProperty.call(a,e)&&(delete a[e],t=!0);t&&r++}r>0?(n.saveChat&&await n.saveChat(),e.clearSnapshot(),e.clearChanges(!0),Se.toast.success(`已强力清除 ${r} 个楼层的数据，正在同步...`),await o()):Se.toast.info('指定范围内没有可清除的数据')}catch(e){console.error('[ACU] Purge Error:',e),Se.toast.error('清除失败: '+e.message)}finally{e.isSaving=!1}}},setupAutoSave:r,stopAutoSave:function(){n&&(n(),n=null,console.info('[ACU] 自动保存已停止'))},migrateLegacyData:i,initDataPersistence:async function(){console.info('[ACU] 初始化数据持久化...'),i(),await e.loadFromDatabase(),a.config.autoSave&&r(a.config.autoSaveDelay||5e3),console.info('[ACU] 数据持久化初始化完成')},getTableData:oe,dataStore:e}}function De(){const e='shujuku_v80_allSettings_v2';if(localStorage.getItem(e))return e;const a='shujuku_v70_allSettings_v2';if(localStorage.getItem(a))return a;return Object.keys(localStorage||{}).find(e=>/^shujuku_.*_allSettings_v2$/.test(e))||e}function Me(){try{const e=De(),a=localStorage.getItem(e);return a?JSON.parse(a):{}}catch(e){return console.warn('[ACU] 读取 localStorage 设置失败:',e),{}}}function _e(e){try{const a=De(),t=Me();localStorage.setItem(a,JSON.stringify({...t,...e}))}catch(e){console.warn('[ACU] 写入 localStorage 设置失败:',e)}}function Ie(){const{saveToDatabase:e,getTableData:a,saveSnapshot:t,loadSnapshot:o}=Ue(),n=ie();return{insertRow:async(t,o)=>{const n=a();if(!n)return;const r=n[t];if(!r?.content)return;const i=r.content,c=i[0]?i[0].length:2,l=new Array(c).fill('');c>0&&(l[0]=String(i.length)),i.splice(o+2,0,l),Se.toast.info('正在插入新行...'),await e(n,!1,!0)},copyContent:e=>{const a=window.parent||window;if(a.TavernHelper&&a.TavernHelper.triggerSlash)try{const t=e.replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\n/g,'\\n');return a.TavernHelper.triggerSlash(`/clipboard-set "${t}"`),void Se.toast.success('已复制')}catch(e){console.warn('酒馆复制接口失败',e)}const t=document.createElement('textarea');t.value=e,t.style.position='fixed',t.style.left='-9999px',document.body.appendChild(t),t.select();try{document.execCommand('copy'),Se.toast.success('已复制')}catch(a){prompt('请手动复制:',e)}document.body.removeChild(t)},toggleDelete:(e,a,t)=>{if(!t||!t.length){const{$}=te();if($){const o=$(window.parent.document).find(`.acu-editable-title[data-tname="${e}"][data-row="${a}"]`);o.length&&(t=o.closest('.acu-data-card'))}}if(!t||!t.find)return void console.warn('[ACU] toggleDelete failed: card element not found',{tableName:e,rowIdx:a});const o=`${e}-row-${a}`;n.isPendingDelete(o)?(n.toggleDelete(o),t.find('.acu-badge-pending').remove(),Se.toast.success('已取消删除')):(n.toggleDelete(o),0===t.find('.acu-badge-pending').length&&t.append('<div class="acu-badge-pending">待删除</div>'),Se.toast.warning('整行已标记为删除'))},setInput:e=>{const a=window.parent.document.getElementById('send_textarea'),t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(a){const o=a.value||'',n=o?o+' '+e:e;a.value=n,a.dispatchEvent(new Event('input',{bubbles:!0})),t||a.focus()}else console.warn('[ACU] 未找到输入框 #send_textarea')},editCell:(e,r,i)=>{const{tableKey:c,rowIdx:l,colIdx:s,$cell:u}=e,{$}=te(),d=i||document;let p=n.getStagedData();if(p||(p=a()),p||(p=o()),p){const e=p[c];e?.content&&e.content[l+1]&&(e.content[l+1][s]=r,n.setStagedData(p),t(p))}u.attr('data-val',encodeURIComponent(r)),u.data('val',encodeURIComponent(r));let g=u;u.hasClass('acu-grid-item')?g=u.find('.acu-grid-value'):u.hasClass('acu-full-item')&&(g=u.find('.acu-full-value'));const m=function(e){if(!e)return'';const a=String(e);return'True'===a||'Yes'===a||'完成'===a||'已完成'===a?'acu-badge-success':'False'===a||'No'===a||'失败'===a||'未完成'===a?'acu-badge-danger':'进行中'===a||'Doing'===a?'acu-badge-warning':/^\d+%$/.test(a)?'acu-badge-info':/^Lv\.?\d+$/i.test(a)?'acu-badge-primary':''}(r);m&&!u.hasClass('acu-editable-title')?g.html(`<span class="acu-badge ${m}">${r}</span>`):g.text(r),g.addClass('acu-highlight-changed'),u.hasClass('acu-editable-title')&&u.addClass('acu-highlight-changed'),n.updateCell(c,l,s,r);$(d).find('#acu-btn-save-global').addClass('acu-save-alert'),Se.toast.info('修改已暂存')}}}const $e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;const Pe={class:'acu-panel-content'},Fe={class:'acu-nav-actions-area'},je=['title','onClick','onMousedown','onTouchstartPassive'],Le=(0,i.defineComponent)({__name:'MainPanel',props:{title:{default:'ACU 可视化表格'},theme:{default:'retro'},layout:{default:'vertical'},isCollapsed:{type:Boolean,default:!1},isPinned:{type:Boolean,default:!1},isContentHidden:{type:Boolean,default:!1},lockPanel:{type:Boolean,default:!1},hasChanges:{type:Boolean,default:!1},panelType:{default:'normal'}},emits:['refresh','save','save-as','manual-update','purge','settings','open-native','toggle-pin','toggle','close','hide-content','height-change','width-change'],setup(e,{expose:a,emit:t}){const o=e,n=t,r=['save','refresh','settings','pin','toggle'],c=(0,i.computed)(()=>{const e=C.config.buttonOrder||J.map(e=>e.id),a=C.config.visibleButtons?.length>0?C.config.visibleButtons:r;return console.info('[ACU MainPanel] 计算可见按钮:',{order:e,visibleIds:a}),e.map(e=>J.find(a=>a.id===e)).filter(e=>!!e&&a.includes(e.id))}),l=(0,i.ref)(!1),s=e=>{const a=[];return'purge'===e&&a.push('acu-btn-danger'),'pin'===e&&(a.push('acu-btn-toggle'),o.isPinned&&a.push('active')),'save'===e&&o.hasChanges&&a.push('has-changes'),'refresh'===e&&l.value&&a.push('refreshing'),a},u=e=>{const a={};return'purge'===e&&(a.color='#e74c3c'),'pin'===e&&o.isPinned&&(a.color='var(--acu-highlight)',a.borderColor='var(--acu-highlight)',a.background='var(--acu-btn-hover)'),a};let d=null;const p=(0,i.ref)(!1),g=e=>{const a=J.find(a=>a.id===e);a?.longPress&&(p.value=!1,d=setTimeout(()=>{p.value=!0,f(a.longPress)},600))},m=()=>{d&&(clearTimeout(d),d=null)},f=e=>{switch(e){case'save':n('save');break;case'saveAs':n('save-as');break;case'refresh':n('refresh');break;case'manualUpdate':n('manual-update');break;case'purge':n('purge');break;case'pin':n('toggle-pin');break;case'toggle':n('toggle');break;case'settings':n('settings');break;case'openNative':n('open-native');break;default:console.warn(`[MainPanel] 未知的动作 ID: ${e}`)}},b=(0,i.ref)(),v=(0,i.ref)(),h=(0,i.ref)(),x=(0,i.ref)(),w=X('acu_win_config',{width:400,left:'50%',bottom:'50%',isCentered:!0});function y(){const e=w.value;if(e.isCentered)return;const{width:a,height:t}={width:window.parent?.innerWidth??window.innerWidth,height:window.parent?.innerHeight??window.innerHeight};let o=!1,n=e.left,r=e.bottom;if('number'==typeof e.left){const t=a-50;e.left<-200?(n=-200,o=!0):e.left>t&&(n=Math.max(0,t),o=!0)}if('number'==typeof e.bottom){const a=t-50;e.bottom<0?(r=0,o=!0):e.bottom>a&&(r=Math.max(0,a),o=!0)}o&&(console.info('[ACU MainPanel] 面板位置越界，已自动修正'),w.value={...e,left:n,bottom:r})}function k(e){if(o.lockPanel)return;if(e.target.closest('.acu-resize-handle, .acu-slider, input'))return;if(0!==e.button)return;const a=h.value;if(!a||!b.value)return;const t=e.clientX,n=e.clientY,r=b.value.getBoundingClientRect(),i=r.left,c=window.parent?.innerHeight??window.innerHeight,l=c-r.bottom;let s=!1,u=!1;const d=e=>{const a=e.originalEvent,o=a.clientX-t,r=a.clientY-n;if(!s&&(Math.abs(o)>5||Math.abs(r)>5)&&(s=!0,u=!0,w.value.isCentered=!1),s){e.preventDefault();let a=i+o,t=l-r;const n=(window.parent?.innerWidth??window.innerWidth)-50,s=c-50;a<-200&&(a=-200),a>n&&(a=n),t<0&&(t=0),t>s&&(t=s),w.value.left=a,w.value.bottom=t}},p=()=>{if($('body').off('pointermove',d),$('body').off('pointerup',p),u){const e=t=>{t.stopPropagation(),t.preventDefault(),a.removeEventListener('click',e,!0)};a.addEventListener('click',e,!0),console.info('[ACU MainPanel] 面板位置已更新')}};$('body').on('pointermove',d),$('body').on('pointerup',p)}(0,i.watchEffect)(()=>{if(!b.value)return;const e=w.value,a=b.value;if(e.width&&a.style.setProperty('--acu-win-width',`${e.width}px`),void 0!==e.left){const t='number'==typeof e.left?`${e.left}px`:e.left;a.style.setProperty('--acu-win-left',t)}if(void 0!==e.bottom){const t='number'==typeof e.bottom?`${e.bottom}px`:e.bottom;a.style.setProperty('--acu-win-bottom',t)}e.isCentered?a.style.transform='translate(-50%, 50%)':a.style.transform=''});const C=ae(),N=(0,i.ref)(),V=(0,i.ref)(!1),E=(0,i.ref)(0),B=(0,i.computed)(()=>o.panelType),S=(0,i.computed)(()=>C.config.showPagination);(0,i.onMounted)(()=>{y();const e=h.value;e&&(e.addEventListener('pointerdown',k),console.info('[ACU MainPanel] 导航栏拖拽事件已绑定'));const a=x.value;a&&(a.addEventListener('pointerdown',D),console.info('[ACU MainPanel] 宽度调节事件已绑定'))}),(0,i.onUnmounted)(()=>{const e=h.value;e&&e.removeEventListener('pointerdown',k);const a=x.value;a&&a.removeEventListener('pointerdown',D)}),A(window.parent??window,'resize',()=>{y()});const{height:T,recalculate:U}=function(e,a,t,o={}){const{minHeight:n=200,maxHeightRatio:r=.8,headerHeight:c=42,paginationHeight:l=56,contentPadding:s=25,onHeightChange:u}=o,d=(0,i.ref)(n),p=()=>window.parent&&window.parent!==window?window.parent.innerHeight:window.innerHeight,g=()=>p()*r,m=()=>'string'==typeof a?a:a.value,f=()=>'boolean'==typeof t?t:t.value;W(e,e=>{const a=e[0];if(!a)return;if('dashboard'===m()){const e=g();return console.info('[ACU useSmartHeight] 仪表盘高度计算:',{maxH:e,parentHeight:p(),ratio:r}),d.value=e,void u?.(e)}const t=a.contentRect.height,o=f()?l:0,i=c+t+s+o,b=g(),v=Math.max(n,Math.min(i,b));d.value=v,u?.(v)}),'string'!=typeof a&&(0,i.watch)(a,e=>{if('dashboard'===e){const e=g();console.info('[ACU useSmartHeight] 切换到仪表盘，设置高度:',e),d.value=e,u?.(e)}}),'boolean'!=typeof t&&(0,i.watch)(t,()=>{if(e.value){const a=e.value.scrollHeight;if('dashboard'!==m()){const e=f()?l:0,t=c+a+s+e,o=g(),r=Math.max(n,Math.min(t,o));d.value=r,u?.(r)}}});const b=(0,i.computed)(()=>({height:`${d.value}px`,maxHeight:`${g()}px`}));return{height:d,heightStyle:b,maxHeight:(0,i.computed)(()=>g()),reset:()=>{d.value=n,u?.(n)},maximize:()=>{const e=g();d.value=e,u?.(e)},recalculate:()=>{if(e.value)if('dashboard'===m()){const e=g();d.value=e,u?.(e)}else{const a=e.value.scrollHeight,t=f()?l:0,o=c+a+s+t,r=g(),i=Math.max(n,Math.min(o,r));d.value=i,u?.(i)}}}}(N,B,S,{minHeight:200,maxHeightRatio:.8,headerHeight:42,paginationHeight:56,contentPadding:25,onHeightChange:e=>{!V.value&&v.value&&(E.value=e,n('height-change',e))}});function D(e){if(0!==e.button)return;e.preventDefault(),e.stopPropagation();if(!x.value||!b.value)return;const a=e.clientX,t=b.value.getBoundingClientRect().width,o=e=>{const o=e.originalEvent.clientX-a;let r=t+o;const i=(window.parent?.innerWidth??window.innerWidth)-10;r<300&&(r=300),r>i&&(r=i),w.value.width=r,n('width-change',r)},r=()=>{$('body').off('pointermove',o),$('body').off('pointerup',r),console.info('[ACU MainPanel] 宽度已更新:',w.value.width)};$('body').on('pointermove',o),$('body').on('pointerup',r)}return a({getPanelElement:()=>b.value,getDataAreaElement:()=>v.value,getCurrentHeight:()=>E.value,resetPosition:()=>{w.value={width:400,left:'50%',bottom:'50%',isCentered:!0}},resetHeight:()=>{if(!v.value)return;V.value=!1;const e=.8*(window.parent?.innerHeight??window.innerHeight);v.value.style.height;v.value.style.height='auto',v.value.style.maxHeight='none';const a=v.value.scrollHeight,t=Math.max(200,Math.min(a,e));v.value.style.height=`${t}px`,v.value.style.maxHeight='',E.value=t,console.info(`[ACU] 高度已重置: natural=${a}, final=${t}, max=${e}`),n('height-change',t)},recalculateHeight:U}),(a,t)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{ref_key:'panelRef',ref:b,class:(0,i.normalizeClass)(['acu-wrapper',[`acu-theme-${e.theme}`,`acu-layout-${e.layout}`,{collapsed:e.isCollapsed,pinned:e.isPinned}]])},[(0,i.createCommentVNode)(' 1. 数据显示区（放在最前面） '),(0,i.createElementVNode)('div',{ref_key:'dataAreaRef',ref:v,class:(0,i.normalizeClass)(['acu-data-display',{visible:!e.isContentHidden,'acu-layout-horizontal':'horizontal'===e.layout,'acu-layout-vertical':'vertical'===e.layout}])},[(0,i.createCommentVNode)(' 内容区 '),(0,i.createElementVNode)('div',Pe,[(0,i.renderSlot)(a.$slots,'default')])],2),(0,i.createCommentVNode)(' 2. 宽度调节把手 '),(0,i.createCommentVNode)(' 注意：事件绑定在 onMounted 中手动进行，避免跨 iframe 生产构建事件绑定失效 '),e.lockPanel?(0,i.createCommentVNode)('v-if',!0):((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,ref_key:'resizeHandleRef',ref:x,class:'acu-resize-handle'},null,512)),(0,i.createCommentVNode)(' 3. 导航容器（放在最后，显示在底部） '),(0,i.createCommentVNode)(' 注意：拖拽事件绑定在 onMounted 中手动进行 '),(0,i.createElementVNode)('div',{ref_key:'navContainerRef',ref:h,class:(0,i.normalizeClass)(['acu-nav-container',{'acu-locked':e.lockPanel}])},[(0,i.createCommentVNode)(' Tab 区域 (由 slot 提供，TabBar 自带 .acu-nav-tabs-area) '),(0,i.renderSlot)(a.$slots,'tabs'),(0,i.createCommentVNode)(' 分隔线 '),t[0]||(t[0]=(0,i.createElementVNode)('div',{class:'acu-nav-separator'},null,-1)),(0,i.createCommentVNode)(' 动作按钮区（横排） '),(0,i.createElementVNode)('div',Fe,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(c.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:e.id,class:(0,i.normalizeClass)(['acu-action-btn',s(e.id)]),title:e.label,style:(0,i.normalizeStyle)(u(e.id)),onClick:(0,i.withModifiers)(a=>{return t=e.id,void(p.value?p.value=!1:('refresh'===t&&(l.value=!0,setTimeout(()=>{l.value=!1},1e3)),f(t)));var t},['stop']),onMousedown:(0,i.withModifiers)(a=>g(e.id),['stop']),onMouseup:(0,i.withModifiers)(m,['stop']),onMouseleave:m,onTouchstartPassive:(0,i.withModifiers)(a=>g(e.id),['stop']),onTouchend:(0,i.withModifiers)(m,['stop'])},[(0,i.createElementVNode)('i',{class:(0,i.normalizeClass)(['fa-solid',e.icon])},null,2)],46,je))),128))])],2)],2))}}),Re=Le,Oe={class:'acu-tab-bar'},He=['draggable','onClick','onDragstart','onDragover','onDrop'],qe=(0,i.defineComponent)({__name:'TabBar',props:{tabs:{},activeTab:{},showDashboard:{type:Boolean,default:!0},hasOptionsTabs:{type:Boolean,default:!1},isEditingOrder:{type:Boolean,default:!1},gridColumns:{default:'repeat(auto-fill, minmax(90px, 1fr))'}},emits:['tab-change','order-change','exit-editing'],setup(e,{expose:a,emit:t}){const o=e,n=t,r=xe(),c=(0,i.ref)([]),l=(0,i.computed)(()=>{const e=r.visibleTabs;return e&&0!==e.length?e.map(e=>c.value.find(a=>a.id===e)).filter(e=>void 0!==e):c.value});let s=null,u=null;(0,i.watch)(()=>o.tabs,e=>{c.value=[...e]},{immediate:!0,deep:!0});const d=e=>{o.isEditingOrder||n('tab-change',e)},p=()=>{n('exit-editing')},g=e=>{e.target.classList.remove('dragging'),s=null,u=null};return a({getCurrentOrder:()=>c.value.map(e=>e.id),getVisibleTabs:()=>l.value.map(e=>e.id)}),(a,t)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',Oe,[(0,i.createCommentVNode)(' 排序提示 '),(0,i.createElementVNode)('div',{class:(0,i.normalizeClass)(['acu-order-controls',{visible:e.isEditingOrder}])},[(0,i.createElementVNode)('span',null,[t[3]||(t[3]=(0,i.createElementVNode)('i',{class:'fas fa-info-circle'},null,-1)),t[4]||(t[4]=(0,i.createTextVNode)(' 拖拽调整顺序，完成后点击 ',-1)),(0,i.createElementVNode)('button',{class:'acu-order-done-btn',onClick:p},[...t[2]||(t[2]=[(0,i.createElementVNode)('i',{class:'fas fa-check'},null,-1),(0,i.createTextVNode)(' 完成',-1)])])])],2),(0,i.createCommentVNode)(' Tab 网格区域 '),(0,i.createElementVNode)('div',{class:'acu-nav-tabs-area',style:(0,i.normalizeStyle)({'--acu-nav-cols':e.gridColumns})},[(0,i.createCommentVNode)(' 仪表盘 Tab (如果显示) '),e.showDashboard?((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:0,class:(0,i.normalizeClass)(['acu-nav-btn acu-nav-btn-special',{active:e.activeTab===(0,i.unref)(ve)}]),onClick:t[0]||(t[0]=(0,i.withModifiers)(e=>d((0,i.unref)(ve)),['stop']))},[...t[5]||(t[5]=[(0,i.createElementVNode)('i',{class:'fas fa-home'},null,-1),(0,i.createElementVNode)('span',null,'仪表盘',-1)])],2)):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 动态 Tab 列表（根据可见性配置过滤） '),((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(l.value,a=>((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:a.id,class:(0,i.normalizeClass)(['acu-nav-btn',{active:e.activeTab===a.id,'drag-handle':e.isEditingOrder}]),draggable:e.isEditingOrder,onClick:(0,i.withModifiers)(e=>d(a.id),['stop']),onDragstart:e=>((e,a)=>{o.isEditingOrder?(s=a,e.dataTransfer&&(e.dataTransfer.effectAllowed='move',e.dataTransfer.setData('text/plain',a.id)),e.target.classList.add('dragging')):e.preventDefault()})(e,a),onDragover:(0,i.withModifiers)(e=>((e,a)=>{o.isEditingOrder&&s&&(e.preventDefault(),u=a)})(e,a),['prevent']),onDrop:e=>((e,a)=>{if(!o.isEditingOrder||!s)return;e.preventDefault();const t=c.value.findIndex(e=>e.id===s.id),r=c.value.findIndex(e=>e.id===a.id);if(-1!==t&&-1!==r&&t!==r){const[e]=c.value.splice(t,1);c.value.splice(r,0,e),n('order-change',c.value.map(e=>e.id))}s=null,u=null})(e,a),onDragend:g},[a.icon?((0,i.openBlock)(),(0,i.createElementBlock)('i',{key:0,class:(0,i.normalizeClass)(a.icon)},null,2)):(0,i.createCommentVNode)('v-if',!0),(0,i.createElementVNode)('span',null,(0,i.toDisplayString)(a.name),1)],42,He))),128)),(0,i.createCommentVNode)(' 选项面板 Tab (如果有选项类表格) '),e.hasOptionsTabs?((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:1,class:(0,i.normalizeClass)(['acu-nav-btn acu-nav-btn-special',{active:e.activeTab===(0,i.unref)(he)}]),onClick:t[1]||(t[1]=(0,i.withModifiers)(e=>d((0,i.unref)(he)),['stop']))},[...t[6]||(t[6]=[(0,i.createElementVNode)('i',{class:'fas fa-sliders-h'},null,-1),(0,i.createElementVNode)('span',null,'选项',-1)])],2)):(0,i.createCommentVNode)('v-if',!0)],4)]))}}),Ye=(0,i.defineComponent)({__name:'Badge',props:{value:{},type:{default:'default'}},setup(e){const a=e,t=(0,i.computed)(()=>{if('default'!==a.type)return a.type;const e=String(a.value);return/Lv\.?\s*\d+/i.test(e)?'level':/\d+(\.\d+)?%/.test(e)?'percent':'男'===e?'male':'女'===e?'female':/^[+-]?\d+(\.\d+)?$/.test(e.trim())?'number':'default'}),o=(0,i.computed)(()=>`acu-badge-${t.value}`),n=(0,i.computed)(()=>{const e=a.value;return null==e||''===e?'-':String(e)});return(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('span',{class:(0,i.normalizeClass)(['acu-badge',o.value])},(0,i.toDisplayString)(n.value),3))}}),Xe=(0,i.defineComponent)({__name:'InlineEditor',props:{value:{},minHeight:{default:24}},emits:['save','cancel'],setup(e,{emit:a}){const t=e,o=a,n=(0,i.ref)(),r=(0,i.ref)(String(t.value)),c=(0,i.ref)(!1),l=(0,i.ref)(!1),s=()=>{const e=window.getSelection();l.value=null!==e&&e.toString().length>0},u=()=>{const e=n.value;if(!e)return;const a=e.offsetHeight,o=e.style.visibility;e.style.visibility='hidden',e.style.height='0px';const r=e.scrollHeight,i=Math.max(r,t.minHeight);e.style.visibility=o,e.style.height=i===a&&a>0?`${a}px`:`${i}px`};(0,i.watch)(r,()=>{(0,i.nextTick)(u)});const d=()=>{if(c.value)return;c.value=!0;const e=String(t.value);r.value!==e?o('save',r.value):o('cancel')},p=e=>{'Escape'===e.key?(e.preventDefault(),e.stopPropagation(),c.value=!0,o('cancel')):'Enter'!==e.key||e.shiftKey||(e.preventDefault(),e.stopPropagation(),d())},g=e=>{e.stopPropagation()},m=e=>{s(),l.value,e.stopPropagation()};return(0,i.onMounted)(()=>{(0,i.nextTick)(()=>{const e=n.value;if(!e)return;const a=e.scrollHeight,o=Math.max(a,t.minHeight);e.style.height=`${o}px`,e.focus(),e.select()}),document.addEventListener('selectionchange',s)}),(0,i.onBeforeUnmount)(()=>{document.removeEventListener('selectionchange',s)}),(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{class:'acu-inline-editor',onClick:a[5]||(a[5]=(0,i.withModifiers)(()=>{},['stop'])),onMousedown:a[6]||(a[6]=(0,i.withModifiers)(()=>{},['stop'])),onPointerdown:a[7]||(a[7]=(0,i.withModifiers)(()=>{},['stop']))},[(0,i.withDirectives)((0,i.createElementVNode)('textarea',{ref_key:'textareaRef',ref:n,'onUpdate:modelValue':a[0]||(a[0]=e=>r.value=e),class:'acu-edit-textarea',onBlur:d,onKeydown:p,onClick:a[1]||(a[1]=(0,i.withModifiers)(()=>{},['stop'])),onMousedown:a[2]||(a[2]=(0,i.withModifiers)(()=>{},['stop'])),onPointerdown:a[3]||(a[3]=(0,i.withModifiers)(()=>{},['stop'])),onTouchstart:g,onTouchmove:m,onTouchend:a[4]||(a[4]=(0,i.withModifiers)(()=>{},['stop']))},null,544),[[i.vModelText,r.value]])],32))}}),We={key:0,class:'acu-card-header'},Ke={key:0,class:'acu-card-index'},Je={class:'acu-card-main-grid'},Ge=['onClick'],Qe={class:'acu-grid-label'},Ze={class:'acu-grid-value'},ea={key:0,class:'acu-card-full-area'},aa=['onClick'],ta={class:'acu-full-label'},oa={class:'acu-full-value'},na={key:1},ra={class:'acu-card-body'},ia=['onClick'],ca={class:'acu-card-label'},la={class:'acu-card-value'},sa={class:'acu-pull-icon'},ua={class:'acu-pull-text'},da={key:3,class:'acu-delete-stamp'},pa=(0,i.defineComponent)({__name:'DataCard',props:{data:{},tableId:{},tableName:{},isChanged:{type:Boolean,default:!1},layout:{default:'vertical'},viewMode:{default:'card'},showIndex:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},titleColIndex:{default:1}},emits:['cellClick','insertRow','toggleDelete','contextMenu'],setup(e,{emit:a}){const t=e,o=a,n=(0,i.ref)(),r=(0,i.ref)(null),c=ie(),l=(0,i.ref)(),s=(0,i.ref)(),u=(0,i.ref)(),d=(0,i.ref)(),{isMobile:p}=function(){const e=(0,i.ref)($e.test(navigator.userAgent));if('undefined'!=typeof window){const a=()=>{e.value=$e.test(navigator.userAgent)||'ontouchstart'in window&&window.innerWidth<768};window.addEventListener('resize',a),(0,i.onUnmounted)(()=>{window.removeEventListener('resize',a)})}return{isMobile:e,isTouchDevice:(0,i.computed)(()=>'ontouchstart'in window||navigator.maxTouchPoints>0)}}(),g=(0,i.ref)(!1),m=(0,i.ref)(null),f=(0,i.computed)(()=>`${t.tableName}-row-${t.data.index}`),b=(0,i.computed)(()=>c.pendingDeletes.has(f.value)),v=(0,i.computed)(()=>t.titleColIndex>=0&&t.data.cells.length>t.titleColIndex?t.data.cells[t.titleColIndex]:null),h=(0,i.computed)(()=>{let e=t.data.cells.filter((_,e)=>e>0);return t.showHeader&&v.value&&t.titleColIndex>0&&(e=e.filter((_,e)=>e+1!==t.titleColIndex)),e}),x=e=>{const a=String(e.value),t=e.key.toLowerCase();return a.length>50||t.includes('描述')||t.includes('说明')||t.includes('备注')||t.includes('内容')||t.includes('detail')||t.includes('description')},w=(0,i.computed)(()=>h.value.filter(e=>!x(e))),y=(0,i.computed)(()=>h.value.filter(e=>x(e)));function k(e){const a=`${t.tableName}-${t.data.index}-${e}`,o=c.getCellChangeType(a);return{'acu-cell-changed':null!==o,'acu-cell-changed-manual':'manual'===o,'acu-cell-changed-ai':'ai'===o}}const C=(0,i.computed)(()=>{const e=c.getRowChangeType(t.tableName,t.data.index,t.data.cells.length);return'manual'===e?'acu-highlight-changed acu-highlight-manual':'ai'===e?'acu-highlight-changed acu-highlight-ai':''}),{isSelecting:N,shouldBlockInteraction:V,wasSelecting:E}=function(){const{text:e}=K(),a=(0,i.computed)(()=>e.value.length>0),t=(0,i.ref)(!1),o=(0,i.ref)(null);return(0,i.watch)(a,e=>{!e&&t.value?o.value=setTimeout(()=>{t.value=!1},100):e&&(t.value=!0,o.value&&(clearTimeout(o.value),o.value=null))}),{selectedText:e,isSelecting:a,wasSelecting:(0,i.computed)(()=>t.value),shouldBlockInteraction:()=>a.value||t.value,clearSelection:()=>{const e=window.getSelection();e&&e.removeAllRanges()}}}(),{isSwiping:B,gestureType:S,atStart:T,atEnd:A,checkScrollEdge:U,lengthX:D,lengthY:M}=function(e,a){const{layout:t,onInsertRow:o,onToggleDelete:n,horizontalThreshold:r=50,verticalThreshold:c=40,edgeThreshold:l=5,longPressDelay:s=400,longPressCancelThreshold:u=5}=a,d='horizontal'===t?r:c,{text:p}=K(),g=(0,i.computed)(()=>p.value.length>0),m=(0,i.ref)(!1),f=(0,i.ref)(!0),b=(0,i.ref)(!1),v=(0,i.ref)(null),h=(0,i.ref)(!1),x=(0,i.ref)(0),w=(0,i.ref)(0),y=(0,i.ref)(0),k=(0,i.ref)(0),C=(0,i.ref)(null),N=(0,i.ref)(0),V=(0,i.ref)(null),E=(0,i.ref)(!1),B=(0,i.ref)(null),S=(0,i.ref)(!1),T=a=>{const o=a?.currentTarget,n=o||e.value;n&&('horizontal'===t?(f.value=n.scrollTop<=l,b.value=n.scrollTop+n.clientHeight>=n.scrollHeight-l):(f.value=n.scrollLeft<=l,b.value=n.scrollLeft+n.clientWidth>=n.scrollWidth-l),m.value=f.value||b.value)},A=()=>{const e=window.getSelection();return!!e&&e.toString().length>0},U=(0,i.computed)(()=>g.value||A()),D=a=>{const o=e.value;if(!o)return;E.value=!1,S.value=!1,v.value=null,C.value=null,B.value&&(clearTimeout(B.value),B.value=null),A()&&(E.value=!0);const n=a.touches[0];if(x.value=n.clientX,w.value=n.clientY,y.value=0,k.value=0,h.value=!0,'horizontal'===t){const e=o.closest('.acu-data-display');V.value=e,N.value=e?.scrollLeft??0}B.value=setTimeout(()=>{S.value=!0,E.value=!0},s),T()},M=a=>{const o=e.value;if(!o||!h.value)return;const n=a.touches[0],r=n.clientX-x.value,i=n.clientY-w.value;y.value=r,k.value=i,(Math.abs(r)>u||Math.abs(i)>u)&&B.value&&(clearTimeout(B.value),B.value=null);const c=A();if(E.value||S.value||c)E.value=!0;else if(T(),!C.value&&(Math.abs(r)>10||Math.abs(i)>10)&&(C.value=Math.abs(r)>Math.abs(i)?'horizontal':'vertical',console.info('[ACU Card] 方向锁定为:',C.value)),'horizontal'===t){if('horizontal'===C.value)return v.value=null,void(V.value&&(V.value.scrollLeft=N.value-r));if('vertical'===C.value){const e=o.scrollTop,t=o.scrollHeight,n=o.clientHeight,r=i>0&&(e<=0||t<=n+2),c=i<0&&e+n>=t-1;if(r||c){a.cancelable&&a.preventDefault(),a.stopPropagation();const e=.6*Math.abs(i);v.value=r&&e>30?'insert':c&&e>30?'delete':null}else v.value=null}}else if('vertical'===t&&Math.abs(r)>Math.abs(i)&&Math.abs(r)>10){a.cancelable&&a.preventDefault(),a.stopPropagation();const e=.7*Math.abs(r);v.value=r>0&&e>28?'delete':r<0&&e>28?'insert':null}},I=a=>{const r=e.value;if(!r)return;if(B.value&&(clearTimeout(B.value),B.value=null),S.value||A())return E.value=!0,h.value=!1,void(v.value=null);if(E.value)return h.value=!1,void(v.value=null);const i=y.value,c=k.value;if('horizontal'===t){const e=r.scrollTop,a=r.scrollHeight,t=r.clientHeight,i=c<0&&e+t>=a-1;c>0&&(e<=0||a<=t+2)&&c>d?(console.info('[ACU Card] 下拉触发新增行 (deltaY:',c,')'),o()):i&&Math.abs(c)>d&&(console.info('[ACU Card] 上划触发删除切换 (deltaY:',c,')'),n())}else'vertical'===t&&(i>d?(console.info('[ACU Card] 右滑触发删除切换 (deltaX:',i,')'),n()):i<-d&&(console.info('[ACU Card] 左滑触发新增行 (deltaX:',i,')'),o()));setTimeout(()=>{v.value=null},300),h.value=!1};return(0,i.watch)(e,(e,a)=>{a&&(a.removeEventListener('touchstart',D),a.removeEventListener('touchmove',M),a.removeEventListener('touchend',I)),e&&(e.addEventListener('touchstart',D,{passive:!0}),e.addEventListener('touchmove',M,{passive:!1}),e.addEventListener('touchend',I,{passive:!0}),T())},{immediate:!0}),(0,i.onUnmounted)(()=>{const a=e.value;a&&(a.removeEventListener('touchstart',D),a.removeEventListener('touchmove',M),a.removeEventListener('touchend',I)),B.value&&(clearTimeout(B.value),B.value=null)}),{isSelecting:U,scrolledToEdge:m,atStart:f,atEnd:b,isSwiping:h,gestureType:v,checkScrollEdge:T,lengthX:y,lengthY:k,shouldBlockClick:E,isSelectionMode:S}}(n,{layout:t.layout,horizontalThreshold:50,verticalThreshold:40,edgeThreshold:10,onInsertRow:()=>{console.info('[ACU DataCard] 手势触发新增行'),o('insertRow')},onToggleDelete:()=>{console.info('[ACU DataCard] 手势触发切换删除',{isDeleting:b.value}),o('toggleDelete')}}),I=(0,i.computed)(()=>{if('horizontal'!==t.layout)return 0;const e=Math.abs(M?.value||0);return Math.min(.6*e,120)}),P=(0,i.computed)(()=>Math.min(I.value/80,1)),F=(0,i.computed)(()=>{if('vertical'!==t.layout)return 0;const e=Math.abs(D?.value||0);return Math.min(.7*e,120)}),j=(0,i.computed)(()=>Math.min(F.value/60,1));(0,i.watchEffect)(()=>{l.value&&(l.value.style.height=`${I.value}px`,l.value.style.opacity=String(P.value)),s.value&&(s.value.style.height=`${I.value}px`,s.value.style.opacity=String(P.value))}),(0,i.watchEffect)(()=>{u.value&&(u.value.style.width=`${F.value}px`,u.value.style.opacity=String(j.value)),d.value&&(d.value.style.width=`${F.value}px`,d.value.style.opacity=String(j.value))}),(0,i.watch)([T,A],([e,a])=>{p.value&&(e||a)&&(m.value&&clearTimeout(m.value),g.value=!0,m.value=setTimeout(()=>{g.value=!1},2e3))});const L=e=>{U(e)},R=e=>{V()||E.value?console.info('[ACU] 检测到选词操作或刚结束选词，阻止点击事件'):B.value?console.info('[ACU] 滑动中，阻止点击事件'):b.value?console.info('[ACU] 待删除行不能编辑'):(r.value=e,o('cellClick',t.data.index,e))},O=()=>{t.titleColIndex<0||(b.value?console.info('[ACU] 待删除行不能编辑标题'):(console.info('[ACU DataCard] 标题点击，触发编辑 colIndex:',t.titleColIndex),r.value=t.titleColIndex,o('cellClick',t.data.index,t.titleColIndex)))},H=(e,a)=>{c.updateCell(t.tableName,t.data.index,e,a),r.value=null},q=e=>{/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?console.info('[ACU] 移动端不触发右键菜单'):o('contextMenu',e,t.data.index)};return(a,t)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{ref_key:'cardRef',ref:n,class:(0,i.normalizeClass)(['acu-data-card',[C.value,{'acu-editing-lock':null!==r.value,'acu-style-list':'list'===e.viewMode,'acu-style-card':'card'===e.viewMode,'acu-swiping':(0,i.unref)(B)}]]),onContextmenu:(0,i.withModifiers)(q,['prevent']),onScroll:L},[(0,i.createCommentVNode)(' 横向布局：顶部下拉新增提示（必须在最前面，与原版 prepend 一致） '),(0,i.createCommentVNode)(' 注意：使用 v-show 替代 v-if 保持 DOM 存在，配合 watchEffect 直接操作样式 '),(0,i.withDirectives)((0,i.createElementVNode)('div',{ref_key:'pullTopRef',ref:l,class:'acu-pull-overlay acu-pull-top'},[...t[5]||(t[5]=[(0,i.createElementVNode)('div',{class:'acu-pull-icon'},[(0,i.createElementVNode)('i',{class:'fa-solid fa-plus'}),(0,i.createElementVNode)('span',{class:'acu-pull-text'},'新增一行')],-1)])],512),[[i.vShow,'horizontal'===e.layout&&(0,i.unref)(p)&&'insert'===(0,i.unref)(S)]]),(0,i.createCommentVNode)(' 卡片头部（可选显示索引和标题） '),e.showHeader?((0,i.openBlock)(),(0,i.createElementBlock)('div',We,[e.showIndex?((0,i.openBlock)(),(0,i.createElementBlock)('span',Ke,'#'+(0,i.toDisplayString)(e.data.index+1),1)):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 标题编辑模式 '),v.value&&r.value===e.titleColIndex?((0,i.openBlock)(),(0,i.createBlock)(Xe,{key:1,class:'acu-title-editor',value:v.value.value,onSave:t[0]||(t[0]=a=>H(e.titleColIndex,a)),onCancel:t[1]||(t[1]=e=>r.value=null)},null,8,['value'])):v.value?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:2},[(0,i.createCommentVNode)(' 标题显示模式 '),(0,i.createElementVNode)('span',{class:'acu-editable-title',onClick:O},(0,i.toDisplayString)(v.value.value||'未命名'),1)],2112)):(0,i.createCommentVNode)('v-if',!0)])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 卡片内容区 - Card 布局 '),'card'===e.viewMode?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createCommentVNode)(' Card 单元格区域 '),(0,i.createElementVNode)('div',Je,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(w.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.colIndex,class:(0,i.normalizeClass)(['acu-grid-item',k(e.colIndex)]),onClick:a=>R(e.colIndex)},[(0,i.createElementVNode)('label',Qe,(0,i.toDisplayString)(e.key),1),(0,i.createElementVNode)('div',Ze,[r.value===e.colIndex?((0,i.openBlock)(),(0,i.createBlock)(Xe,{key:0,value:e.value,onSave:a=>H(e.colIndex,a),onCancel:t[2]||(t[2]=e=>r.value=null)},null,8,['value','onSave'])):((0,i.openBlock)(),(0,i.createBlock)(Ye,{key:1,value:e.value},null,8,['value']))])],10,Ge))),128))]),(0,i.createCommentVNode)(' Full-Width 单元格区域（长文本） '),y.value.length>0?((0,i.openBlock)(),(0,i.createElementBlock)('div',ea,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(y.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.colIndex,class:(0,i.normalizeClass)(['acu-full-item',k(e.colIndex)]),onClick:a=>R(e.colIndex)},[(0,i.createElementVNode)('label',ta,(0,i.toDisplayString)(e.key),1),(0,i.createElementVNode)('div',oa,[r.value===e.colIndex?((0,i.openBlock)(),(0,i.createBlock)(Xe,{key:0,value:e.value,'max-height':300,onSave:a=>H(e.colIndex,a),onCancel:t[3]||(t[3]=e=>r.value=null)},null,8,['value','onSave'])):((0,i.openBlock)(),(0,i.createElementBlock)('span',na,(0,i.toDisplayString)(e.value||'-'),1))])],10,aa))),128))])):(0,i.createCommentVNode)('v-if',!0)],64)):((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:2},[(0,i.createCommentVNode)(' 卡片内容区 - List 布局 '),(0,i.createElementVNode)('div',ra,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(h.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.colIndex,class:(0,i.normalizeClass)(['acu-card-row',k(e.colIndex)]),onClick:a=>R(e.colIndex)},[(0,i.createElementVNode)('label',ca,(0,i.toDisplayString)(e.key)+':',1),(0,i.createElementVNode)('div',la,[r.value===e.colIndex?((0,i.openBlock)(),(0,i.createBlock)(Xe,{key:0,value:e.value,onSave:a=>H(e.colIndex,a),onCancel:t[4]||(t[4]=e=>r.value=null)},null,8,['value','onSave'])):((0,i.openBlock)(),(0,i.createBlock)(Ye,{key:1,value:e.value},null,8,['value']))])],10,ia))),128))])],64)),(0,i.createCommentVNode)(' 横向布局：底部上划删除提示（在内容区域之后，与原版 append 一致） '),(0,i.createCommentVNode)(' 注意：使用 v-show 替代 v-if 保持 DOM 存在，配合 watchEffect 直接操作样式 '),(0,i.withDirectives)((0,i.createElementVNode)('div',{ref_key:'pullBottomRef',ref:s,class:(0,i.normalizeClass)(['acu-pull-overlay acu-pull-bottom',{'acu-pull-restore':b.value}])},[(0,i.createElementVNode)('div',sa,[(0,i.createElementVNode)('i',{class:(0,i.normalizeClass)(b.value?'fa-solid fa-undo':'fa-solid fa-trash')},null,2),(0,i.createElementVNode)('span',ua,(0,i.toDisplayString)(b.value?'撤销删除':'删除本行'),1)])],2),[[i.vShow,'horizontal'===e.layout&&(0,i.unref)(p)&&'delete'===(0,i.unref)(S)]]),(0,i.createCommentVNode)(' 待删除印章 (圆形印章样式，与原代码 .acu-badge-pending 保持一致) '),b.value?((0,i.openBlock)(),(0,i.createElementBlock)('div',da,'待删除')):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 竖向布局：左右滑动反馈（与原版 .acu-swipe-overlay 一致） '),(0,i.createCommentVNode)(' 注意：使用 v-show 替代 v-if 保持 DOM 存在，配合 watchEffect 直接操作样式 '),'vertical'===e.layout&&(0,i.unref)(p)?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:4},[(0,i.createCommentVNode)(' 左侧右滑删除提示 '),(0,i.withDirectives)((0,i.createElementVNode)('div',{ref_key:'swipeLeftRef',ref:u,class:(0,i.normalizeClass)(['acu-swipe-overlay acu-swipe-left',{'acu-swipe-restore':b.value}])},[(0,i.createElementVNode)('i',{class:(0,i.normalizeClass)(b.value?'fa-solid fa-undo':'fa-solid fa-trash')},null,2)],2),[[i.vShow,'delete'===(0,i.unref)(S)]]),(0,i.createCommentVNode)(' 右侧左滑新增提示 '),(0,i.withDirectives)((0,i.createElementVNode)('div',{ref_key:'swipeRightRef',ref:d,class:'acu-swipe-overlay acu-swipe-right'},[...t[6]||(t[6]=[(0,i.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1)])],512),[[i.vShow,'insert'===(0,i.unref)(S)]])],64)):(0,i.createCommentVNode)('v-if',!0)],34))}}),ga={class:'acu-dashboard'},ma={class:'acu-dashboard-grid'},fa={key:0,class:'acu-dashboard-card acu-card-primary'},ba={class:'acu-card-header'},va={class:'acu-card-body'},ha={key:1,class:'acu-dashboard-card'},xa={class:'acu-card-header'},wa={class:'acu-card-body acu-scroll'},ya=['onClick'],ka={class:'acu-mini-name'},Ca={key:2,class:'acu-dashboard-card'},Na={class:'acu-card-header'},Va={class:'acu-card-body acu-scroll'},Ea=['onClick'],za={class:'acu-task-name'},Ba={key:3,class:'acu-dashboard-card'},Sa={class:'acu-card-header'},Ta={class:'acu-card-body acu-scroll'},Aa={class:'acu-items-grid'},Ua=['title','onClick'],Da={key:0,class:'acu-item-count'},Ma={class:'acu-dashboard-card acu-card-stats'},_a={class:'acu-card-body'},Ia={class:'acu-stats-grid'},$a={class:'acu-stat-item'},Pa={class:'acu-stat-value'},Fa={class:'acu-stat-item'},ja={class:'acu-stat-value'},La={class:'acu-stat-value'},Ra={class:'acu-stat-value'},Oa={key:4,class:'acu-dashboard-card acu-card-quick-access'},Ha={class:'acu-card-body'},qa={class:'acu-quick-grid'},Ya=['onClick'],Xa=(0,i.defineComponent)({__name:'Dashboard',props:{tables:{}},emits:['refresh','navigate','cellClick','rowClick'],setup(e,{emit:a}){const t=e,o=a,n=ie();(0,i.ref)(!1);function r(...e){return t.tables.find(a=>e.some(e=>a.name.includes(e)||a.id.includes(e)))}const c=(0,i.computed)(()=>r('主角','玩家','Player','protagonist')),l=(0,i.computed)(()=>c.value?.rows[0]||null),s=(0,i.computed)(()=>r('NPC','npc','角色')),u=(0,i.computed)(()=>s.value?.rows||[]),d=(0,i.computed)(()=>u.value.slice(0,5)),p=(0,i.computed)(()=>r('任务','Task','Quest','quest')),g=(0,i.computed)(()=>p.value?.name||'任务'),m=(0,i.computed)(()=>p.value?.rows||[]),f=(0,i.computed)(()=>m.value.slice(0,3)),b=(0,i.computed)(()=>r('物品','道具','Item','item','背包','库存')),v=(0,i.computed)(()=>b.value?.name||'物品'),h=(0,i.computed)(()=>b.value?.rows||[]),x=(0,i.computed)(()=>h.value.slice(0,12)),w=(0,i.computed)(()=>{const e=new Set([c.value?.id,s.value?.id,p.value?.id,b.value?.id].filter(Boolean));return t.tables.filter(a=>!e.has(a.id)).map(e=>({id:e.id,name:e.name,count:e.rows.length})).slice(0,8)}),y=(0,i.computed)(()=>t.tables.length),k=(0,i.computed)(()=>t.tables.reduce((e,a)=>e+a.rows.length,0)),C=(0,i.computed)(()=>n.diffMap.size),N=(0,i.computed)(()=>n.pendingDeletes.size);function V(e){const a=e.cells.find(e=>['名称','姓名','name','Name','角色名'].includes(e.key));return String(a?.value||`NPC #${e.index+1}`)}function E(e){const a=e.cells.find(e=>['状态','好感度','status','Status','关系'].includes(e.key));return String(a?.value||'-')}function B(e){const a=e.cells.find(e=>['名称','任务名','name','Name','标题'].includes(e.key));return String(a?.value||`任务 #${e.index+1}`)}function S(e){const a=e.cells.find(e=>['类型','type','Type','分类'].includes(e.key));return String(a?.value||'主线')}function T(e){const a=e.cells.find(e=>['名称','物品名','name','Name','道具名'].includes(e.key));return String(a?.value||`物品 #${e.index+1}`)}function A(e){const a=e.cells.find(e=>['数量','count','Count','个数','amount'].includes(e.key)),t=a?.value;return t&&Number(t)>1?String(t):''}function U(e){const a=e.cells.find(e=>['描述','说明','desc','description','Description'].includes(e.key));return String(a?.value||'')}function D(e){const a=e.toLowerCase();return a.includes('技能')||a.includes('skill')?'fas fa-magic':a.includes('装备')||a.includes('equip')?'fas fa-shield-alt':a.includes('状态')||a.includes('status')?'fas fa-heart':a.includes('事件')||a.includes('event')?'fas fa-calendar-alt':a.includes('日志')||a.includes('log')?'fas fa-scroll':a.includes('地点')||a.includes('location')?'fas fa-map-marker-alt':a.includes('关系')||a.includes('relation')?'fas fa-link':a.includes('设置')||a.includes('setting')?'fas fa-cog':'fas fa-table'}function M(e){o('navigate',e)}return(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',ga,[(0,i.createCommentVNode)(' 仪表盘网格 '),(0,i.createElementVNode)('div',ma,[(0,i.createCommentVNode)(' 主角信息卡片 '),l.value?((0,i.openBlock)(),(0,i.createElementBlock)('div',fa,[(0,i.createElementVNode)('div',ba,[a[9]||(a[9]=(0,i.createElementVNode)('i',{class:'fas fa-user'},null,-1)),a[10]||(a[10]=(0,i.createElementVNode)('span',null,'主角',-1)),(0,i.createElementVNode)('button',{class:'acu-btn acu-btn-link',onClick:a[0]||(a[0]=e=>M('主角'))},[...a[8]||(a[8]=[(0,i.createElementVNode)('i',{class:'fas fa-external-link-alt'},null,-1)])])]),(0,i.createElementVNode)('div',va,[(0,i.createVNode)(pa,{data:l.value,'table-id':'主角','table-name':'主角','view-mode':'list','show-index':!1,'show-header':!1,onCellClick:a[1]||(a[1]=(e,a)=>function(e,a,t){o('cellClick',e,a,t)}('主角',e,a))},null,8,['data'])])])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' NPC 快捷面板 '),u.value.length>0?((0,i.openBlock)(),(0,i.createElementBlock)('div',ha,[(0,i.createElementVNode)('div',xa,[a[12]||(a[12]=(0,i.createElementVNode)('i',{class:'fas fa-users'},null,-1)),a[13]||(a[13]=(0,i.createElementVNode)('span',null,'NPC',-1)),(0,i.createVNode)(Ye,{value:`${u.value.length}`,type:'number'},null,8,['value']),(0,i.createElementVNode)('button',{class:'acu-btn acu-btn-link',onClick:a[2]||(a[2]=e=>M('NPC'))},[...a[11]||(a[11]=[(0,i.createElementVNode)('i',{class:'fas fa-external-link-alt'},null,-1)])])]),(0,i.createElementVNode)('div',wa,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(d.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.index,class:'acu-mini-card',onClick:a=>function(e){s.value&&o('rowClick',s.value.id,e)}(e)},[(0,i.createElementVNode)('span',ka,(0,i.toDisplayString)(V(e)),1),(0,i.createVNode)(Ye,{value:E(e)},null,8,['value'])],8,ya))),128)),u.value.length>5?((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:0,class:'acu-btn acu-btn-link acu-show-more',onClick:a[3]||(a[3]=e=>M('NPC'))},' 查看全部 ('+(0,i.toDisplayString)(u.value.length)+') ',1)):(0,i.createCommentVNode)('v-if',!0)])])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 任务面板 '),m.value.length>0?((0,i.openBlock)(),(0,i.createElementBlock)('div',Ca,[(0,i.createElementVNode)('div',Na,[a[15]||(a[15]=(0,i.createElementVNode)('i',{class:'fas fa-tasks'},null,-1)),a[16]||(a[16]=(0,i.createElementVNode)('span',null,'任务',-1)),(0,i.createVNode)(Ye,{value:`${m.value.length}`,type:'number'},null,8,['value']),(0,i.createElementVNode)('button',{class:'acu-btn acu-btn-link',onClick:a[4]||(a[4]=e=>M(g.value))},[...a[14]||(a[14]=[(0,i.createElementVNode)('i',{class:'fas fa-external-link-alt'},null,-1)])])]),(0,i.createElementVNode)('div',Va,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(f.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.index,class:'acu-task-item',onClick:a=>function(e){p.value&&o('rowClick',p.value.id,e)}(e)},[(0,i.createElementVNode)('span',za,(0,i.toDisplayString)(B(e)),1),(0,i.createVNode)(Ye,{value:S(e)},null,8,['value'])],8,Ea))),128)),m.value.length>3?((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:0,class:'acu-btn acu-btn-link acu-show-more',onClick:a[5]||(a[5]=e=>M(g.value))},' 查看全部 ('+(0,i.toDisplayString)(m.value.length)+') ',1)):(0,i.createCommentVNode)('v-if',!0)])])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 物品/道具面板 '),h.value.length>0?((0,i.openBlock)(),(0,i.createElementBlock)('div',Ba,[(0,i.createElementVNode)('div',Sa,[a[18]||(a[18]=(0,i.createElementVNode)('i',{class:'fas fa-box-open'},null,-1)),a[19]||(a[19]=(0,i.createElementVNode)('span',null,'物品',-1)),(0,i.createVNode)(Ye,{value:`${h.value.length}`,type:'number'},null,8,['value']),(0,i.createElementVNode)('button',{class:'acu-btn acu-btn-link',onClick:a[6]||(a[6]=e=>M(v.value))},[...a[17]||(a[17]=[(0,i.createElementVNode)('i',{class:'fas fa-external-link-alt'},null,-1)])])]),(0,i.createElementVNode)('div',Ta,[(0,i.createElementVNode)('div',Aa,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(x.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.index,class:'acu-item-chip',title:U(e),onClick:a=>function(e){b.value&&o('rowClick',b.value.id,e)}(e)},[(0,i.createTextVNode)((0,i.toDisplayString)(T(e))+' ',1),A(e)?((0,i.openBlock)(),(0,i.createElementBlock)('span',Da,' ×'+(0,i.toDisplayString)(A(e)),1)):(0,i.createCommentVNode)('v-if',!0)],8,Ua))),128))]),h.value.length>12?((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:0,class:'acu-btn acu-btn-link acu-show-more',onClick:a[7]||(a[7]=e=>M(v.value))},' 查看全部 ('+(0,i.toDisplayString)(h.value.length)+') ',1)):(0,i.createCommentVNode)('v-if',!0)])])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 统计概览 '),(0,i.createElementVNode)('div',Ma,[a[24]||(a[24]=(0,i.createElementVNode)('div',{class:'acu-card-header'},[(0,i.createElementVNode)('i',{class:'fas fa-chart-bar'}),(0,i.createElementVNode)('span',null,'数据统计')],-1)),(0,i.createElementVNode)('div',_a,[(0,i.createElementVNode)('div',Ia,[(0,i.createElementVNode)('div',$a,[(0,i.createElementVNode)('span',Pa,(0,i.toDisplayString)(y.value),1),a[20]||(a[20]=(0,i.createElementVNode)('span',{class:'acu-stat-label'},'表格',-1))]),(0,i.createElementVNode)('div',Fa,[(0,i.createElementVNode)('span',ja,(0,i.toDisplayString)(k.value),1),a[21]||(a[21]=(0,i.createElementVNode)('span',{class:'acu-stat-label'},'记录',-1))]),(0,i.createElementVNode)('div',{class:(0,i.normalizeClass)(['acu-stat-item',{'acu-stat-highlight':C.value>0}])},[(0,i.createElementVNode)('span',La,(0,i.toDisplayString)(C.value),1),a[22]||(a[22]=(0,i.createElementVNode)('span',{class:'acu-stat-label'},'变更',-1))],2),(0,i.createElementVNode)('div',{class:(0,i.normalizeClass)(['acu-stat-item',{'acu-stat-danger':N.value>0}])},[(0,i.createElementVNode)('span',Ra,(0,i.toDisplayString)(N.value),1),a[23]||(a[23]=(0,i.createElementVNode)('span',{class:'acu-stat-label'},'待删除',-1))],2)])])]),(0,i.createCommentVNode)(' 快捷表格入口 '),w.value.length>0?((0,i.openBlock)(),(0,i.createElementBlock)('div',Oa,[a[25]||(a[25]=(0,i.createElementVNode)('div',{class:'acu-card-header'},[(0,i.createElementVNode)('i',{class:'fas fa-th'}),(0,i.createElementVNode)('span',null,'快捷访问')],-1)),(0,i.createElementVNode)('div',Ha,[(0,i.createElementVNode)('div',qa,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(w.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:e.id,class:'acu-quick-btn',onClick:a=>M(e.id)},[(0,i.createElementVNode)('i',{class:(0,i.normalizeClass)(D(e.id))},null,2),(0,i.createElementVNode)('span',null,(0,i.toDisplayString)(e.name),1),e.count>0?((0,i.openBlock)(),(0,i.createBlock)(Ye,{key:0,value:`${e.count}`,type:'number'},null,8,['value'])):(0,i.createCommentVNode)('v-if',!0)],8,Ya))),128))])])])):(0,i.createCommentVNode)('v-if',!0)])]))}}),Wa={class:'acu-table-toolbar'},Ka={class:'acu-toolbar-left'},Ja={class:'acu-table-title'},Ga={class:'acu-table-count'},Qa={key:0,class:'acu-table-badge acu-badge-changed'},Za={key:1,class:'acu-table-badge acu-badge-deleting'},et={class:'acu-toolbar-right'},at=['title'],tt={class:'acu-search-box'},ot={key:0,class:'acu-empty-state'},nt={key:0,class:'acu-pagination-container'},rt={class:'acu-pagination-numbers'},it={key:0,class:'acu-page-dots'},ct=['onClick'],lt=(0,i.defineComponent)({__name:'DataTable',props:{tableId:{},tableName:{},rows:{},headers:{default:()=>[]},searchTerm:{default:''},showIndex:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showPagination:{type:Boolean,default:!0},emptyText:{default:'暂无数据'},isLoading:{type:Boolean,default:!1}},emits:['cellClick','insertRow','toggleDelete','contextMenu','searchChange','pageChange','close','heightDragStart','heightReset'],setup(e,{emit:a}){const t=e,o=a,n=ie(),r=ae(),c=xe(),l=(0,i.ref)(),s=(0,i.ref)(),u=(0,i.ref)(c.getTableStyle(t.tableName)),d=(0,i.ref)(t.searchTerm),p=(0,i.ref)(1),g=(0,i.computed)(()=>{if(t.tableName.includes('总结')||t.tableName.includes('大纲')){const e=t.headers.findIndex(e=>e&&(e.includes('索引')||e.includes('编号')||e.includes('代码')));if(e>0)return e}return 1}),m=(0,i.computed)(()=>c.isTableReversed(t.tableName)),f=(0,i.computed)(()=>{const e=d.value.toLowerCase().trim();return e?t.rows.filter(a=>a.cells.some(a=>String(a.value).toLowerCase().includes(e))):t.rows});function b(e){return n.getRowChangeType(t.tableName,e.index,e.cells.length)}function v(e){return'manual'===e?2:'ai'===e?1:0}const h=(0,i.computed)(()=>[...f.value].sort((e,a)=>{const t=b(e),o=b(a),n=v(t),r=v(o);return n!==r?r-n:m.value?a.index-e.index:e.index-a.index})),x=(0,i.computed)(()=>r.config.itemsPerPage||20),w=(0,i.computed)(()=>Math.max(1,Math.ceil(h.value.length/x.value))),y=(0,i.computed)(()=>{const e=(p.value-1)*x.value;return h.value.slice(e,e+x.value)}),k=(0,i.computed)(()=>t.rows.length),C=(0,i.computed)(()=>t.rows.filter(e=>B(e)).length),N=(0,i.computed)(()=>t.rows.filter(e=>{const a=`${t.tableName}-row-${e.index}`;return n.pendingDeletes.has(a)}).length),V=(0,i.computed)(()=>t.showPagination&&!1!==r.config.showPagination),E=(0,i.computed)(()=>{const e=[],a=w.value,t=p.value;if(a<=7)for(let t=1;t<=a;t++)e.push(t);else{e.push(1),t>3&&e.push('...');const o=Math.max(2,t-1),n=Math.min(a-1,t+1);for(let a=o;a<=n;a++)e.push(a);t<a-2&&e.push('...'),e.push(a)}return e});function B(e){return n.isRowChanged(t.tableName,e.index,e.cells.length)}function S(){c.toggleTableReverse(t.tableName)}function T(){u.value='card'===u.value?'list':'card'}function A(){o('close')}function U(){p.value=1,o('searchChange',d.value)}function D(){d.value='',p.value=1,o('searchChange','')}function M(e){e<1||e>w.value||(p.value=e,o('pageChange',e),(0,i.nextTick)(()=>{l.value?.scrollTo({top:0,behavior:'smooth'})}))}function I(e,a){o('cellClick',t.tableId,e,a)}function P(e,a){o('contextMenu',e,t.tableId,a)}function F(e){s.value&&o('heightDragStart',e,s.value)}function j(){o('heightReset')}let L=0;function R(){const e=Date.now();e-L<300?(j(),L=0):L=e}return(0,i.watch)(()=>t.searchTerm,e=>{d.value=e}),(0,i.watch)(u,e=>{c.setTableStyle(t.tableName,e)}),(0,i.watch)(w,e=>{p.value>e&&(p.value=Math.max(1,e))}),(a,n)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{class:(0,i.normalizeClass)(['acu-data-table',{'acu-table-loading':e.isLoading}])},[(0,i.createCommentVNode)(' 固定工具栏 '),(0,i.createElementVNode)('div',Wa,[(0,i.createCommentVNode)(' 左侧：表名 + (条数) '),(0,i.createElementVNode)('div',Ka,[(0,i.createElementVNode)('span',Ja,(0,i.toDisplayString)(e.tableName),1),(0,i.createElementVNode)('span',Ga,'('+(0,i.toDisplayString)(k.value)+')',1),C.value>0?((0,i.openBlock)(),(0,i.createElementBlock)('span',Qa,(0,i.toDisplayString)(C.value),1)):(0,i.createCommentVNode)('v-if',!0),N.value>0?((0,i.openBlock)(),(0,i.createElementBlock)('span',Za,(0,i.toDisplayString)(N.value),1)):(0,i.createCommentVNode)('v-if',!0)]),(0,i.createCommentVNode)(' 右侧：从右到左 - 关闭、搜索、高度拖手、倒序、视图切换 '),(0,i.createElementVNode)('div',et,[(0,i.createCommentVNode)(' 视图切换按钮 '),(0,i.createElementVNode)('button',{class:'acu-toolbar-btn',title:'card'===u.value?'切换到列表视图':'切换到卡片视图',onClick:T},[(0,i.createElementVNode)('i',{class:(0,i.normalizeClass)('card'===u.value?'fas fa-list':'fas fa-th-large')},null,2)],8,at),(0,i.createCommentVNode)(' 倒序按钮 '),(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-toolbar-btn',{active:m.value}]),title:'倒序显示',onClick:S},[...n[3]||(n[3]=[(0,i.createElementVNode)('i',{class:'fas fa-sort-amount-down-alt'},null,-1)])],2),(0,i.createCommentVNode)(' 高度拖手 '),(0,i.createElementVNode)('button',{ref_key:'heightHandleRef',ref:s,class:'acu-toolbar-btn acu-height-handle',title:'拖动调整高度 / 双击重置',onPointerdown:F,onDblclick:j,onTouchend:(0,i.withModifiers)(R,['stop'])},[...n[4]||(n[4]=[(0,i.createElementVNode)('i',{class:'fas fa-grip-lines'},null,-1)])],544),(0,i.createCommentVNode)(' 搜索框 '),(0,i.createElementVNode)('div',tt,[n[5]||(n[5]=(0,i.createElementVNode)('i',{class:'fas fa-search acu-search-icon'},null,-1)),(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':n[0]||(n[0]=e=>d.value=e),type:'text',class:'acu-search-input',placeholder:'搜索...',onInput:U},null,544),[[i.vModelText,d.value]]),d.value?((0,i.openBlock)(),(0,i.createElementBlock)('i',{key:0,class:'fas fa-times acu-search-clear',onClick:D})):(0,i.createCommentVNode)('v-if',!0)]),(0,i.createCommentVNode)(' 关闭按钮 '),(0,i.createElementVNode)('button',{class:'acu-toolbar-btn acu-close-btn',title:'关闭数据区',onClick:(0,i.withModifiers)(A,['stop'])},[...n[6]||(n[6]=[(0,i.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])])]),(0,i.createCommentVNode)(' 数据卡片列表 '),(0,i.createElementVNode)('div',{ref_key:'containerRef',ref:l,class:(0,i.normalizeClass)(['acu-cards-container',[`acu-view-${u.value}`]])},[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(y.value,a=>((0,i.openBlock)(),(0,i.createBlock)(pa,{key:`${e.tableId}-${a.index}`,data:a,'table-id':e.tableId,'table-name':e.tableName,'is-changed':B(a),layout:(0,i.unref)(r).config.layout,'view-mode':u.value,'show-index':e.showIndex,'show-header':e.showHeader,'title-col-index':g.value,onCellClick:I,onInsertRow:e=>{return n=a.index,void o('insertRow',t.tableId,n);var n},onToggleDelete:e=>{return n=a.index,void o('toggleDelete',t.tableId,n);var n},onContextMenu:P},null,8,['data','table-id','table-name','is-changed','layout','view-mode','show-index','show-header','title-col-index','onInsertRow','onToggleDelete']))),128)),(0,i.createCommentVNode)(' 空状态 '),0===f.value.length?((0,i.openBlock)(),(0,i.createElementBlock)('div',ot,[n[7]||(n[7]=(0,i.createElementVNode)('i',{class:'fas fa-inbox'},null,-1)),(0,i.createElementVNode)('p',null,(0,i.toDisplayString)(e.emptyText),1)])):(0,i.createCommentVNode)('v-if',!0)],2),(0,i.createCommentVNode)(' 分页器 (读取全局配置) '),(0,i.renderSlot)(a.$slots,'pagination',{},()=>[V.value&&w.value>1?((0,i.openBlock)(),(0,i.createElementBlock)('div',nt,[(0,i.createCommentVNode)(' 上一页 (固定在最左) '),(0,i.createElementVNode)('div',{class:(0,i.normalizeClass)(['acu-page-btn acu-page-arrow',{disabled:1===p.value}]),title:'上一页',onClick:n[1]||(n[1]=e=>p.value>1&&M(p.value-1))},[...n[8]||(n[8]=[(0,i.createElementVNode)('i',{class:'fa-solid fa-chevron-left'},null,-1)])],2),(0,i.createCommentVNode)(' 中间数字区 (居中) '),(0,i.createElementVNode)('div',rt,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(E.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:e},['...'===e?((0,i.openBlock)(),(0,i.createElementBlock)('div',it,'...')):((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:1,class:(0,i.normalizeClass)(['acu-page-btn',{active:e===p.value}]),onClick:a=>M(e)},(0,i.toDisplayString)(e),11,ct))],64))),128))]),(0,i.createCommentVNode)(' 下一页 (固定在最右) '),(0,i.createElementVNode)('div',{class:(0,i.normalizeClass)(['acu-page-btn acu-page-arrow',{disabled:p.value===w.value}]),title:'下一页',onClick:n[2]||(n[2]=e=>p.value<w.value&&M(p.value+1))},[...n[9]||(n[9]=[(0,i.createElementVNode)('i',{class:'fa-solid fa-chevron-right'},null,-1)])],2)])):(0,i.createCommentVNode)('v-if',!0)])],2))}}),st=lt,ut={class:'acu-options-panel'},dt={class:'acu-panel-header acu-options-header'},pt={class:'acu-header-actions'},gt={class:'acu-options-count'},mt={class:'acu-panel-content acu-options-content'},ft={key:0,class:'acu-empty-state'},bt={class:'acu-options-list'},vt={class:'acu-dash-title'},ht={class:'acu-option-rows'},xt=['onClick'],wt={class:'acu-option-tags'},yt={class:'acu-option-text'},kt=(0,i.defineComponent)({__name:'OptionsPanel',props:{tables:{}},emits:['navigate','optionClick'],setup(e,{emit:a}){const t=e,o=a,{setInput:n}=Ie(),r=(0,i.computed)(()=>t.tables.filter(e=>e.name.includes('选项')));function c(e){const a=[],{isMatrix:t,optionColIndices:o}=function(e){const a=e.headers||[],t=[];return a.forEach((e,a)=>{e&&/(选项|Option|分支)/i.test(String(e))&&t.push(a)}),{isMatrix:t.length>=2,optionColIndices:t}}(e),n=e.headers||[];return e.rows.forEach(e=>{const r=e.cells.map(e=>String(e.value||'').trim());if(t){const e=[];r.forEach((a,t)=>{!o.includes(t)&&a&&e.push(a)}),o.forEach(t=>{const o=r[t];if(o){const r=n[t]||'',i=[...e];r&&i.push(r),a.push({text:o,tags:i})}})}else{const e=r.filter(e=>''!==e);if(0===e.length)return;const t=e[e.length-1],o=e.slice(0,e.length-1);a.push({text:t,tags:o})}}),a}function l(e,a){const t=e.currentTarget;a?(t.style.background='var(--acu-table-hover)',t.style.borderColor='var(--acu-highlight)'):(t.style.background='rgba(255,255,255,0.05)',t.style.borderColor='var(--acu-border)')}return(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',ut,[(0,i.createCommentVNode)(' 面板头部 '),(0,i.createElementVNode)('div',dt,[a[4]||(a[4]=(0,i.createElementVNode)('div',{class:'acu-panel-title acu-options-title'},[(0,i.createElementVNode)('i',{class:'fa-solid fa-list-check'}),(0,i.createTextVNode)(' 选项聚合 ')],-1)),(0,i.createElementVNode)('div',pt,[(0,i.createElementVNode)('span',gt,(0,i.toDisplayString)(r.value.length)+' 个选项表',1)])]),(0,i.createCommentVNode)(' 内容滚动区域 '),(0,i.createElementVNode)('div',mt,[(0,i.createCommentVNode)(' 空状态 '),0===r.value.length?((0,i.openBlock)(),(0,i.createElementBlock)('div',ft,'未找到名称包含"选项"的表格')):((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createCommentVNode)(' 选项表格列表 '),(0,i.createElementVNode)('div',bt,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(r.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.id,class:'acu-dash-card'},[(0,i.createCommentVNode)(' 表格标题 '),(0,i.createElementVNode)('div',vt,(0,i.toDisplayString)(e.name),1),(0,i.createCommentVNode)(' 选项行列表 '),(0,i.createElementVNode)('div',ht,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(c(e),(e,t)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:t,class:'acu-option-row',title:'点击追加',onClick:a=>{return t=e.text,n(t),o('optionClick',t),void Se.toast.success('已追加到输入框');var t},onMouseover:a[0]||(a[0]=e=>l(e,!0)),onMouseout:a[1]||(a[1]=e=>l(e,!1)),onMousedown:a[2]||(a[2]=e=>{e.currentTarget.style.transform='translateY(1px)'}),onMouseup:a[3]||(a[3]=e=>{e.currentTarget.style.transform='translateY(0)'})},[(0,i.createCommentVNode)(' 标签区域 '),(0,i.createElementVNode)('div',wt,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(e.tags,(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('span',{key:a,class:'acu-badge acu-option-tag'},(0,i.toDisplayString)(e),1))),128))]),(0,i.createCommentVNode)(' 选项文本 '),(0,i.createElementVNode)('div',yt,(0,i.toDisplayString)(e.text),1)],40,xt))),128))])]))),128))])],2112))])]))}}),Ct=(0,i.defineComponent)({__name:'ContextMenu',props:{visible:{type:Boolean},x:{},y:{},tableId:{},tableName:{},rowIndex:{},cellValue:{}},emits:['update:visible','insertRow','delete','undoDelete','copied'],setup(e,{expose:a,emit:t}){const o=e,n=t,r=(0,i.ref)(),c=ie(),{copy:l,copied:s}=P(),u=(0,i.computed)(()=>{const e=`${o.tableName||o.tableId}-row-${o.rowIndex}`;return c.pendingDeletes.has(e)}),d=(0,i.computed)(()=>{const e=window.parent||window,a=e.innerWidth,t=e.innerHeight;let n=o.x,r=o.y;return n+180>a&&(n=a-180-10),r+200>t&&(r=t-200-10),n=Math.max(10,n),r=Math.max(10,r),{left:`${n}px`,top:`${r}px`}});let p=null,g=null;(0,i.onMounted)(()=>{const e=window.parent?.document||document;p=e=>{if(!o.visible||!r.value)return;const a=e.target;r.value.contains(a)||(console.info('[ACU] 点击外部关闭右键菜单'),m())},g=e=>{if(!o.visible||!r.value)return;const a=e.target;r.value.contains(a)||(console.info('[ACU] 右键点击外部关闭右键菜单'),m())},e.addEventListener('click',p,!0),e.addEventListener('contextmenu',g,!0),e.addEventListener('touchstart',p,!0)}),(0,i.onUnmounted)(()=>{const e=window.parent?.document||document;p&&(e.removeEventListener('click',p,!0),e.removeEventListener('touchstart',p,!0),p=null),g&&(e.removeEventListener('contextmenu',g,!0),g=null)}),(0,i.watch)(()=>o.visible,e=>{e&&(0,i.nextTick)(()=>{r.value?.focus()})});const m=()=>{n('update:visible',!1)},f=()=>{n('insertRow',o.tableId,o.rowIndex),m()},b=async()=>{if(o.cellValue)try{await l(o.cellValue),n('copied')}catch(e){console.error('[ACU] Copy failed:',e)}m()},v=()=>{n('delete',o.tableId,o.rowIndex),m()},h=()=>{n('undoDelete',o.tableId,o.rowIndex),m()};return a({close:m,copied:s}),(a,t)=>((0,i.openBlock)(),(0,i.createBlock)(i.Transition,{name:'acu-menu-fade'},{default:(0,i.withCtx)(()=>[e.visible?((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,ref_key:'menuRef',ref:r,class:'acu-context-menu',style:(0,i.normalizeStyle)(d.value),tabindex:'-1',onKeydown:(0,i.withKeys)(m,['escape']),onClick:t[0]||(t[0]=(0,i.withModifiers)(()=>{},['stop'])),onMousedown:t[1]||(t[1]=(0,i.withModifiers)(()=>{},['stop'])),onTouchstart:t[2]||(t[2]=(0,i.withModifiers)(()=>{},['stop']))},[(0,i.createCommentVNode)(' 插入行 '),(0,i.createElementVNode)('div',{class:'acu-menu-item',onClick:(0,i.withModifiers)(f,['stop'])},[...t[3]||(t[3]=[(0,i.createElementVNode)('i',{class:'fas fa-plus'},null,-1),(0,i.createElementVNode)('span',null,'插入行',-1)])]),(0,i.createCommentVNode)(' 复制内容 '),(0,i.createElementVNode)('div',{class:'acu-menu-item',onClick:(0,i.withModifiers)(b,['stop'])},[...t[4]||(t[4]=[(0,i.createElementVNode)('i',{class:'fas fa-copy'},null,-1),(0,i.createElementVNode)('span',null,'复制内容',-1)])]),(0,i.createCommentVNode)(' 分隔线 '),t[7]||(t[7]=(0,i.createElementVNode)('div',{class:'acu-menu-divider'},null,-1)),(0,i.createCommentVNode)(' 删除行（未标记删除时显示） '),u.value?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createCommentVNode)(' 撤销删除（已标记删除时显示） '),(0,i.createElementVNode)('div',{class:'acu-menu-item acu-menu-warning',onClick:(0,i.withModifiers)(h,['stop'])},[...t[6]||(t[6]=[(0,i.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,i.createElementVNode)('span',null,'撤销删除',-1)])])],2112)):((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,class:'acu-menu-item acu-menu-danger',onClick:(0,i.withModifiers)(v,['stop'])},[...t[5]||(t[5]=[(0,i.createElementVNode)('i',{class:'fas fa-trash'},null,-1),(0,i.createElementVNode)('span',null,'删除整行',-1)])]))],36)):(0,i.createCommentVNode)('v-if',!0)]),_:1}))}}),Nt={class:'acu-pagination'},Vt={class:'acu-pagination-info'},Et={class:'acu-pagination-current'},zt={key:0,class:'acu-pagination-total'},Bt={class:'acu-pagination-controls'},St=['disabled'],Tt=['disabled'],At={class:'acu-page-list'},Ut={key:0,class:'acu-page-ellipsis'},Dt=['onClick'],Mt=['disabled'],_t=['disabled'],It={key:0,class:'acu-pagination-jump'},$t=['max'],Pt=(Boolean,Boolean,{class:'acu-search-input-wrapper'}),Ft=['placeholder'],jt={key:0,class:'acu-search-result'},Lt={key:1,class:'no-result'},Rt=(Boolean,Boolean,{class:'acu-modal-body'}),Ot={class:'floor-input-group'},Ht={key:0,class:'floor-info'},qt={key:1,class:'floor-error'},Yt={class:'acu-modal-footer'},Xt=['disabled'],Wt=(0,i.defineComponent)({__name:'InputFloorDialog',props:{visible:{type:Boolean},currentFloorInfo:{default:''},maxFloor:{default:999}},emits:['update:visible','confirm'],setup(e,{emit:a}){const t=e,o=a,n=(0,i.ref)(),r=(0,i.ref)(),c=(0,i.ref)(null),l=(0,i.computed)(()=>{if(null===c.value||void 0===c.value)return!1;const e=c.value;return Number.isInteger(e)&&0!==e}),s=(0,i.computed)(()=>null===c.value||void 0===c.value?'':0===c.value?'楼层索引不能为 0':Number.isInteger(c.value)?Math.abs(c.value)>t.maxFloor?`楼层索引超出范围 (±${t.maxFloor})`:'':'请输入整数');(0,i.watch)(()=>t.visible,e=>{e&&(c.value=null,(0,i.nextTick)(()=>{r.value?.focus()}))}),D(n,()=>{d()});const u=()=>{l.value&&null!==c.value&&(o('confirm',c.value),o('update:visible',!1))},d=()=>{o('update:visible',!1)};return(a,t)=>((0,i.openBlock)(),(0,i.createBlock)(i.Transition,{name:'modal'},{default:(0,i.withCtx)(()=>[e.visible?((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,i.withModifiers)(d,['self'])},[(0,i.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-input-floor-modal'},[(0,i.createCommentVNode)(' 头部 '),(0,i.createElementVNode)('div',{class:'acu-modal-header'},[t[2]||(t[2]=(0,i.createElementVNode)('h3',null,[(0,i.createElementVNode)('i',{class:'fas fa-layer-group'}),(0,i.createTextVNode)(' 指定保存楼层 ')],-1)),(0,i.createElementVNode)('button',{class:'acu-modal-close',onClick:d},[...t[1]||(t[1]=[(0,i.createElementVNode)('i',{class:'fas fa-times'},null,-1)])])]),(0,i.createCommentVNode)(' 内容 '),(0,i.createElementVNode)('div',Rt,[(0,i.createElementVNode)('div',Ot,[t[5]||(t[5]=(0,i.createElementVNode)('p',{class:'floor-hint'},'输入目标楼层索引。正数为从头开始计数，负数为倒数计数（-1 表示最后一楼）。',-1)),(0,i.withDirectives)((0,i.createElementVNode)('input',{ref_key:'inputRef',ref:r,'onUpdate:modelValue':t[0]||(t[0]=e=>c.value=e),type:'number',class:'floor-input',placeholder:'例如: 5 或 -1',onKeydown:[(0,i.withKeys)(u,['enter']),(0,i.withKeys)(d,['escape'])]},null,544),[[i.vModelText,c.value,void 0,{number:!0}]]),e.currentFloorInfo?((0,i.openBlock)(),(0,i.createElementBlock)('div',Ht,[t[3]||(t[3]=(0,i.createElementVNode)('i',{class:'fas fa-info-circle'},null,-1)),(0,i.createElementVNode)('span',null,'当前自动目标楼层: '+(0,i.toDisplayString)(e.currentFloorInfo),1)])):(0,i.createCommentVNode)('v-if',!0),s.value?((0,i.openBlock)(),(0,i.createElementBlock)('div',qt,[t[4]||(t[4]=(0,i.createElementVNode)('i',{class:'fas fa-exclamation-circle'},null,-1)),(0,i.createElementVNode)('span',null,(0,i.toDisplayString)(s.value),1)])):(0,i.createCommentVNode)('v-if',!0)])]),(0,i.createCommentVNode)(' 底部 '),(0,i.createElementVNode)('div',Yt,[(0,i.createElementVNode)('button',{class:'acu-modal-btn secondary',onClick:d},'取消'),(0,i.createElementVNode)('button',{class:'acu-modal-btn primary',disabled:!l.value,onClick:u},[...t[6]||(t[6]=[(0,i.createElementVNode)('i',{class:'fas fa-save'},null,-1),(0,i.createTextVNode)(' 保存到此楼层 ',-1)])],8,Xt)])],512)])):(0,i.createCommentVNode)('v-if',!0)]),_:1}))}}),Kt={class:'acu-modal-body'},Jt={key:0,class:'acu-loading-state'},Gt={class:'acu-settings-group'},Qt={class:'acu-settings-row'},Zt={class:'acu-settings-control'},eo={class:'acu-settings-row'},ao={class:'acu-settings-control'},to={class:'acu-settings-row'},oo={class:'acu-settings-control'},no={class:'acu-settings-row'},ro={class:'acu-settings-control'},io={class:'acu-update-action-group'},co=['disabled'],lo={key:0,class:'fas fa-spinner fa-spin'},so={key:1,class:'fas fa-hand-sparkles'},uo=(0,i.defineComponent)({__name:'ManualUpdateDialog',props:{visible:{type:Boolean}},emits:['update:visible'],setup(e,{emit:a}){const t=e,o=a,n=(0,i.ref)(),r=(0,i.ref)(!0),c=(0,i.ref)(!1),l=(0,i.reactive)({autoUpdateThreshold:void 0,autoUpdateFrequency:void 0,updateBatchSize:void 0,skipUpdateFloors:void 0}),{settings:s,loadSettings:u,saveSettings:d,executeManualUpdate:p}=function(){const e=(0,i.ref)({}),a=(0,i.ref)(!1),t=(0,i.ref)(!1);async function o(a){try{const t=te().getDB(),o={...e.value,...a};return t&&'function'==typeof t.updateSettings?(await t.updateSettings(o),e.value=o,console.info('[ACU] 通过 API 保存设置成功'),!0):(_e(o),e.value=o,console.info('[ACU] 通过 localStorage 保存设置'),!0)}catch(t){console.error('[ACU] 保存设置失败:',t);try{return _e({...e.value,...a}),e.value={...e.value,...a},!0}catch{return!1}}}return{settings:e,isLoading:a,isInitialized:t,loadSettings:async function(){a.value=!0;try{const a=te().getDB();if(a&&'function'==typeof a.getSettings){const t=await a.getSettings();if(t&&'object'==typeof t)return e.value=t,console.info('[ACU] 从 API 读取设置成功'),t}const t=Me();return e.value=t,console.info('[ACU] 从 localStorage 读取设置'),t}catch(a){console.error('[ACU] 读取设置失败:',a);const t=Me();return e.value=t,t}finally{a.value=!1,t.value=!0}},saveSettings:o,updateSetting:async function(e,a){await o({[e]:a})},executeManualUpdate:async function(){try{const e=te().getDB();if(!e)return console.warn('[ACU] 数据库 API 不可用'),!1;if('function'==typeof e.manualUpdate)return await e.manualUpdate(),console.info('[ACU] 手动更新执行成功 (manualUpdate)'),!0;if('function'==typeof e.triggerUpdate){const a=await e.triggerUpdate();return console.info('[ACU] 手动更新执行成功 (triggerUpdate):',a),!!a}return console.warn('[ACU] 没有可用的更新方法'),!1}catch(e){return console.error('[ACU] 手动更新失败:',e),!1}},findDatabaseSettingsKey:De}}();function g(){o('update:visible',!1)}async function m(e,a){if(void 0!==a&&!isNaN(a))try{await d({[e]:a}),console.info(`[ACU] 配置项 ${e} 已更新为:`,a)}catch(a){console.error(`[ACU] 保存配置项 ${e} 失败:`,a),Se.toast.error('保存配置失败')}}async function f(){if(!c.value){c.value=!0;try{await p()?Se.toast.success('手动更新已执行'):Se.toast.warning('更新执行完成，请检查结果')}catch(e){console.error('[ACU] 手动更新执行失败:',e),Se.toast.error('手动更新执行失败')}finally{c.value=!1}}}return(0,i.watch)(()=>t.visible,async e=>{if(e){r.value=!0;try{await u(),Object.assign(l,{autoUpdateThreshold:s.value.autoUpdateThreshold,autoUpdateFrequency:s.value.autoUpdateFrequency,updateBatchSize:s.value.updateBatchSize,skipUpdateFloors:s.value.skipUpdateFloors})}catch(e){console.error('[ACU] 加载配置失败:',e),Se.toast.error('加载配置失败')}finally{r.value=!1}}},{immediate:!0}),D(n,()=>{g()}),(a,t)=>e.visible?((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,i.withModifiers)(g,['self'])},[(0,i.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-manual-update-modal'},[(0,i.createCommentVNode)(' 头部 '),(0,i.createElementVNode)('div',{class:'acu-modal-header'},[(0,i.createCommentVNode)(' 返回按钮 '),(0,i.createElementVNode)('button',{class:'acu-modal-back',onClick:g},[...t[8]||(t[8]=[(0,i.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])]),t[9]||(t[9]=(0,i.createElementVNode)('span',{class:'acu-modal-title'},'手动更新配置',-1)),(0,i.createCommentVNode)(' 胶囊式完成按钮 '),(0,i.createElementVNode)('button',{class:'acu-close-pill',onClick:g},'完成')]),(0,i.createCommentVNode)(' 内容 '),(0,i.createElementVNode)('div',Kt,[(0,i.createCommentVNode)(' 加载状态 '),r.value?((0,i.openBlock)(),(0,i.createElementBlock)('div',Jt,[...t[10]||(t[10]=[(0,i.createElementVNode)('i',{class:'fas fa-spinner fa-spin'},null,-1),(0,i.createElementVNode)('span',null,'加载配置中...',-1)])])):((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createCommentVNode)(' 配置项 '),(0,i.createElementVNode)('div',Gt,[t[15]||(t[15]=(0,i.createElementVNode)('div',{class:'acu-settings-title'},[(0,i.createElementVNode)('i',{class:'fas fa-sliders-h'}),(0,i.createTextVNode)(' 更新参数设置 ')],-1)),(0,i.createCommentVNode)(' AI读取上下文层数 '),(0,i.createElementVNode)('div',Qt,[t[11]||(t[11]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' AI读取上下文层数 '),(0,i.createElementVNode)('span',{class:'hint'},'AI阅读最近多少层来理解剧情')],-1)),(0,i.createElementVNode)('div',Zt,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[0]||(t[0]=e=>l.autoUpdateThreshold=e),type:'number',class:'acu-config-input',min:'1',max:'500',onChange:t[1]||(t[1]=e=>m('autoUpdateThreshold',l.autoUpdateThreshold))},null,544),[[i.vModelText,l.autoUpdateThreshold,void 0,{number:!0}]])])]),(0,i.createCommentVNode)(' 每N层自动更新一次 '),(0,i.createElementVNode)('div',eo,[t[12]||(t[12]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 每N层自动更新一次 '),(0,i.createElementVNode)('span',{class:'hint'},'设置自动触发更新的楼层间隔')],-1)),(0,i.createElementVNode)('div',ao,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[2]||(t[2]=e=>l.autoUpdateFrequency=e),type:'number',class:'acu-config-input',min:'1',max:'100',onChange:t[3]||(t[3]=e=>m('autoUpdateFrequency',l.autoUpdateFrequency))},null,544),[[i.vModelText,l.autoUpdateFrequency,void 0,{number:!0}]])])]),(0,i.createCommentVNode)(' 每批次更新楼层数 '),(0,i.createElementVNode)('div',to,[t[13]||(t[13]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 每批次更新楼层数 '),(0,i.createElementVNode)('span',{class:'hint'},'单次更新处理的最大楼层数')],-1)),(0,i.createElementVNode)('div',oo,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[4]||(t[4]=e=>l.updateBatchSize=e),type:'number',class:'acu-config-input',min:'1',max:'50',onChange:t[5]||(t[5]=e=>m('updateBatchSize',l.updateBatchSize))},null,544),[[i.vModelText,l.updateBatchSize,void 0,{number:!0}]])])]),(0,i.createCommentVNode)(' 保留X层楼不更新 '),(0,i.createElementVNode)('div',no,[t[14]||(t[14]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 保留X层楼不更新 '),(0,i.createElementVNode)('span',{class:'hint'},'最近的几层楼跳过更新')],-1)),(0,i.createElementVNode)('div',ro,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[6]||(t[6]=e=>l.skipUpdateFloors=e),type:'number',class:'acu-config-input',min:'0',max:'20',onChange:t[7]||(t[7]=e=>m('skipUpdateFloors',l.skipUpdateFloors))},null,544),[[i.vModelText,l.skipUpdateFloors,void 0,{number:!0}]])])])]),(0,i.createCommentVNode)(' 执行按钮 '),(0,i.createElementVNode)('div',io,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-update-btn',{'is-updating':c.value}]),disabled:c.value,onClick:f},[c.value?((0,i.openBlock)(),(0,i.createElementBlock)('i',lo)):((0,i.openBlock)(),(0,i.createElementBlock)('i',so)),(0,i.createElementVNode)('span',null,(0,i.toDisplayString)(c.value?'正在更新...':'立即执行手动更新'),1)],10,co)])],64))])],512)])):(0,i.createCommentVNode)('v-if',!0)}});r(655);var po=r(455);const go=(0,po.A)(uo,[['__scopeId','data-v-54d99594']]),mo={class:'acu-purge-content'},fo={class:'acu-purge-inputs'},bo={class:'acu-purge-btns'},vo=['disabled'],ho=(0,i.defineComponent)({__name:'PurgeRangeDialog',props:{visible:{type:Boolean},maxFloor:{default:999}},emits:['update:visible','confirm'],setup(e,{emit:a}){const t=e,o=a,n=(0,i.ref)(),r=(0,i.ref)(),c=(0,i.ref)(),l=(0,i.ref)(null),s=(0,i.ref)(null),u=(0,i.ref)(!1);const d=(0,i.computed)(()=>null!==l.value&&null!==s.value&&(!isNaN(l.value)&&!isNaN(s.value)&&(!(l.value<0||s.value<0)&&!(l.value>s.value))));(0,i.watch)(()=>t.visible,e=>{if(e){const e=function(){let e=window.SillyTavern||(window.parent?window.parent.SillyTavern:null);!e&&window.top&&window.top.SillyTavern&&(e=window.top.SillyTavern);let a=-1,t=0;if(e&&e.chat){t=Math.max(0,e.chat.length-1);for(let t=e.chat.length-1;t>=0;t--){const o=e.chat[t];if(!o.is_user&&o.TavernDB_ACU_IsolatedData){a=t;break}}}return{start:-1!==a?a:t,end:-1!==a?a:t}}();l.value=e.start,s.value=e.end,u.value=!1,(0,i.nextTick)(()=>{r.value?.focus()})}}),D(n,()=>{m()});const p=()=>{c.value?.focus()},g=()=>{d.value&&null!==l.value&&null!==s.value?(o('confirm',l.value,s.value),o('update:visible',!1)):(u.value=!0,setTimeout(()=>{u.value=!1},500),Se.toast.warning('请输入有效的楼层范围 (Start <= End)'))},m=()=>{o('update:visible',!1)};return(a,t)=>e.visible?((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,class:'acu-modal-container acu-purge-overlay',onClick:(0,i.withModifiers)(m,['self'])},[(0,i.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-purge-range-modal'},[(0,i.createCommentVNode)(' 标题区 '),t[5]||(t[5]=(0,i.createElementVNode)('div',{class:'acu-purge-title'},'清除数据范围',-1)),(0,i.createCommentVNode)(' 内容区 '),(0,i.createElementVNode)('div',mo,[(0,i.createCommentVNode)(' 装饰图标 '),t[3]||(t[3]=(0,i.createElementVNode)('div',{class:'acu-purge-icon'},[(0,i.createElementVNode)('i',{class:'fa-solid fa-eraser'})],-1)),(0,i.createCommentVNode)(' 提示文字 '),t[4]||(t[4]=(0,i.createElementVNode)('p',{class:'acu-purge-hint'},[(0,i.createTextVNode)(' 请输入要清除数据的楼层范围'),(0,i.createElementVNode)('br'),(0,i.createElementVNode)('span',{class:'acu-purge-hint-sub'},'(起始楼层 - 结束楼层)')],-1)),(0,i.createCommentVNode)(' 范围输入 '),(0,i.createElementVNode)('div',fo,[(0,i.withDirectives)((0,i.createElementVNode)('input',{ref_key:'startInputRef',ref:r,'onUpdate:modelValue':t[0]||(t[0]=e=>l.value=e),type:'number',class:'acu-purge-input',placeholder:'Start',min:'0',onKeydown:(0,i.withKeys)(p,['enter'])},null,544),[[i.vModelText,l.value,void 0,{number:!0}]]),t[2]||(t[2]=(0,i.createElementVNode)('span',{class:'acu-purge-separator'},'-',-1)),(0,i.withDirectives)((0,i.createElementVNode)('input',{ref_key:'endInputRef',ref:c,'onUpdate:modelValue':t[1]||(t[1]=e=>s.value=e),type:'number',class:'acu-purge-input',placeholder:'End',min:'0',onKeydown:(0,i.withKeys)(g,['enter'])},null,544),[[i.vModelText,s.value,void 0,{number:!0}]])])]),(0,i.createCommentVNode)(' 按钮区 '),(0,i.createElementVNode)('div',bo,[(0,i.createElementVNode)('button',{class:'acu-purge-btn acu-purge-btn-cancel',onClick:m},'取消'),(0,i.createElementVNode)('button',{class:'acu-purge-btn acu-purge-btn-confirm',disabled:!d.value,onClick:g},' 确认清除 ',8,vo)])],512)])):(0,i.createCommentVNode)('v-if',!0)}}),xo={class:'acu-sortable-list'},wo=['onClick'],yo={class:'acu-sort-controls'},ko=['disabled','onClick'],Co=['disabled','onClick'],No={class:'acu-item-content'},Vo=['onClick'],Eo={key:0,class:'acu-sortable-empty'},zo=(0,i.defineComponent)({__name:'SortableList',props:{items:{},selectedId:{default:''},showRemove:{type:Boolean,default:!0}},emits:['reorder','remove','select'],setup(e,{emit:a}){const t=e,o=a;return(a,n)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',xo,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(e.items,(a,r)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:a.id,class:(0,i.normalizeClass)(['acu-sortable-item',{selected:e.selectedId===a.id}]),onClick:e=>o('select',a)},[(0,i.createCommentVNode)(' 移动按钮 '),(0,i.createElementVNode)('div',yo,[(0,i.createElementVNode)('button',{class:'acu-sort-btn',disabled:0===r,title:'上移',onClick:(0,i.withModifiers)(e=>(e=>{if(0===e)return;const a=[...t.items];[a[e-1],a[e]]=[a[e],a[e-1]],o('reorder',a)})(r),['stop'])},[...n[0]||(n[0]=[(0,i.createElementVNode)('i',{class:'fas fa-chevron-up'},null,-1)])],8,ko),(0,i.createElementVNode)('button',{class:'acu-sort-btn',disabled:r===e.items.length-1,title:'下移',onClick:(0,i.withModifiers)(e=>(e=>{if(e===t.items.length-1)return;const a=[...t.items];[a[e],a[e+1]]=[a[e+1],a[e]],o('reorder',a)})(r),['stop'])},[...n[1]||(n[1]=[(0,i.createElementVNode)('i',{class:'fas fa-chevron-down'},null,-1)])],8,Co)]),(0,i.createCommentVNode)(' 项目内容 '),(0,i.createElementVNode)('div',No,[a.icon?((0,i.openBlock)(),(0,i.createElementBlock)('i',{key:0,class:(0,i.normalizeClass)(['fas',a.icon])},null,2)):(0,i.createCommentVNode)('v-if',!0),(0,i.createElementVNode)('span',null,(0,i.toDisplayString)(a.name||a.label),1)]),(0,i.createCommentVNode)(' 删除按钮 '),e.showRemove?((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:0,class:'acu-remove-btn',title:'移除',onClick:(0,i.withModifiers)(e=>(e=>{o('remove',t.items[e])})(r),['stop'])},[...n[2]||(n[2]=[(0,i.createElementVNode)('i',{class:'fas fa-times'},null,-1)])],8,Vo)):(0,i.createCommentVNode)('v-if',!0)],10,wo))),128)),(0,i.createCommentVNode)(' 空状态 '),0===e.items.length?((0,i.openBlock)(),(0,i.createElementBlock)('div',Eo,[(0,i.renderSlot)(a.$slots,'empty',{},()=>[n[3]||(n[3]=(0,i.createElementVNode)('span',null,'暂无项目',-1))])])):(0,i.createCommentVNode)('v-if',!0)]))}});r(202);const Bo=(0,po.A)(zo,[['__scopeId','data-v-23a88fea']]),So={class:'acu-button-config-panel'},To={class:'acu-config-section'},Ao={class:'acu-config-section'},Uo={class:'acu-button-list'},Do=['onClick'],Mo={class:'button-main'},_o={class:'button-label'},Io={key:0,class:'fas fa-check check-icon'},$o={key:0,class:'button-hint'},Po=(0,i.defineComponent)({__name:'NavButtonConfigPanel',setup(e){const a=ae(),t=(0,i.computed)(()=>J.filter(e=>!e.hidden)),o=(0,i.computed)(()=>a.config.visibleButtons),n=(0,i.computed)(()=>{const e=a.config.buttonOrder,t=[],n=o.value.slice().sort((a,t)=>e.indexOf(a)-e.indexOf(t));for(const e of n){const a=J.find(a=>a.id===e);a&&t.push({id:a.id,name:a.label,label:a.label,icon:a.icon})}return t}),r={saveAs:'另存为',openNative:'原生编辑器'},c=e=>o.value.includes(e),l=e=>{const t=e.map(e=>e.id),n=a.config.buttonOrder.filter(e=>!o.value.includes(e));a.setButtonOrder([...t,...n])},s=e=>{'settings'!==e.id&&a.toggleButtonVisibility(e.id)},u=()=>{a.setVisibleButtons(['save','refresh','settings','pin','toggle']),a.setButtonOrder(['save','saveAs','refresh','manualUpdate','purge','pin','toggle','settings'])};return(e,d)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',So,[(0,i.createElementVNode)('div',{class:'acu-config-header'},[d[1]||(d[1]=(0,i.createElementVNode)('h3',null,'导航栏按钮配置',-1)),(0,i.createElementVNode)('button',{class:'acu-btn-text',onClick:u},[...d[0]||(d[0]=[(0,i.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,i.createTextVNode)(' 重置',-1)])])]),(0,i.createCommentVNode)(' 已启用的按钮 '),(0,i.createElementVNode)('div',To,[(0,i.createElementVNode)('h4',null,'已启用的按钮 ('+(0,i.toDisplayString)(o.value.length)+')',1),(0,i.createVNode)(Bo,{items:n.value,'show-remove':!0,onReorder:l,onRemove:s},{empty:(0,i.withCtx)(()=>[...d[2]||(d[2]=[(0,i.createElementVNode)('span',null,'请至少选择一个按钮',-1)])]),_:1},8,['items'])]),(0,i.createCommentVNode)(' 可用按钮 '),(0,i.createElementVNode)('div',Ao,[d[3]||(d[3]=(0,i.createElementVNode)('h4',null,'可用按钮',-1)),(0,i.createElementVNode)('div',Uo,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(t.value,e=>{return(0,i.openBlock)(),(0,i.createElementBlock)('div',{key:e.id,class:(0,i.normalizeClass)(['acu-button-item',{selected:c(e.id),disabled:'settings'===e.id}]),onClick:t=>(e=>{'settings'!==e.id&&a.toggleButtonVisibility(e.id)})(e)},[(0,i.createElementVNode)('div',Mo,[(0,i.createElementVNode)('i',{class:(0,i.normalizeClass)(['fas',e.icon])},null,2),(0,i.createElementVNode)('span',_o,(0,i.toDisplayString)(e.label),1),c(e.id)?((0,i.openBlock)(),(0,i.createElementBlock)('i',Io)):(0,i.createCommentVNode)('v-if',!0)]),e.longPress?((0,i.openBlock)(),(0,i.createElementBlock)('div',$o,[(0,i.createElementVNode)('span',null,'长按: '+(0,i.toDisplayString)((t=e.longPress,r[t]||t)),1)])):(0,i.createCommentVNode)('v-if',!0)],10,Do);var t}),128))])]),(0,i.createCommentVNode)(' 提示信息 '),d[4]||(d[4]=(0,i.createElementVNode)('div',{class:'acu-config-hint'},[(0,i.createElementVNode)('i',{class:'fas fa-info-circle'}),(0,i.createElementVNode)('span',null,'设置按钮不可隐藏，确保始终可以访问设置')],-1))]))}});r(514);const Fo=(0,po.A)(Po,[['__scopeId','data-v-ded612aa']]),jo={class:'acu-tab-config-panel'},Lo={class:'acu-config-section'},Ro={class:'acu-config-section'},Oo={class:'acu-tab-grid'},Ho=['onClick'],qo={class:'tab-name'},Yo={key:0,class:'fas fa-check'},Xo=(0,i.defineComponent)({__name:'TabConfigPanel',setup(e){const a=xe(),t=ie(),o=(0,i.computed)(()=>Object.keys(t.tables).map(e=>({id:e,label:e}))),n=(0,i.computed)(()=>a.visibleTabs),r=(0,i.computed)(()=>{const e=[];for(const a of n.value){const t=o.value.find(e=>e.id===a);t&&e.push({id:t.id,name:t.label,label:t.label})}return e}),c=e=>n.value.includes(e),l=e=>{const t=e.map(e=>e.id);a.setVisibleTabs(t)},s=e=>{a.toggleTabVisibility(e.id)},u=()=>{a.resetVisibleTabs()};return(e,t)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',jo,[(0,i.createElementVNode)('div',{class:'acu-config-header'},[t[1]||(t[1]=(0,i.createElementVNode)('h3',null,'表格展示选择',-1)),(0,i.createElementVNode)('button',{class:'acu-btn-text',onClick:u},[...t[0]||(t[0]=[(0,i.createElementVNode)('i',{class:'fas fa-undo'},null,-1),(0,i.createTextVNode)(' 重置',-1)])])]),(0,i.createCommentVNode)(' 已选中的表格 '),(0,i.createElementVNode)('div',Lo,[(0,i.createElementVNode)('h4',null,'已选中的表格 ('+(0,i.toDisplayString)(r.value.length)+')',1),(0,i.createVNode)(Bo,{items:r.value,'show-remove':!0,onReorder:l,onRemove:s},{empty:(0,i.withCtx)(()=>[...t[2]||(t[2]=[(0,i.createElementVNode)('span',null,'未选择任何表格，将显示全部',-1)])]),_:1},8,['items'])]),(0,i.createCommentVNode)(' 可用表格库 '),(0,i.createElementVNode)('div',Ro,[t[3]||(t[3]=(0,i.createElementVNode)('h4',null,'可用表格',-1)),(0,i.createElementVNode)('div',Oo,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(o.value,e=>((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:e.id,class:(0,i.normalizeClass)(['acu-tab-grid-item',{selected:c(e.id)}]),onClick:t=>(e=>{a.toggleTabVisibility(e.id)})(e)},[(0,i.createElementVNode)('span',qo,(0,i.toDisplayString)(e.label),1),c(e.id)?((0,i.openBlock)(),(0,i.createElementBlock)('i',Yo)):(0,i.createCommentVNode)('v-if',!0)],10,Ho))),128))])]),(0,i.createCommentVNode)(' 提示信息 '),t[4]||(t[4]=(0,i.createElementVNode)('div',{class:'acu-config-hint'},[(0,i.createElementVNode)('i',{class:'fas fa-info-circle'}),(0,i.createElementVNode)('span',null,'未选择任何表格时将显示全部表格')],-1))]))}});r(453);const Wo=(0,po.A)(Xo,[['__scopeId','data-v-26f88eaa']]),Ko={class:'acu-modal-header'},Jo={class:'acu-modal-title'},Go={class:'acu-modal-body'},Qo={class:'acu-settings-section'},Zo={class:'acu-settings-group'},en={class:'acu-settings-row'},an={class:'acu-settings-control'},tn=['value'],on={class:'acu-settings-row'},nn={class:'acu-settings-control'},rn=['value'],cn={class:'acu-settings-row'},ln={class:'acu-settings-control'},sn={class:'acu-settings-row'},un={class:'acu-settings-label'},dn={class:'hint'},pn={class:'acu-settings-control'},gn={class:'acu-settings-row'},mn={class:'acu-settings-label'},fn={class:'hint'},bn={class:'acu-settings-control'},vn={class:'acu-settings-row'},hn={class:'acu-settings-label'},xn={class:'hint'},wn={class:'acu-settings-control'},yn={class:'acu-settings-row'},kn={class:'acu-settings-label'},Cn={class:'hint'},Nn={class:'acu-settings-control'},Vn={class:'acu-settings-section'},En={class:'acu-settings-group'},zn={class:'acu-settings-row'},Bn={class:'acu-settings-control'},Sn={key:0,class:'acu-settings-row acu-color-picker-row'},Tn={class:'acu-settings-control'},An={class:'acu-color-row'},Un=['title','onClick'],Dn={key:1,class:'acu-settings-row acu-color-picker-row'},Mn={class:'acu-settings-control'},_n={class:'acu-color-row'},In=['title','onClick'],$n={class:'acu-settings-row'},Pn={class:'acu-settings-control'},Fn={key:2,class:'acu-settings-row acu-color-picker-row'},jn={class:'acu-settings-control'},Ln={class:'acu-color-row'},Rn=['title','onClick'],On={class:'acu-settings-section'},Hn={class:'acu-settings-group'},qn={class:'acu-settings-section'},Yn={class:'acu-settings-group'},Xn={class:'acu-settings-row'},Wn={class:'acu-settings-control'},Kn={class:'acu-settings-row'},Jn={class:'acu-settings-control'},Gn={class:'acu-settings-row'},Qn={class:'acu-settings-control'},Zn={class:'acu-settings-row'},er={class:'acu-settings-control'},ar=(0,i.defineComponent)({__name:'SettingsDialog',props:{visible:{type:Boolean}},emits:['update:visible'],setup(e,{emit:a}){const t=e,o=a,n=(0,i.ref)(),r=ae(),c=(0,i.ref)('main'),l=(0,i.reactive)({...r.config});(0,i.watch)(l,e=>{r.updateConfig(e)},{deep:!0});const s=(0,i.computed)(()=>{switch(c.value){case'tabConfig':return'表格展示选择';case'buttonConfig':return'导航栏按钮配置';default:return'设置'}}),u=((0,i.computed)(()=>{switch(c.value){case'tabConfig':return'fas fa-table';case'buttonConfig':return'fas fa-ellipsis-h';default:return'fas fa-cog'}}),e=>{c.value=e}),d=()=>{c.value='main'};(0,i.watch)(()=>t.visible,e=>{e&&(Object.assign(l,r.config),c.value='main')}),D(n,()=>{g()});const p=()=>{o('update:visible',!1)},g=()=>{o('update:visible',!1)};return(a,t)=>((0,i.openBlock)(),(0,i.createBlock)(i.Transition,{name:'modal'},{default:(0,i.withCtx)(()=>[e.visible?((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,class:'acu-modal-container',onClick:(0,i.withModifiers)(g,['self'])},[(0,i.createElementVNode)('div',{ref_key:'dialogRef',ref:n,class:'acu-modal acu-settings-modal'},[(0,i.createCommentVNode)(' 头部 '),(0,i.createElementVNode)('div',Ko,[(0,i.createCommentVNode)(' 返回按钮（仅在子面板时显示） '),'main'!==c.value?((0,i.openBlock)(),(0,i.createElementBlock)('button',{key:0,class:'acu-modal-back',onClick:(0,i.withModifiers)(d,['stop'])},[...t[15]||(t[15]=[(0,i.createElementVNode)('i',{class:'fas fa-arrow-left'},null,-1)])])):(0,i.createCommentVNode)('v-if',!0),(0,i.createElementVNode)('span',Jo,(0,i.toDisplayString)(s.value),1),(0,i.createCommentVNode)(' 胶囊式完成按钮 '),(0,i.createElementVNode)('button',{class:'acu-close-pill',onClick:(0,i.withModifiers)(p,['stop'])},'完成')]),(0,i.createCommentVNode)(' 内容 '),(0,i.createElementVNode)('div',Go,[(0,i.createCommentVNode)(' ============ 主设置面板 ============ '),'main'===c.value?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:0},[(0,i.createCommentVNode)(' 外观与布局（合并）'),(0,i.createElementVNode)('div',Qo,[t[24]||(t[24]=(0,i.createElementVNode)('div',{class:'acu-settings-title'},[(0,i.createElementVNode)('i',{class:'fas fa-palette'}),(0,i.createTextVNode)(' 外观与布局 ')],-1)),(0,i.createElementVNode)('div',Zo,[(0,i.createCommentVNode)(' 主题选择 '),(0,i.createElementVNode)('div',en,[t[16]||(t[16]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 主题风格 '),(0,i.createElementVNode)('span',{class:'hint'},'选择界面配色方案')],-1)),(0,i.createElementVNode)('div',an,[(0,i.withDirectives)((0,i.createElementVNode)('select',{'onUpdate:modelValue':t[0]||(t[0]=e=>l.theme=e)},[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)((0,i.unref)(Q),e=>((0,i.openBlock)(),(0,i.createElementBlock)('option',{key:e.id,value:e.id},(0,i.toDisplayString)(e.name),9,tn))),128))],512),[[i.vModelSelect,l.theme]])])]),(0,i.createCommentVNode)(' 字体选择 '),(0,i.createElementVNode)('div',on,[t[17]||(t[17]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 显示字体 '),(0,i.createElementVNode)('span',{class:'hint'},'选择界面字体')],-1)),(0,i.createElementVNode)('div',nn,[(0,i.withDirectives)((0,i.createElementVNode)('select',{'onUpdate:modelValue':t[1]||(t[1]=e=>l.fontFamily=e)},[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)((0,i.unref)(Z),e=>((0,i.openBlock)(),(0,i.createElementBlock)('option',{key:e.id,value:e.id},(0,i.toDisplayString)(e.name),9,rn))),128))],512),[[i.vModelSelect,l.fontFamily]])])]),(0,i.createCommentVNode)(' 布局模式 '),(0,i.createElementVNode)('div',cn,[t[19]||(t[19]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 布局模式 '),(0,i.createElementVNode)('span',{class:'hint'},'卡片排列方向')],-1)),(0,i.createElementVNode)('div',ln,[(0,i.withDirectives)((0,i.createElementVNode)('select',{'onUpdate:modelValue':t[2]||(t[2]=e=>l.layout=e)},[...t[18]||(t[18]=[(0,i.createElementVNode)('option',{value:'vertical'},'纵向布局',-1),(0,i.createElementVNode)('option',{value:'horizontal'},'横向布局',-1)])],512),[[i.vModelSelect,l.layout]])])]),(0,i.createCommentVNode)(' 字体大小 '),(0,i.createElementVNode)('div',sn,[(0,i.createElementVNode)('div',un,[t[20]||(t[20]=(0,i.createTextVNode)(' 字体大小 ',-1)),(0,i.createElementVNode)('span',dn,(0,i.toDisplayString)(l.fontSize)+'px',1)]),(0,i.createElementVNode)('div',pn,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[3]||(t[3]=e=>l.fontSize=e),type:'range',min:'12',max:'18',step:'1'},null,512),[[i.vModelText,l.fontSize,void 0,{number:!0}]])])]),(0,i.createCommentVNode)(' 卡片宽度 '),(0,i.createElementVNode)('div',gn,[(0,i.createElementVNode)('div',mn,[t[21]||(t[21]=(0,i.createTextVNode)(' 卡片宽度 ',-1)),(0,i.createElementVNode)('span',fn,(0,i.toDisplayString)(l.cardWidth)+'px',1)]),(0,i.createElementVNode)('div',bn,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[4]||(t[4]=e=>l.cardWidth=e),type:'range',min:'200',max:'400',step:'10'},null,512),[[i.vModelText,l.cardWidth,void 0,{number:!0}]])])]),(0,i.createCommentVNode)(' 表格按钮列数 '),(0,i.createElementVNode)('div',vn,[(0,i.createElementVNode)('div',hn,[t[22]||(t[22]=(0,i.createTextVNode)(' 表格按钮列数 ',-1)),(0,i.createElementVNode)('span',xn,(0,i.toDisplayString)(0===l.gridColumns?'自适应':`${l.gridColumns} 列`),1)]),(0,i.createElementVNode)('div',wn,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[5]||(t[5]=e=>l.gridColumns=e),type:'range',min:'0',max:'6',step:'1'},null,512),[[i.vModelText,l.gridColumns,void 0,{number:!0}]])])]),(0,i.createCommentVNode)(' 每页显示数 '),(0,i.createElementVNode)('div',yn,[(0,i.createElementVNode)('div',kn,[t[23]||(t[23]=(0,i.createTextVNode)(' 每页显示条数 ',-1)),(0,i.createElementVNode)('span',Cn,(0,i.toDisplayString)(l.itemsPerPage)+' 条',1)]),(0,i.createElementVNode)('div',Nn,[(0,i.withDirectives)((0,i.createElementVNode)('input',{'onUpdate:modelValue':t[6]||(t[6]=e=>l.itemsPerPage=e),type:'range',min:'10',max:'100',step:'10'},null,512),[[i.vModelText,l.itemsPerPage,void 0,{number:!0}]])])])])]),(0,i.createCommentVNode)(' 高亮设置 '),(0,i.createElementVNode)('div',Vn,[t[30]||(t[30]=(0,i.createElementVNode)('div',{class:'acu-settings-title'},[(0,i.createElementVNode)('i',{class:'fas fa-highlighter'}),(0,i.createTextVNode)(' 高亮 ')],-1)),(0,i.createElementVNode)('div',En,[(0,i.createCommentVNode)(' 高亮新内容 '),(0,i.createElementVNode)('div',zn,[t[25]||(t[25]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 高亮变动内容 '),(0,i.createElementVNode)('span',{class:'hint'},'突出显示有变化的数据')],-1)),(0,i.createElementVNode)('div',Bn,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-switch',{active:l.highlightNew}]),onClick:t[7]||(t[7]=e=>l.highlightNew=!l.highlightNew)},null,2)])]),(0,i.createCommentVNode)(' 手动修改高亮颜色 - 圆点选择器 '),l.highlightNew?((0,i.openBlock)(),(0,i.createElementBlock)('div',Sn,[t[26]||(t[26]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 手动修改高亮 '),(0,i.createElementVNode)('span',{class:'hint'},'手动编辑内容的标记颜色')],-1)),(0,i.createElementVNode)('div',Tn,[(0,i.createElementVNode)('div',An,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)((0,i.unref)(ee),(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:a,class:(0,i.normalizeClass)(['acu-color-circle',{selected:l.highlightManualColor===a}]),style:(0,i.normalizeStyle)({backgroundColor:e.main}),title:e.name,onClick:e=>l.highlightManualColor=a},null,14,Un))),128))])])])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' AI填表高亮颜色 - 圆点选择器 '),l.highlightNew?((0,i.openBlock)(),(0,i.createElementBlock)('div',Dn,[t[27]||(t[27]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' AI填表高亮 '),(0,i.createElementVNode)('span',{class:'hint'},'AI自动填写内容的标记颜色')],-1)),(0,i.createElementVNode)('div',Mn,[(0,i.createElementVNode)('div',_n,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)((0,i.unref)(ee),(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:a,class:(0,i.normalizeClass)(['acu-color-circle',{selected:l.highlightAiColor===a}]),style:(0,i.normalizeStyle)({backgroundColor:e.main}),title:e.name,onClick:e=>l.highlightAiColor=a},null,14,In))),128))])])])):(0,i.createCommentVNode)('v-if',!0),(0,i.createCommentVNode)(' 自定义标题颜色 '),(0,i.createElementVNode)('div',$n,[t[28]||(t[28]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 自定义标题颜色 '),(0,i.createElementVNode)('span',{class:'hint'},'使用独立的标题颜色')],-1)),(0,i.createElementVNode)('div',Pn,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-switch',{active:l.customTitleColor}]),onClick:t[8]||(t[8]=e=>l.customTitleColor=!l.customTitleColor)},null,2)])]),(0,i.createCommentVNode)(' 标题颜色 - 圆点选择器（仅当启用自定义时显示） '),l.customTitleColor?((0,i.openBlock)(),(0,i.createElementBlock)('div',Fn,[t[29]||(t[29]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 标题颜色 '),(0,i.createElementVNode)('span',{class:'hint'},'表格标题的颜色')],-1)),(0,i.createElementVNode)('div',jn,[(0,i.createElementVNode)('div',Ln,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)((0,i.unref)(ee),(e,a)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:a,class:(0,i.normalizeClass)(['acu-color-circle',{selected:l.titleColor===a}]),style:(0,i.normalizeStyle)({backgroundColor:e.main}),title:e.name,onClick:e=>l.titleColor=a},null,14,Rn))),128))])])])):(0,i.createCommentVNode)('v-if',!0)])]),(0,i.createCommentVNode)(' 界面配置入口（使用圆角容器）'),(0,i.createElementVNode)('div',On,[t[33]||(t[33]=(0,i.createElementVNode)('div',{class:'acu-settings-title'},[(0,i.createElementVNode)('i',{class:'fas fa-columns'}),(0,i.createTextVNode)(' 界面配置 ')],-1)),(0,i.createElementVNode)('div',Hn,[(0,i.createCommentVNode)(' 表格展示选择入口 '),(0,i.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:t[9]||(t[9]=e=>u('tabConfig'))},[...t[31]||(t[31]=[(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 表格自定义配置 '),(0,i.createElementVNode)('span',{class:'hint'},'选择要显示的表格及排序')],-1),(0,i.createElementVNode)('div',{class:'acu-settings-control'},[(0,i.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])]),(0,i.createCommentVNode)(' 导航栏按钮配置入口 '),(0,i.createElementVNode)('div',{class:'acu-settings-row acu-nav-row',onClick:t[10]||(t[10]=e=>u('buttonConfig'))},[...t[32]||(t[32]=[(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 导航栏按钮自定义配置 '),(0,i.createElementVNode)('span',{class:'hint'},'自定义导航栏显示的按钮')],-1),(0,i.createElementVNode)('div',{class:'acu-settings-control'},[(0,i.createElementVNode)('i',{class:'fas fa-chevron-right'})],-1)])])])]),(0,i.createCommentVNode)(' 行为设置 '),(0,i.createElementVNode)('div',qn,[t[38]||(t[38]=(0,i.createElementVNode)('div',{class:'acu-settings-title'},[(0,i.createElementVNode)('i',{class:'fas fa-sliders-h'}),(0,i.createTextVNode)(' 行为 ')],-1)),(0,i.createElementVNode)('div',Yn,[(0,i.createCommentVNode)(' 显示分页 (移除了仪表盘开关) '),(0,i.createElementVNode)('div',Xn,[t[34]||(t[34]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 显示分页器 '),(0,i.createElementVNode)('span',{class:'hint'},'表格底部分页控件')],-1)),(0,i.createElementVNode)('div',Wn,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-switch',{active:l.showPagination}]),onClick:t[11]||(t[11]=e=>l.showPagination=!l.showPagination)},null,2)])]),(0,i.createCommentVNode)(' 限制长文本 '),(0,i.createElementVNode)('div',Kn,[t[35]||(t[35]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 限制长文本 '),(0,i.createElementVNode)('span',{class:'hint'},'超长内容自动截断')],-1)),(0,i.createElementVNode)('div',Jn,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-switch',{active:l.limitLongText}]),onClick:t[12]||(t[12]=e=>l.limitLongText=!l.limitLongText)},null,2)])]),(0,i.createCommentVNode)(' 锁定面板位置 '),(0,i.createElementVNode)('div',Gn,[t[36]||(t[36]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 锁定面板位置 '),(0,i.createElementVNode)('span',{class:'hint'},'禁止拖动面板')],-1)),(0,i.createElementVNode)('div',Qn,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-switch',{active:l.lockPanel}]),onClick:t[13]||(t[13]=e=>l.lockPanel=!l.lockPanel)},null,2)])]),(0,i.createCommentVNode)(' 清除确认 '),(0,i.createElementVNode)('div',Zn,[t[37]||(t[37]=(0,i.createElementVNode)('div',{class:'acu-settings-label'},[(0,i.createTextVNode)(' 清除操作确认 '),(0,i.createElementVNode)('span',{class:'hint'},'删除数据前需确认')],-1)),(0,i.createElementVNode)('div',er,[(0,i.createElementVNode)('button',{class:(0,i.normalizeClass)(['acu-switch',{active:l.purgeConfirmation}]),onClick:t[14]||(t[14]=e=>l.purgeConfirmation=!l.purgeConfirmation)},null,2)])])])])],64)):'tabConfig'===c.value?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createCommentVNode)(' ============ Tab 配置面板 ============ '),(0,i.createVNode)(Wo)],2112)):'buttonConfig'===c.value?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:2},[(0,i.createCommentVNode)(' ============ 导航栏按钮配置面板 ============ '),(0,i.createVNode)(Fo)],2112)):(0,i.createCommentVNode)('v-if',!0)]),(0,i.createCommentVNode)(' 底部留白适配移动端安全区 '),t[39]||(t[39]=(0,i.createElementVNode)('div',{class:'acu-bottom-spacer'},'—— ACU Visualizer 7.0.9 ——',-1))],512)])):(0,i.createCommentVNode)('v-if',!0)]),_:1}))}});r(538);const tr=(0,po.A)(ar,[['__scopeId','data-v-42d4787f']]),or={class:'acu-action-bar'},nr=['title','onClick','onMousedown','onTouchstartPassive'];Boolean,Boolean;r(952);const rr={class:'acu-toast-message'},ir=(0,i.defineComponent)({__name:'Toast',props:{visible:{type:Boolean},message:{},type:{default:'info'}},setup(e){const a=e,t=(0,i.computed)(()=>`acu-toast-${a.type}`),o=(0,i.computed)(()=>{switch(a.type){case'success':return'fas fa-check-circle';case'error':return'fas fa-times-circle';case'warning':return'fas fa-exclamation-triangle';default:return'fas fa-info-circle'}});return(a,n)=>((0,i.openBlock)(),(0,i.createBlock)(i.Transition,{name:'toast'},{default:(0,i.withCtx)(()=>[e.visible?((0,i.openBlock)(),(0,i.createElementBlock)('div',{key:0,class:(0,i.normalizeClass)(['acu-toast',t.value])},[(0,i.createElementVNode)('i',{class:(0,i.normalizeClass)(o.value)},null,2),(0,i.createElementVNode)('span',rr,(0,i.toDisplayString)(e.message),1)],2)):(0,i.createCommentVNode)('v-if',!0)]),_:1}))}}),cr=(0,i.defineComponent)({__name:'App',setup(e){const a=xe(),t=ie(),o=ae(),{init:n,cleanup:r}=Ne(),{saveToDatabase:c,getTableData:l,purgeFloorRange:s,stopAutoSave:u}=Ue(),{state:d}=(0,Se.d)();!function(){const e=(0,i.ref)(0),a=(0,i.ref)(0);let t=null,o=null;function n(t){const o=t.target;if(!o.closest?.('.acu-layout-horizontal .acu-panel-content'))return;const n=t.touches[0];e.value=n.clientX,a.value=n.clientY}function r(t){const o=t.target;if(!o.closest?.('.acu-layout-horizontal .acu-panel-content'))return;if('INPUT'===o.tagName||'TEXTAREA'===o.tagName||o.isContentEditable)return;let n=o,r=!1;for(;n&&n.classList&&!n.classList.contains('acu-panel-content');){if(n.scrollHeight>n.clientHeight){const e=window.getComputedStyle(n);if(['auto','scroll'].includes(e.overflowY)){r=!0;break}}n=n.parentElement}if(r)return;const i=t.touches[0],c=i.clientX-e.value,l=i.clientY-a.value;Math.abs(l)>Math.abs(c)&&t.cancelable&&t.preventDefault()}function c(){const e=window.parent?.document;e?(t=n,o=r,e.addEventListener('touchstart',t,{capture:!0,passive:!1}),e.addEventListener('touchmove',o,{capture:!0,passive:!1}),console.info('[ACU] 触摸滚动修复已安装（composable 管理）')):console.warn('[ACU] 无法访问父窗口 document，触摸滚动修复未安装')}function l(){const e=window.parent?.document;e&&(t&&(e.removeEventListener('touchstart',t,{capture:!0}),t=null),o&&(e.removeEventListener('touchmove',o,{capture:!0}),o=null),console.info('[ACU] 触摸滚动修复已卸载'))}(0,i.onMounted)(()=>{c()}),(0,i.onUnmounted)(()=>{l()})}(),Be();const p=(0,i.ref)(),g=(0,i.ref)(),m=(0,i.ref)(''),f=(0,i.ref)(!1),b=(0,i.ref)(!1),v=(0,i.ref)(!1),h=(0,i.ref)(!1),x=(0,i.ref)(!1),w=(0,i.reactive)({visible:!1,x:0,y:0,tableId:'',tableName:'',rowIndex:0,isDeleting:!1}),y=(0,i.computed)(()=>[`acu-theme-${o.config.theme}`,`acu-font-${o.config.fontFamily.replace(/\s+/g,'-').toLowerCase()}`,{'acu-mobile':a.isMobile,'acu-layout-horizontal':'horizontal'===o.config.layout,'acu-layout-vertical':'vertical'===o.config.layout}]),k=(0,i.computed)(()=>a.activeTab===ve?'ACU 仪表盘':a.activeTab===he?'ACU 选项面板':`ACU - ${a.activeTab||'可视化表格'}`),C=(0,i.computed)(()=>{const e=t.stagedData;if(!e)return[];const a=function(e){if(!e||'object'!=typeof e)return{};const a={};for(const t in e)if(e[t]?.name){const o=e[t];a[o.name]={key:t,headers:o.content?.[0]||[],rows:o.content?.slice(1)||[]}}return Object.keys(a).length>0?a:null}(e);return a?Object.entries(a).map(([e,a])=>{const{key:t,headers:o,rows:n}=a,r=n.map((a,t)=>{const n=a.map((e,a)=>({colIndex:a,key:o[a]||`col_${a}`,value:String(e??'')}));return{index:t,key:`${e}-row-${t}`,cells:n}});return{id:t,name:e,headers:o.map(e=>String(e)),rows:r}}):[]}),N=(0,i.computed)(()=>C.value.map(e=>({id:e.id,name:e.name,icon:A(e.name)}))),V=(0,i.computed)(()=>C.value.some(e=>e.name.includes('选项')||e.name.toLowerCase().includes('option'))),E=(0,i.computed)(()=>C.value.filter(e=>e.name.includes('选项')||e.name.toLowerCase().includes('option'))),B=(0,i.computed)(()=>a.activeTab&&C.value.find(e=>e.id===a.activeTab)||null),S=(0,i.computed)(()=>0),T=(0,i.computed)(()=>{const e=window.SillyTavern?.chat;return Array.isArray(e)?e.length-1:0});function A(e){const a=e.toLowerCase();return a.includes('主角')||a.includes('player')?'fas fa-user':a.includes('npc')||a.includes('角色')?'fas fa-users':a.includes('任务')||a.includes('quest')?'fas fa-tasks':a.includes('物品')||a.includes('item')?'fas fa-box-open':a.includes('技能')||a.includes('skill')?'fas fa-magic':a.includes('装备')||a.includes('equip')?'fas fa-shield-alt':a.includes('状态')||a.includes('status')?'fas fa-heart':a.includes('事件')||a.includes('event')?'fas fa-calendar-alt':a.includes('选项')||a.includes('option')?'fas fa-sliders-h':'fas fa-table'}function U(){a.closePanel(),console.info('[ACU] 面板已关闭')}function D(){f.value=!f.value}function M(){a.isCollapsed=!0,console.info('[ACU] 面板已收起为悬浮球')}function I(e){a.setActiveTab(e),m.value='',console.info(`[ACU] 切换到 Tab: ${e}`),(0,i.nextTick)(()=>{P(e)})}function P(e){const t=g.value?.getDataAreaElement();if(!t)return;const o=a.getTableHeight(e);o?(t.style.height=`${o}px`,console.info(`[ACU] 恢复高度: ${e} = ${o}px`)):g.value?.resetHeight()}function F(e){a.setTableOrder(e),console.info('[ACU] Tab 顺序已更新')}function j(e){a.setActiveTab(e),console.info(`[ACU] 导航到表格: ${e}`),(0,i.nextTick)(()=>{P(e)})}function L(){a.setActiveTab(ve),console.info('[ACU] 关闭表格，返回仪表盘'),(0,i.nextTick)(()=>{P(ve)})}function R(e,t){const o=g.value?.getDataAreaElement();if(!o)return;if(0!==e.button)return;e.preventDefault(),e.stopPropagation(),t.setPointerCapture(e.pointerId);const n=e.clientY,r=o.offsetHeight,i=e=>{const a=n-e.clientY;let t=r+a;const i=.8*(window.parent?.innerHeight??window.innerHeight);t=Math.max(200,Math.min(i,t)),o.style.height=`${t}px`},c=e=>{t.releasePointerCapture(e.pointerId),t.removeEventListener('pointermove',i),t.removeEventListener('pointerup',c);const n=a.activeTab;if(n&&o){const e=o.offsetHeight;a.setTableHeight(n,e),console.info(`[ACU] 保存高度: ${n} = ${e}px`)}};t.addEventListener('pointermove',i),t.addEventListener('pointerup',c)}function O(){const e=a.activeTab;e&&(a.resetTableHeight(e),console.info(`[ACU] 清除高度记忆: ${e}`)),g.value?.resetHeight(),console.info('[ACU] 高度已重置为自适应')}async function H(){const e=l();e&&(t.setStagedData(e),t.saveSnapshot(e),t.clearChanges(!0))}async function q(){try{await H(),console.info('[ACU] 数据已刷新')}catch(e){console.error('[ACU] 刷新失败:',e)}}async function Y(){try{await c()&&(console.info('[ACU] 数据已保存'),await H())}catch(e){console.error('[ACU] 保存失败:',e)}}function X(e,a,t){console.info(`[ACU] 单元格点击: ${e}[${a}][${t}]`)}function W(e,a){console.info(`[ACU] 行点击: ${e}[${a.index}]`)}async function K(e,a){console.info(`[ACU] 插入行: ${e} 在索引 ${a} 之后`);if(!C.value.find(a=>a.id===e))return void console.warn('[ACU] 未找到表格:',e);const{insertRow:t}=Ie();await t(e,a),await H()}function J(e,a){const o=C.value.find(a=>a.id===e),n=`${o?.name||e}-row-${a}`;t.toggleDelete(n),console.info(`[ACU] 切换删除状态: ${n}`)}function G(e,a,o){const n=C.value.find(e=>e.id===a),r=n?.name||a,i=`${r}-row-${o}`;w.visible=!0,w.x=e.clientX,w.y=e.clientY,w.tableId=a,w.tableName=r,w.rowIndex=o,w.isDeleting=t.pendingDeletes.has(i)}function Q(){K(w.tableId,w.rowIndex),w.visible=!1}function Z(){const e=C.value.find(e=>e.id===w.tableId),a=e?.rows[w.rowIndex];if(a){const e=a.cells.map(e=>`${e.key}: ${e.value}`).join('\n');navigator.clipboard.writeText(e).then(()=>{console.info('[ACU] 内容已复制')})}w.visible=!1}function ee(){J(w.tableId,w.rowIndex),w.visible=!1}function te(){J(w.tableId,w.rowIndex),w.visible=!1}function oe(){console.info('[ACU] 设置已保存')}function ne(){x.value=!0}function re(){try{const e=(window.parent||window).AutoCardUpdaterAPI||window.AutoCardUpdaterAPI;e&&'function'==typeof e.openVisualizer?(e.openVisualizer(),console.info('[ACU] 已打开原生编辑器')):console.warn('[ACU] AutoCardUpdaterAPI.openVisualizer 不可用')}catch(e){console.error('[ACU] 打开原生编辑器失败:',e)}}async function ce(e){try{await c(null,!1,!1,e)&&console.info(`[ACU] 数据已保存到第 ${e} 楼`)}catch(e){console.error('[ACU] 保存到指定楼层失败:',e)}}async function le(e,a){try{await s(e,a),console.info(`[ACU] 已清除第 ${e} 到 ${a} 楼的数据`),await H()}catch(e){console.error('[ACU] 清除范围失败:',e)}}return(0,i.onMounted)(async()=>{console.info('[ACU] App 组件已挂载'),n(),a.setMobile(window.innerWidth<=768),window.addEventListener('resize',()=>{a.setMobile(window.innerWidth<=768)});try{await H(),a.setInitialized(!0),!a.activeTab&&C.value.length>0&&a.setActiveTab(ve)}catch(e){console.error('[ACU] 初始化数据加载失败:',e)}}),(0,i.onUnmounted)(()=>{console.info('[ACU] App 组件已卸载'),u(),r()}),(0,i.onMounted)(()=>{const e=window.parent?.document||document,t=e=>{if(!a.isPanelVisible||a.isPinned)return;(function(e){const a=window.parent?.document||document;if(a.querySelector('.acu-inline-editor'))return console.info('[ACU] 检测到 InlineEditor 存在，阻止收起面板'),!0;if(a.querySelector('.acu-editing-lock'))return console.info('[ACU] 检测到编辑锁定状态，阻止收起面板'),!0;const t=a.activeElement;return!t||'TEXTAREA'!==t.tagName&&'INPUT'!==t.tagName||!t.closest('.acu-wrapper')&&!t.closest('.acu-inline-editor')?!!(e.closest('.acu-wrapper')||e.closest('.acu-floating-ball-vue')||e.closest('.acu-context-menu')||e.closest('.acu-modal-overlay')||e.closest('.acu-modal')||e.closest('.acu-dialog')||e.closest('[class*="acu-settings"]')||e.closest('#acu_visualizer_vue-root')||e.closest('.acu-inline-editor')||e.closest('.acu-editing-lock')||e.closest('.acu-edit-textarea')):(console.info('[ACU] 检测到 ACU 内的输入框活动，阻止收起面板'),!0)})(e.target)||(a.closePanel(),console.info('[ACU] 点击外部，面板已收起'))};e.addEventListener('click',t),(0,i.onUnmounted)(()=>{e.removeEventListener('click',t)})}),(0,i.watch)(()=>t.stagedData,e=>{e&&t.generateDiffMap(e)},{deep:!0}),(e,n)=>((0,i.openBlock)(),(0,i.createElementBlock)('div',{class:(0,i.normalizeClass)(['acu-app',y.value])},[(0,i.createCommentVNode)(' 悬浮球 (面板隐藏时显示) '),(0,i.createCommentVNode)(' :style 绑定在跨 iframe 脚本项目中是可用的（参考 src/手机界面） '),(0,i.createVNode)((0,i.unref)(ye),{ref_key:'floatingBallRef',ref:p,style:(0,i.normalizeStyle)({display:(0,i.unref)(a).isPanelVisible?'none':'block'})},null,8,['style']),(0,i.createCommentVNode)(' 主面板 '),(0,i.createCommentVNode)(' :style 绑定在跨 iframe 脚本项目中是可用的（参考 src/手机界面） '),(0,i.createVNode)((0,i.unref)(Re),{ref_key:'mainPanelRef',ref:g,style:(0,i.normalizeStyle)({display:(0,i.unref)(a).isPanelVisible?'flex':'none'}),title:k.value,theme:(0,i.unref)(o).config.theme,layout:(0,i.unref)(o).config.layout,'is-collapsed':(0,i.unref)(a).isCollapsed,'is-pinned':(0,i.unref)(a).isPinned,'is-content-hidden':f.value,'lock-panel':(0,i.unref)(o).config.lockPanel,'has-changes':(0,i.unref)(t).hasUnsavedChanges,onRefresh:q,onSave:Y,onSaveAs:n[2]||(n[2]=e=>v.value=!0),onManualUpdate:ne,onPurge:n[3]||(n[3]=e=>h.value=!0),onOpenNative:re,onSettings:n[4]||(n[4]=e=>b.value=!0),onTogglePin:(0,i.unref)(a).togglePin,onToggle:M,onClose:U,onHideContent:D},{tabs:(0,i.withCtx)(()=>[(0,i.createVNode)((0,i.unref)(qe),{tabs:N.value,'active-tab':(0,i.unref)(a).activeTab,'show-dashboard':!0,'has-options-tabs':V.value,'is-editing-order':(0,i.unref)(a).isEditingOrder,'grid-columns':(0,i.unref)(o).gridColumnsCss,onTabChange:I,onOrderChange:F,onExitEditing:n[0]||(n[0]=e=>(0,i.unref)(a).setEditingOrder(!1))},null,8,['tabs','active-tab','has-options-tabs','is-editing-order','grid-columns'])]),default:(0,i.withCtx)(()=>[(0,i.createCommentVNode)(' 仪表盘视图 '),(0,i.unref)(a).activeTab===(0,i.unref)(ve)?((0,i.openBlock)(),(0,i.createBlock)((0,i.unref)(Xa),{key:0,tables:C.value,onRefresh:q,onNavigate:j,onCellClick:X,onRowClick:W},null,8,['tables'])):(0,i.unref)(a).activeTab===(0,i.unref)(he)?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createCommentVNode)(' 选项面板视图 '),(0,i.createVNode)((0,i.unref)(kt),{tables:E.value,onCellClick:X,onToggleDelete:J},null,8,['tables'])],2112)):B.value?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:2},[(0,i.createCommentVNode)(' 普通表格视图 '),((0,i.openBlock)(),(0,i.createBlock)((0,i.unref)(st),{key:(0,i.unref)(a).activeTab,'table-id':B.value.id,'table-name':B.value.name,rows:B.value.rows,headers:B.value.headers,'search-term':m.value,onCellClick:X,onInsertRow:K,onToggleDelete:J,onContextMenu:G,onSearchChange:n[1]||(n[1]=e=>m.value=e),onClose:L,onHeightDragStart:R,onHeightReset:O},null,8,['table-id','table-name','rows','headers','search-term']))],2112)):((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:3},[(0,i.createCommentVNode)(' 无数据状态 '),n[10]||(n[10]=(0,i.createElementVNode)('div',{class:'acu-no-data'},[(0,i.createElementVNode)('i',{class:'fas fa-inbox'}),(0,i.createElementVNode)('p',null,'请选择一个表格')],-1))],2112))]),_:1},8,['style','title','theme','layout','is-collapsed','is-pinned','is-content-hidden','lock-panel','has-changes','onTogglePin']),(0,i.createCommentVNode)(' 右键菜单 '),(0,i.createVNode)((0,i.unref)(Ct),{visible:w.visible,'onUpdate:visible':n[5]||(n[5]=e=>w.visible=e),x:w.x,y:w.y,'table-id':w.tableId,'table-name':w.tableName,'row-index':w.rowIndex,onInsertRow:Q,onCopy:Z,onDelete:ee,onUndoDelete:te},null,8,['visible','x','y','table-id','table-name','row-index']),(0,i.createCommentVNode)(' 设置弹窗 '),(0,i.createVNode)((0,i.unref)(tr),{visible:b.value,'onUpdate:visible':n[6]||(n[6]=e=>b.value=e),onSave:oe},null,8,['visible']),(0,i.createCommentVNode)(' 输入楼层弹窗 '),(0,i.createVNode)((0,i.unref)(Wt),{visible:v.value,'onUpdate:visible':n[7]||(n[7]=e=>v.value=e),'current-floor':S.value,onConfirm:ce},null,8,['visible','current-floor']),(0,i.createCommentVNode)(' 清除范围弹窗 '),(0,i.createVNode)((0,i.unref)(ho),{visible:h.value,'onUpdate:visible':n[8]||(n[8]=e=>h.value=e),'max-floor':T.value,onConfirm:le},null,8,['visible','max-floor']),(0,i.createCommentVNode)(' 手动更新配置弹窗 '),(0,i.createVNode)((0,i.unref)(go),{visible:x.value,'onUpdate:visible':n[9]||(n[9]=e=>x.value=e)},null,8,['visible']),(0,i.createCommentVNode)(' 全局 Toast 通知 '),(0,i.createVNode)((0,i.unref)(ir),{visible:(0,i.unref)(d).visible,message:(0,i.unref)(d).message,type:(0,i.unref)(d).type},null,8,['visible','message','type'])],2))}}),lr=cr;window.$=window.parent.$;const sr='acu-parent-container';let ur=null,dr=null,pr=null,gr=!1;function mr(){let a=0;const t=()=>{if(gr)return void console.info('[ACU] 脚本正在卸载，停止 API 检查');const{$,getDB:o}=te(),n=o();if(n&&'function'==typeof n.exportTableAsJson&&$){const o=n.exportTableAsJson();if(!(o&&Object.keys(o).length>0)&&a<10)return a++,console.info(`[ACU] API 就绪但无数据，等待中... (${a}/10)`),void(pr=setTimeout(t,1e3));pr=null,function(){const a=window.parent.document;if(a.getElementById(sr))return void console.warn('[ACU] Vue 应用已存在，跳过重复初始化');dr=a.createElement('div'),dr.id=sr,a.body.appendChild(dr);const t=e();ur=(0,i.createApp)(lr),ur.use(t),ur.mount(dr),console.info(`[ACU] Vue 应用已挂载到父窗口 (${sr})`)}()}else pr=setTimeout(t,1e3)};t()}$(()=>{console.info(`[ACU] 脚本加载: ${sr}`),mr(),$(window).on('pagehide',()=>{console.info('[ACU] 页面卸载，执行清理'),console.info('[ACU] 开始清理资源...'),gr=!0,null!==pr&&(clearTimeout(pr),pr=null,console.info('[ACU] 初始化定时器已清除')),ur&&(ur.unmount(),ur=null,console.info('[ACU] Vue 应用已卸载')),dr&&(dr.remove(),dr=null,console.info('[ACU] 挂载点已移除')),console.info('[ACU] 资源清理完成')})});
//# sourceMappingURL=index.js.map